<!DOCTYPE html><html class="appearance-auto" lang="cn"><head><meta charset="UTF-8"><title>对母校终端机的一次渗透</title><meta name="description" content="J0o1ey Blog | Hack for Sec and Good"><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, initial-scale=1"><!-- Google Analytics --><!-- End Google Analytics -->
<!-- Baidu Analytics --><script>var _hmt = _hmt || [];
(function() {
var hm = document.createElement("script");
hm.src = "//hm.baidu.com/hm.js?" + '1da71ad199e154beef984da705235690';
var s = document.getElementsByTagName("script")[0];
s.parentNode.insertBefore(hm, s);
})();</script><!-- End Baidu Analytics --><link rel="icon" href="/images/favicon.ico"><link rel="stylesheet" href="/style/common/bulma.css"><link rel="stylesheet" href="/style/base.css"><link rel="stylesheet" href="/style/common/helper.css"><script src="/js/common.js"></script><link rel="stylesheet" href="/style/post.css"><link rel="stylesheet" href="/style/themes/highlight-theme-light.css"><link rel="stylesheet" href="/style/common/jquery.fancybox.min.css"><script src="/js/highlight.pack.js"></script><meta name="description" content="0x01 一点感悟又回到最初的起点 记忆中你青涩的脸
我们终于 来到了这一天                   —胡夏《那些年》
当这首歌的旋律在我耳边响起，我的思绪仿佛一下间重返多年前。有些情思，难以抓住，我已变成如今的自己。纵使很多故人难以重逢，生活难以重返，但是我依然坚信踏实地走好现在的路便是最好的选择。朋友们，好好珍惜现在处在一起的友情、爱情，这些青葱岁月的小幸运可能会成为人生中最美的一缕记忆。
趁着母校的学生还在上课，老师们没放假，我想回到母校走走，看看那些花儿、那些草木和那些日日夜夜陪伴我的老师。伴着发动机的轰鸣声，我来到了母校。
0x02:本性难移走在这片熟悉的土地上，抚摸大地的每一寸肌肤，嗅着花儿的芬芳，感受着蓝天白云，远山沧海之美，不由得有些心潮澎湃看着操场上奔跑的少年，校园里卿卿我我的.."><meta name="generator" content="Hexo 6.3.0"></head><body class="is-flex is-flex-direction-column"><header class="header-widget is-flex-shrink-0 is-hidden-mobile"><div class="container is-fullhd is-flex is-justify-content-space-between is-align-items-center is-full-height"><section class="is-hidden-mobile is-flex-shrink-0"><h2><a href="/">J0o1ey's blog</a></h2></section><h3 class="is-hidden-mobile is-family-serif is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height" id="postTopic"><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">对母校终端机的一次渗透</p><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">点击返回顶部</p></div></h3><aside class="is-flex-shrink-0"><h3 class="is-inline-block"><a href="/">首页</a></h3><h3 class="is-inline-block"><a href="/about">关于</a></h3><h3 class="is-inline-block"><a href="/archives">归档</a></h3></aside></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-center is-hidden-tablet"><h3 class="is-inline-block"><a href="/">首页</a></h3><h3 class="is-inline-block"><a href="/about">关于</a></h3><h3 class="is-inline-block"><a href="/archives">归档</a></h3></header><main><main class="container is-max-widescreen content section post-page pt-4 px-4"><div class="columns is-flex-desktop is-justify-content-center is-flex-direction-row-reverse"><div class="column is-3 is-hidden-mobile"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#0x01-%E4%B8%80%E7%82%B9%E6%84%9F%E6%82%9F"><span class="toc-text">0x01 一点感悟</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x02-%E6%9C%AC%E6%80%A7%E9%9A%BE%E7%A7%BB"><span class="toc-text">0x02:本性难移</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x03-%E5%94%A0%E5%97%91%E5%90%8E%E7%9A%84Getshell"><span class="toc-text">0x03:唠嗑后的Getshell</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x04-%E8%9B%8B%E7%96%BC%E7%9A%84%E6%8F%90%E6%9D%83"><span class="toc-text">0x04:蛋疼的提权</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x05-%E6%94%B6%E5%B0%BE"><span class="toc-text">0x05:收尾</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x06-%E6%83%B3%E6%B3%95%E4%B8%8E%E6%80%BB%E7%BB%93"><span class="toc-text">0x06:想法与总结</span></a></li></ol></div><div class="column is-9"><header class="my-4"><a href="/tags/%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98"><i class="tag post-item-tag">漏洞挖掘</i></a></header><h1 class="mt-0 mb-1 is-family-serif" id="postTitle">对母校终端机的一次渗透</h1><time class="has-text-grey" datetime="2017-06-17T05:02:00.000Z">2017-06-17</time><article class="mt-2 post-content"><h2 id="0x01-一点感悟"><a href="#0x01-一点感悟" class="headerlink" title="0x01 一点感悟"></a>0x01 一点感悟</h2><p>又回到最初的起点 记忆中你青涩的脸</p>
<p>我们终于 来到了这一天                   —胡夏《那些年》</p>
<p>当这首歌的旋律在我耳边响起，我的思绪仿佛一下间重返多年前。<br>有些情思，难以抓住，我已变成如今的自己。<br>纵使很多故人难以重逢，生活难以重返，但是我依然坚信踏实地走好现在的路便是最好的选择。<br>朋友们，好好珍惜现在处在一起的友情、爱情，这些青葱岁月的小幸运可能会成为人生中最美的一缕记忆。</p>
<p>趁着母校的学生还在上课，老师们没放假，我想回到母校走走，看看那些花儿、那些草木和那些日日夜夜陪伴我的老师。<br>伴着发动机的轰鸣声，我来到了母校。</p>
<h2 id="0x02-本性难移"><a href="#0x02-本性难移" class="headerlink" title="0x02:本性难移"></a>0x02:本性难移</h2><p>走在这片熟悉的土地上，抚摸大地的每一寸肌肤，嗅着花儿的芬芳，感受着蓝天白云，远山沧海之美，不由得有些心潮澎湃<br>看着操场上奔跑的少年，校园里卿卿我我的学生。<br>“依然是那般单纯且美好~”我感叹到。<br>看了下手表，马上就要到和老师约定的时间了，我便快马加鞭地走向老师的办公室<br>但是途中发现了这个好东西。。。。我这技术菜鸡的禽兽本性就暴露无遗了。。<br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191407864.png" alt="image"></p>
<p>我去，学校现在真的是发达了，学校里都装上这种查询用的触屏终端机了。<br>我好奇地点开各个栏目。。浏览了一下学校的各种新闻（由于终端机屏幕亮，这些照片反光比较厉害）<br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191407936.png" alt="image"></p>
<p>不得不为母校的日益辉煌感到高兴啊，终端机里的新闻都挺牛逼。<br>但是我点击左上方的LOGO时，惊奇的发现了这个<br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191407512.png" alt="image"></p>
<p>没错404界面，说明我们应该进入了浏览器，那么我们思路可以骚一点，利用浏览器的审查元素来实现输入法工具栏的弹出<br>当我们在404界面手指长摁屏幕时，相当于使用鼠标右键<br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191406618.png" alt="image-20230419132352843"></p>
<p>我们立马点开审查元素，找到一个可以输入字符的地方，召唤出我们亲爱的输入法<br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191408853.png" alt="image"></p>
<p>搜狗输入法。。。可以很强势，点击搜狗输入法的工具栏，成功弹出Windows系统下方的工具栏<br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191408786.png" alt="image"></p>
<p>然后利用搜狗的软键盘和下方的Windows工具栏，我们成功地打开cmd进行了一波信息搜集，这台终端机也宣布gg<br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191410094.png" alt="image"></p>
<p>没错，就这样把这台终端机给拿下了，我带着满心欢喜，上楼去找班主任的办公室。</p>
<h2 id="0x03-唠嗑后的Getshell"><a href="#0x03-唠嗑后的Getshell" class="headerlink" title="0x03:唠嗑后的Getshell"></a>0x03:唠嗑后的Getshell</h2><p>来到班主任的办公室里，班主任非常亲切地招待了我一番，颇有一番活跃的气氛<br>过了一会，班主任说她要上课了，我决定等她下班后和她吃顿饭。于是她把我安排在她办公室的座位上跟我说<br>——“你在这里拿我的电脑看看网页吧，我上完课和你一块出去哈”</p>
<p>这一句话可算是高兴坏了我，这简直是引狼入室啊。。。于是我拿出U盘，开始对学校内网进行进一步的探测。</p>
<p>首先使用ScanPort对192段内网开放的WEB服务进行了扫描</p>
<p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191410608.png" alt="image"></p>
<p>我看了一下，有些是路由器的管理界面，尝试了一些弱口令爆破无果后便放弃了<br>但是我发现了学校的一个校内直播平台 192.168.88.128:80</p>
<p>2.打开直播平台后，发现每次直播的发起人的用户名均是admin….运气好炸<br>用户登录界面没有验证码，果断进行一波猛如虎的爆破。。（忘截图了）</p>
<p>成功登录后台，找到一个LOGO的上传点上传SHELL<br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191410789.png" alt="image"></p>
<p>很明显。。。拦截掉了，但是目测肯定是用的前端认证。<br>直接在Burp的Http请求中修改shell.jpg为shell.php</p>
<p>如图所示<br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191410915.png" alt="image"></p>
<p>成功拿到SHELL<br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191410865.png" alt="image"></p>
<h2 id="0x04-蛋疼的提权"><a href="#0x04-蛋疼的提权" class="headerlink" title="0x04:蛋疼的提权"></a>0x04:蛋疼的提权</h2><p>whoami执行看了一下，权限比较小，没有c盘的写权限(所以shift后门还是算了)。<br>于是我上了一堆ms提权集试了下，发现补丁打的还算是及时，都没什么卵用。。。<br>后来翻了翻数据库配置文件，拿到了数据库的相关配置信息<br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191411392.png" alt="image"></p>
<p>UDF提权试下<br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191411538.png" alt="image"></p>
<p>OKOK，非常可以，直接上用户，使用默认3389端口登录服务器<br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191411845.png" alt="image"></p>
<h2 id="0x05-收尾"><a href="#0x05-收尾" class="headerlink" title="0x05:收尾"></a>0x05:收尾</h2><p>拿到服务器后，我在网站根目录写了一个PHP的文件下载系统，然后在服务器上架设好远控，跑到楼下的终端机上下载了远控木马执行<br>这样操作就更加方便了。正当我准备进行进一步嗅探时，我看了看时间已经不早了。。老师马上要下课了。。</p>
<p>于是我使用工具清理了一下服务器日志，删除了shell，拿QQ音乐放上一首老男孩，静静地听着。<br>随后老师回来了，我们愉快的离开校园，我叫上一个基友一块到万达吃了顿饭，感觉还不错<br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191411549.png" alt="image"></p>
<h2 id="0x06-想法与总结"><a href="#0x06-想法与总结" class="headerlink" title="0x06:想法与总结"></a>0x06:想法与总结</h2><p>当我离开校园时，我静静地回首望向一座座教学楼——那是我梦想开始的地方。<br>时至今日我已不记得多少个无助的夜里面，我听着那首《老男孩》，然后在宿舍里开着手电筒背书，学技术<br>我也不需要记得。</p>
<p>下面说一下终端机的常用渗透测试技巧:</p>
<blockquote>
<p>1.在终端机输入内容时，注意是否出现语言栏，很多情况可以利用语言栏进行渗透<br>2.可以频繁点击屏幕，程序有可能崩溃掉（不要笑，这是真的）<br>3.利用长摁某一位置出现的右键菜单（比如本篇文章中浏览器中的审查元素）<br>4.如果可以接触到终端机的电源，可以电源，然后让终端机重启，往往会有意想不到的结果</p>
</blockquote>
</article><section class="jump-container is-flex is-justify-content-space-between my-6"><!-- em is empty placeholder--><a class="button is-default" href="/2018/04/10/PHP%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E7%A5%9E%E5%99%A8%E2%80%94%E2%80%94RIPS%E4%B8%AA%E4%BA%BA%E6%B1%89%E5%8C%96%E7%89%88-1/" title="PHP代码审计神器——RIPS个人汉化版"><i class="iconfont icon-prev mr-2 has-text-grey"></i><span class="has-text-weight-semibold">上一页: PHP代码审计神器——RIPS个人汉化版</span></a></section><article class="mt-6 comment-container"><script async repo="j0o1ey/j0o1ey.github.io" src="https://utteranc.es/client.js" issue-term="pathname" theme="preferred-color-scheme"></script></article></div></div></main></main><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0 is-family-serif"><section class="sns-container"><a title="twitter" target="_blank" rel="noopener nofollow" href="//twitter.com//"><i class="iconfont icon-twitter"></i></a><!-- Github--><a title="github" target="_blank" rel="noopener nofollow" href="//github.com/j0o1ey"><i class="iconfont icon-github"></i></a><!-- Ins--><a title="instagram" target="_blank" rel="noopener nofollow" href="//www.instagram.com//"><i class="iconfont icon-ins"></i></a><!-- RSS--><!-- 知乎--><!-- 领英--><!-- 脸书--><a title="facebook" target="_blank" rel="noopener nofollow" href="//www.facebook.com//"><i class="iconfont icon-tian7_facebook"></i></a></section><p><span>Copyright ©</span><span> J0o1ey 2024</span></p><div class="is-flex is-justify-content-center is-flex-wrap-wrap"><p>Powered by Hexo &verbar;&nbsp;</p><p class="is-flex is-justify-content-center"><a title="Hexo theme author" target="_blank" rel="noopener" href="//github.com/haojen">Theme by Haojen&nbsp;</a></p><div style="margin-top: 2px"><a class="github-button" title="github-button" target="_blank" rel="noopener" href="https://github.com/haojen/hexo-theme-Claudia" data-color-scheme="no-preference: light; light: light; dark: dark;" data-show-count="true"></a></div></div><div><span></span></div></footer><script async defer src="https://buttons.github.io/buttons.js"></script><script src="/js/jquery-3.6.1.min.js"></script><script src="/js/jquery-fancybox.min.js"></script><script src="/js/img_zoom.js"></script><script src="/js/post.js"></script></body></html>